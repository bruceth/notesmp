(this.webpackJsonpnotes=this.webpackJsonpnotes||[]).push([[0],[,,,,,,,function(e,t,n){"use strict";n(23);var r=n(20);n.d(t,"userApi",(function(){return r.p}));var a=n(15);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return a.CStringEdit})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"Controller")&&n.d(t,"Controller",(function(){return a.Controller})),n.o(a,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return a.DropdownActions})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"IconText")&&n.d(t,"IconText",(function(){return a.IconText})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"NavView")&&n.d(t,"NavView",(function(){return a.NavView})),n.o(a,"Page")&&n.d(t,"Page",(function(){return a.Page})),n.o(a,"PropGrid")&&n.d(t,"PropGrid",(function(){return a.PropGrid})),n.o(a,"QueryPager")&&n.d(t,"QueryPager",(function(){return a.QueryPager})),n.o(a,"SearchBox")&&n.d(t,"SearchBox",(function(){return a.SearchBox})),n.o(a,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return a.TabCaptionComponent})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"nav")&&n.d(t,"nav",(function(){return a.nav})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"t")&&n.d(t,"t",(function(){return a.t}));n(93);var i=n(34);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return i.CStringEdit})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"Controller")&&n.d(t,"Controller",(function(){return i.Controller})),n.o(i,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return i.DropdownActions})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"IconText")&&n.d(t,"IconText",(function(){return i.IconText})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"NavView")&&n.d(t,"NavView",(function(){return i.NavView})),n.o(i,"Page")&&n.d(t,"Page",(function(){return i.Page})),n.o(i,"PropGrid")&&n.d(t,"PropGrid",(function(){return i.PropGrid})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"SearchBox")&&n.d(t,"SearchBox",(function(){return i.SearchBox})),n.o(i,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return i.TabCaptionComponent})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"nav")&&n.d(t,"nav",(function(){return i.nav})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"t")&&n.d(t,"t",(function(){return i.t}));var c=n(90);n.d(t,"CAppBase",(function(){return c.a})),n.d(t,"CBase",(function(){return c.b})),n.d(t,"CSub",(function(){return c.c})),n.d(t,"start",(function(){return c.d}));var o=n(32);n.d(t,"CStringEdit",(function(){return o.a})),n.d(t,"Controller",(function(){return o.b})),n.d(t,"VPage",(function(){return o.c})),n.d(t,"View",(function(){return o.d}))},,,,,,,,function(e,t,n){"use strict";n(57);var r=n(21);n.d(t,"NavView",(function(){return r.a})),n.d(t,"nav",(function(){return r.b}));var a=n(73);n.d(t,"Page",(function(){return a.a})),n.d(t,"TabCaptionComponent",(function(){return a.b}));var i=n(74);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return i.CStringEdit})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"Controller")&&n.d(t,"Controller",(function(){return i.Controller})),n.o(i,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return i.DropdownActions})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"IconText")&&n.d(t,"IconText",(function(){return i.IconText})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"PropGrid")&&n.d(t,"PropGrid",(function(){return i.PropGrid})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"SearchBox")&&n.d(t,"SearchBox",(function(){return i.SearchBox})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"emailRegex")&&n.d(t,"emailRegex",(function(){return i.emailRegex})),n.o(i,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return i.mobileRegex})),n.o(i,"resLang")&&n.d(t,"resLang",(function(){return i.resLang})),n.o(i,"resOptions")&&n.d(t,"resOptions",(function(){return i.resOptions})),n.o(i,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return i.setGlobalRes})),n.o(i,"setRes")&&n.d(t,"setRes",(function(){return i.setRes})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"t")&&n.d(t,"t",(function(){return i.t}));var c=n(88);n.d(t,"Form",(function(){return c.a}));var o=n(89);n.d(t,"Edit",(function(){return o.a}));var u=n(31);n.d(t,"resLang",(function(){return u.a})),n.d(t,"resOptions",(function(){return u.b})),n.d(t,"setGlobalRes",(function(){return u.c})),n.d(t,"setRes",(function(){return u.d})),n.d(t,"t",(function(){return u.e}));n(46);var s=n(37);n.d(t,"Image",(function(){return s.a}));n(59);var l=n(79);n.d(t,"emailRegex",(function(){return l.a})),n.d(t,"mobileRegex",(function(){return l.b}));var h=n(91);n.d(t,"List",(function(){return h.a}));var d=n(80);n.d(t,"DropdownActions",(function(){return d.a}));var f=n(81);n.d(t,"EasyTime",(function(){return f.a}));var p=n(92);n.d(t,"PropGrid",(function(){return p.a}));var v=n(42);n.d(t,"FA",(function(){return v.a})),n.d(t,"IconText",(function(){return v.b})),n.d(t,"LMR",(function(){return v.c})),n.d(t,"Muted",(function(){return v.d}));n(82);var m=n(83);n.d(t,"SearchBox",(function(){return m.a}));var b=n(84);n.d(t,"UserView",(function(){return b.a}))},,,,,function(e,t,n){"use strict";n.d(t,"l",(function(){return r.b})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return d.h})),n.d(t,"e",(function(){return d.d})),n.d(t,"d",(function(){return d.c})),n.d(t,"o",(function(){return d.j})),n.d(t,"n",(function(){return d.i})),n.d(t,"b",(function(){return d.a})),n.d(t,"c",(function(){return d.b})),n.d(t,"i",(function(){return d.g})),n.d(t,"p",(function(){return d.l})),n.d(t,"f",(function(){return v.a})),n.d(t,"m",(function(){return m.b})),n.d(t,"h",(function(){return m.a})),n.d(t,"k",(function(){return b.a}));n(36);var r=n(49),a=n(1),i=n.n(a),c=n(4),o=n(2),u=n(3),s=n(5),l=n(6),h=n(39),d=n(30),f=new(function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"guest",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("",{});case 2:t=e.sent,e.t0=typeof t,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(h.a)(t));case 8:return n=Object(h.a)(t.token),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unitFromName",value:function(){var e=Object(c.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t);case 2:return n=e.sent,e.abrupt("return",n&&n.unit);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(d.a))("tv/guest/",void 0),p=function(){function e(t,n){Object(o.a)(this,e),this._params=void 0,this.method="POST",this.waiting=void 0,this._params=t,this.waiting=n}return Object(u.a)(e,[{key:"buildParams",value:function(){return this.params}},{key:"params",get:function(){return this._params}},{key:"headers",get:function(){}}]),e}(),v=n(26),m=n(40),b=n(56)},function(e,t,n){"use strict";n.d(t,"a",(function(){return M})),n.d(t,"b",(function(){return z}));var r,a,i,c=n(13),o=n(10),u=n(9),s=(n(18),n(1)),l=n.n(s),h=n(4),d=n(2),f=n(3),p=n(11),v=n(5),m=n(6),b=n(0),y=n(8),k=n(95),g=n.n(k),w=n(24),O=n(30),j=n(36),x=function(e,t){Object(O.i)(e,t),j.a.setCenterToken(t)},E=n(20),C=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).reApi=Object(h.a)(l.a.mark((function t(){var n,r,a,i,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.props.clearError(),n=e.props,r=n.channel,a=n.url,i=n.options,c=n.resolve,o=n.reject,t.next=4,Object(E.l)(r,a,i,c,o);case 4:case"end":return t.stop()}}),t)}))),e.close=Object(h.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.clearError();case 1:case"end":return t.stop()}}),t)}))),e}return Object(f.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.error,r=t.url;if("object"===typeof n){var a=[];for(var i in n)a.push(b.createElement("li",{key:i},b.createElement("label",null,i),b.createElement("div",{style:{wordWrap:"break-word"}},n[i])));e=b.createElement("ul",null,a)}else e=b.createElement("div",null,n);return b.createElement("div",null,b.createElement("article",null,b.createElement("main",{className:"va-error"},b.createElement("div",null,"\u7f51\u7edc\u51fa\u73b0\u95ee\u9898"),b.createElement("div",null,"\u70b9\u51fb\u91cd\u65b0\u8bbf\u95ee"),b.createElement("div",{style:{wordWrap:"break-word"}},"url: ",r),e,b.createElement("div",{className:"p-3"},b.createElement("button",{type:"button",onClick:this.reApi},"\u91cd\u65b0API"),b.createElement("button",{type:"button",onClick:this.close},"\u5173\u95ed")))))}}]),n}(b.Component),N=function(e){var t=e.message;return b.createElement(w.a,{header:"\u7cfb\u7edf\u63d0\u9192"},b.createElement("div",{className:"px-3"},t))},I=n(26),S=n(23),A=n(31),P=n(46),T=n(57),F=n(16),V=n.n(F),R=(n(72),n(98),n(109),n(110),n(42)),_=n(52),D=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(d.a)(this,n),(r=t.call(this,e)).timerHandler=void 0,r.reload=function(){clearInterval(r.timerHandler),z.reload()};var a=e.seconds;return void 0===a?Object(_.a)(r):(r.state={seconds:a},a<=0?Object(_.a)(r):(r.timerHandler=setInterval((function(){var e=r.state.seconds;--e<=0?r.reload():r.setState({seconds:e})}),1e3),r))}return Object(f.a)(n,[{key:"render",value:function(){var e,t;return this.state.seconds>0?(e="\u7a0b\u5e8f\u5347\u7ea7\u4e2d...",t=this.state.seconds+"\u79d2\u949f\u4e4b\u540e\u81ea\u52a8\u91cd\u542f\u52a8"):(e="\u7a0b\u5e8f\u9700\u8981\u5347\u7ea7",t="\u8bf7\u70b9\u51fb\u4e0b\u9762\u6309\u94ae\u91cd\u542f"),b.createElement(w.a,{header:!1},b.createElement("div",{className:"text-center p-5"},b.createElement("div",{className:"text-info py-5"},b.createElement("span",{className:"text-danger"},e),b.createElement("br",null),t,b.createElement("br",null),b.createElement("span",{className:"small text-muted"},this.props.message)),b.createElement("button",{className:"btn btn-danger",onClick:this.reload},"\u7acb\u523b\u91cd\u542f")))}}]),n}(b.Component),B=function(e){return b.createElement(w.a,{header:"\u5347\u7ea7\u8f6f\u4ef6",back:"close"},b.createElement("div",{className:"py-5 px-3 my-5 mx-2 border bg-white rounded"},b.createElement("div",{className:"text-center text-info"},"\u5347\u7ea7\u5c06\u6e05\u9664\u6240\u6709\u672c\u673a\u7f13\u51b2\u533a\u5185\u5bb9\uff0c\u5e76\u4ece\u670d\u52a1\u5668\u91cd\u65b0\u5b89\u88c5\u7a0b\u5e8f\uff01"),b.createElement("div",{className:"text-center mt-5"},b.createElement("button",{className:"btn btn-danger mr-3",onClick:function(){return e.confirm(!0)}},"\u786e\u8ba4\u5347\u7ea7"))))},U=new RegExp("Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i").test(navigator.userAgent),L=[],q=1,M=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).stack=void 0,r.htmlTitle=void 0,r.waitCount=0,r.waitTimeHandler=void 0,r.upgradeUq=function(){z.start()},r.isHistoryBack=!1,r.navBack=function(){var e=Date.now();r.isHistoryBack=!0,r.back(!0),r.isHistoryBack=!1,console.log("///\\\\ ".concat(Date.now()-e,"ms backbutton pressed - nav level: ").concat(r.stack.length))},r.back=Object(h.a)(l.a.mark((function e(){var t,n,a,i,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(c.length>0&&void 0!==c[0])||c[0],n=r.stack,0!==(a=n.length)){e.next=5;break}return e.abrupt("return");case 5:if(1!==a){e.next=8;break}return window.self!==window.top&&window.top.postMessage({type:"pop-app"},"*"),e.abrupt("return");case 8:if(i=n[a-1],!0!==t||!i.confirmClose){e.next=17;break}return e.next=12,i.confirmClose();case 12:if(e.t0=e.sent,!0!==e.t0){e.next=15;break}r.pop();case 15:e.next=18;break;case 17:r.pop();case 18:case"end":return e.stop()}}),e)}))),r.clearError=function(){r.setState({fetchError:void 0})},r.stack=[],r.state={stack:r.stack,wait:0,fetchError:void 0},z.set(Object(p.a)(r)),r}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.addEventListener("popstate",this.navBack),!1!==z.isRouting){e.next=4;break}return e.next=4,z.init();case 4:return e.next=6,z.start();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startWait",value:function(){var e=this;0===this.waitCount&&(this.setState({wait:1}),this.waitTimeHandler=S.c.setTimeout("NavView.startWait",(function(){e.waitTimeHandler=void 0,e.setState({wait:2})}),1e3)),++this.waitCount,this.setState({fetchError:void 0})}},{key:"endWait",value:function(){var e=this;S.c.setTimeout(void 0,(function(){--e.waitCount,0===e.waitCount&&(void 0!==e.waitTimeHandler&&(S.c.clearTimeout(e.waitTimeHandler),e.waitTimeHandler=void 0),e.setState({wait:0}))}),100)}},{key:"onError",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=t.error)){e.next=14;break}if(!0!==n.unauthorized){e.next=6;break}return e.next=5,z.showLogin(void 0);case 5:return e.abrupt("return");case 6:e.t0=n.type,e.next="unauthorized"===e.t0?9:"sheet-processing"===e.t0?12:14;break;case 9:return e.next=11,z.showLogin(void 0);case 11:return e.abrupt("return");case 12:return z.push(b.createElement(N,{message:"\u5355\u636e\u6b63\u5728\u5904\u7406\u4e2d\u3002\u8bf7\u91cd\u65b0\u64cd\u4f5c\uff01"})),e.abrupt("return");case 14:this.setState({fetchError:t});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.show(b.createElement(w.a,{header:!1},b.createElement("div",null,"UQ\u5347\u7ea7\u4e86\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u5347\u7ea7 ",b.createElement("br",null),b.createElement("small",{className:"text-muted"},t," ver-",n),b.createElement("button",{className:"btn btn-primary",onClick:this.upgradeUq},"\u5347\u7ea7"))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"show",value:function(e,t){return this.clear(),this.push(e,t)}},{key:"push",value:function(e,t){this.removeCeased(),this.stack.length>0&&window.history.pushState("forward",null,null);var n=q++;return this.stack.push({key:n,view:e,ceased:!1,disposer:t}),this.refresh(),n}},{key:"replace",value:function(e,t){var n=void 0,r=this.stack;r.length>0&&(n=r.pop());var a=q++;return this.stack.push({key:a,view:e,ceased:!1,disposer:t}),void 0!==n&&this.dispose(n.disposer),this.refresh(),a}},{key:"ceaseTop",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack.length-1,n=0;n<e&&!(t<0);n++,t--){var r=this.stack[t];r.ceased=!0}}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.stack,n=t.length;if(!(e<=0||n<=1)){n<e&&(e=n);for(var r=0,a=0;a<e&&0!==t.length;a++)this.popAndDispose(),++r;r>=n&&r--,this.refresh(),this.isHistoryBack}}},{key:"popTo",value:function(e){if(void 0!==e&&void 0!==this.stack.find((function(t){return t.key===e})))for(;this.stack.length>0;){var t=this.stack.length;if(this.stack[t-1].key===e)break;this.pop()}}},{key:"topKey",value:function(){var e=this.stack.length;if(0!==e)return this.stack[e-1].key}},{key:"removeCeased",value:function(){for(;;){var e=this.stack.length-1;if(e<0)break;if(!1===this.stack[e].ceased)break;var t=this.stack.pop().disposer;this.dispose(t)}this.refresh()}},{key:"popAndDispose",value:function(){this.removeCeased();var e=this.stack.pop();if(void 0!==e){var t=e.disposer;return this.dispose(t),this.removeCeased(),e}}},{key:"dispose",value:function(e){void 0!==e&&(void 0===this.stack.find((function(t){return t.disposer===e}))&&e())}},{key:"clear",value:function(){for(this.stack.length;this.stack.length>0;)this.popAndDispose()}},{key:"regConfirmClose",value:function(e){var t=this.stack,n=t.length;0!==n&&(t[n-1].confirmClose=e)}},{key:"confirmBox",value:function(e){return window.confirm(e)}},{key:"render",value:function(){var e=this.state,t=e.wait,n=e.fetchError,r=this.state.stack,a=r.length-1,i=null,c=null;switch(t){case 1:i=b.createElement("div",{className:"va-wait va-wait1"});break;case 2:i=b.createElement("div",{className:"va-wait va-wait2"},b.createElement(P.a,null))}n&&(c=b.createElement(C,Object.assign({clearError:this.clearError},n)));var o=!0===z.testing&&b.createElement("span",{className:"cursor-pointer position-fixed",style:{top:0,left:"0.2rem",zIndex:90001}},b.createElement(R.a,{className:"text-warning",name:"info-circle"}));return b.createElement(b.Fragment,null,r.map((function(e,t){var n=e.key,r=e.view;return b.createElement("div",{key:n,style:t<a?{visibility:"hidden",position:"absolute"}:void 0},r)})),i,c,o)}},{key:"refresh",value:function(){this.setState({stack:this.stack})}},{key:"level",get:function(){return this.stack.length}}]),n}(b.Component),z=new(r=function(){function e(){var t=this;Object(d.a)(this,e),this.nav=void 0,this.wsHost=void 0,this.local=new S.a,this.navigo=void 0,this.isRouting=!1,this.navSettings=void 0,Object(o.a)(this,"user",a,this),this.testing=void 0,this.language=void 0,this.culture=void 0,this.resUrl=void 0,this.hashParam=void 0,this.centerHost=void 0,this.arrs=["/test","/test/"],this.windowOnError=function(e,t,n,r,a){console.error("windowOnError"),console.error(a)},this.windowOnUnhandledRejection=function(e){console.error("windowOnUnhandledRejection"),console.error(e.reason)},this.windowOnClick=function(e){console.error("windowOnClick")},this.windowOnMouseMove=function(e){console.log("navigator.userAgent: "+navigator.userAgent),console.log("mouse move (%s, %s)",e.x,e.y)},this.windowOnScroll=function(e){console.log("scroll event")},this.showPrivacyPage=function(){var e=t.getPrivacyContent();e?t.privacyPage(e):z.push(b.createElement(w.a,{header:"\u9690\u79c1\u653f\u7b56"},b.createElement("div",{className:"p-3"},"AppConfig \u4e2d\u6ca1\u6709\u5b9a\u4e49 privacy\u3002\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5b57\u7b26\u4e32\uff0c\u6216\u8005url\u3002markdown\u683c\u5f0f")))},this.privacyPage=function(){var e=Object(h.a)(l.a.mark((function e(n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPrivacy(n);case 2:r=e.sent,a={__html:g()(r)},z.push(b.createElement(w.a,{header:"\u9690\u79c1\u653f\u7b56"},b.createElement("div",{className:"p-3",dangerouslySetInnerHTML:a})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.reload=Object(h.a)(l.a.mark((function e(){var t,n,r,a,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new Promise((function(e,t){setTimeout(e,100)})),!("serviceWorker"in navigator)){e.next=6;break}return e.next=4,Promise.race([t,navigator.serviceWorker.ready]);case 4:(n=e.sent)&&n.unregister();case 6:window.document.location.reload(),(r=window.plus)&&((a=r.webview)?a.reload&&a.reload(!0):(i=r.webView)&&i.reload&&i.reload(!0));case 9:case"end":return e.stop()}}),e)}))),this.resetAll=function(){t.push(b.createElement(B,{confirm:function(e){!0===e?(t.showReloadPage("\u5f7b\u5e95\u5347\u7ea7"),localStorage.clear()):t.pop()}}))};var n=A.b.lang,r=A.b.district;this.language=n,this.culture=r,this.testing=!1}return Object(f.a)(e,[{key:"set",value:function(e){this.nav=e}},{key:"onReceive",value:function(){var e=Object(h.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.k.dispatch(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadUnitJson",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.unitJsonPath(),e.next=4,fetch(t,{});case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r.unit);case 11:return e.prev=11,e.t0=e.catch(0),this.local.unit.remove(),e.abrupt("return");case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPredefinedUnitName",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=document.getElementById("unit"))){e.next=3;break}return e.abrupt("return",t.innerText);case 3:if(t=document.getElementById("unit.json")){e.next=8;break}return e.next=7,this.loadUnitJson();case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,n=t.innerHTML,r=JSON.parse(n),e.abrupt("return",r.unit);case 14:return e.prev=14,e.t0=e.catch(8),e.next=18,this.loadUnitJson();case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e,this,[[8,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadPredefinedUnit",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UNIT)){e.next=3;break}return e.abrupt("return",Number(t));case 3:if(void 0===(r=this.local.unit.get())){e.next=16;break}if(!0===S.c.isDevelopment){e.next=7;break}return e.abrupt("return",r.id);case 7:return e.next=9,this.getPredefinedUnitName();case 9:if(void 0!==(n=e.sent)){e.next=12;break}return e.abrupt("return");case 12:if(r.name!==n){e.next=14;break}return e.abrupt("return",r.id);case 14:e.next=21;break;case 16:return e.next=18,this.getPredefinedUnitName();case 18:if(void 0!==(n=e.sent)){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,E.g.unitFromName(n);case 23:return void 0!==(a=e.sent)&&this.local.unit.set({id:a,name:n}),e.abrupt("return",a);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setSettings",value:function(e){this.navSettings=e}},{key:"unitJsonPath",value:function(){var e=document.location,t=e.origin,n=e.pathname;n=n.toLowerCase();var r,a=Object(c.a)(this.arrs);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!0===V.a.endsWith(n,i)){n=n.substr(0,n.length-i.length);break}}}catch(o){a.e(o)}finally{a.f()}return!0!==V.a.endsWith(n,"/")&&!0!==V.a.endsWith(n,"\\")||(n=n.substr(0,n.length-1)),t+n+"/unit.json"}},{key:"init",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,r,a,i,c,o,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.testing=S.c.testing,e.next=3,E.h.start(this.testing);case 3:if(void 0!==(t=document.location.hash)&&t.length>0&&((n=Object(I.g)())<0&&(n=void 0),this.hashParam=t.substring(1,n)),r=E.h.url,a=E.h.ws,i=E.h.resHost,this.centerHost=r,this.resUrl=Object(E.m)(i),this.wsHost=a,Object(E.o)(r),void 0!==(c=this.local.guest.get())){e.next=15;break}return e.next=14,E.g.guest();case 14:c=e.sent;case 15:if(c){e.next=18;break}throw Error("guest can not be undefined");case 18:if(z.setGuest(c),o=Object(I.f)(),u=Object(I.j)(o),void 0===o||window===window.parent){e.next=26;break}if(void 0===u){e.next=26;break}return console.log("this.ws = wsBridge in sub frame"),window.self!==window.parent&&window.parent.postMessage({type:"sub-frame-started",hash:u.hash},"*"),e.abrupt("return");case 26:return e.next=28,this.loadPredefinedUnit();case 28:s=e.sent,u.predefinedUnit=s;case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,window.onerror=this.windowOnError,window.onunhandledrejection=this.windowOnUnhandledRejection,!0===U&&(document.onselectstart=function(){return!1},document.oncontextmenu=function(){return!1}),z.clear(),this.startWait(),void 0!==(t=this.local.user.get())){e.next=17;break}if(void 0===(n=this.nav.props.notLogined)){e.next=14;break}return e.next=12,n();case 12:e.next=16;break;case 14:return e.next=16,z.showLogin(void 0);case 16:return e.abrupt("return");case 17:return e.next=19,z.logined(t);case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0);case 25:return e.prev=25,this.endWait(),e.finish(25);case 28:case"end":return e.stop()}}),e,this,[[0,21,25,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"resolveRoute",value:function(){!1!==this.isRouting&&void 0!==this.navigo&&this.navigo.resolve()}},{key:"on",value:function(){return void 0===this.navigo&&(this.navigo=new T.a),this.navigo.on(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"navigate",value:function(e,t){return this.clear(),this.navigo.navigate(e,t)}},{key:"go",value:function(e,t,n){void 0!==this.navigo?this.navigate(t,n):e()}},{key:"showAppView",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.nav.props.onLogined)){e.next=4;break}return z.push(b.createElement("div",null,"NavView has no prop onLogined")),e.abrupt("return");case 4:return z.clear(),e.next=7,n(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setGuest",value:function(e){this.local.guest.set(e),x(0,e.token)}},{key:"saveLocalUser",value:function(){this.local.user.set(this.user)}},{key:"loadMe",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.p.me();case 2:t=e.sent,this.user.icon=t.icon,this.user.nick=t.nick;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"internalLogined",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(E.j)(),console.log("logined: %s",JSON.stringify(t)),this.user=t,this.saveLocalUser(),x(t.id,t.token),z.clear(),void 0===n){e.next=10;break}n(t),e.next=12;break;case 10:return e.next=12,this.showAppView(r);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"logined",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalLogined(t,n,!1);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"userLogined",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalLogined(t,n,!0);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loginTop",value:function(e){return this.navSettings&&this.navSettings.loginTop||e}},{key:"privacyEntry",value:function(){if(this.getPrivacyContent())return b.createElement("div",{className:"text-center"},b.createElement("button",{className:"btn btn-sm btn-link",onClick:this.showPrivacyPage},b.createElement("small",{className:"text-muted"},"\u9690\u79c1\u653f\u7b56")))}},{key:"getPrivacyContent",value:function(){if(this.navSettings)return this.navSettings.privacy}},{key:"getPrivacy",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n,r,a,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Headers({"Content-Type":"text/plain"}),!((r=t.indexOf("://"))>0)){e.next=18;break}if("http"!==(a=t.substring(0,r).toLowerCase())&&"https"!==a){e.next=18;break}return e.prev=5,e.next=8,fetch(t,{method:"GET",headers:n});case 8:return i=e.sent,e.next=11,i.text();case 11:return c=e.sent,e.abrupt("return",c);case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",e.t0.message);case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"showLogin",value:function(){var e=Object(h.a)(l.a.mark((function e(t,r){var a,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(3).then(n.bind(null,120));case 2:a=e.sent,i=b.createElement(a.default,{withBack:r,callback:t}),!0!==r&&(this.nav.clear(),this.pop()),this.nav.push(i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"showLogout",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n,r=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=b.createElement("div",{className:"text-center justify-content-center"},b.createElement("button",{className:"btn btn-outline-danger",onClick:this.resetAll},"\u5347\u7ea7\u8f6f\u4ef6")),z.push(b.createElement(w.a,{header:"\u5b89\u5168\u9000\u51fa",back:"close",footer:n},b.createElement("div",{className:"my-5 mx-1 border border-info bg-white rounded p-3 text-center"},b.createElement("div",null,"\u9000\u51fa\u5f53\u524d\u8d26\u53f7\u4e0d\u4f1a\u5220\u9664\u4efb\u4f55\u5386\u53f2\u6570\u636e\uff0c\u4e0b\u6b21\u767b\u5f55\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u672c\u8d26\u53f7"),b.createElement("div",{className:"mt-3 text-center"},b.createElement("button",{className:"btn btn-danger",onClick:function(){return r.logout(t)}},"\u5b89\u5168\u9000\u51fa")))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.f.unit=void 0,this.local.logoutClear(),this.user=void 0,Object(E.j)(),n=this.local.guest.get(),Object(E.n)(0,n&&n.token),this.clear(),void 0!==t){e.next=12;break}return e.next=10,z.start();case 10:e.next=14;break;case 12:return e.next=14,t();case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changePassword",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(4).then(n.bind(null,119));case 2:t=e.sent,z.push(b.createElement(t.ChangePasswordPage,null));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startWait",value:function(){var e;null===(e=this.nav)||void 0===e||e.startWait()}},{key:"endWait",value:function(){var e;null===(e=this.nav)||void 0===e||e.endWait()}},{key:"onError",value:function(){var e=Object(h.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nav.onError(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nav.showUpgradeUq(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"show",value:function(e,t){this.nav.show(e,t)}},{key:"push",value:function(e,t){this.nav.push(e,t)}},{key:"replace",value:function(e,t){this.nav.replace(e,t)}},{key:"pop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.nav.pop(e)}},{key:"topKey",value:function(){return this.nav.topKey()}},{key:"popTo",value:function(e){this.nav.popTo(e)}},{key:"clear",value:function(){var e;null===(e=this.nav)||void 0===e||e.clear()}},{key:"navBack",value:function(){this.nav.navBack()}},{key:"ceaseTop",value:function(e){this.nav.ceaseTop(e)}},{key:"removeCeased",value:function(){this.nav.removeCeased()}},{key:"back",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(n.length>0&&void 0!==n[0])||n[0],e.next=3,this.nav.back(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"regConfirmClose",value:function(e){this.nav.regConfirmClose(e)}},{key:"confirmBox",value:function(e){return this.nav.confirmBox(e)}},{key:"navToApp",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,r,a,i){var c=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var u=!0===c.centerHost.includes("http://localhost:")?"sheet_debug":"sheet",s=void 0===i?Object(I.c)(t,n):Object(I.c)(t,n,u,[r,a,i]);console.log("navToApp: %s",JSON.stringify(s)),z.push(b.createElement("article",{className:"app-container"},b.createElement("span",{id:s.hash,onClick:function(){return c.back()}},b.createElement("i",{className:"fa fa-arrow-left"})),b.createElement("iframe",{src:s.url,title:String(i)})),(function(){e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"navToSite",value:function(e){window.open(e)}},{key:"log",value:function(e){L.push(e)}},{key:"logMark",value:function(){var e=new Date;i=e.getTime(),L.push("log-mark: "+e.toTimeString())}},{key:"logStep",value:function(e){L.push(e+": "+((new Date).getTime()-i))}},{key:"showReloadPage",value:function(e){this.push(b.createElement(D,{message:e,seconds:-1}))}},{key:"checkVersion",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,n,r,a,i,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.location.href,t+=(t.indexOf("?")>=0?"&":"?")+"_t_t_="+(new Date).getTime(),e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.text();case 7:return r=e.sent,a=new DOMParser,i=a.parseFromString(r,"text/html"),c=i.getElementsByTagName("html"),o=c[0].getAttribute("data-version"),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"guest",get:function(){var e=this.local.guest;if(void 0===e)return 0;var t=e.get();return void 0===t?0:t.guest}},{key:"oem",get:function(){return this.navSettings&&this.navSettings.oem}},{key:"level",get:function(){return this.nav.level}},{key:"logs",get:function(){return L}}]),e}(),a=Object(u.a)(r.prototype,"user",[y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),r)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return v.a})),n.d(t,"d",(function(){return b}));n(39),n(33);var r,a,i=n(55),c=n(1),o=n.n(c),u=n(4),s=n(13),l=n(10),h=n(2),d=n(3),f=n(9),p=(n(18),n(8)),v=(r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(h.a)(this,e),this.maxCount=void 0,this.arr=[],Object(l.a)(this,"dict",a,this),this.maxCount=t}return Object(d.a)(e,[{key:"loadIds",value:function(e){var t,n=[],r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(null!==a){var i=this.dict.get(a);void 0===i&&(n.push(a),i={id:a},this.dict.set(a,i))}}}catch(c){r.e(c)}finally{r.f()}this.loadId(n)}},{key:"get",value:function(e){if(void 0===e||null===e)return null;var t=this.dict.get(e);return void 0===t&&(this.dict.set(e,{id:e}),this.loadId([e]),t=this.dict.get(e)),t}},{key:"setItem",value:function(e,t){void 0===t?(this.dict.set(e,null),this.arr.push({id:e})):(this.dict.set(e,t),this.arr.push(t)),this.arr.length>this.maxCount&&(t=this.arr.shift(),this.dict.delete(t.id))}},{key:"loadId",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,a,i,c,u,l,h,d=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadIds(t);case 2:if(void 0!==(n=e.sent)){e.next=27;break}r=Object(s.a)(t),e.prev=5,r.s();case 7:if((a=r.n()).done){e.next=17;break}if(null!==(i=a.value)){e.next=11;break}return e.abrupt("continue",15);case 11:return e.next=13,this._loadId(i);case 13:c=e.sent,this.setItem(i,c);case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(5),r.e(e.t0);case 22:return e.prev=22,r.f(),e.finish(22);case 25:e.next=29;break;case 27:u=Object(s.a)(t);try{for(h=function(){var e=l.value,t=n.find((function(t){return t.id===e}));d.setItem(e,t)},u.s();!(l=u.n()).done;)h()}catch(o){u.e(o)}finally{u.f()}case 29:case"end":return e.stop()}}),e,this,[[5,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),a=Object(f.a)(r.prototype,"dict",[p.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),n(43),n(47)),m=function(){function e(){Object(h.a)(this,e),this.user=v.a.localDb.child("user"),this.guest=v.a.localDb.child("guest"),this.unit=v.a.localDb.child("unit"),this._user=void 0,this._guest=void 0,this._unit=void 0}return Object(d.a)(e,[{key:"readToMemory",value:function(){this._user=this.user.get(),this._guest=this.guest.get(),this._unit=this.unit.get()}},{key:"saveToLocalStorage",value:function(){this.user.set(this._user),this.guest.set(this._guest),this.unit.set(this._unit)}},{key:"logoutClear",value:function(){[this.user,this.unit].forEach((function(e){return e.remove()}))}}]),e}();function b(e,t){if(e&&t){var n=Object.keys(e);t=t.toLowerCase();for(var r=0,a=n;r<a.length;r++){var i=a[r];if(i.toLowerCase()===t)return e[i]}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,a=n(2),i=n(3),c=n(5),o=n(6),u=n(0),s=n(12),l=n(1),h=n.n(l),d=n(4),f=n(21),p=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).back=Object(d.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.b.back();case 2:(n=e.props.afterBack)&&n();case 4:case"end":return t.stop()}}),t)}))),e.logoutClick=function(){f.b.showLogout(e.logout)},e.logout=Object(d.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"!==typeof(n=e.props.logout)){t.next=4;break}return t.next=4,n();case 4:return t.next=6,f.b.logout(void 0);case 6:case"end":return t.stop()}}),t)}))),e}return Object(i.a)(n,[{key:"openWindow",value:function(){window.open(document.location.href)}},{key:"render",value:function(){var e,t,n=f.b.level>1||window.self!==window.top,r=this.props,a=r.right,i=r.center,c=r.logout,o=r.className,s=r.ex;if(void 0!==c&&window.self===window.top&&("boolean"===typeof c&&!0===c||"function"===typeof c)){var l=f.b.user;if(void 0!==l){var h=l.nick,d=l.name;t=u.createElement("div",{className:"d-flex align-items-center"},u.createElement("small",{className:"text-light"},h||d),u.createElement("div",{className:"ml-2 py-2 px-3 cursor-pointer",role:"button",onClick:this.logoutClick},u.createElement("i",{className:"fa fa-sign-out fa-lg"})))}}if(n)switch(this.props.back){case"none":e=void 0;break;default:case"back":e=u.createElement("nav",{onClick:this.back},u.createElement("i",{className:"fa fa-angle-left"}));break;case"close":e=u.createElement("nav",{onClick:this.back},u.createElement("i",{className:"fa fa-close"}))}window.self!==window.top&&console.log(document.location.href),void 0===e&&"string"===typeof i&&(i=u.createElement("div",{className:"px-3"},i));var p=(a||t)&&u.createElement("aside",null,a," ",t),v=u.createElement("header",{className:o},u.createElement("nav",null,e,u.createElement("div",null,i),p),s);return u.createElement(u.Fragment,null,u.createElement("section",{className:"tv-page-header"},v),v)}}]),n}(u.Component),v=n(58),m=n(45),b=Object(s.a)(r=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(e){var r;Object(a.a)(this,n),(r=t.call(this,e)).tabsView=void 0;var i=e.tabsProps;return i&&(r.tabsView=new v.b(i)),r}return Object(i.a)(n,[{key:"renderHeader",value:function(){var e=this.props,t=e.back,n=e.header,r=e.right,a=e.headerClassName,i=e.afterBack;return!1!==n&&u.createElement(p,{back:t,center:n,right:r,logout:this.props.logout,className:a,afterBack:i})}},{key:"renderFooter",value:function(){var e=this.props.footer;if(e){var t=u.createElement("footer",null,e);return u.createElement(u.Fragment,null,u.createElement("section",{className:"tv-page-footer"},t),t)}}},{key:"render",value:function(){if(this.tabsView)return u.createElement(this.tabsView.content);var e=this.props,t=e.onScroll,n=e.onScrollTop,r=e.onScrollBottom,a=e.children,i=e.className;return u.createElement(m.a,{onScroll:t,onScrollTop:n,onScrollBottom:r,className:i},this.renderHeader(),u.createElement("main",null,a),this.renderFooter())}}]),n}(u.Component))||r},,function(e,t,n){"use strict";n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return y})),n.d(t,"h",(function(){return k})),n.d(t,"j",(function(){return N})),n.d(t,"g",(function(){return I})),n.d(t,"f",(function(){return S})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return F})),n.d(t,"b",(function(){return R})),n.d(t,"d",(function(){return D}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(16),s=n.n(u),l=n(15),h=n(33),d=n(30),f=n(36),p=n(40),v={};function m(){for(var e in v)v[e]=void 0}var b={},y=new(function(){function e(){Object(c.a)(this,e),this.hash=void 0,this._unit=void 0,this.page=void 0,this.param=void 0}return Object(o.a)(e,[{key:"unit",get:function(){return this._unit},set:function(e){this._unit=e}}]),e}());function k(){return window.self!==window.parent}function g(e){var t=e.data,n=e.source;Object(f.b)(n),function(e){var t=document.getElementById(e);void 0!==t&&(t.hidden=!0)}(t.hash);var r=s.a.clone(l.nav.user);r.type="init-sub-win",n.postMessage(r,"*")}function w(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("initSubWin: set nav.user",t),n=l.nav.user=t,Object(d.i)(n.id,n.token),e.next=5,l.nav.showAppView();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return x.apply(this,arguments)}function x(){return(x=Object(i.a)(a.a.mark((function e(t,n){var r,i,c,o,u,s,l,h,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=b[t])){e.next=3;break}return e.abrupt("return",{name:n,db:void 0,url:void 0,token:void 0});case 3:return i=r.unit,c=r.predefinedUnit,(i=i||c)||console.error("no unit defined in unit.json or in index.html, or not logined in",i),o=n.split("/"),u={unit:i,uqOwner:o[0],uqName:o[1],appOwner:o[2],appName:o[3]},console.log("uqTokenApi.uq onReceiveAppApiMessage",u),e.next=11,d.k.uq(u);case 11:return s=e.sent,l=s.db,h=s.url,f=s.token,e.abrupt("return",{name:n,db:l,url:h,token:f});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return C.apply(this,arguments)}function C(){return(C=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.apiName,r=t.db,i=t.url,c=t.urlTest,o=t.token,void 0!==(u=T[n])){e.next=4;break}throw new Error("error app api return");case 4:s=p.a.getUrlOrTest(r,i,c),console.log("onAppApiReturn(message:any): url="+i+", real="+s),u.resolve({name:n,db:r,url:s,token:o});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){if(e){var t=e.split("-"),n=t.length;if(n>0){var r=1;y.hash=t[r++],n>0&&(y.unit=Number(t[r++])),n>1&&(y.page=t[r++]),n>2&&(y.param=t.slice(r++))}}return y}function I(){var e=document.location.hash;if(void 0!==e&&e.length>0){var t=e.lastIndexOf("#tv-");return t<0&&(t=e.lastIndexOf("#tvdebug-")),t}return-1}function S(){var e=I();if(!(e<0))return document.location.hash.substring(e)}function A(e,t,n,r){for(var a;;){if(a=Object(h.a)(),void 0===b[a]){b[a]={hash:a,unit:t};break}}if(e+="#tv-"+a+"-"+t,void 0!==n&&(e+="-"+n,void 0!==r))for(var i=0;i<r.length;i++)e+="-"+r[i];return{url:e,hash:a}}function P(){var e=y.unit,t=y.predefinedUnit,n=e||t;if(void 0===n)throw new Error("no unit defined in unit.json or not logined in");return n}window.addEventListener("message",function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,e.t0=n.type,e.next="sub-frame-started"===e.t0?4:"ws"===e.t0?6:"init-sub-win"===e.t0?9:"pop-app"===e.t0?12:"center-api"===e.t0?15:"center-api-return"===e.t0?18:"app-api"===e.t0?20:"app-api-return"===e.t0?25:30;break;case 4:return g(t),e.abrupt("break",34);case 6:return e.next=8,l.nav.onReceive(n.msg);case 8:return e.abrupt("break",34);case 9:return e.next=11,w(n);case 11:return e.abrupt("break",34);case 12:return window.console.log("///\\\\\\ pop-app"),l.nav.navBack(),e.abrupt("break",34);case 15:return e.next=17,U(t.source,n);case 17:return e.abrupt("break",34);case 18:return q(n),e.abrupt("break",34);case 20:return e.next=22,j(n.hash,n.apiName);case 22:return r=e.sent,t.source.postMessage({type:"app-api-return",apiName:n.apiName,db:r.db,url:r.url,token:r.token},"*"),e.abrupt("break",34);case 25:return console.log("app-api-return: %s",JSON.stringify(n)),console.log("await onAppApiReturn(message);"),e.next=29,E(n);case 29:return e.abrupt("break",34);case 30:if(!n.source||!0!==s.a.startsWith(n.source,"react-devtools")){e.next=32;break}return e.abrupt("break",34);case 32:return window.console.log("message: %s",JSON.stringify(n)),e.abrupt("break",34);case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var T={};function F(e,t,n,r,a){return V.apply(this,arguments)}function V(){return(V=Object(i.a)(a.a.mark((function e(t,n,r,c,o){var u,s,l,h,f,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k()){e.next=12;break}return u=P(),e.next=4,d.k.uq({unit:u,uqOwner:n,uqName:r,appOwner:c,appName:o});case 4:return void 0===(s=e.sent).token&&(s.token=d.f),l=s.db,h=s.url,f=s.urlTest,m=p.a.getUrlOrTest(l,h,f),console.log("realUrl: %s",m),s.url=m,v[t]=s,e.abrupt("return",s);case 12:if(console.log("**** before buildAppUq ****",y),void 0===T[t]){e.next=16;break}return e.abrupt("return");case 16:return e.abrupt("return",new Promise((function(e,n){T[t]={resolve:function(){var n=Object(i.a)(a.a.mark((function n(r){var i,c,o,u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r;case 2:i=n.sent,c=i.db,o=i.url,u=i.token,v[t]={name:t,db:c,url:o,token:u},T[t]=void 0,console.log("**** after buildAppUq ****",y),e();case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),reject:n},(window.opener||window.parent).postMessage({type:"app-api",apiName:t,hash:y.hash},"*")})));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){return v[e]}var _={};function D(e,t,n){return B.apply(this,arguments)}function B(){return(B=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("bridgeCenterApi: url=%s, method=%s",t,n),e.next=3,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(i,c){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(h.a)(),void 0!==_[o]){e.next=5;break}return _[o]={id:o,resolve:i,reject:c},e.abrupt("break",7);case 5:e.next=0;break;case 7:(window.opener||window.parent).postMessage({type:"center-api",callId:o,url:t,method:n,body:r},"*");case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return L.apply(this,arguments)}function L(){return(L=Object(i.a)(a.a.mark((function e(t,n){var r,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.callId,i=n.url,c=n.method,o=n.body,e.next=3,d.e.directCall(i,c,o);case 3:u=e.sent,t.postMessage({type:"center-api-return",callId:r,result:u},"*");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){var t=e.callId,n=e.result,r=_[t];void 0!==r&&(_[t]=void 0,r.resolve(n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,a,i,c=n(13),o=n(1),u=n.n(o),s=n(4),l=n(10),h=n(2),d=n(3),f=n(9),p=(n(18),n(0)),v=n(21),m=n(8),b=n(37),y=(r=function(){function e(t,n,r,c,o){Object(h.a)(this,e),this.edit=void 0,this.name=void 0,this._itemSchema=void 0,this._uiItem=void 0,this.value=void 0,this.label=void 0,Object(l.a)(this,"error",a,this),Object(l.a)(this,"isChanged",i,this),this.newValue=void 0,this.edit=t,this._itemSchema=n,this._uiItem=r,this.value=o;var u=n.name;this.name=u,this.label=c}return Object(d.a)(e,[{key:"itemSchema",get:function(){return this._itemSchema}},{key:"uiItem",get:function(){return this._uiItem}},{key:"editInRow",get:function(){return!1}}]),Object(d.a)(e,[{key:"init",value:function(){}},{key:"start",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalStart();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.internalEnd();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t,n,r=this,a=this._itemSchema,i=a.name,c=a.type,o=this._uiItem;if(void 0===o)t=i;else{t=o.label,n=o.labelHide;var u=o.Templet;if(void 0!==u)"function"===typeof u?void 0!==this.value&&(e=u(this.value)):e={templet:u};else if(void 0!==this.value)switch(o.widget){case"radio":case"select":var s=o.list;e=p.createElement("b",null,s.find((function(e){return e.value===r.value})).title);break;case"id":e=p.createElement("b",null,"no templet for ",i,"=",this.value)}}if(void 0===e)switch(c){default:e=this.value?p.createElement("b",null,this.value):p.createElement("small",{className:"text-muted"},"[",!0===n?t:"\u65e0","]");break;case"image":e=p.createElement(b.a,{className:"w-4c h-4c",src:this.value})}return e}},{key:"internalEnd",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.b.pop();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"verifyValue",value:function(){if(void 0!==this.uiItem){var e=this.uiItem.rules;if(void 0!==e){var t=this.newValue;if(Array.isArray(e)){var n,r=Object(c.a)(e);try{for(r.s();!(n=r.n()).done;){var a=i(n.value);if(void 0!==a){this.error=a;break}}}catch(o){r.e(o)}finally{r.f()}}else this.error=i(e)}}function i(e,n){var r=e(t);if(void 0!==r)return"object"!==typeof r?r:JSON.stringify(r)}}}]),e}(),a=Object(f.a)(r.prototype,"error",[m.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(f.a)(r.prototype,"isChanged",[m.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r)},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(5),s=n(6),l=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(c.a)(this,n),(a=t.call(this,r,i)).tries=void 0,a._entity=void 0,a.tries=0,a._entity=e,a}return Object(o.a)(n,[{key:"request",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.loadSchema();case 2:return e.next=4,this.innerRequest();case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerCall",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entity.uqApi.xcall(this);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"innerRequest",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerCall();case 2:if(t=e.sent,n=t.$uq,r=t.$modify,i=t.res,this.entity.uq.pullModify(r),void 0!==n){e.next=8;break}return c=this.xresult(i),e.abrupt("return",c);case 8:return e.next=10,this.retry(n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"xresult",value:function(e){return e}},{key:"retry",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(++this.tries,!(this.tries>5)){e.next=3;break}throw new Error("can not get right uq response schema, 5 tries");case 3:return this.rebuildSchema(t),e.next=6,this.innerRequest();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rebuildSchema",value:function(e){var t=e.uq,n=e.entity;void 0!==t&&this.entity.uq.buildEntities(t),void 0!==n&&this.entity.setSchema(n)}},{key:"entity",get:function(){return this._entity}},{key:"headers",get:function(){var e=this.entity,t=e.ver,n=e.uq.uqVersion;return{uq:"".concat(n),en:"".concat(t)}}}]),n}(n(20).a),h=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(l),d=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}},{key:"buildParams",value:function(){return this.entity.buildParams(this.params)}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query/".concat(this.entity.name)}}]),n}(l),f=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"buildParams",value:function(){var e,t=this.params,n=t.pageStart,r=t.pageSize,a=t.params;return(e=void 0===a?{key:""}:this.entity.buildParams(a)).$pageStart=n,e.$pageSize=r,e}},{key:"xresult",value:function(e){return this.entity.unpackReturns(e)}},{key:"params",get:function(){return this._params}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"query-page/".concat(this.entity.name)}}]),n}(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(1),a=n.n(r),i=n(4),c=n(13),o=n(2),u=n(3),s=n(23),l="\n",h="\\ntbfvr",d=h.charCodeAt(0),f=h.charCodeAt(1),p=h.charCodeAt(2),v=h.charCodeAt(3),m=h.charCodeAt(4),b=h.charCodeAt(5),y=h.charCodeAt(6),k="\n\t\b\f\v\r",g=k.charCodeAt(0),w=k.charCodeAt(1),O=k.charCodeAt(2),j=k.charCodeAt(3),x=k.charCodeAt(4),E=k.charCodeAt(5),C=function(){function e(t,n,r){Object(o.a)(this,e),this.jName=void 0,this.schema=void 0,this.ver=0,this.sys=void 0,this.uq=void 0,this.name=void 0,this.typeId=void 0,this.cache=void 0,this.uqApi=void 0,this.fields=void 0,this.arrFields=void 0,this.returns=void 0,this.face=void 0,this.fieldMaps={},this.uq=t,this.name=n,this.typeId=r,this.sys=this.name.indexOf("$")>=0,this.cache=this.uq.localMap.item(this.name),this.uqApi=this.uq.uqApi}return Object(u.a)(e,[{key:"sName",get:function(){return this.jName||this.name}}]),Object(u.a)(e,[{key:"fieldMap",value:function(e){void 0===e&&(e="$");var t=this.fieldMaps[e];if(void 0===t){var n;if("$"===e)n=this.fields;else if(void 0!==this.arrFields){var r=this.arrFields.find((function(t){return t.name===e}));void 0!==r&&(n=r.fields)}else if(void 0!==this.returns){var a=this.returns.find((function(t){return t.name===e}));void 0!==a&&(n=a.fields)}if(void 0===n)return{};t={};var i,o=Object(c.a)(n);try{for(o.s();!(i=o.n()).done;){var u=i.value;t[u.name]=u}}catch(s){o.e(s)}finally{o.f()}this.fieldMaps[e]=t}return t}},{key:"loadSchema",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.schema){e.next=2;break}return e.abrupt("return");case 2:if(t=this.cache.get()){e.next=7;break}return e.next=6,this.uq.loadEntitySchema(this.name);case 6:t=e.sent;case 7:return this.setSchema(t),this.buildFieldsTuid(),e.next=11,this.loadValues();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadValues",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"clearSchema",value:function(){this.schema=void 0}},{key:"setSchema",value:function(e){if(void 0!==e){var t=e.name,n=e.version;this.ver=n||0,this.setJName(t),this.cache.set(e),this.schema=e,this.buildFieldsTuid()}}},{key:"setJName",value:function(e){e!==this.name&&(this.jName=e)}},{key:"buildFieldsTuid",value:function(){var e=this.schema,t=e.fields,n=e.arrs,r=e.returns;this.uq.buildFieldTuid(this.fields=t),this.uq.buildArrFieldsTuid(this.arrFields=n,t),this.uq.buildArrFieldsTuid(this.returns=r,t)}},{key:"schemaStringify",value:function(){return JSON.stringify(this.schema,(function(e,t){if("_tuid"!==e)return t}),4)}},{key:"tuidFromName",value:function(e,t){if(void 0!==this.schema){var n=this.schema,r=n.fields,a=n.arrs,i=this.uq,c=e.toLowerCase();if(void 0===t)return s(c,r);if(void 0!==a){var o=t.toLowerCase(),u=a.find((function(e){return e.name===o}));if(void 0!==u)return s(c,u.fields)}}function s(e,t){if(void 0!==t){var n=t.find((function(t){return t.name===e}));if(void 0!==n)return i.getTuid(n.tuid)}}}},{key:"buildParams",value:function(e){var t={},n=this.fields;void 0!==n&&this.buildFieldsParams(t,n,e);var r=this.arrFields;if(void 0!==r){var a,i=Object(c.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value,u=o.name,s=o.fields;if(void 0!==e[u]){var l=[];t[u]=l;var h,d=Object(c.a)(e);try{for(d.s();!(h=d.n()).done;){var f=h.value,p={};this.buildFieldsParams(p,s,f),l.push(p)}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){i.e(v)}finally{i.f()}}return t}},{key:"buildFieldsParams",value:function(e,t,n){var r,a=Object(c.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.name,u=i.type,s=n[o],l=void 0;switch(u){case"datetime":l=this.buildDateTimeParam(s);break;case"date":l=s instanceof Date?"".concat(s.getFullYear(),"-").concat(s.getMonth()+1,"-").concat(s.getDate()):s;break;default:switch(typeof s){default:l=s;break;case"object":if(s instanceof Date){l=s;break}var h=i._tuid;l=void 0===h?s.id:h.getIdFromObj(s)}}e[o]=l}}catch(d){a.e(d)}finally{a.f()}}},{key:"buildDateTimeParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return"";case"object":t=e;break;case"string":case"number":t=new Date(e)}return Math.floor(t.getTime()/1e3)}},{key:"buildDateParam",value:function(e){var t;switch(typeof e){default:throw new Error("escape datetime field in pack data error: value="+e);case"undefined":return"";case"string":return e;case"object":t=e;break;case"number":t=new Date(e)}var n=t.toISOString(),r=n.indexOf("T");return r>0?n.substr(0,r):n}},{key:"pack",value:function(e){var t=[],n=this.fields;void 0!==n&&this.packRow(t,n,e);var r=this.arrFields;if(void 0!==r){var a,i=Object(c.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value,u=o.name,l=o.fields,h=Object(s.d)(e,u);this.packArr(t,l,h)}}catch(d){i.e(d)}finally{i.f()}}return t.join("")}},{key:"escape",value:function(e,t){var n=e[t.name];switch(t.type){case"datetime":return this.buildDateTimeParam(n);default:switch(typeof n){default:return n;case"object":var r=t._tuid;return void 0===r?n.id:r.getIdFromObj(n);case"string":for(var a=n.length,i="",c=0,o=0;o<a;o++){var u=void 0;switch(n.charCodeAt(o)){default:continue;case d:u="\\\\";break;case w:u="\\t";break;case g:u="\\n";break;case j:u="\\f";break;case x:u="\\v";break;case O:u="\\b";break;case E:u="\\r"}i+=n.substring(c,o)+u,c=o+1}return i+n.substring(c);case"undefined":return""}}}},{key:"packRow",value:function(e,t,n){var r=t.length;if(0!==r){var a="";a+=this.escape(n,t[0]);for(var i=1;i<r;i++){var c=t[i];a+="\t"+this.escape(n,c)}e.push(a+l)}}},{key:"packArr",value:function(e,t,n){if(void 0!==n)if(0===n.length)e.push(l);else{var r,a=Object(c.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.packRow(e,t,i)}}catch(o){a.e(o)}finally{a.f()}}else e.push(l);e.push(l)}},{key:"cacheFieldsInValue",value:function(e,t){var n,r=Object(c.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.name,o=a._tuid;if(void 0!==o){var u=e[i];e[i]=o.boxId(u)}}}catch(s){r.e(s)}finally{r.f()}}},{key:"unpackTuidIdsOfFields",value:function(e,t){if(void 0===t)return e;var n,r=[],a=Object(c.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i)for(var o=i.length,u=0;u<o;){if(10===i.charCodeAt(u)){++u;break}var s={};u=this.unpackRow(s,t,i,u),r.push(s)}}}catch(l){a.e(l)}finally{a.f()}return r}},{key:"unpackSheet",value:function(e){var t={},n=this.fields,r=0;void 0!==n&&(r=this.unpackRow(t,n,e,r));var a=this.arrFields;if(void 0!==a){var i,o=Object(c.a)(a);try{for(o.s();!(i=o.n()).done;){var u=i.value;r=this.unpackArr(t,u,e,r)}}catch(s){o.e(s)}finally{o.f()}}return t}},{key:"unpackReturns",value:function(e){var t={},n=0,r=this.returns;if(void 0!==r){var a,i=Object(c.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;n=this.unpackArr(t,o,e,n)}}catch(u){i.e(u)}finally{i.f()}}return t}},{key:"unpackRow",value:function(e,t,n,r){for(var a=0,i=0,c=r,o=0,u=n.length,s=t.length;r<u;r++)if(a=i,9===(i=n.charCodeAt(r))){var l=t[o],h=l.name;if(8!==a){if(r>c){var d=n.substring(c,r);e[h]=this.to(e,d,l)}}else e[h]=null;if(c=r+1,++o>=s)return(r=n.indexOf("\n",c))>=0?++r:r=u,r}else if(10===i){var f=t[o],p=f.name;if(8!==a){if(r>c){var v=n.substring(c,r);e[p]=this.to(e,v,f)}}else e[p]=null;return++o,++r}var m=t[o],b=m.name;if(8!==a){var y=n.substring(c);e[b]=this.to(e,y,m)}return u}},{key:"to",value:function(e,t,n){switch(n.type){default:return t;case"text":case"char":return this.reverseNT(t);case"datetime":case"time":case"timestamp":var r=Number(t);return!0===isNaN(r)?new Date(t):new Date(1e3*r);case"date":var a=t.split("-");return new Date(Number(a[0]),Number(a[1])-1,Number(a[2]));case"tinyint":case"smallint":case"int":case"bigint":case"dec":return Number(t);case"id":var i=Number(t),c=n._tuid;return void 0===c?i:c.boxId(i)}}},{key:"reverseNT",value:function(e){if(void 0!==e&&null!==e){for(var t=e.length,n="",r=0,a=0;a<t;a++){if(e.charCodeAt(a)===d){if(a===t-1)break;var i=void 0;switch(e.charCodeAt(a+1)){default:continue;case d:i="\\";break;case f:i="\n";break;case p:i="\t";break;case v:i="\b";break;case m:i="\f";break;case b:i="\v";break;case y:i="\r"}n+=e.substring(r,a)+i,r=a+2,++a}}return n+=e.substring(r,t)}}},{key:"unpackArr",value:function(e,t,n,r){for(var a=r,i=[],c=n.length,o=t.name,u=t.fields;r<c;){var s=n.charCodeAt(r);if(10===s){if(r===a){if(10!==(s=n.charCodeAt(r)))throw new Error("upackArr: arr\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f10\uff0c\u5219\u5fc5\u987b\u7d27\u8ddf\u4e00\u4e2a10\uff0c\u8868\u793a\u6574\u4e2aarr\u7684\u7ed3\u675f");++r}++r;break}var l={};i.push(l),r=this.unpackRow(l,u,n,r)}return e[o]=i,r}}]),e}()},function(e,t,n){"use strict";n.d(t,"h",(function(){return C})),n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return A})),n.d(t,"j",(function(){return P})),n.d(t,"f",(function(){return V})),n.d(t,"i",(function(){return _})),n.d(t,"a",(function(){return D})),n.d(t,"k",(function(){return U})),n.d(t,"e",(function(){return L})),n.d(t,"b",(function(){return q})),n.d(t,"g",(function(){return M})),n.d(t,"l",(function(){return H}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(5),s=n(6),l=n(16),h=n.n(l),d=n(13),f=n(26),p=n(21),v=n(23),m=["POST","PUT"],b=function(){function e(t,n,r){var o=this;Object(c.a)(this,e),this.timeout=void 0,this.ui=void 0,this.hostUrl=void 0,this.apiToken=void 0,this.startWait=function(e){!0===e&&void 0!==o.ui&&o.ui.startWait()},this.endWait=function(e,t){void 0!==o.ui&&o.ui.endWait(),void 0!==t&&t("\u8bbf\u95eewebapi\u8d85\u65f6 "+e)},this.showError=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o.ui){e.next=3;break}return e.next=3,o.ui.showError(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.hostUrl=t,this.apiToken=n,this.ui=r,this.timeout=!0===v.c.isDevelopment?5e5:5e4}return Object(o.a)(e,[{key:"used",value:function(){this.post("",{})}},{key:"xcall",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i,c,o,u,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.buildOptions(),i=n.headers,c=n.path,o=n.method,void 0!==i)for(s in u=r.headers,i)u.append(s,encodeURI(i[s]));return r.method=o,l=n.buildParams(),m.indexOf(o)>=0&&void 0!==l&&(r.body=JSON.stringify(l)),e.next=8,this.innerFetch(t+c,r,n.waiting);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"innerFetchResult",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.innerFetch(t,n,r);case 2:return i=e.sent,e.abrupt("return",i.res);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o,u,s,l,h=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:void 0,r=h.length>2?h[2]:void 0,!n){e.next=26;break}if(!((i=Object.keys(n)).length>0)){e.next=26;break}c="?",o=Object(d.a)(i),e.prev=7,o.s();case 9:if((u=o.n()).done){e.next=18;break}if(s=u.value,void 0!==n[s]){e.next=14;break}return e.abrupt("continue",16);case 14:t+=c+s+"="+n[s],c="&";case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),o.e(e.t0);case 23:return e.prev=23,o.f(),e.finish(23);case 26:return(l=this.buildOptions()).method="GET",e.next=30,this.innerFetchResult(t,l,r);case 30:return e.abrupt("return",e.sent);case 31:case"end":return e.stop()}}),e,this,[[7,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="POST",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="PUT",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=this.buildOptions()).method="DELETE",i.body=JSON.stringify(n),e.next=5,this.innerFetchResult(t,i,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"fetch",value:function(e){function t(t,n,r,a,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,c,o){var u,s,l,d,f,m,b,y,k;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(e,t){switch(typeof e){case"string":void 0!==t&&(e+=" "+t);break;case"object":for(var r={ex:t},a=0,i=Object.keys(e);a<i.length;a++){var l=i[a];r[l]=e[l]}e=r}return{channel:u,url:s,options:n,resolve:c,reject:o,error:e}},u=this,this.startWait(r),s=t,e.prev=4,console.log("%s-%s %s",n.method,s,n.body||""),d=Date.now(),f=v.c.setTimeout(void 0,(function(){u.endWait(t+" timeout endWait: "+(Date.now()-d)+"ms",o)}),this.timeout),e.next=10,fetch(encodeURI(s),n);case 10:if(!1!==(m=e.sent).ok){e.next=17;break}throw v.c.clearTimeout(f),console.log("ok false endWait"),u.endWait(),console.log("call error %s",m.statusText),m.statusText;case 17:if(!((b=m.headers.get("content-type"))&&b.indexOf("json")>=0)){e.next=22;break}return e.abrupt("return",m.json().then(function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v.c.clearTimeout(f),u.endWait(),!0!==t.ok){e.next=5;break}return"object"!==typeof t||Array.isArray(t),e.abrupt("return",c(t));case 5:if(void 0!==(n=t.error)){e.next=11;break}return e.next=9,u.showError(l("not valid tonva json"));case 9:e.next=14;break;case 11:return e.next=13,u.showError(l(n,"retJson.error"));case 13:o(n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.showError(l(t,"catch res.json()"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 22:return e.next=24,m.text();case 24:y=e.sent,v.c.clearTimeout(f),console.log("text endWait"),u.endWait(),c(y);case 29:e.next=40;break;case 31:if(e.prev=31,e.t0=e.catch(4),this.endWait(t,o),"string"!==typeof e.t0){e.next=39;break}if(k=e.t0.toLowerCase(),!0!==h.a.startsWith(k,"unauthorized")){e.next=39;break}return p.b.logout(),e.abrupt("return");case 39:console.error("fecth error (no nav.showError): "+t);case 40:case 41:case"end":return e.stop()}}),e,this,[[4,31]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}())},{key:"callFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var c,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(c=this.buildOptions()).method=n,c.body=r,e.next=5,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetch(t,c,!0,n,r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"buildOptions",value:function(){return{headers:this.buildHeaders(),method:void 0,body:void 0}}},{key:"buildHeaders",value:function(){var e=p.b.language,t=p.b.culture,n=new Headers;n.append("Content-Type","application/json;charset=UTF-8");var r=e;return t&&(r+="-"+t),n.append("Accept-Language",r),this.apiToken&&n.append("Authorization",this.apiToken),n}}]),e}(),y=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"innerFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var c,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=this.hostUrl+t,void 0!==this.apiToken||!Object(f.h)()){e.next=5;break}return e.next=4,Object(f.d)(c,n.method,n.body);case 4:return e.abrupt("return",e.sent);case 5:return e.next=7,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(t,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetch(c,n,r,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(b),k=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"innerFetch",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var c,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.hostUrl+t,e.next=3,new Promise(function(){var e=Object(i.a)(a.a.mark((function e(t,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetch(c,n,r,t,i);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(b),g=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"startWait",value:function(){p.b.startWait()}},{key:"endWait",value:function(){p.b.endWait()}},{key:"showError",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.b.endWait(),e.next=3,p.b.onError(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"showUpgradeUq",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.b.showUpgradeUq(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),w=n(49),O=n(40),j=n(39),x={},E={};function C(){x={},E={},I={},Object(f.i)()}var N=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e,r,a,i,o,u,s){var l;return Object(c.a)(this,n),(l=t.call(this,e,s)).access=void 0,l.appOwner=void 0,l.appName=void 0,l.uqOwner=void 0,l.uqName=void 0,l.uq=void 0,l.appOwner=r,l.appName=a,o&&(l.uqOwner=i,l.uqName=o,l.uq=i+"/"+o),l.access=u,l.showWaiting=s,l}return Object(o.a)(n,[{key:"init",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.e)(this.uq,this.uqOwner,this.uqName,this.appOwner,this.appName);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===this.showWaiting||void 0===this.showWaiting?(t=x,n=new g):t=E,void 0===(r=t[this.uq])){e.next=4;break}return e.abrupt("return",r);case 4:if(i=Object(f.b)(this.uq)){e.next=9;break}return e.next=8,this.init();case 8:i=Object(f.b)(this.uq);case 9:return o=(c=i).url,u=c.token,this.token=u,r=new k(o,u,n),e.abrupt("return",t[this.uq]=r);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadAccess",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0===this.access?"":this.access.join("|"),e.next=3,this.get("access",{acc:t});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"schema",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("schema/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queueModify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("queue-modify",{start:t,page:n,entities:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(w.a),I={};var S,A=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,"tv/",void 0,void 0,void 0,void 0,void 0,!0)).unitId=void 0,r.unitId=e,r}return Object(o.a)(n,[{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(t=I[this.unitId])){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,this.buildChannel();case 5:return e.abrupt("return",I[this.unitId]=e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new g,n=new q("tv/",void 0),e.next=4,n.unitxUq(this.unitId);case 4:return r=e.sent,i=r.token,c=r.db,o=r.url,u=r.urlTest,s=O.a.getUrlOrTest(c,o,u),this.token=i,e.abrupt("return",new k(s,i,t));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(N);function P(e){console.log("setCenterUrl %s",e),S=e,F=void 0,T=void 0}var T,F,V=void 0,R=0;function _(e,t){R=e,V=t,console.log("setCenterToken %s",t),F=void 0,T=void 0}var D=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getHttpChannel",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0===this.showWaiting||void 0===this.showWaiting?void 0!==T?T:T=new y(S,V,new g):void 0!==F?F:F=new y(S,V));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(w.a),B="uqTokens",U=new(function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).localMap=v.c.localDb.map(B),e}return Object(o.a)(n,[{key:"uq",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o,u,s,l,d,f,p,v,m,b,y,k,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uqOwner,r=t.uqName,i=n+"/"+r,c=this.localMap.child(i),e.prev=3,void 0!==(o=c.get())&&(s=(u=o).unit,l=u.user,s===t.unit&&l===R||(c.remove(),o=void 0)),d=Math.floor(Date.now()/1e3),void 0===o){e.next=11;break}if(p=(f=o).tick,!(void 0!==(v=f.value)&&d-p<86400)){e.next=11;break}return e.abrupt("return",h.a.clone(v));case 11:return(m=h.a.clone(t)).testing=O.a.testing,e.next=15,this.get("app-uq",m);case 15:if(void 0!==(b=e.sent)){e.next=20;break}throw y=t.unit,k=t.uqOwner,g=t.uqName,"center get app-uq(unit=".concat(y,", '").concat(k,"/").concat(g,"') - not exists or no unit-service");case 20:return o={unit:t.unit,user:R,tick:d,value:b},c.set(o),e.abrupt("return",h.a.clone(b));case 25:throw e.prev=25,e.t0=e.catch(3),c.remove(),e.t0;case 29:case"end":return e.stop()}}),e,this,[[3,25]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(D))("tv/tie/",void 0),L=new(function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"directCall",value:function(e,t,n){return this.call(e,t,n)}}]),n}(D))("",void 0),q=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"uqs",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/app-uqs",{appOwner:t,appName:n});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uqsPure",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/app-uqs",{appOwner:t,appName:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unitxUq",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/unitx-uq",{unit:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changePassword",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/change-password",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(D);function M(e,t){return z.apply(this,arguments)}function z(){return(z=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new q("tv/",void 0),e.next=3,r.uqs(t,n);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=new(function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"login",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/login",t);case 2:n=e.sent,e.t0=typeof n,e.next="string"===e.t0?7:"object"===e.t0?8:6;break;case 6:return e.abrupt("return");case 7:return e.abrupt("return",Object(j.b)(n));case 8:return r=n.token,i=Object(j.b)(r),c=n.nick,o=n.icon,c&&(i.nick=c),o&&(i.icon=o),e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/register",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendVerify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/set-verify",{account:t,type:n,oem:r});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"checkVerify",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/check-verify",{account:t,verify:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"isExists",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/is-exists",{account:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("user/reset-password",{account:t,password:n,verify:r,type:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"userSetProp",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.post("tie/user-set-prop",{prop:t,value:n});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"me",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/me");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"user",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user",{id:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromKey",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(D))("tv/",void 0)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l}));var r=n(16),a=n.n(r),i={lang:void 0,$lang:void 0,district:void 0,$district:void 0};function c(e){var t=i.lang,n=i.district,r={};if(void 0===e)return r;a.a.merge(r,e._);var c=e[t];if(void 0===c)return r;a.a.merge(r,c._);var o=c[n];if(void 0===o)return r;a.a.merge(r,o);var u=r.entity;if(void 0!==u)for(var s in u)u[s.toLowerCase()]=u[s];return r}!function(){var e,t,n=navigator.languages&&navigator.languages[0]||navigator.language;if(n){var r=n.split("-");e=r[0],r.length>1&&(t=r[1].toUpperCase())}else e="zh",t="CN";!function(e,t){i.lang=e,i.$lang="$"+e,i.district=t,i.$district="$"+t}(e,t)}();var o={};function u(e,t){if(void 0!==t){var n=i.$lang,r=i.$district;if(a.a.merge(e,t),void 0!==n){var c=t[n];if(void 0!==c){a.a.merge(e,c);var o=c[r];void 0!==o&&a.a.merge(e,o)}}return function(t){return e[t]||t}}}function s(e){u(o,e)}function l(e){return o[e]||e}},function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return w})),n.d(t,"c",(function(){return x})),n.d(t,"a",(function(){return P}));var r,a,i,c,o,u=n(1),s=n.n(u),l=n(4),h=n(2),d=n(3),f=n(0),p=n.n(f),v=n(16),m=n.n(v),b=n(15),y=n(23),k=n(20),g=function(){function e(t){var n=this;Object(h.a)(this,e),this.res=void 0,this.x=void 0,this._t={},this.t=void 0,this.icon=void 0,this.label=void 0,this.isDev=y.c.isDevelopment,this.receiveHandlerId=void 0,this.dispose=function(){k.k.unregisterReceiveHandler(n.receiveHandlerId),n.onDispose()},this.onMessageReceive=function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.onMessage(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this._resolve_$=void 0,this.topPageKey=void 0,this.res=t||{},this.x=this.res.x||{},this.t=function(e){return n.internalT(e)||e}}return Object(d.a)(e,[{key:"user",get:function(){return b.nav.user}},{key:"isLogined",get:function(){var e=b.nav.user;return void 0!==e&&e.id>0}}]),Object(d.a)(e,[{key:"init",value:function(){}},{key:"internalT",value:function(e){return this._t[e]}},{key:"setRes",value:function(e){if(void 0!==e){var t=b.resOptions.$lang,n=b.resOptions.$district;if(m.a.merge(this._t,e),void 0!==t){var r=e[t];if(void 0!==r){m.a.merge(this._t,r);var a=r[n];void 0!==a&&m.a.merge(this._t,a)}}}}},{key:"onDispose",value:function(){}},{key:"isMe",value:function(e){if(null===e)return!1;var t=this.user.id;switch(typeof e){default:return!1;case"string":return Number(e)===t;case"number":return e===t;case"object":return e.id===t}}},{key:"openVPage",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this).open(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"replaceVPage",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this).replaceOpen(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"renderView",value:function(e,t){return new e(this).render(t)}},{key:"event",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onEvent(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEvent",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"msg",value:function(e){alert(e)}},{key:"errorPage",value:function(e,t){this.openPage(f.createElement(b.Page,{header:"App error!"},f.createElement("pre",null,"string"===typeof t?t:t.message)))}},{key:"onMessage",value:function(e){}},{key:"beforeStart",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"registerReceiveHandler",value:function(){this.receiveHandlerId=k.k.registerReceiveHandler(this.onMessageReceive)}},{key:"start",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,a,i=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.registerReceiveHandler(),e.next=3,this.beforeStart();case 3:if(!1!==e.sent){e.next=6;break}return e.abrupt("return");case 6:for(n=i.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=i[a];return e.next=9,this.internalStart.apply(this,[t].concat(r));case 9:return e.next=11,this.afterStart();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n,r,a,i=this,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=c[a];return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(l.a)(s.a.mark((function e(n,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._resolve_$.push(n),e.next=3,i.start.apply(i,[t].concat(r));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"vCall",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var r=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this._resolve_$&&(this._resolve_$=[]),e.abrupt("return",new Promise(function(){var e=Object(l.a)(s.a.mark((function e(a,i){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r._resolve_$.push(a),e.next=3,new t(r).open(n);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"returnCall",value:function(e){if(void 0!==this._resolve_$){var t=this._resolve_$.pop();void 0!==t?t(e):alert("the Controller call already returned, or not called")}}},{key:"openPage",value:function(e,t){var n;void 0!==t&&(n=function(){t(void 0)}),b.nav.push(e,n)}},{key:"replacePage",value:function(e,t){b.nav.replace(e,t)}},{key:"backPage",value:function(){b.nav.back()}},{key:"closePage",value:function(e){b.nav.pop(e)}},{key:"ceasePage",value:function(e){b.nav.ceaseTop(e)}},{key:"go",value:function(e,t,n){b.nav.go(e,t,n)}},{key:"removeCeased",value:function(){b.nav.removeCeased()}},{key:"regConfirmClose",value:function(e){b.nav.regConfirmClose(e)}},{key:"startAction",value:function(){this.topPageKey=b.nav.topKey()}},{key:"SetTopKey",value:function(e){this.topPageKey=e}},{key:"popToTopPage",value:function(){b.nav.popTo(this.topPageKey)}},{key:"confirm",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(l.a)(s.a.mark((function e(r,a){var i,c,o,u,h,d,p,v;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.caption,c=t.message,o=t.ok,u=t.yes,h=t.no,d=t.classNames,p=function(e){n.closePage(),r(e)},v=[],void 0!==o&&v.push(f.createElement("button",{key:"ok",className:"btn btn-primary mr-3",onClick:function(){return p("ok")}},o)),void 0!==u&&v.push(f.createElement("button",{key:"yes",className:"btn btn-success mr-3",onClick:function(){return p("yes")}},u)),void 0!==h&&v.push(f.createElement("button",{key:"no",className:"btn btn-outline-danger mr-3",onClick:function(){return p("no")}},h)),n.openPage(f.createElement(b.Page,{header:i||"\u8bf7\u786e\u8ba4",back:"close"},f.createElement("div",{className:d||"rounded bg-white m-5 p-3 border"},f.createElement("div",{className:"d-flex align-items-center justify-content-center"},c),f.createElement("div",{className:"mt-3 d-flex align-items-center justify-content-center"},v)))),b.nav.regConfirmClose(Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(void 0),e.abrupt("return",!0);case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"isRouting",get:function(){return b.nav.isRouting}},{key:"isCalling",get:function(){return void 0!==this._resolve_$}},{key:"TopKey",get:function(){return this.topPageKey}}]),e}(),w=function(){function e(t){Object(h.a)(this,e),this.controller=void 0,this.res=void 0,this.x=void 0,this.t=void 0,this.controller=t,this.res=t.res,this.x=t.x,this.t=t.t}return Object(d.a)(e,[{key:"isMe",value:function(e){return this.controller.isMe(e)}},{key:"renderVm",value:function(e,t){return new e(this.controller).render(t)}},{key:"openVPage",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new t(this.controller).open(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"event",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.event(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"go",value:function(e,t,n){this.controller.go(e,t,n)}},{key:"vCall",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.vCall(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"returnCall",value:function(e){this.controller.returnCall(e)}},{key:"renderUser",value:function(e,t,n){var r=function(e){var r=e.name,a=e.nick,i=e.icon;return f.createElement(f.Fragment,null,f.createElement(b.Image,{src:i,className:t||"w-1c h-1c mr-2"}),f.createElement("span",{className:n},a||r))};return f.createElement(b.UserView,{user:e,render:r})}},{key:"renderUserText",value:function(e){return f.createElement(b.UserView,{user:e,render:function(e){var t=e.name,n=e.nick;return f.createElement(f.Fragment,null,n||t)}})}},{key:"renderMe",value:function(e,t){var n=this.controller.user;if(n)return this.renderUser(n.id,e,t)}},{key:"openPage",value:function(e,t,n){var r=typeof t;"object"===r||"undefined"===r?this.controller.openPage(f.createElement(e,t),n):this.controller.openPage(f.createElement(b.Page,{header:"param type error"},"View.openPage param must be object, but here is ",r),n)}},{key:"replacePage",value:function(e,t){this.controller.replacePage(f.createElement(e,t))}},{key:"openPageElement",value:function(e,t){this.controller.openPage(e,t)}},{key:"replacePageElement",value:function(e,t){this.controller.replacePage(e,t)}},{key:"backPage",value:function(){this.controller.backPage()}},{key:"closePage",value:function(e){this.controller.closePage(e)}},{key:"ceasePage",value:function(e){this.controller.ceasePage(e)}},{key:"removeCeased",value:function(){this.controller.removeCeased()}},{key:"regConfirmClose",value:function(e){this.controller.regConfirmClose(e)}},{key:"popToTopPage",value:function(){this.controller.popToTopPage()}},{key:"isDev",get:function(){return y.c.isDevelopment}}]),e}(),O=n(5),j=n(6),x=function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).retOnClosePage=void 0,e}return Object(d.a)(n,[{key:"open",value:function(e,t){var n,r=this;this.init(e),void 0!==t&&(n=function(){return t(r.retOnClosePage)}),this.openPageElement(this.renderPage(),n)}},{key:"replaceOpen",value:function(e,t){var n,r=this;this.init(e),void 0!==t&&(n=function(){return t(r.retOnClosePage)}),this.replacePageElement(this.renderPage(),n)}},{key:"render",value:function(e){return this.init(e),this.renderPage()}},{key:"init",value:function(e){}},{key:"header",value:function(){return null}},{key:"right",value:function(){return null}},{key:"content",value:function(){return null}},{key:"footer",value:function(){return null}},{key:"logout",value:function(){return!1}},{key:"renderPage",value:function(){var e=this,t=this.header();return t||(t=!1),f.createElement(b.Page,{header:t,right:this.right(),footer:this.footer(),onScroll:function(t){return e.onPageScroll(t)},onScrollTop:function(t){return e.onPageScrollTop(t)},onScrollBottom:function(t){return e.onPageScrollBottom(t)},back:this.back,headerClassName:this.headerClassName,className:this.className,afterBack:function(){return e.afterBack()},tabsProps:this.tabsProps,logout:this.logout()},this.content())}},{key:"onPageScroll",value:function(e){}},{key:"onPageScrollTop",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPageScrollBottom",value:function(){var e=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterBack",value:function(){}},{key:"back",get:function(){return"back"}},{key:"headerClassName",get:function(){return null}},{key:"className",get:function(){return null}},{key:"tabsProps",get:function(){return null}}]),n}(w),E=n(10),C=n(11),N=n(9),I=(n(18),n(7)),S=n(8),A=n(12),P=(r=function(e){Object(O.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,u=new Array(r),s=0;s<r;s++)u[s]=arguments[s];return(e=t.call.apply(t,[this].concat(u))).props={label:"\u7f16\u8f91"},Object(E.a)(e,"value",a,Object(C.a)(e)),Object(E.a)(e,"newValue",i,Object(C.a)(e)),Object(E.a)(e,"isChanged",c,Object(C.a)(e)),Object(E.a)(e,"error",o,Object(C.a)(e)),e.onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.onEdit=function(){var t=e.props,n=t.label,r=t.maxLength,a=t.placeholder,i=t.onValueChange,c=function(){e.verifyValue(),void 0===e.error&&(e.value=e.newValue,e.closePage(),i&&i(e.value))},o=p.a.createElement(Object(A.a)((function(){return p.a.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!e.isChanged,onClick:c},"\u4fdd\u5b58")})));e.openPage(p.a.createElement(I.Page,{header:n,right:o},p.a.createElement("div",{className:"m-3"},p.a.createElement("input",{type:"text",onChange:e.onChange,onKeyDown:function(e){13===e.keyCode&&c()},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,maxLength:r}),p.a.createElement(Object(A.a)((function(){return a&&p.a.createElement("div",{className:"small muted m-2"},a)}))),e.error&&p.a.createElement("div",{className:"text-danger"},e.error))))},e}return Object(d.a)(n,[{key:"internalStart",value:function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e,t){var n=this;return this.value=e,t&&m.a.merge(this.props,t),p.a.createElement(Object(A.a)((function(){return p.a.createElement(p.a.Fragment,null,n.renderValue(),n.renderPencil())})))}},{key:"renderValue",value:function(){return p.a.createElement(p.a.Fragment,null,this.value)}},{key:"renderPencil",value:function(){return p.a.createElement("span",{onClick:this.onEdit,className:"cursor-pointer"},"\xa0 ",p.a.createElement(I.FA,{className:"text-info",name:"pencil-square-o"})," \xa0")}},{key:"verifyValue",value:function(){}}]),n}(g),a=Object(N.a)(r.prototype,"value",[S.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(N.a)(r.prototype,"newValue",[S.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(N.a)(r.prototype,"isChanged",[S.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(N.a)(r.prototype,"error",[S.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function a(){for(var e=r.length,t="",n=0;n<8;n++)t+=r.charAt(Math.floor(Math.random()*e));return t}},function(e,t,n){"use strict";n(60),n(29),n(41);var r=n(35);n.d(t,"QueryPager",(function(){return r.b}));n(61);var a=n(48);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return a.CStringEdit})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"Controller")&&n.d(t,"Controller",(function(){return a.Controller})),n.o(a,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return a.DropdownActions})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"IconText")&&n.d(t,"IconText",(function(){return a.IconText})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"NavView")&&n.d(t,"NavView",(function(){return a.NavView})),n.o(a,"Page")&&n.d(t,"Page",(function(){return a.Page})),n.o(a,"PropGrid")&&n.d(t,"PropGrid",(function(){return a.PropGrid})),n.o(a,"SearchBox")&&n.d(t,"SearchBox",(function(){return a.SearchBox})),n.o(a,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return a.TabCaptionComponent})),n.o(a,"UQsMan")&&n.d(t,"UQsMan",(function(){return a.UQsMan})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"nav")&&n.d(t,"nav",(function(){return a.nav})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"t")&&n.d(t,"t",(function(){return a.t}));n(62),n(64),n(63),n(65);var i=n(87);n.d(t,"UQsMan",(function(){return i.a}));n(66)},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return E}));var r,a,i=n(22),c=n(10),o=n(11),u=n(19),s=n(17),l=n(9),h=(n(18),n(1)),d=n.n(h),f=n(4),p=n(2),v=n(3),m=n(5),b=n(6),y=n(16),k=n.n(y),g=n(8),w=n(23),O=n(29),j=n(28),x=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(e,r,a,i){var c;return Object(p.a)(this,n),(c=t.call(this,i)).query=void 0,c.$page=void 0,c.idFieldName=void 0,c.query=e,void 0!==r&&(c.pageSize=r),void 0!==a&&(c.firstSize=a),c}return Object(v.a)(n,[{key:"setReverse",value:function(){this.appendPosition="head"}},{key:"onLoad",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$page){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==(t=this.query.schema)){e.next=7;break}return e.next=6,this.query.loadSchema();case 6:t=this.query.schema;case 7:if(void 0!==t){e.next=9;break}return e.abrupt("return");case 9:if(void 0!==(n=this.$page=t.returns.find((function(e){return"$page"===e.name})))){e.next=12;break}return e.abrupt("return");case 12:this.sortOrder=n.order,void 0!==(r=n.fields)&&(a=r[0])&&(this.idFieldName=a.name);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadResults",value:function(){var e=Object(f.a)(d.a.mark((function e(t,n,r){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query.page(t,n,r);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getPageId",value:function(e){if(void 0!==e){if("number"===typeof e)return e;var t=e[this.idFieldName];if(null!==t&&void 0!==t){if("object"===typeof t){var n=t.id;if(void 0!==n)return n}return t}}}},{key:"refreshItems",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,a,i,c,o,u,s=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this._items.indexOf(t))<0)){e.next=3;break}return e.abrupt("return");case 3:return r="tail"===this.appendPosition?n-1:n+1,a=this.getPageId(this._items[r]),1,e.next=8,this.load(this.param,a,1);case 8:if(i=e.sent,0!==(c=i.length)){e.next=13;break}return this._items.splice(n,1),e.abrupt("return");case 13:o=function(e){var t=i[e];if(!t)return"continue";var n=t[s.idFieldName];if(void 0===n||null===n)return"continue";"object"===typeof n&&(n=n.id);var r=s._items.find((function(e){var t=e[s.idFieldName];return void 0!==t&&null!==t&&("object"===typeof t&&(t=t.id),n)}));r&&k.a.merge(r,t)},u=0;case 15:if(!(u<c)){e.next=22;break}if("continue"!==o(u)){e.next=19;break}return e.abrupt("continue",19);case 19:u++,e.next=15;break;case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(w.b),E=(r=function(e){Object(m.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(p.a)(this,n);for(var r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return(e=t.call.apply(t,[this].concat(i))).pageStart=void 0,e.pageSize=void 0,e.params=void 0,e.more=void 0,e.startField=void 0,Object(c.a)(e,"list",a,Object(o.a)(e)),e.returns=void 0,e.isPaged=void 0,e}return Object(v.a)(n,[{key:"setSchema",value:function(e){Object(u.a)(Object(s.a)(n.prototype),"setSchema",this).call(this,e);var t=e.returns;this.isPaged=t&&void 0!==t.find((function(e){return"$page"===e.name}))}},{key:"resetPage",value:function(e,t){this.pageStart=void 0,this.pageSize=e,this.params=t,this.more=!1,this.list=void 0}},{key:"loadPage",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n,r,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.pageSize){e.next=2;break}throw new Error("call resetPage(size:number, params:any) first");case 2:if(void 0===this.pageStart){e.next=10;break}e.t0=this.startField.type,e.next="date"===e.t0||"time"===e.t0||"datetime"===e.t0?8:6;break;case 6:return t=this.pageStart,e.abrupt("break",10);case 8:return t=this.pageStart.getTime(),e.abrupt("break",10);case 10:return e.next=12,this.page(this.params,t,this.pageSize+1);case 12:n=e.sent,r=n.$page,this.list=g.m.array([],{deep:!1}),void 0!==r&&(r.length>this.pageSize?(this.more=!0,r.pop(),c=this.returns.find((function(e){return"$page"===e.name})),this.startField=c.fields[0],this.pageStart=r[r.length-1][this.startField.name]):this.more=!1,(a=this.list).push.apply(a,Object(i.a)(r)));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pageCaller",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new j.c(this,e,t)}},{key:"page",value:function(){var e=Object(f.a)(d.a.mark((function e(t,n,r){var a,i,c,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(o.length>3&&void 0!==o[3])||o[3],i={pageStart:n,pageSize:r,params:t},e.next=4,this.pageCaller(i,a).request();case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"queryCaller",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new j.d(this,e,t)}},{key:"query",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,a=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.queryCaller(t,n).request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,a,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.query(t,n);case 3:r=e.sent,e.t0=d.a.keys(r);case 5:if((e.t1=e.t0()).done){e.next=10;break}return a=e.t1.value,e.abrupt("return",r[a]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,a=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],e.next=3,this.table(t,n);case 3:if(!((r=e.sent).length>0)){e.next=6;break}return e.abrupt("return",r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,r,a,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.obj(t,n);case 3:r=e.sent,e.t0=d.a.keys(r);case 5:if((e.t1=e.t0()).done){e.next=10;break}return a=e.t1.value,e.abrupt("return",r[a]);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"query"}},{key:"hasMore",get:function(){return this.more}}]),n}(O.a),a=Object(l.a)(r.prototype,"list",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return m}));var r,a=n(5),i=n(6),c=n(1),o=n.n(c),u=n(4),s=n(2),l=n(3),h=n(56);function d(e){void 0!==r&&r.postMessage({type:"ws",msg:e},"*")}function f(e){r=e}var p=function(){function e(){Object(s.a)(this,e),this.messageHub=h.a}return Object(l.a)(e,[{key:"receive",value:function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.messageHub.dispatch(t);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),v=1,m=(new(function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).wsBaseId="WsBridge seed "+v++,e}return n}(p)),function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).wsBaseId="WSChannel seed "+v++,a.wsHost=void 0,a.token=void 0,a.ws=void 0,a.wsHost=e,a.token=r,a}return Object(l.a)(n,[{key:"connect",value:function(){var e=this;if(void 0===this.ws){var t=this;return new Promise((function(r,a){var i=new WebSocket(e.wsHost,e.token||n.centerToken);console.log("connect webSocket %s",e.wsHost),i.onopen=function(n){console.log("webSocket connected %s",e.wsHost),t.ws=i,r()},i.onerror=function(e){a("webSocket can't open!")},i.onmessage=function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.wsMessage(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.onclose=function(e){t.ws=void 0,console.log("webSocket closed!")}}))}}},{key:"close",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}},{key:"wsMessage",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("websocket message: %s",t.data),d(n=JSON.parse(t.data)),e.next=6,this.receive(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("ws msg error: ",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendWs",value:function(e){var t=this;this.connect().then((function(){t.ws.send(e)}))}}],[{key:"setCenterToken",value:function(e){n.centerToken=e}}]),n}(p));m.centerToken=void 0},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(14),i=n.n(a),c=n(21),o=n(16),u=n.n(o);function s(e){var t,n=e.className,a=e.style,o=e.src,s=e.altImage;if(o){if(0!==o.indexOf("."))return!0===u.a.startsWith(o,":")&&(o=c.b.resUrl+o.substr(1)),r.createElement("img",{src:o,className:n,alt:"img",style:a,onError:function(e){e.currentTarget.src=s||"https://tv.jkchemical.com/imgs/0001.png"}});t=o.substr(1)}else t="file-o";return r.createElement("span",{className:i()(n,"image-none"),style:a},r.createElement("i",{className:"fa fa-"+t}))}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(69);function a(e){var t=Object(r.a)(e);return{id:t.id,name:t.name,guest:t.guest,token:e}}function i(e){return{id:0,guest:Object(r.a)(e).guest,token:e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return g}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(13),s=n(23),l=n(16),h=n.n(l),d="localhost:3015",f={centerhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_CENTER_DEBUG_HOST||"localhost:3000",local:!1},reshost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_RES_DEBUG_HOST||"localhost:3015",local:!1},uqhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_HOST||d,local:!1},unitxhost:{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_HOST||d,local:!1},"uq-build":{value:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_CENTER_HOST:"https://tv.jkchemical.com",REACT_APP_RES_HOST:"https://tv.jkchemical.com"}).REACT_APP_UQ_DEBUG_BUILDER_HOST||"localhost:3009",local:!1}},p=["https://","http://"];function v(e){return!0===function(e){var t,n=Object(u.a)(p);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!0===h.a.startsWith(e,r))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}(e)?h.a.endsWith(e,"/")?e:e+"/":"http://".concat(e,"/")}function m(e){return v(e)}function b(e){var t="https://";return!0===h.a.startsWith(e,t)?(e=e.substr(t.length),!0===h.a.endsWith(e,"/")&&(e=e.substr(0,e.length-1)),"wss://"+e+"/tv/"):"ws://".concat(e,"/tv/")}function y(e){if(e)return v(e)+"res/"}var k={method:"GET",mode:"no-cors",headers:{"Content-Type":"text/plain"}},g=new(function(){function e(){Object(c.a)(this,e),this.testing=void 0,this.url=void 0,this.ws=void 0,this.resHost=void 0}return Object(o.a)(e,[{key:"start",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.testing=t,n=this.getCenterHost(),this.url=m(n),this.ws=b(n),this.resHost=this.getResHost();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"debugHostUrl",value:function(e){return"http://".concat(e,"/hello")}},{key:"tryLocal",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u,s,l,h,d,p,v,m,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in t=[],n=[],r=function(e){var t=f[e].value;n.findIndex((function(e){return e===t}))<0&&n.push(t)},f)r(i);for(c=0,o=n;c<o.length;c++)u=o[c],s=this.debugHostUrl(u),t.push(O(s));return e.next=7,Promise.all(t);case 7:for(l=e.sent,h=n.length,d=0;d<h;d++)for(m in p=l[d],v=n[d],f)(b=f[m]).value===v&&(b.local=p);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCenterHost",value:function(){var e=f.centerhost,t=e.value,n=e.local;if(document.location){var r=document.location.hash;if(r&&!0===r.includes("sheet_debug"))return t}return!0===s.c.isDevelopment&&!0===n?t:"https://tv.jkchemical.com"}},{key:"getResHost",value:function(){var e=f.reshost,t=e.value,n=e.local;return!0===document.location.hash.includes("sheet_debug")||!0===s.c.isDevelopment&&!0===n?t:"https://tv.jkchemical.com"}},{key:"getUrlOrDebug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uqhost";if(!1===s.c.isDevelopment)return e;var n=f[t];if(void 0===n)return e;var r=n.value,a=n.local;return!1===a?e:"http://".concat(r,"/")}},{key:"getUrlOrTest",value:function(e,t,n){var r;return n||(n=t)||console.error("no server set for "+e),!0===this.testing?("-"!==n&&(t=n),r="uq/test/"+e+"/"):r="uq/prod/"+e+"/",t=this.getUrlOrDebug(t),!1===h.a.endsWith(t,"/")&&(t+="/"),t+r}},{key:"localCheck",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}());function w(e){return new Promise((function(t,n){fetch(e,k).then((function(e){e.text().then(t).catch(n)})).catch(n);var r=new Error("Connection timed out");s.c.setTimeout("fetchLocalCheck",n,200,r)}))}function O(e){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w(t);case 3:return e.abrupt("return",!0);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(5),s=n(6),l=n(29),h=n(28),d=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"submit",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!(i.length>1&&void 0!==i[1])||i[1],n=new f(this,t),e.next=4,n.request();case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitReturns",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new p(this,t).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"submitConvert",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new v(this,t).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"action"}}]),n}(l.a),f=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"buildParams",value:function(){return{data:this.entity.pack(this.params)}}},{key:"path",get:function(){return"action/"+this.entity.name}}]),n}(h.a),p=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"xresult",value:function(e){for(var t=this.entity.returns,n=t.length,r={},a=0;a<n;a++){r[t[a].name]=e[a]}return r}},{key:"path",get:function(){return"action/"+this.entity.name+"/returns"}}]),n}(f),v=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"buildParams",value:function(){return{data:this.params}}},{key:"path",get:function(){return"action-convert/"+this.entity.name}}]),n}(f)},function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return m}));var r,a,i=n(2),c=n(3),o=n(5),u=n(6),s=n(0),l=n(12),h=n(14),d=n.n(h),f=(n(111),Object(l.a)(r=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.badge,a=t.size,i=t.color,c=t.badgeAlign,o=t.badgeVertical,u=t.children,l=d()(n,"va-badge",a&&"va-badge-"+a,"va-badge-"+(i||"secondary"),c&&"va-badg-"+c,o&&"va-badg-"+o);return r&&(e=s.createElement("b",null,r)),s.createElement("div",{className:l},u,e)}}]),n}(s.Component)),n(112),Object(l.a)(a=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e,t,n,r=this.props,a=r.className,i=r.left,c=r.children,o=r.right,u=r.onClick;return void 0!==i&&(e=s.createElement("header",null,i)),void 0!==o&&(t=s.createElement("footer",null,o)),void 0!==u&&(n="cursor-pointer"),s.createElement("div",{className:d()("va-lmr",a,n),onClick:u},e,s.createElement("div",null,c),t)}}]),n}(s.Component))||a),p=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.className,r=e.size,a=e.spin,i=e.fixWidth,c=e.border,o=e.pull,u=e.pulse,l=e.rotate,h=e.flip,f=e.inverse,p=d()(n,"fa",t&&"fa-"+t,r&&"fa-"+r,i&&"fa-fw",c&&"fa-border",o&&"fa-pull-"+o,a&&"fa-spin",u&&"fa-pulse",l&&"fa-rotate-"+l,h&&"fa-flip-"+h,f&&"fa-inverse");return s.createElement("i",{className:p})}}]),n}(s.Component),v=(s.Component,function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.iconClass,r=e.text,a=e.textClass;return s.createElement("div",{className:"py-2"},s.createElement(p,{className:n,name:t,fixWidth:!0}),s.createElement("span",{className:a},r))}}]),n}(s.Component)),m=function(e){return s.createElement("small",{className:d()("text-muted",e.className),style:e.style},e.children)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(13),a=n(5),i=n(6),c=n(2),o=n(3),u=n(16),s=n.n(u),l=new(function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"getItem",value:function(e){return localStorage.getItem(e)}},{key:"setItem",value:function(e,t){localStorage.setItem(e,t)}},{key:"removeItem",value:function(e){localStorage.removeItem(e)}}]),e}()),h=function(){function e(t,n){Object(c.a)(this,e),this.local=void 0,this.key=void 0,this.local=t,this.key=n}return Object(o.a)(e,[{key:"get",value:function(){try{var e=this.local.getItem(this.key);if(null===e)return;if(void 0===e)return;return JSON.parse(e)}catch(t){return void this.local.removeItem(this.key)}}},{key:"set",value:function(e){var t=JSON.stringify(e,(function(e,t){if("_tuid"!==e)return t}));this.local.setItem(this.key,t)}},{key:"remove",value:function(e){void 0===e?this.local.removeItem(this.key):this.local.removeLocal(e)}},{key:"child",value:function(e){return this.local.child(e)}},{key:"arr",value:function(e){return this.local.arr(e)}},{key:"map",value:function(e){return this.local.map(e)}}]),e}(),d=function(){function e(t){Object(c.a)(this,e),this.caches=void 0,this.locals=void 0,this.name=void 0,this.name=t,this.caches={},this.locals={}}return Object(o.a)(e,[{key:"getItem",value:function(e){var t=this.keyForGet(e);if(void 0!==t)return l.getItem(t)}},{key:"setItem",value:function(e,t){var n=this.keyForSet(e);l.setItem(n,t)}},{key:"removeItem",value:function(e){var t=this.keyForSet(e);void 0!==t&&localStorage.removeItem(t)}},{key:"arr",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new f(r)}return n}},{key:"map",value:function(e){var t=String(e),n=this.locals[t];if(void 0===n){var r=this.keyForSet(e);this.locals[t]=n=new p(r)}return n}},{key:"removeLocal",value:function(e){var t=e.name,n=this.keyForRemove(t);if(void 0!==n){var r=this.locals[t];void 0===r?r=new f(n):this.locals[t]=void 0,r.removeAll()}}},{key:"child",value:function(e){var t=String(e),n=this.caches[t];return void 0!==n?n:this.caches[t]=new h(this,e)}}]),e}(),f=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).index=void 0;var a=l.getItem(r.name);return r.index=null===a?[]:a.split("\n").map((function(e){return Number(e)})),r}return Object(o.a)(n,[{key:"saveIndex",value:function(){l.setItem(this.name,this.index.join("\n"))}},{key:"keyForGet",value:function(e){if(!(s.a.indexOf(this.index,e)<0))return"".concat(this.name,".").concat(e)}},{key:"keyForSet",value:function(e){var t=s.a.indexOf(this.index,e);return t<0?(this.index.unshift(e),this.index.length>500&&this.index.pop()):(this.index.splice(t,1),this.index.unshift(e)),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"keyForRemove",value:function(e){var t=s.a.indexOf(this.index,e);if(!(t<0))return this.index.splice(t,1),this.saveIndex(),"".concat(this.name,".").concat(e)}},{key:"removeAll",value:function(){var e,t=Object(r.a)(this.index);try{for(t.s();!(e=t.n()).done;){var n=e.value;l.removeItem("".concat(this.name,".").concat(n))}}catch(a){t.e(a)}finally{t.f()}l.removeItem(this.name),this.index.splice(0)}},{key:"item",value:function(e){return this.child(e)}}]),n}(d),p=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).index=void 0,r.max=void 0,r.max=0,r.index={};var a=l.getItem(r.name);null!==a&&a.split("\n").forEach((function(e){var t=e.indexOf("\t");if(!(t<0)){var n=e.substr(0,t),a=Number(e.substr(t+1));!0!==isNaN(a)&&(r.index[n]=a,a>r.max&&(r.max=a))}}));return r}return Object(o.a)(n,[{key:"saveIndex",value:function(){var e=[];for(var t in this.index){var n=this.index[t];void 0!==n&&e.push("".concat(t,"\t").concat(n))}l.setItem(this.name,e.join("\n"))}},{key:"keyForGet",value:function(e){var t=this.index[e];if(void 0!==t)return"".concat(this.name,".").concat(t)}},{key:"keyForSet",value:function(e){var t=this.index[e];return void 0===t&&(++this.max,t=this.max,this.index[e]=t,this.saveIndex()),"".concat(this.name,".").concat(t)}},{key:"keyForRemove",value:function(e){var t=this.index[e];if(void 0!==t)return this.index[e]=void 0,this.saveIndex(),"".concat(this.name,".").concat(t)}},{key:"removeAll",value:function(){for(var e in this.index)l.removeItem("".concat(this.name,".").concat(this.index[e])),this.index[e]=void 0;l.removeItem(this.name),this.max=0}},{key:"item",value:function(e){return this.child(e)}}]),n}(d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(0),s=n(12),l=function(e,t,n){return u.createElement(u.Fragment,null,e,": ",function(e){var t="{";if(void 0===e)return"undefined";for(var n in e){var r=e[n];if(t+=n+": ",void 0===r)t+="undefined";else if(null===r)t+="null";else switch(typeof r){default:t+=r;break;case"function":t+="function";break;case"object":t+="{obj}"}t+=", "}return t+"}"}(t))};var h=function(){function e(t,n,r){Object(c.a)(this,e),this.id=void 0,this.tuid=void 0,this.ui=void 0,this.isUndefined=void 0,this.id=Number(t),this.tuid=n,this.ui=r,this.isUndefined=void 0===this.tuid}return Object(o.a)(e,[{key:"equ",value:function(e){return void 0!==e&&null!==e&&("object"===typeof e?this.id===e.id:this.id===e)}},{key:"render",value:function(e,t){if(void 0!==this.id&&null!==this.id&&!0!==isNaN(this.id)){var n=this.boxName,r=this.obj;if(!0===this.isUndefined)return void 0!==e?e(r,t):l(n,r);switch(typeof r){case"undefined":return u.createElement("span",{className:"text-black-50"},n," undefined");case"number":return u.createElement("span",{className:"text-light"},n," ",this.id)}if(void 0===e&&(e=this.ui),void 0!==e&&("function"!==typeof e&&(e=e.content),void 0!==e)){var a=e(r);return void 0!==a?a:u.createElement("span",{className:"text-danger"},n," ",this.id)}return l(n,r)}}},{key:"assure",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuid.assureBox(this.id);case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"obj",get:function(){return this.tuid.valueFromId(this.id)}},{key:"boxName",get:function(){return this.tuid.name}}]),e}();Object(s.a)((function(e){var t=e.tuidValue,n=e.ui,r=e.x,a=e.nullUI;if(void 0===t)return void 0===a?u.createElement("small",{className:"text-muted"},"[\u65e0]"):a();if(null===t)return void 0===a?u.createElement(u.Fragment,null,"[null]"):a();var i=typeof t;switch(i){default:if(void 0===n)return u.createElement(u.Fragment,null,i,"-",t);var c=n(t,r);return void 0!==c?c:u.createElement(u.Fragment,null,t);case"object":var o=function(e,t,n){var r,a=e;switch(typeof e){case"undefined":r=u.createElement(u.Fragment,null,"boxId undefined");break;case"number":r=u.createElement(u.Fragment,null,"id:",e);break;default:if("function"!==typeof a.render){if(void 0!==t)return t(e,n);r=l(a.boxName,e)}}return void 0!==r?u.createElement("del",{className:"text-danger"},r):a.render(t,n)}(t,n,r);return void 0!==o?o:void 0===a?u.createElement(u.Fragment,null,"id null"):a();case"number":return u.createElement(u.Fragment,null,"id...",t)}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(1),a=n.n(r),i=n(4),c=n(5),o=n(6),u=n(2),s=n(3),l=n(0),h=n.n(l),d=n(14),f=n.n(d),p=function(){function e(t){Object(u.a)(this,e),this.el=void 0,this.el=t}return Object(s.a)(e,[{key:"scrollToTop",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,0)}),20)}},{key:"scrollToBottom",value:function(){var e=this;setTimeout((function(){return e.el.scrollTo(0,e.el.scrollTop+e.el.offsetHeight)}),20)}}]),e}(),v=100,m=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).bottomTime=0,e.topTime=0,e.div=void 0,e.refDiv=function(t){t?(e.div=t,e.div.addEventListener("resize",e.onResize)):e.div&&e.div.removeEventListener("resize",e.onResize)},e.onResize=function(e){console.error("div resize")},e.onScroll=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i,c,o,u,s,l,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.props,i=r.onScroll,c=r.onScrollTop,o=r.onScrollBottom,i&&e.props.onScroll(n),u=n.target,s=new p(u),u.scrollTop<30&&void 0!==c&&(l=(new Date).getTime())-e.topTime>v&&(e.topTime=l,c(s).then((function(e){if(!0===e){var t=u.scrollHeight,n=200;n>t&&(n=t),u.scrollTop=n}}))),u.scrollTop+u.offsetHeight>u.scrollHeight-30&&void 0!==o&&(h=(new Date).getTime())-e.bottomTime>v&&(e.bottomTime=h,o(s));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(n,[{key:"eachChild",value:function(e,t){var n=this,r=e.props;if(void 0!==r){var a=r.children;void 0!==a&&h.a.Children.forEach(a,(function(e,r){var a=e._$scroll;a&&a(t),console.log(e.toString()),n.eachChild(e,t)}))}}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.style;return h.a.createElement("div",{ref:this.refDiv,className:f()("tv-page"),onScroll:this.onScroll,style:n},h.a.createElement("article",{className:t},this.props.children))}}]),n}(h.a.Component)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(){return r.createElement("div",{className:"d-flex h-100 align-items-center justify-content-center"},r.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"}))}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var r=n(13),a=n(43),i=n(16),c=n.n(i),o=["/test","/test/","-test","-test/"];var u=function(){var t=function(){if("undefined"!=typeof wx)return!1;var e,t=document.location.pathname.toLowerCase(),n=Object(r.a)(o);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(!0===c.a.endsWith(t,a))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}();return{testing:t,isDevelopment:!1,localDb:new a.a(!0===t?"$$":"$"),setTimeout:function(t,n,r){for(var a,i=arguments.length,c=new Array(i>3?i-3:0),o=3;o<i;o++)c[o-3]=arguments[o];return(a=e).setTimeout.apply(a,[n,r].concat(c))},clearTimeout:function(t){e.clearTimeout(t)},setInterval:function(t,n){for(var r,a=arguments.length,i=new Array(a>2?a-2:0),c=2;c<a;c++)i[c-2]=arguments[c];return(r=e).setInterval.apply(r,[t,n].concat(i))},clearInterval:function(t){e.clearInterval(t)}}}()}).call(this,n(53))},function(e,t,n){"use strict";var r=n(85);n.o(r,"CAppBase")&&n.d(t,"CAppBase",(function(){return r.CAppBase})),n.o(r,"CBase")&&n.d(t,"CBase",(function(){return r.CBase})),n.o(r,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return r.CStringEdit})),n.o(r,"CSub")&&n.d(t,"CSub",(function(){return r.CSub})),n.o(r,"Controller")&&n.d(t,"Controller",(function(){return r.Controller})),n.o(r,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return r.DropdownActions})),n.o(r,"EasyTime")&&n.d(t,"EasyTime",(function(){return r.EasyTime})),n.o(r,"Edit")&&n.d(t,"Edit",(function(){return r.Edit})),n.o(r,"FA")&&n.d(t,"FA",(function(){return r.FA})),n.o(r,"Form")&&n.d(t,"Form",(function(){return r.Form})),n.o(r,"IconText")&&n.d(t,"IconText",(function(){return r.IconText})),n.o(r,"Image")&&n.d(t,"Image",(function(){return r.Image})),n.o(r,"LMR")&&n.d(t,"LMR",(function(){return r.LMR})),n.o(r,"List")&&n.d(t,"List",(function(){return r.List})),n.o(r,"Muted")&&n.d(t,"Muted",(function(){return r.Muted})),n.o(r,"NavView")&&n.d(t,"NavView",(function(){return r.NavView})),n.o(r,"Page")&&n.d(t,"Page",(function(){return r.Page})),n.o(r,"PropGrid")&&n.d(t,"PropGrid",(function(){return r.PropGrid})),n.o(r,"SearchBox")&&n.d(t,"SearchBox",(function(){return r.SearchBox})),n.o(r,"TabCaptionComponent")&&n.d(t,"TabCaptionComponent",(function(){return r.TabCaptionComponent})),n.o(r,"TuidImport")&&n.d(t,"TuidImport",(function(){return r.TuidImport})),n.o(r,"TuidInner")&&n.d(t,"TuidInner",(function(){return r.TuidInner})),n.o(r,"UQsMan")&&n.d(t,"UQsMan",(function(){return r.UQsMan})),n.o(r,"UserView")&&n.d(t,"UserView",(function(){return r.UserView})),n.o(r,"VPage")&&n.d(t,"VPage",(function(){return r.VPage})),n.o(r,"View")&&n.d(t,"View",(function(){return r.View})),n.o(r,"nav")&&n.d(t,"nav",(function(){return r.nav})),n.o(r,"start")&&n.d(t,"start",(function(){return r.start})),n.o(r,"t")&&n.d(t,"t",(function(){return r.t}));var a=n(94);n.d(t,"TuidImport",(function(){return a.a})),n.d(t,"TuidInner",(function(){return a.b}));var i=n(86);n.d(t,"TuidsCache",(function(){return i.a}));n(44)},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n(1),a=n.n(r),i=n(2),c=n(3),o=n(4);function u(e,t,n,r,a){return s.apply(this,arguments)}function s(){return(s=Object(o.a)(a.a.mark((function e(t,n,r,i,c){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetch(n,r,!1,i,c);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(){function e(t,n){Object(i.a)(this,e),this.token=void 0,this.path=void 0,this.showWaiting=void 0,this.path=t||"",this.showWaiting=n}return Object(c.a)(e,[{key:"xcall",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return n=e.sent,e.next=5,n.xcall(this.path,t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return i=e.sent,e.next=5,i.callFetch(t,n,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:void 0,e.next=3,this.getHttpChannel();case 3:return r=e.sent,e.next=6,r.get(this.path+t,n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.post(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.put(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHttpChannel();case 2:return r=e.sent,e.next=5,r.delete(this.path+t,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r,a,i=n(1),c=n.n(i),o=n(4),u=n(10),s=n(2),l=n(3),h=n(11),d=n(5),f=n(6),p=n(9),v=(n(18),n(0)),m=n(12),b=n(8),y=n(59),k=n(21),g=(r=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),Object(u.a)(e,"resId",a,Object(h.a)(e)),e.page=Object(m.a)((function(t){var n=t.resolve,r=e.uiItem&&e.uiItem.size;return v.createElement(y.a,{label:"\u66f4\u6539"+e.label,id:e.resId,size:r,onSaved:function(e){n(e)}})})),e}return Object(l.a)(n,[{key:"internalStart",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resId=this.value,e.abrupt("return",new Promise((function(e,n){k.b.push(v.createElement(t.page,{resolve:e,reject:n}),(function(){return n()}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(n(27).a),a=Object(p.a)(r.prototype,"resId",[b.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c}));n(31);var r={_:{required:"required",number:"not valid number",integer:"not valid integer",min:"min value is ${min}",max:"max value is ${max}"},zh:{_:{required:"\u5fc5\u987b\u586b",number:"\u9700\u8981\u6570\u5b57",integer:"\u9700\u8981\u6574\u6570",min:"\u4e0d\u80fd\u5c0f\u4e8e${min}",max:"\u4e0d\u80fd\u5927\u4e8e${max}"}}},a={_:{none:"[none]"},zh:{_:{none:"[\u65e0]"}}},i={_:{a:"d"}},c={_:{a:"d"}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r,a,i,c,o,u,s,l=n(22),h=n(1),d=n.n(h),f=n(4),p=n(10),v=n(2),m=n(3),b=n(9),y=(n(18),n(16)),k=n.n(y),g=n(8),w=(r=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(v.a)(this,e),this.isFirst=!0,this.pageItemAction=void 0,this.itemConverter=void 0,Object(p.a)(this,"loading",a,this),Object(p.a)(this,"beforeLoad",i,this),Object(p.a)(this,"loaded",c,this),this._items=void 0,Object(p.a)(this,"allLoaded",o,this),Object(p.a)(this,"topDiv",u,this),Object(p.a)(this,"bottomDiv",s,this),this.scrollToTop=function(){t.scrollIntoView(t.topDiv)},this.scrollToBottom=function(){t.scrollIntoView(t.bottomDiv)},this.param=void 0,this.firstSize=100,this.pageStart=void 0,this.pageSize=30,this.appendPosition="tail",this.sortOrder=void 0,this.changing=!1,this._items=g.m.array([],{deep:n})}return Object(m.a)(e,[{key:"setEachPageItem",value:function(e){this.pageItemAction=e}},{key:"setItemConverter",value:function(e){this.itemConverter=e}},{key:"scrollIntoView",value:function(e){setTimeout((function(){var t=document.getElementById(e);null===t||void 0===t||t.scrollIntoView()}),20)}},{key:"getPageId",value:function(e){}},{key:"setPageStart",value:function(e){this.pageStart=this.getPageId(e)}},{key:"load",value:function(){var e=Object(f.a)(d.a.mark((function e(t,n,r){var a,i,c,o,u,s,l,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadResults(t,n,r);case 2:if(a=e.sent,i=a.$page,!this.itemConverter){e.next=9;break}for(c=[],o=i.length,u=0;u<o;u++)s=this.itemConverter(i[u],a),c.push(s);return e.abrupt("return",c);case 9:if(void 0!==this.pageItemAction)for(l=i.length,h=0;h<l;h++)this.pageItemAction(i[h],a);return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.isFirst=!0,this.beforeLoad=!0,this.loaded=!1,this.param=void 0,this.allLoaded=!1,this.pageStart=void 0,this._items.clear()}},{key:"append",value:function(e){"tail"===this.appendPosition?this._items.unshift(e):this._items.push(e)}},{key:"first",value:function(){var e=Object(f.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.reset(),this.beforeLoad=!1,this.param=t,e.next=5,this.more();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"attach",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n,r,a,i,c,o,u,s,l,h,f,p,v;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sortOrder){e.next=3;break}return console.error("\u6ca1\u6709\u5b9a\u4e49\u589e\u51cf\u5e8f\uff0c\u65e0\u6cd5attach"),e.abrupt("return");case 3:if(!0!==this.changing){e.next=5;break}return e.abrupt("return");case 5:this.changing=!0,t=this._items,n="asc"===this.sortOrder,"tail"===this.appendPosition?(r=t[0],a=this.scrollToTop,i=function(e){return t.unshift(e)}):(c=t.length,r=t[c-1],a=this.scrollToBottom,i=function(e){return t.splice(c,0,e)}),o=this.getPageId(r),u=void 0,s=0,l=50;case 12:if(!(s<l)){e.next=39;break}return e.next=15,this.load(this.param,u,3);case 15:if(h=e.sent,0!==(f=h.length)){e.next=19;break}return e.abrupt("break",39);case 19:p=0;case 20:if(!(p<f)){e.next=37;break}if(v=h[p],u=this.getPageId(v),!0!==n){e.next=29;break}if(!(u>=o)){e.next=27;break}return l=0,e.abrupt("break",37);case 27:e.next=32;break;case 29:if(!(u<=o)){e.next=32;break}return l=0,e.abrupt("break",37);case 32:i(v),++s;case 34:p++,e.next=20;break;case 37:e.next=12;break;case 39:this.changing=!1,s>0&&a();case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.changing){e.next=2;break}return e.abrupt("return");case 2:return this.changing=!0,e.next=5,this.load(this.param,void 0,this.firstSize>this.pageSize?this.firstSize:this.pageSize);case 5:t=e.sent,this._items.clear(),this.setLoaded(t),this.changing=!1;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRefreshPageId",value:function(e){return this.getPageId(e)}},{key:"onLoad",value:function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onLoaded",value:function(){var e=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"more",value:function(){var e=Object(f.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.allLoaded){e.next=2;break}return e.abrupt("return",!1);case 2:if(!0!==this.loading){e.next=4;break}return e.abrupt("return",!0);case 4:if(!0!==this.changing){e.next=6;break}return e.abrupt("return",!0);case 6:return this.loading=!0,this.changing=!0,e.next=10,this.onLoad();case 10:return void 0===this.pageStart&&this.setPageStart(void 0),t=this.pageSize+1,!0===this.isFirst&&this.firstSize>this.pageSize&&(t=this.firstSize+1),e.next=15,this.load(this.param,this.pageStart,t);case 15:return n=e.sent,this.loaded=!0,r=n.length,!0===this.isFirst&&r>this.firstSize||!1===this.isFirst&&r>this.pageSize?(this.allLoaded=!1,--r,n.splice(r,1)):this.allLoaded=!0,this.setLoaded(n),this.isFirst=!1,this.onLoaded(),this.changing=!1,this.loading=!1,e.abrupt("return",!this.allLoaded);case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setLoaded",value:function(e){var t,n,r=e.length;0===r?(this.setPageStart(void 0),this._items.clear()):(this.setPageStart(e[r-1]),"tail"===this.appendPosition?(t=this._items).push.apply(t,Object(l.a)(e)):(n=this._items).unshift.apply(n,Object(l.a)(e.reverse())))}},{key:"findItem",value:function(e){var t=this,n=this.getPageId(e),r=k.a.findIndex(this._items,(function(e){return t.getPageId(e)===n}));if(!(r<0))return this._items[r]}},{key:"items",get:function(){return!0===this.beforeLoad?null:!1!==this.loaded?this._items:void 0}}]),e}(),a=Object(b.a)(r.prototype,"loading",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(b.a)(r.prototype,"beforeLoad",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),c=Object(b.a)(r.prototype,"loaded",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=Object(b.a)(r.prototype,"allLoaded",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(b.a)(r.prototype,"items",[g.g],Object.getOwnPropertyDescriptor(r.prototype,"items"),r.prototype),u=Object(b.a)(r.prototype,"topDiv",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$$top"}}),s=Object(b.a)(r.prototype,"bottomDiv",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$$bottom"}}),r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=new(function(){function e(){Object(c.a)(this,e),this.handlerSeed=1,this.anyHandlers={},this.msgHandlers={}}return Object(o.a)(e,[{key:"registerReceiveHandler",value:function(){var e,t=this.handlerSeed++,n=arguments.length<=0?void 0:arguments[0];switch(typeof n){case"string":e=arguments.length<=1?void 0:arguments[1],this.msgHandlers[t]={type:n,handler:e};break;case"function":this.anyHandlers[t]=n}return t}},{key:"unregisterReceiveHandler",value:function(e){delete this.anyHandlers[e],delete this.msgHandlers[e]}},{key:"dispatch",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$type,e.t0=a.a.keys(this.anyHandlers);case 2:if((e.t1=e.t0()).done){e.next=8;break}return r=e.t1.value,e.next=6,this.anyHandlers[r](t);case 6:e.next=2;break;case 8:e.t2=a.a.keys(this.msgHandlers);case 9:if((e.t3=e.t2()).done){e.next=18;break}if(i=e.t3.value,c=this.msgHandlers[i],o=c.type,u=c.handler,o===n){e.next=14;break}return e.abrupt("continue",9);case 14:return e.next=16,u(t);case 16:e.next=9;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}())},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(22),a=n(2),i=n(3),c=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#";Object(a.a)(this,e),this.root=void 0,this._routes=[],this._useHash=void 0,this._hash=void 0,this._paused=void 0,this._destroyed=void 0,this._lastRouteResolved=void 0,this._notFoundHandler=void 0,this._defaultHandler=void 0,this._usePushState=void 0,this._genericHooks=void 0,this._historyUpdateMethod=void 0,this.timout=void 0,this._onLocationChange=function(){console.log("_onLocationChange"),t.resolve()},this.root=null,this._useHash=r,this._hash=i||"#",this._paused=!1,this._destroyed=!1,this._lastRouteResolved=null,this._notFoundHandler=null,this._defaultHandler=null,this._usePushState=!r&&e.isPushStateAvailable(),this._genericHooks=null,this._historyUpdateMethod="pushState",n?this.root=r?n.replace(/\/$/,"/"+this._hash):n.replace(/\/$/,""):r&&(this.root=this._cLoc().split(this._hash)[0].replace(/\/$/,"/"+this._hash)),this._listen(),this.updatePageLinks()}return Object(i.a)(e,null,[{key:"isPushStateAvailable",value:function(){return!("undefined"===typeof window||!window.history||!window.history.pushState)}},{key:"clean",value:function(t){return t instanceof RegExp?t:e.cleanUrl(t)}},{key:"cleanUrl",value:function(e){return e.replace(/\/+$/,"").replace(/^\/+/,"^/")}},{key:"regExpResultToParams",value:function(e,t){return 0===t.length?null:e?e.slice(1,e.length).reduce((function(e,n,r){return null===e&&(e={}),e[t[r]]=decodeURIComponent(n),e}),null):null}},{key:"replaceDynamicURLParts",value:function(t){var n=[];return{regexp:t instanceof RegExp?t:new RegExp(t.replace(e.PARAMETER_REGEXP,(function(t,r,a){return n.push(a),e.REPLACE_VARIABLE_REGEXP})).replace(e.WILDCARD_REGEXP,e.REPLACE_WILDCARD)+e.FOLLOWED_BY_SLASH_REGEXP,e.MATCH_REGEXP_FLAGS),paramNames:n}}},{key:"getUrlDepth",value:function(e){return e.replace(/\/$/,"").split("/").length}},{key:"compareUrlDepth",value:function(t,n){return e.getUrlDepth(n)-e.getUrlDepth(t)}},{key:"findMatchedRoutes",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.map((function(n){var r=e.replaceDynamicURLParts(e.clean(n.route)),a=r.regexp,i=r.paramNames,c=t.replace(/^\/+/,"/").match(a),o=e.regExpResultToParams(c,i);return!!c&&{match:c,route:n,params:o}})).filter((function(e){return e}))}},{key:"match",value:function(t,n){return e.findMatchedRoutes(t,n)[0]||!1}},{key:"root",value:function(t,n){var r=RegExp("\\/:\\D(\\w*)","g"),a=n.map((function(e){var n=e.route;if(""===n||"*"===n)return t;"string"===typeof n&&(n=n.replace(r,"\\/\\w+"));var a=n+"";return t.split(new RegExp(a))[0]})),i=e.cleanUrl(t),c=a.length;if(0===c)return i;var o=a[0];return 1===c?o:a.reduce((function(e,t){return e.length>t.length&&(e=t),e}),o)}},{key:"isHashChangeAPIAvailable",value:function(){return"undefined"!==typeof window&&"onhashchange"in window}},{key:"extractGETParameters",value:function(e){return e.split(/\?(.*)?$/).slice(1).join("")}},{key:"getOnlyURL",value:function(t,n,r){var a,i=function(e){return e.split(/\?(.*)?$/)[0]};return"undefined"===typeof r&&(r="#"),e.isPushStateAvailable()&&!n?i(t).split(r)[0]:(a=t.split(r)).length>1?i(a[1]):i(a[0])}},{key:"manageHooks",value:function(e,t,n,r){if(t&&"object"===typeof t){if(t.before)return void t.before((function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r&&(e(),t.after&&t.after(n))}),n);if(t.after)return e(),void(t.after&&t.after(n))}e()}},{key:"isHashedRoot",value:function(t,n,r){if(e.isPushStateAvailable()&&!n)return!1;if(!t.match(r))return!1;var a=t.split(r);return a.length<2||""===a[1]}}]),Object(i.a)(e,[{key:"navigate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=e||"",this._usePushState)t=(t=(n?"":this._getRoot()+"/")+e.replace(/^\/+/,"/")).replace(/([^:])(\/{2,})/g,"$1/"),this._historyUpdate({},"",t),this.resolve();else if("undefined"!==typeof window){e=e.replace(new RegExp("^"+this._hash),"");var r=window,a=r.location;a.href=a.href.replace(/#$/,"").replace(new RegExp(this._hash+".*$"),"")+this._hash+e}return this}},{key:"on",value:function(){var t=this,n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];switch(typeof n){case"function":this._defaultHandler={handler:n,hooks:r},this._notFoundHandler||(this._notFoundHandler=this._defaultHandler);break;case"object":var a=Object.keys(n).sort(e.compareUrlDepth);a.forEach((function(e){return t.on(e,n[e])}));break;default:if(arguments.length<2)break;if("/"===n){this._defaultHandler={handler:"object"===typeof r?r.uses:r,hooks:arguments.length<=2?void 0:arguments[2]};break}this._add(n,r,arguments.length<=2?void 0:arguments[2])}return this}},{key:"off",value:function(e){return null!==this._defaultHandler&&e===this._defaultHandler.handler?this._defaultHandler=null:null!==this._notFoundHandler&&e===this._notFoundHandler.handler&&(this._notFoundHandler=null),this._routes=this._routes.reduce((function(t,n){return n.handler!==e&&t.push(n),t}),[]),this}},{key:"notFound",value:function(e,t){return this._notFoundHandler={handler:e,hooks:t},this}},{key:"resolve",value:function(t){var n=this,a=t||this._cLoc(),i=this._getRoot(),c=a.replace(i,"");if(this._useHash){c=c.replace(new RegExp("^\\/"+this._hash),"/")}var o=e.extractGETParameters(t||this._cLoc()),u=e.getOnlyURL(c,this._useHash,this._hash);if(this._paused)return!1;if(this._lastRouteResolved&&u===this._lastRouteResolved.url&&o===this._lastRouteResolved.query)return this._lastRouteResolved.hooks&&this._lastRouteResolved.hooks.already&&this._lastRouteResolved.hooks.already(this._lastRouteResolved.params),!1;var s=e.match(u,this._routes),l=function(t){e.manageHooks((function(){e.manageHooks((function(){n._callLeave(),n._lastRouteResolved={url:u,query:o,hooks:t.hooks},t.handler(o)}),t.hooks)}),n._genericHooks)};if(!1===s)return this._defaultHandler&&(""===u||"/"===u||u===this._hash||e.isHashedRoot(u,this._useHash,this._hash))?(l(this._defaultHandler),!0):(this._notFoundHandler&&l(this._notFoundHandler),!1);var h=s;if(h){this._callLeave(),this._lastRouteResolved={url:u,query:o,hooks:h.route.hooks,params:h.params,name:h.route.name};var d=h.route.handler;return e.manageHooks((function(){e.manageHooks((function(){h.route.route instanceof RegExp?d.apply(void 0,Object(r.a)(h.match.slice(1,h.match.length))):d(h.params,o)}),h.route.hooks,h.params,n._genericHooks)}),this._genericHooks,h.params),h}}},{key:"destroy",value:function(){this._routes=[],this._destroyed=!0,this._lastRouteResolved=null,this._genericHooks=null,clearTimeout(this.timout),"undefined"!==typeof window&&(window.removeEventListener("popstate",this._onLocationChange),window.removeEventListener("hashchange",this._onLocationChange))}},{key:"updatePageLinks",value:function(){var e=this;"undefined"!==typeof document&&this._findLinks().forEach((function(t){t.hasListenerAttached||(t.addEventListener("click",(function(n){if((n.ctrlKey||n.metaKey)&&"a"===n.currentTarget.tagName.toLowerCase())return!1;var r=e.getLinkPath(t);e._destroyed||(n.preventDefault(),e.navigate(r.replace(/\/+$/,"").replace(/^\/+/,"/")))})),t.hasListenerAttached=!0)}))}},{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._routes.reduce((function(n,r){if(r.name===e)for(var a in n=r.route.toString(),t)n=n.replace(":"+a,t[a]);return n}),"");return this._useHash?this._hash+n:n}},{key:"link",value:function(e){return this._getRoot()+e}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._paused=e,this._historyUpdateMethod=e?"replaceState":"pushState"}},{key:"resume",value:function(){this.pause(!1)}},{key:"historyAPIUpdateMethod",value:function(e){return"undefined"===typeof e?this._historyUpdateMethod:(this._historyUpdateMethod=e,e)}},{key:"disableIfAPINotAvailable",value:function(){e.isPushStateAvailable()||this.destroy()}},{key:"lastRouteResolved",value:function(){return this._lastRouteResolved}},{key:"getLinkPath",value:function(e){return e.getAttribute("href")}},{key:"hooks",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this._genericHooks=e}))},{key:"_add",value:function(e,t,n){return"string"===typeof e&&(e=encodeURI(e)),this._routes.push("object"===typeof t?{route:e,handler:t.uses,name:t.as,hooks:n||t.hooks}:{route:e,handler:t,name:void 0,hooks:n}),this._add}},{key:"_historyUpdate",value:function(e,t,n){switch(this._historyUpdateMethod){default:throw Error("unknow history method "+this._historyUpdateMethod);case"pushState":return void window.history.pushState(e,t,n);case"replaceState":return void window.history.replaceState(e,t,n)}}},{key:"_getRoot",value:function(){if(null!==this.root)return this.root;var t=this._cLoc().split("?")[0];return this.root=e.root(t,this._routes),this.root}},{key:"_listen",value:function(){var t=this;if(this._usePushState)window.addEventListener("popstate",this._onLocationChange);else if(e.isHashChangeAPIAvailable())window.addEventListener("hashchange",this._onLocationChange);else{var n=this._cLoc();!function e(){var r=t._cLoc();n!==r&&(n=r,t.resolve()),t.timout&&clearTimeout(t.timout),t.timout=setTimeout(e,200)}()}}},{key:"_cLoc",value:function(){return"undefined"!==typeof window?e.cleanUrl(window.location.href):""}},{key:"_findLinks",value:function(){return[].slice.call(document.querySelectorAll("[data-navigo]"))}},{key:"_callLeave",value:function(){var e=this._lastRouteResolved;if(e){var t=e.params,n=e.hooks;n&&n.leave&&n.leave(t)}}}]),e}();c.PARAMETER_REGEXP=/([:*])(\w+)/g,c.WILDCARD_REGEXP=/\*/g,c.REPLACE_VARIABLE_REGEXP="([^\\/]+)",c.REPLACE_WILDCARD="(?:.*)",c.FOLLOWED_BY_SLASH_REGEXP="(?:\\/$|$)",c.MATCH_REGEXP_FLAGS="";new c},function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return I}));var r,a,i,c,o,u,s,l,h=n(5),d=n(6),f=n(1),p=n.n(f),v=n(4),m=n(10),b=n(2),y=n(3),k=n(9),g=(n(18),n(0)),w=n(8),O=n(12),j=n(14),x=n.n(j),E=(n(108),n(45)),C=(r=function(){function e(){Object(b.a)(this,e),Object(m.a)(this,"loaded",a,this),this.name=void 0,Object(m.a)(this,"selected",i,this),this.caption=void 0,this.contentBuilder=void 0,this.page=void 0,this.notify=void 0,this.load=void 0,this.onShown=void 0,this.onScroll=void 0,this.onScrollTop=void 0,this.onScrollBottom=void 0,this.className=void 0,this._content=void 0}return Object(y.a)(e,[{key:"shown",value:function(){var e=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.onShown){e.next=3;break}return e.next=3,this.onShown();case 3:if(void 0===this.load){e.next=8;break}if(!1!==this.loaded){e.next=8;break}return e.next=7,this.load();case 7:this.loaded=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"content",get:function(){return this.load&&!1===this.loaded?null:(!1===this.selected||this._content||(void 0!==this.contentBuilder?this._content=this.contentBuilder():void 0!==this.page?this._content=this.page.content():this._content=g.createElement("div",{className:"p-5"},"tab \u5e94\u8be5\u5b9a\u4e49content\u6216\u8005page")),this._content)}}]),e}(),a=Object(k.a)(r.prototype,"loaded",[w.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(k.a)(r.prototype,"selected",[w.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r),N=function(e,t,n){return g.createElement("div",{className:"d-flex justify-content-center align-items-center flex-column cursor-pointer "+n},g.createElement("div",null,g.createElement("i",{className:"fa fa-lg fa-"+t})),g.createElement("small",null,e))},I=(c=function(){function e(t){var n=this;Object(b.a)(this,e),this.props=void 0,this.size=void 0,this.tabBg=void 0,this.sep=void 0,Object(m.a)(this,"selectedTab",o,this),Object(m.a)(this,"tabArr",u,this),this.tabClick=function(){var e=Object(v.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}if(void 0!==(t=n.selectedTab)){e.next=8;break}if(void 0!==n.tabArr){e.next=5;break}return e.abrupt("return");case 5:if(0!==n.tabArr.length){e.next=7;break}return e.abrupt("return");case 7:t=n.tabArr[0];case 8:return n.selectedTab.selected=!1,t.selected=!0,n.selectedTab=t,e.next=13,t.shown();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.tabs=Object(O.a)((function(){var e,t,r=n.props,a=r.tabPosition,i=r.borderColor;i&&(e={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderLeftWidth:1,borderRightWidth:1,borderBottomWidth:1},t={borderColor:i,borderStyle:"solid",borderTopWidth:1,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:0},"top"===a?(e.borderBottomWidth=0,e.borderTopLeftRadius=10,e.borderTopRightRadius=10,t.borderTopWidth=0):(e.borderTopWidth=0,e.borderBottomLeftRadius=10,e.borderBottomRightRadius=10,t.borderBottomWidth=0));var c=x()("tv-tabs",n.tabBg,n.sep,"tv-tabs-"+n.size);return g.createElement("div",{className:c},n.tabArr.map((function(r,a){var i,c=r.selected,o=r.caption,u=r.notify;if(void 0!==u){var s=u.get();void 0!==s&&(s>0?i=g.createElement("u",null,s>99?"99+":s):s<0&&(i=g.createElement("u",{className:"dot"})))}return g.createElement("div",{key:a,onClick:function(){return n.tabClick(r)},style:!0===c?e:t},g.createElement("div",null,i,o(c)))})))})),this.content=Object(O.a)((function(){var e={visibility:"hidden"};return g.createElement(g.Fragment,null,n.tabArr.map((function(t,r){var a,i,c,o,u=n.props.tabPosition,s=t.content,l=t.page,h=t.onScroll,d=t.onScrollTop,f=t.onScrollBottom,p=t.className,v=g.createElement(n.tabs);void 0!==l&&(a=l.header(),i=l.footer());var m,b={visibility:"hidden"};return"top"===u?(c=g.createElement(g.Fragment,null,g.createElement("section",{className:"tv-page-header"},g.createElement("header",null,v,a)),g.createElement("header",{style:b},v,a)),void 0!==i&&(o=g.createElement(g.Fragment,null,g.createElement("footer",{style:b},i),g.createElement("section",{className:"tv-page-footer"},g.createElement("footer",null,i))))):(void 0!==a&&(c=g.createElement(g.Fragment,null,g.createElement("section",{className:"tv-page-header"},g.createElement("header",null,a)),g.createElement("header",{style:b},a))),o=g.createElement(g.Fragment,null,g.createElement("footer",{style:b},i,v),g.createElement("section",{className:"tv-page-footer"},g.createElement("footer",null,i,v)))),!1===t.selected&&(m=e),g.createElement(E.a,{key:r,className:p,style:m,onScroll:h,onScrollTop:d,onScrollBottom:f},c,s,o)})))})),this.props=t;var r=t.size,a=t.tabs,i=t.tabBg,c=t.sep,s=t.selected;this.size=r||"md",this.tabArr=a.map((function(e){var t=new C,r=e.name,a=e.caption,i=e.content,c=e.page,o=e.notify,u=e.load,l=e.onShown,h=e.isSelected,d=e.onScroll,f=e.onScrollTop,p=e.onScrollBottom,v=e.className;return t.name=r,!0!==h&&r!==s||(n.selectedTab=t),t.selected=!1,t.caption=a,void 0!==i?t.contentBuilder=i:void 0!==c&&(t.page=c),t.notify=o,t.load=u,t.onShown=l,t.onScroll=d,t.onScrollTop=f,t.onScrollBottom=p,t.className=v,t})),this.tabBg=i,this.sep=c,void 0===this.selectedTab&&(this.selectedTab=this.tabArr[0]),this.selectedTab.selected=!0}return Object(y.a)(e,[{key:"render",value:function(){var e,t,n=this.props.tabPosition,r=g.createElement(this.tabs),a={display:"none"};return"top"===n?e=g.createElement("header",null,r):t=g.createElement("footer",null,r),g.createElement(g.Fragment,null,e,this.tabArr.map((function(e,t){var n;return!1===e.selected&&(n=a),g.createElement("div",{key:t,className:x()(e.className),style:n},e.content)})),t)}}]),e}(),o=Object(k.a)(c.prototype,"selectedTab",[w.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(k.a)(c.prototype,"tabArr",[w.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c);Object(O.a)(s=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new I(e),setTimeout((function(){r.tabsView.tabClick(void 0)}),100),r}return Object(y.a)(n,[{key:"render",value:function(){return this.tabsView.render()}}]),n}(g.Component)),Object(O.a)(l=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).tabsView=void 0,r.tabsView=new I(e),setTimeout((function(){r.tabsView.tabClick(void 0)}),100),r}return Object(y.a)(n,[{key:"render",value:function(){return g.createElement(this.tabsView.content)}}]),n}(g.Component))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r,a,i,c,o,u,s,l,h,d,f,p,v,m,b,y,k,g,w,O,j,x,E,C,N,I,S,A,P,T,F,V,R,_=n(1),D=n.n(_),B=n(4),U=n(10),L=n(2),q=n(3),M=n(11),z=n(5),H=n(6),W=n(9),G=(n(18),n(0)),$=n(21),K=n(46),Q=n(37),J=n(24),X=n(12),Y=n(8),Z=n(42),ee=Object(X.a)((a=function(e){Object(z.a)(n,e);var t=Object(H.a)(n);function n(){var e;Object(L.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).fileInput=void 0,Object(U.a)(e,"fileName",i,Object(M.a)(e)),e.upload=function(){var t=Object(B.a)(D.a.mark((function t(n){var r,a,i,c;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=$.b.resUrl+"upload",n||(n=e.buildFormData()),t.prev=2,$.b.startWait(),(a=new Headers).append("Access-Control-Allow-Origin","*"),t.next=8,fetch(r,{method:"POST",body:n,headers:a});case 8:return i=t.sent,t.next=11,i.json();case 11:return c=t.sent,t.abrupt("return",":"+c.res.id);case 15:return t.prev=15,t.t0=t.catch(2),console.error("%s %s",r,t.t0),t.abrupt("return",{error:t.t0});case 19:return t.prev=19,$.b.endWait(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,15,19,22]])})));return function(e){return t.apply(this,arguments)}}(),e.onFilesChange=function(t){var n=e.props.onFilesChange;n&&n(t);for(var r=t.target.files,a=r.length,i=[],c=0;c<a;c++)i.push(r.item(c).name);e.fileName=i.join(", ")},e}return Object(q.a)(n,[{key:"buildFormData",value:function(){var e=this.props.maxSize;void 0===e||e<=0?e=1e11:e*=1024;for(var t=this.fileInput.files,n=new FormData,r=t.length,a=0;a<r;a++){var i=t[a];if(i.size>e)return null;n.append("files[]",i,i.name)}}},{key:"getFile0",value:function(){return this.fileInput.files[0]}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.multiple,a=t.label;return G.createElement("div",null,G.createElement("label",{className:"btn btn-outline-success"},a||"\u9009\u62e9\u6587\u4ef6",G.createElement("input",{className:n,ref:function(t){return e.fileInput=t},onChange:this.onFilesChange,type:"file",name:"file",multiple:r,style:{display:"none"}})),"\xa0",this.fileName)}}]),n}(G.Component),i=Object(W.a)(a.prototype,"fileName",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r=a))||r;function te(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2?arguments[2]:void 0;for(r=r||["B","K","M","G","TB"];(t=r.shift())&&e>1024;)e/=1024;return("B"===t?e:e.toFixed(void 0===n?2:n))+t}var ne=1600,re=400,ae=Object(X.a)((O=w=function(e){Object(z.a)(n,e);var t=Object(H.a)(n);function n(e){var r;return Object(L.a)(this,n),(r=t.call(this,e)).imgBaseSize=void 0,r.imageTypes=void 0,r.suffix=void 0,r.resUploader=void 0,Object(U.a)(r,"file",u,Object(M.a)(r)),Object(U.a)(r,"desImgWidth",s,Object(M.a)(r)),Object(U.a)(r,"desImgHeight",l,Object(M.a)(r)),Object(U.a)(r,"desImgSize",h,Object(M.a)(r)),Object(U.a)(r,"srcImgWidth",d,Object(M.a)(r)),Object(U.a)(r,"srcImgHeight",f,Object(M.a)(r)),Object(U.a)(r,"isChanged",p,Object(M.a)(r)),Object(U.a)(r,"resId",v,Object(M.a)(r)),Object(U.a)(r,"enableUploadButton",m,Object(M.a)(r)),Object(U.a)(r,"srcImage",b,Object(M.a)(r)),Object(U.a)(r,"desImage",y,Object(M.a)(r)),Object(U.a)(r,"fileError",k,Object(M.a)(r)),Object(U.a)(r,"uploaded",g,Object(M.a)(r)),r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),r.imageTypes.indexOf(r.suffix)<0)return void(r.fileError="\u56fe\u7247\u7c7b\u578b\u5fc5\u987b\u662f ".concat(r.imageTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var n=new FileReader;n.readAsDataURL(r.file),n.onload=Object(B.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.srcImage=n.result,e.t0=r.suffix,e.next="svg"===e.t0?7:4;break;case 4:return e.next=6,r.setSize(r.props.size);case 6:return e.abrupt("break",11);case 7:return r.imgBaseSize=re,r.desImgSize=r.srcImage.length,r.desImage=r.srcImage,e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})))}},r.compress=function(){return new Promise((function(e,t){var n=new Image;n.src=r.srcImage,n.onload=function(){var t=n.width,a=n.height;r.srcImgWidth=t,r.srcImgHeight=a;var i,c,o=t/a;r.imgBaseSize<0||t<=r.imgBaseSize&&a<=r.imgBaseSize?(i=t,c=a):o<0?c=(i=r.imgBaseSize)/o:i=(c=r.imgBaseSize)*o,r.desImgWidth=Math.round(i),r.desImgHeight=Math.round(c);var u=document.createElement("canvas"),s=u.getContext("2d"),l=document.createAttribute("width");l.nodeValue=String(i);var h=document.createAttribute("height");h.nodeValue=String(c),u.setAttributeNode(l),u.setAttributeNode(h),s.drawImage(n,0,0,i,c);var d=u.toDataURL("image/"+r.suffix,.7),f=r.convertBase64UrlToBlob(d);r.desImgSize=f.size,r.desImgSize>3145728&&(r.fileError="\u56fe\u7247\u5927\u4e8e3M\uff0c\u65e0\u6cd5\u4e0a\u4f20",r.enableUploadButton=!1),e(d)}}))},r.upload=Object(B.a)(D.a.mark((function e(){var t,n,a,i,c,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return t=new FormData,n=r.convertBase64UrlToBlob(r.desImage),t.append("image",n,r.file.name),e.next=7,r.resUploader.upload(t);case 7:if("object"!==typeof(a=e.sent)){e.next=24;break}i=a.error,c=typeof i,e.t0=c,e.next="undefined"===e.t0?14:"string"===e.t0?16:"object"===e.t0?18:20;break;case 14:return o="error: undefined",e.abrupt("break",22);case 16:return o=i,e.abrupt("break",22);case 18:return o=i.message,e.abrupt("break",22);case 20:return o=String(o),e.abrupt("break",22);case 22:return r.fileError="error: "+c+" - "+o,e.abrupt("return");case 24:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 27:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},r.showOrgImage=function(){$.b.push(G.createElement(J.a,{header:"\u539f\u56fe"},G.createElement("div",{className:"p-3 text-center"},G.createElement(Q.a,{className:"h-min-4c",style:{maxWidth:"100%"},src:r.srcImage}))))},r.resId=e.id,r.imageTypes=e.imageTypes||n.imageTypes,r}return Object(q.a)(n,[{key:"setSize",value:function(){var e=Object(B.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="sm"===e.t0?3:"md"===e.t0?5:"lg"===e.t0?7:"xl"===e.t0?9:"raw"===e.t0?11:3;break;case 3:return this.imgBaseSize=180,e.abrupt("break",13);case 5:return this.imgBaseSize=re,e.abrupt("break",13);case 7:return this.imgBaseSize=800,e.abrupt("break",13);case 9:return this.imgBaseSize=ne,e.abrupt("break",13);case 11:return this.imgBaseSize=-1,e.abrupt("break",13);case 13:return e.next=15,this.compress();case 15:this.desImage=e.sent;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"levelDiv",value:function(){var e=this;if(!this.props.size){var t=[{caption:"\u5c0f\u56fe",size:"sm"}];if((this.srcImgHeight>re||this.srcImgWidth>re)&&t.push({caption:"\u4e2d\u56fe",size:"md"}),(this.srcImgHeight>800||this.srcImgWidth>800)&&t.push({caption:"\u5927\u56fe",size:"lg"}),(this.srcImgHeight>ne||this.srcImgWidth>ne)&&(t.push({caption:"\u8d85\u5927\u56fe",size:"xl"}),t.push({caption:"\u539f\u56fe",size:"raw"})),!(t.length<2))return G.createElement("div",null,t.map((function(t,n){var r=t.caption,a=t.size;return G.createElement("label",{key:n,className:"mr-3"},G.createElement("input",{type:"radio",name:"size",onChange:function(){return e.setSize(a)},defaultChecked:0===n})," ",r)})))}}},{key:"render",value:function(){var e=this,t=this.props.label,n=G.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!this.isChanged,onClick:this.onSaved},"\u4fdd\u5b58");return G.createElement(J.a,{header:t||"\u66f4\u6539\u56fe\u7247",right:n},G.createElement("div",{className:"my-3 px-3 py-3 bg-white"},G.createElement("div",null,G.createElement("div",{className:"mb-3"},G.createElement(ee,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u56fe\u7247\u6587\u4ef6",onFilesChange:this.onFileChange}),G.createElement("div",{className:"small text-muted"},"\u652f\u6301 ",this.imageTypes.join(", ")," \u683c\u5f0f\u56fe\u7247\u3002"),this.fileError&&G.createElement("div",{className:"text-danger"},this.fileError)),G.createElement(Z.c,{left:!0===this.uploaded?G.createElement("div",{className:"text-success p-2"},"\u4e0a\u4f20\u6210\u529f\uff01"):this.file&&this.desImgSize>0&&G.createElement("div",{className:"mb-3 d-flex align-items-end"},G.createElement("div",{className:"mr-5"},this.levelDiv(),G.createElement("div",null,"\u5206\u8fa8\u7387\uff1a",this.desImgWidth," x ",this.desImgHeight,"\xa0 \xa0 \u6587\u4ef6\u5927\u5c0f\uff1a",te(this.desImgSize))),G.createElement("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload},"\u4e0a\u4f20")),right:this.desImage&&G.createElement("button",{className:"btn btn-link btn-sm text-right mb-3",onClick:this.showOrgImage},"\u539f\u56fe\u5927\u5c0f: ",te(this.file.size),G.createElement("br",null),"\u5206\u8fa8\u7387\uff1a",this.srcImgWidth," x ",this.srcImgHeight)})),G.createElement("div",{className:"text-center",style:{border:!0===this.uploaded?"2px solid green":"1px dotted gray",padding:"8px"}},G.createElement(Q.a,{className:"h-min-4c",style:{maxWidth:"100%"},src:this.desImage}))))}}]),n}(G.Component),w.imageTypes=["gif","jpg","jpeg","png","svg","apng","bmp","ico","cur","tiff","tif","webp"],o=O,u=Object(W.a)(o.prototype,"file",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(W.a)(o.prototype,"desImgWidth",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(W.a)(o.prototype,"desImgHeight",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(W.a)(o.prototype,"desImgSize",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(W.a)(o.prototype,"srcImgWidth",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(W.a)(o.prototype,"srcImgHeight",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(W.a)(o.prototype,"isChanged",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=Object(W.a)(o.prototype,"resId",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(W.a)(o.prototype,"enableUploadButton",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=Object(W.a)(o.prototype,"srcImage",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(W.a)(o.prototype,"desImage",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(W.a)(o.prototype,"fileError",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(W.a)(o.prototype,"uploaded",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=o))||c;Object(X.a)((R=V=function(e){Object(z.a)(n,e);var t=Object(H.a)(n);function n(e){var r;return Object(L.a)(this,n),(r=t.call(this,e)).suffix=void 0,r.resUploader=void 0,Object(U.a)(r,"content",E,Object(M.a)(r)),Object(U.a)(r,"file",C,Object(M.a)(r)),Object(U.a)(r,"fileSize",N,Object(M.a)(r)),Object(U.a)(r,"isChanged",I,Object(M.a)(r)),Object(U.a)(r,"resId",S,Object(M.a)(r)),Object(U.a)(r,"enableUploadButton",A,Object(M.a)(r)),Object(U.a)(r,"fileError",P,Object(M.a)(r)),Object(U.a)(r,"uploaded",T,Object(M.a)(r)),Object(U.a)(r,"uploading",F,Object(M.a)(r)),r.onFileChange=function(e){if(r.fileError=void 0,r.uploaded=!1,r.enableUploadButton=e.target.files.length>0,r.enableUploadButton){r.file=e.target.files[0];var t=r.file.name.lastIndexOf(".");if(t>=0&&(r.suffix=r.file.name.substr(t+1).toLowerCase()),n.audioTypes.indexOf(r.suffix)<0)return void(r.fileError="\u97f3\u9891\u7c7b\u578b\u5fc5\u987b\u662f ".concat(n.audioTypes.join(", ")," \u4e2d\u7684\u4e00\u79cd"));var a=new FileReader;a.readAsDataURL(r.file),a.onload=Object(B.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.content=a.result,r.fileSize=r.content.length;case 2:case"end":return e.stop()}}),e)})))}},r.upload=Object(B.a)(D.a.mark((function e(){var t,n,a,i,c,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resUploader){e.next=2;break}return e.abrupt("return");case 2:return r.uploading=!0,t=new FormData,n=r.convertBase64UrlToBlob(r.content),t.append("image",n,r.file.name),e.next=8,r.resUploader.upload(t);case 8:if("object"!==typeof(a=e.sent)){e.next=25;break}i=a.error,c=typeof i,e.t0=c,e.next="undefined"===e.t0?15:"string"===e.t0?17:"object"===e.t0?19:21;break;case 15:return o="error: undefined",e.abrupt("break",23);case 17:return o=i,e.abrupt("break",23);case 19:return o=i.message,e.abrupt("break",23);case 21:return o=String(o),e.abrupt("break",23);case 23:return r.fileError="error: "+c+" - "+o,e.abrupt("return");case 25:r.resId=a,r.isChanged=r.resId!==r.props.id,r.uploaded=!0;case 28:case"end":return e.stop()}}),e)}))),r.onSaved=function(){var e=r.props.onSaved;e&&e(r.resId)},r.resId=e.id,r}return Object(q.a)(n,[{key:"convertBase64UrlToBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,i=new Uint8Array(a);a--;)i[a]=r.charCodeAt(a);return new Blob([i],{type:n})}},{key:"render",value:function(){var e=this,t=this.props.label,r=G.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!this.isChanged,onClick:this.onSaved},"\u4fdd\u5b58");return G.createElement(J.a,{header:t||"\u66f4\u6539\u6587\u4ef6",right:r},G.createElement("div",{className:"my-3 px-3 py-3 bg-white"},G.createElement("div",null,G.createElement("div",{className:"mb-3"},G.createElement(ee,{ref:function(t){return e.resUploader=t},multiple:!1,maxSize:2048,label:"\u9009\u62e9\u97f3\u9891\u6587\u4ef6",onFilesChange:this.onFileChange}),G.createElement("div",{className:"small text-muted"},"\u652f\u6301 ",n.audioTypes.join(", ")," \u683c\u5f0f\u3002"),this.fileError&&G.createElement("div",{className:"text-danger"},this.fileError)))),G.createElement(Z.c,{left:!0===this.uploaded?G.createElement("div",{className:"text-success p-2"},"\u4e0a\u4f20\u6210\u529f\uff01"):!0===this.uploading?G.createElement("div",{className:"m-3"},G.createElement(K.a,null)):this.file&&this.content&&G.createElement("div",{className:"m-3"},G.createElement("div",{className:"mb-3"},"\u6587\u4ef6\u5927\u5c0f\uff1a",te(this.fileSize)),G.createElement("button",{className:"btn btn-primary",disabled:!this.enableUploadButton,onClick:this.upload},"\u4e0a\u4f20"))}))}}]),n}(G.Component),V.audioTypes=["mp3","wav"],x=R,E=Object(W.a)(x.prototype,"content",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(W.a)(x.prototype,"file",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(W.a)(x.prototype,"fileSize",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(W.a)(x.prototype,"isChanged",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S=Object(W.a)(x.prototype,"resId",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(W.a)(x.prototype,"enableUploadButton",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=Object(W.a)(x.prototype,"fileError",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(W.a)(x.prototype,"uploaded",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),F=Object(W.a)(x.prototype,"uploading",[Y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=x))},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(13),a=n(1),i=n.n(a),c=n(4),o=n(2),u=n(3),s=n(16),l=n.n(s),h=n(20),d=n(48),f=n(41),p=n(61),v=n(35),m=n(62),b=n(63),y=n(64),k=n(65),g=n(44),w=n(66);var O=function(){function e(t,n,r,a){var i=this;Object(o.a)(this,e),this.actions={},this.sheets={},this.queries={},this.books={},this.maps={},this.histories={},this.pendings={},this.tags={},this.tuidsCache=void 0,this.localAccess=void 0,this.tvs=void 0,this.localMap=void 0,this.localModifyMax=void 0,this.tuids={},this.createBoxId=void 0,this.newVersion=void 0,this.uqOwner=void 0,this.uqName=void 0,this.name=void 0,this.uqApi=void 0,this.id=void 0,this.uqVersion=void 0,this.createBoxIdFromTVs=function(e,t){var n=e.name;return new g.a(t,e,i.tvs[n])},this.tuidArr=[],this.actionArr=[],this.sheetArr=[],this.queryArr=[],this.bookArr=[],this.mapArr=[],this.historyArr=[],this.pendingArr=[],this.tagArr=[],this.createBoxId=r,void 0===r&&(this.createBoxId=this.createBoxIdFromTVs,this.tvs=a||{});var c=n.id,u=n.uqOwner,s=n.uqName,l=n.access,f=n.newVersion;this.newVersion=f,this.uqOwner=u,this.uqName=s,this.id=c,this.name=u+"/"+s,this.uqVersion=0,this.localMap=t.localMap.map(this.name),this.localModifyMax=this.localMap.child("$modifyMax"),this.localAccess=this.localMap.child("$access");var p;if(p=null===l||void 0===l||"*"===l?[]:l.split(";").map((function(e){return e.trim()})).filter((function(e){return e.length>0})),"$$$/$unitx"===this.name)this.uqApi=new h.d(h.f.unit);else{var v=t.appOwner,m=t.appName;this.uqApi=new h.e("tv/",v,m,u,s,p,!0)}this.tuidsCache=new d.TuidsCache(this)}return Object(u.a)(e,[{key:"tuid",value:function(e){return this.tuids[e.toLowerCase()]}},{key:"tuidDiv",value:function(e,t){var n=this.tuids[e.toLowerCase()];return n&&n.div(t.toLowerCase())}},{key:"action",value:function(e){return this.actions[e.toLowerCase()]}},{key:"sheet",value:function(e){return this.sheets[e.toLowerCase()]}},{key:"query",value:function(e){return this.queries[e.toLowerCase()]}},{key:"book",value:function(e){return this.books[e.toLowerCase()]}},{key:"map",value:function(e){return this.maps[e.toLowerCase()]}},{key:"history",value:function(e){return this.histories[e.toLowerCase()]}},{key:"pending",value:function(e){return this.pendings[e.toLowerCase()]}},{key:"sheetFromTypeId",value:function(e){for(var t in this.sheets){var n=this.sheets[t];if(n.typeId===e)return n}}},{key:"init",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.init();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadEntities",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.localAccess.get()){e.next=6;break}return e.next=5,this.uqApi.loadAccess();case 5:t=e.sent;case 6:if(t){e.next=8;break}return e.abrupt("return");case 8:this.buildEntities(t),e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"buildEntities",value:function(e){this.localAccess.set(e);var t=e.access,n=e.tuids,r=e.version;this.uqVersion=r,this.buildTuids(n),this.buildAccess(t)}},{key:"buildTuids",value:function(e){for(var t in e){var n=e[t],r=n.typeId,a=n.from;this.newTuid(t,r,a).sys=!0}for(var i in e){var c=e[i];this.getTuid(i).setSchema(c)}for(var o in this.tuids){this.tuids[o].buildFieldsTuid()}}},{key:"loadEntitySchema",value:function(){var e=Object(c.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqApi.schema(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTuid",value:function(e){return this.tuids[e]}},{key:"buildAccess",value:function(e){for(var t in e){var n=e[t];switch(typeof n){case"string":this.fromType(t,n);break;case"object":this.fromObj(t,n)}}}},{key:"cacheTuids",value:function(e){this.tuidsCache.cacheTuids(e)}},{key:"newAction",value:function(e,t){var n=this.actions[e];return void 0!==n||(n=this.actions[e]=new f.a(this,e,t),this.actionArr.push(n)),n}},{key:"newTuid",value:function(e,t,n){var r=this.tuids[e];return void 0!==r||(r=void 0!==n?new d.TuidImport(this,e,t,n):new d.TuidInner(this,e,t),this.tuids[e]=r,this.tuidArr.push(r)),r}},{key:"newQuery",value:function(e,t){var n=this.queries[e];return void 0!==n||(n=this.queries[e]=new v.a(this,e,t),this.queryArr.push(n)),n}},{key:"newBook",value:function(e,t){var n=this.books[e];return void 0!==n||(n=this.books[e]=new m.a(this,e,t),this.bookArr.push(n)),n}},{key:"newMap",value:function(e,t){var n=this.maps[e];return void 0!==n||(n=this.maps[e]=new y.a(this,e,t),this.mapArr.push(n)),n}},{key:"newTag",value:function(e,t){var n=this.tags[e];return void 0!==n||(n=this.tags[e]=new w.a(this,e,t),this.tagArr.push(n)),n}},{key:"newHistory",value:function(e,t){var n=this.histories[e];if(void 0===n)return n=this.histories[e]=new b.a(this,e,t),this.historyArr.push(n),n}},{key:"newPending",value:function(e,t){var n=this.pendings[e];if(void 0===n)return n=this.pendings[e]=new k.a(this,e,t),this.pendingArr.push(n),n}},{key:"newSheet",value:function(e,t){var n=this.sheets[e];return void 0!==n||(n=this.sheets[e]=new p.a(this,e,t),this.sheetArr.push(n)),n}},{key:"fromType",value:function(e,t){var n=t.split("|");t=n[0];var r=Number(n[1]);switch(t){case"tuid":break;case"action":this.newAction(e,r);break;case"query":this.newQuery(e,r);break;case"book":this.newBook(e,r);break;case"map":this.newMap(e,r);break;case"history":this.newHistory(e,r);break;case"sheet":this.newSheet(e,r);break;case"pending":this.newPending(e,r);break;case"tag":this.newTag(e,r)}}},{key:"fromObj",value:function(e,t){switch(t.$){case"sheet":this.buildSheet(e,t)}}},{key:"buildSheet",value:function(e,t){var n=this.sheets[e];void 0===n&&(n=this.newSheet(e,t.id)),n.build(t)}},{key:"buildFieldTuid",value:function(e,t){var n=this;if(void 0!==e){var a,i=Object(r.a)(e);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=c.tuid;if(void 0!==o){var u=this.getTuid(o);void 0!==u&&(c._tuid=u.buildTuidBox())}}}catch(d){i.e(d)}finally{i.f()}var s,l=Object(r.a)(e);try{var h=function(){var r=s.value,a=r.owner;if(void 0===a)return"continue";var i=e.find((function(e){return e.name===a}));if(void 0===i&&(void 0!==t&&(i=t.find((function(e){return e.name===a}))),void 0===i))throw new Error("owner field ".concat(a," is undefined"));var c=r.arr,o=r.tuid,u=n.getTuid(i._tuid.tuid.name);if(void 0===u)return"continue";var l=u.div(c||o);if(r._tuid=l&&l.buildTuidDivBox(i),void 0===r._tuid)throw new Error("owner field ".concat(a," is not tuid"))};for(l.s();!(s=l.n()).done;)h()}catch(d){l.e(d)}finally{l.f()}}}},{key:"buildArrFieldsTuid",value:function(e,t){if(void 0!==e){var n,a=Object(r.a)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value.fields;void 0!==i&&this.buildFieldTuid(i,t)}}catch(c){a.e(c)}finally{a.f()}}}},{key:"pullModify",value:function(e){this.tuidsCache.pullModify(e)}},{key:"entities",get:function(){return l.a.merge({},this.actions,this.sheets,this.queries,this.books,this.maps,this.histories,this.pendings,this.tuids,this.tags)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(1),a=n.n(r),i=n(4),c=n(13),o=n(2),u=n(3),s=n(19),l=n(17),h=n(5),d=n(6),f=n(29),p=n(55),v=n(28),m=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).states=void 0,e}return Object(u.a)(n,[{key:"setSchema",value:function(e){Object(s.a)(Object(l.a)(n.prototype),"setSchema",this).call(this,e),this.states=e.states}},{key:"build",value:function(e){this.states=[];var t,n=Object(c.a)(e.ops);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.states.push({name:r,actions:void 0})}}catch(a){n.e(a)}finally{n.f()}}},{key:"createSheetState",value:function(e,t){var n={name:e,actions:[]},r=n.actions;for(var a in t){var i={name:a};r.push(i)}return n}},{key:"save",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.uq.id,i={app:r,discription:t,data:n},e.next=4,new y(this,i).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"action",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new k(this,{id:t,flow:n,state:r,action:i}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"unpack",value:function(e){var t=e[0][0];return{brief:t,data:this.unpackSheet(t.data),flows:e[1]}}},{key:"getSheet",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new g(this,t).request();case 2:if(0!==(n=e.sent)[0].length){e.next=7;break}return e.next=6,this.getArchive(t);case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",this.unpack(n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchive",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new w(this,t).request();case 2:return n=e.sent,e.abrupt("return",this.unpack(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getArchives",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={pageStart:t,pageSize:n},e.next=3,new O(this,r).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStateSheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={state:t,pageStart:n,pageSize:r},e.next=3,new j(this,i).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createPageStateItems",value:function(){return new N(this)}},{key:"stateSheetCount",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new x(this,void 0).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"userSheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={state:t,user:n,pageStart:r,pageSize:i},e.next=3,new E(this,c).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"mySheets",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={state:t,pageStart:n,pageSize:r},e.next=3,new C(this,i).request();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"sheet"}}]),n}(f.a),b=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix=void 0,e}return Object(u.a)(n,[{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/").concat(this.suffix)}}]),n}(v.b),y=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"buildParams",value:function(){var e=this.params,t=e.app,n=e.discription,r=e.data;return{app:t,discription:n,data:this.entity.pack(r)}}},{key:"path",get:function(){return"sheet/".concat(this.entity.name)}}]),n}(b),k=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="PUT",e}return Object(u.a)(n,[{key:"path",get:function(){return"sheet/".concat(this.entity.name)}}]),n}(b),g=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(u.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/get/").concat(this.params)}}]),n}(b),w=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(u.a)(n,[{key:"buildParams",value:function(){}},{key:"path",get:function(){return"sheet/".concat(this.entity.name,"/archive/").concat(this.params)}}]),n}(b),O=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="archives",e}return n}(b),j=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="states",e}return n}(b),x=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e.suffix="statecount",e}return Object(u.a)(n,[{key:"xresult",value:function(e){return this.entity.states.map((function(t){var n=t.name,r=0,a=e.find((function(e){return e.state===n}));return void 0!==a&&(r=a.count),{state:n,count:r}}))}}]),n}(b),E=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="user-sheets",e}return Object(u.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(b),C=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).suffix="my-sheets",e}return Object(u.a)(n,[{key:"xresult",value:function(e){return e}}]),n}(b),N=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,!0)).sheet=void 0,r.sheet=e,r.pageSize=10,r}return Object(u.a)(n,[{key:"loadResults",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sheet.getStateSheets(t,n,r);case 2:return i=e.sent,e.abrupt("return",{$page:i});case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getPageId",value:function(e){return void 0===e?0:e.id}}]),n}(p.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),a=n(3),i=n(5),c=n(6),o=n(35),u=n(28),s=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).queryApiName="book",e}return Object(a.a)(n,[{key:"queryCaller",value:function(e){return new l(this,e)}},{key:"typeName",get:function(){return"book"}}]),n}(o.a),l=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"path",get:function(){return"book/".concat(this.entity.name)}}]),n}(u.d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),a=n(3),i=n(5),c=n(6),o=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).queryApiName="history",e}return Object(a.a)(n,[{key:"typeName",get:function(){return"history"}}]),n}(n(35).a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(19),s=n(17),l=n(5),h=n(6),d=n(29),f=n(41),p=n(28),v=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).keys=void 0,e.actions={},e.queries={},e.schemaFrom=void 0,e}return Object(o.a)(n,[{key:"setSchema",value:function(e){Object(u.a)(Object(s.a)(n.prototype),"setSchema",this).call(this,e),this.schemaFrom=this.schema.from;var t=e.actions,r=e.queries,a=e.keys;for(var i in this.uq.buildFieldTuid(this.keys=a),t){var c=t[i],o=c.name,l=this.uq.newAction(o,void 0);l.setSchema(c),l.buildFieldsTuid(),this.actions[i]=l}for(var h in r){var d=r[h],f=d.name,p=this.uq.newQuery(f,void 0);p.setSchema(d),p.buildFieldsTuid(),this.queries[h]=p}}},{key:"add",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new b(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new y(this,t).request();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new k(this,void 0).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"page",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new g(this,{pageStart:n,pageSize:r,param:t}).request();case 2:return i=e.sent,e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new w(this,t),e.next=3,n.request();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"table",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query(t);case 2:n=e.sent,e.t0=a.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"obj",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.table(t);case 2:if(!((n=e.sent).length>0)){e.next=5;break}return e.abrupt("return",n[0]);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"scalar",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.obj(t);case 2:n=e.sent,e.t0=a.a.keys(n);case 4:if((e.t1=e.t0()).done){e.next=9;break}return r=e.t1.value,e.abrupt("return",n[r]);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"map"}}]),n}(d.a),m=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"innerCall",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getCaller(this.params),e.next=3,this.entity.uqApi.xcall(t);case 3:return n=e.sent,r=t.xresult(n.res),e.abrupt("return",{res:r});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildParams",value:function(){return Object(u.a)(Object(s.a)(n.prototype),"buildParams",this).call(this)}},{key:"entity",get:function(){return this._entity}},{key:"path",get:function(){}}]),n}(p.b),b=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCaller",value:function(e){return new O(this.entity,this.entity.actions.add,e)}}]),n}(m),y=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCaller",value:function(e){return new j(this.entity,this.entity.actions.add,e)}}]),n}(m),k=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCaller",value:function(e){return new x(this.entity,this.entity.queries.all,e)}}]),n}(m),g=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCaller",value:function(e){return new E(this.entity,this.entity.queries.page,e)}}]),n}(m),w=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getCaller",value:function(e){return new C(this.entity,this.entity.queries.query,e)}}]),n}(m),O=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(o.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/add")}},{key:"headers",get:function(){}}]),n}(f.b),j=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(o.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/del")}},{key:"headers",get:function(){}}]),n}(f.b),x=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(o.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/all")}},{key:"headers",get:function(){}}]),n}(p.c),E=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(o.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/page")}},{key:"headers",get:function(){}}]),n}(p.c),C=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,r,a)).map=void 0,i.map=e,i}return Object(o.a)(n,[{key:"path",get:function(){return"map/".concat(this.map.name,"/query")}},{key:"headers",get:function(){}}]),n}(p.d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),a=n(3),i=n(5),c=n(6),o=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).queryApiName="pending",e}return Object(a.a)(n,[{key:"typeName",get:function(){return"pending"}}]),n}(n(35).a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(1),a=n.n(r),i=n(4),c=n(13),o=n(2),u=n(3),s=n(5),l=n(6),h=n(29),d=n(0),f={height:"auto"},p=function(){function e(t){Object(o.a)(this,e),this.tag=void 0,this.tag=t}return Object(u.a)(e,[{key:"render",value:function(e){var t;return t="number"===typeof e?[this.tag.nameFromId(e)]:this.tag.namesFromIds(e),d.createElement("div",{className:"d-flex flex-wrap "},t.map((function(e,t){return d.createElement("div",{key:t,className:"mx-2 border border-muted rounded px-3 bg-light"},e)})))}},{key:"renderRadios",value:function(e,t){var n=this,r=this.tag.values.map((function(r,a){return d.createElement("div",{className:"col",key:a},n.renderRadio(r,e,t))}));return this.renderView(t,r)}},{key:"renderChecks",value:function(e,t){var n=this,r=void 0===e?void 0:e.split("|").map((function(e){return Number(e)})),a=this.tag.values.map((function(e,a){var i=void 0===r?void 0:r.indexOf(e.id)>=0;return d.createElement("div",{className:"col",key:a},n.renderCheck(e,i,t))}));return this.renderView(t,a)}},{key:"renderView",value:function(e,t){var n=e.className,r=e.wrapClassName;return r=r?"row "+r:"row row-cols-2 row-cols-sm-3 row-cols-md-4",d.createElement("div",{className:n,style:f},d.createElement("div",{className:r},t))}},{key:"renderRadio",value:function(e,t,n){var r=e.id,a=e.name,i=n.inputs,c=n.inputName,o=n.onInputChange,u=i&&function(e){return i[r]=e};return d.createElement("label",{className:"form-radio-inline"},d.createElement("input",{ref:u,type:"radio",name:c,value:r,defaultChecked:t===r,onChange:o}),a)}},{key:"renderCheck",value:function(e,t,n){var r=e.id,a=e.name,i=n.inputs,c=n.onInputChange,o=i&&function(e){return i[r]=e};return d.createElement("label",{className:"form-radio-inline"},d.createElement("input",{ref:o,type:"checkbox",value:r,defaultChecked:t,onChange:c}),a)}}]),e}(),v=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).values=void 0,e.coll={},e._view=void 0,e}return Object(u.a)(n,[{key:"nameFromId",value:function(e){var t=this.coll[e];return void 0===t?void 0:t.name}},{key:"namesFromIds",value:function(e){var t,n=[],r=Object(c.a)(e.split("|"));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=this.coll[Number(a)],o=void 0===i?void 0:i.name;void 0!==o&&n.push(o)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"loadValues",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,o,u,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.values){e.next=2;break}return e.abrupt("return",this.values);case 2:return this.values=[],e.next=5,this.uqApi.get("tag/values/"+this.name);case 5:if(void 0!==(t=e.sent)){e.next=8;break}return e.abrupt("return");case 8:n=t.split("\n"),r=Object(c.a)(n),e.prev=10,r.s();case 12:if((i=r.n()).done){e.next=23;break}if(0!==(o=i.value).length){e.next=16;break}return e.abrupt("continue",21);case 16:u=o.split("\t"),s=Number(u[0]),l={id:s,name:u[1],ext:u[2]},this.values.push(l),this.coll[s]=l;case 21:e.next=12;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(10),r.e(e.t0);case 28:return e.prev=28,r.f(),e.finish(28);case 31:return e.abrupt("return",this.values);case 32:case"end":return e.stop()}}),e,this,[[10,25,28,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"typeName",get:function(){return"tag"}},{key:"view",get:function(){return void 0!==this._view?this._view:this._view=new p(this)}}]),n}(h.a)},,,,,,,function(e,t,n){"use strict";var r=n(24);n.d(t,"a",(function(){return r.a}));var a=n(58);n.d(t,"b",(function(){return a.a}));n(45)},function(e,t,n){"use strict";var r=n(75);n.o(r,"CAppBase")&&n.d(t,"CAppBase",(function(){return r.CAppBase})),n.o(r,"CBase")&&n.d(t,"CBase",(function(){return r.CBase})),n.o(r,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return r.CStringEdit})),n.o(r,"CSub")&&n.d(t,"CSub",(function(){return r.CSub})),n.o(r,"Controller")&&n.d(t,"Controller",(function(){return r.Controller})),n.o(r,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return r.DropdownActions})),n.o(r,"EasyTime")&&n.d(t,"EasyTime",(function(){return r.EasyTime})),n.o(r,"Edit")&&n.d(t,"Edit",(function(){return r.Edit})),n.o(r,"FA")&&n.d(t,"FA",(function(){return r.FA})),n.o(r,"Form")&&n.d(t,"Form",(function(){return r.Form})),n.o(r,"IconText")&&n.d(t,"IconText",(function(){return r.IconText})),n.o(r,"Image")&&n.d(t,"Image",(function(){return r.Image})),n.o(r,"LMR")&&n.d(t,"LMR",(function(){return r.LMR})),n.o(r,"List")&&n.d(t,"List",(function(){return r.List})),n.o(r,"Muted")&&n.d(t,"Muted",(function(){return r.Muted})),n.o(r,"PropGrid")&&n.d(t,"PropGrid",(function(){return r.PropGrid})),n.o(r,"QueryPager")&&n.d(t,"QueryPager",(function(){return r.QueryPager})),n.o(r,"SearchBox")&&n.d(t,"SearchBox",(function(){return r.SearchBox})),n.o(r,"UserView")&&n.d(t,"UserView",(function(){return r.UserView})),n.o(r,"VPage")&&n.d(t,"VPage",(function(){return r.VPage})),n.o(r,"View")&&n.d(t,"View",(function(){return r.View})),n.o(r,"emailRegex")&&n.d(t,"emailRegex",(function(){return r.emailRegex})),n.o(r,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return r.mobileRegex})),n.o(r,"resLang")&&n.d(t,"resLang",(function(){return r.resLang})),n.o(r,"resOptions")&&n.d(t,"resOptions",(function(){return r.resOptions})),n.o(r,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return r.setGlobalRes})),n.o(r,"setRes")&&n.d(t,"setRes",(function(){return r.setRes})),n.o(r,"start")&&n.d(t,"start",(function(){return r.start})),n.o(r,"t")&&n.d(t,"t",(function(){return r.t}));var a=n(76);n.o(a,"CAppBase")&&n.d(t,"CAppBase",(function(){return a.CAppBase})),n.o(a,"CBase")&&n.d(t,"CBase",(function(){return a.CBase})),n.o(a,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return a.CStringEdit})),n.o(a,"CSub")&&n.d(t,"CSub",(function(){return a.CSub})),n.o(a,"Controller")&&n.d(t,"Controller",(function(){return a.Controller})),n.o(a,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return a.DropdownActions})),n.o(a,"EasyTime")&&n.d(t,"EasyTime",(function(){return a.EasyTime})),n.o(a,"Edit")&&n.d(t,"Edit",(function(){return a.Edit})),n.o(a,"FA")&&n.d(t,"FA",(function(){return a.FA})),n.o(a,"Form")&&n.d(t,"Form",(function(){return a.Form})),n.o(a,"IconText")&&n.d(t,"IconText",(function(){return a.IconText})),n.o(a,"Image")&&n.d(t,"Image",(function(){return a.Image})),n.o(a,"LMR")&&n.d(t,"LMR",(function(){return a.LMR})),n.o(a,"List")&&n.d(t,"List",(function(){return a.List})),n.o(a,"Muted")&&n.d(t,"Muted",(function(){return a.Muted})),n.o(a,"PropGrid")&&n.d(t,"PropGrid",(function(){return a.PropGrid})),n.o(a,"QueryPager")&&n.d(t,"QueryPager",(function(){return a.QueryPager})),n.o(a,"SearchBox")&&n.d(t,"SearchBox",(function(){return a.SearchBox})),n.o(a,"UserView")&&n.d(t,"UserView",(function(){return a.UserView})),n.o(a,"VPage")&&n.d(t,"VPage",(function(){return a.VPage})),n.o(a,"View")&&n.d(t,"View",(function(){return a.View})),n.o(a,"emailRegex")&&n.d(t,"emailRegex",(function(){return a.emailRegex})),n.o(a,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return a.mobileRegex})),n.o(a,"resLang")&&n.d(t,"resLang",(function(){return a.resLang})),n.o(a,"resOptions")&&n.d(t,"resOptions",(function(){return a.resOptions})),n.o(a,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return a.setGlobalRes})),n.o(a,"setRes")&&n.d(t,"setRes",(function(){return a.setRes})),n.o(a,"start")&&n.d(t,"start",(function(){return a.start})),n.o(a,"t")&&n.d(t,"t",(function(){return a.t}));n(77);var i=n(78);n.o(i,"CAppBase")&&n.d(t,"CAppBase",(function(){return i.CAppBase})),n.o(i,"CBase")&&n.d(t,"CBase",(function(){return i.CBase})),n.o(i,"CStringEdit")&&n.d(t,"CStringEdit",(function(){return i.CStringEdit})),n.o(i,"CSub")&&n.d(t,"CSub",(function(){return i.CSub})),n.o(i,"Controller")&&n.d(t,"Controller",(function(){return i.Controller})),n.o(i,"DropdownActions")&&n.d(t,"DropdownActions",(function(){return i.DropdownActions})),n.o(i,"EasyTime")&&n.d(t,"EasyTime",(function(){return i.EasyTime})),n.o(i,"Edit")&&n.d(t,"Edit",(function(){return i.Edit})),n.o(i,"FA")&&n.d(t,"FA",(function(){return i.FA})),n.o(i,"Form")&&n.d(t,"Form",(function(){return i.Form})),n.o(i,"IconText")&&n.d(t,"IconText",(function(){return i.IconText})),n.o(i,"Image")&&n.d(t,"Image",(function(){return i.Image})),n.o(i,"LMR")&&n.d(t,"LMR",(function(){return i.LMR})),n.o(i,"List")&&n.d(t,"List",(function(){return i.List})),n.o(i,"Muted")&&n.d(t,"Muted",(function(){return i.Muted})),n.o(i,"PropGrid")&&n.d(t,"PropGrid",(function(){return i.PropGrid})),n.o(i,"QueryPager")&&n.d(t,"QueryPager",(function(){return i.QueryPager})),n.o(i,"SearchBox")&&n.d(t,"SearchBox",(function(){return i.SearchBox})),n.o(i,"UserView")&&n.d(t,"UserView",(function(){return i.UserView})),n.o(i,"VPage")&&n.d(t,"VPage",(function(){return i.VPage})),n.o(i,"View")&&n.d(t,"View",(function(){return i.View})),n.o(i,"emailRegex")&&n.d(t,"emailRegex",(function(){return i.emailRegex})),n.o(i,"mobileRegex")&&n.d(t,"mobileRegex",(function(){return i.mobileRegex})),n.o(i,"resLang")&&n.d(t,"resLang",(function(){return i.resLang})),n.o(i,"resOptions")&&n.d(t,"resOptions",(function(){return i.resOptions})),n.o(i,"setGlobalRes")&&n.d(t,"setGlobalRes",(function(){return i.setGlobalRes})),n.o(i,"setRes")&&n.d(t,"setRes",(function(){return i.setRes})),n.o(i,"start")&&n.d(t,"start",(function(){return i.start})),n.o(i,"t")&&n.d(t,"t",(function(){return i.t}))},function(e,t){},function(e,t){},function(e,t,n){"use strict";n(13)},function(e,t){},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=/^[0-9]*$/,a=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),a=n(3),i=n(5),c=n(6),o=n(0),u=n(14),s=n.n(u),l=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).menu=void 0,a.button=void 0,a.handleDocumentClick=function(e){!1!==a.state.dropdownOpen&&(a.button&&a.button.contains(e.target)||a.menu&&a.toggle())},a.toggle=function(){a.setState({dropdownOpen:!a.state.dropdownOpen})},a.state={dropdownOpen:!1},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocumentClick),document.addEventListener("touchstart",this.handleDocumentClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("touchstart",this.handleDocumentClick)}},{key:"render",value:function(){var e=this,t=this.props,n=t.icon,r=t.actions,a=t.isRight,i=t.className,c=t.itemIconClass,u=t.itemCaptionClass;void 0===a&&(a=!0);var l=r.some((function(e){return void 0!==e.icon})),h=this.state.dropdownOpen,d=i||"cursor-pointer dropdown-toggle btn btn-sm";return o.createElement("div",{className:"dropdown"},o.createElement("button",{ref:function(t){return e.button=t},className:d,"data-toggle":"dropdown","aria-expanded":h,onClick:this.toggle},o.createElement("i",{className:s()("fa fa-fw ","fa-"+(n||"ellipsis-v"))})),o.createElement("div",{ref:function(t){return e.menu=t},className:s()({"dropdown-menu":!0,"dropdown-menu-right":a,show:h})},r.map((function(e,t){if(!e)return o.createElement("div",{className:"dropdown-divider",key:t});var n,r=e.icon,a=e.caption,i=e.action,h=e.iconClass,d=e.captionClass;if(void 0===r&&void 0===a)return o.createElement("div",{className:"dropdown-divider"});if(!0===l&&(void 0!==r&&(r="fa-"+r),n=o.createElement("i",{className:s()("mr-2","fa",r,"fa-fw",h||c),"aria-hidden":!0})),void 0===i)return o.createElement("h6",{className:"dropdown-header"},n," ",a);return o.createElement("a",{className:"dropdown-item",key:t,href:"#/",onClick:function(e){e.preventDefault(),i()},onTouchStart:function(e){i()}},n," ",o.createElement("span",{className:d||u},a))}))))}}]),n}(o.Component)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),a=n(3),i=n(5),c=n(6),o=n(0),u=n(15),s={md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw",$zh:{md:function(e,t){return"".concat(e,"\u6708").concat(t,"\u65e5")},ymd:function(e,t,n){return"".concat(e,"\u5e74").concat(t,"\u6708").concat(n,"\u65e5")},yesterday:"\u6628\u5929",today:"\u4eca\u5929",tomorrow:"\u660e\u5929"},$en:{md:function(e,t){return"".concat(e,"-").concat(t)},ymd:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)},yesterday:"Yday",today:"Today",tomorrow:"Tmw"}};function l(e){return s[e]}function h(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;switch(typeof e){default:n=e;break;case"string":n=new Date(e);break;case"number":n=new Date(1e3*e)}var a,i,c,o,u,s,h=new Date,d=n;a=h.getTime()-d.getTime();var f=d.getHours(),p=d.getMinutes();i=h.getDate(),c=d.getDate(),o=d.getMonth()+1,u=d.getFullYear(),s=h.getFullYear();var v=!1,m=a<-864e5?u===s?(v=!0,l("md")(o,c)):(v=!0,l("ymd")(u,o,c)):a<864e5?c!==i?(v=!0,l(a<0?"tomorrow":"yesterday")):!0===t?(v=!0,""):l("today"):u===s?l("md")(o,c):l("ymd")(u,o,c),b=f+(p<10?":0":":")+p;return!0===v||!0===r?m+" "+b:m}Object(u.setRes)(s,s);o.Component;var d=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props;return h(e.date,!0,e.always)}}]),n}(o.Component)},function(e,t,n){"use strict";var r=n(2),a=n(3),i=n(5),c=n(6),o=n(0),u=n(14),s=n.n(u),l=n(15);o.Component},function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r,a,i=n(1),c=n.n(i),o=n(4),u=n(10),s=n(2),l=n(3),h=n(11),d=n(5),f=n(6),p=n(9),v=(n(18),n(0)),m=n(14),b=n.n(m),y=n(8),k=(r=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];return(e=t.call.apply(t,[this].concat(i))).input=void 0,e.key=null,Object(u.a)(e,"disabled",a,Object(h.a)(e)),e.onChange=function(t){e.key=t.target.value,void 0!==e.key&&(e.key=e.key.trim(),""===e.key&&(e.key=void 0)),!0!==e.props.allowEmptySearch&&(e.disabled=!e.key)},e.onSubmit=function(){var t=Object(o.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),null===e.key&&(e.key=e.props.initKey||""),!0===e.props.allowEmptySearch){t.next=6;break}if(e.key){t.next=5;break}return t.abrupt("return");case 5:e.input&&(e.input.disabled=!0);case 6:return t.next=8,e.props.onSearch(e.key);case 8:e.input&&(e.input.disabled=!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"clear",value:function(){this.input&&(this.input.value="")}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.className,a=n.inputClassName,i=n.onFocus,c=n.label,o=n.placeholder,u=n.buttonText,s=n.maxLength;switch(n.size){default:case"sm":e="input-group-sm";break;case"md":e="input-group-md";break;case"lg":e="input-group-lg"}return v.createElement("form",{className:r,onSubmit:this.onSubmit},v.createElement("div",{className:b()("input-group",e)},c&&v.createElement("div",{className:"input-group-addon align-self-center mr-2"},c),v.createElement("input",{ref:function(e){return t.input=e},onChange:this.onChange,type:"text",name:"key",onFocus:i,className:b()("form-control",a||"border-primary"),placeholder:o,defaultValue:this.props.initKey,maxLength:s}),v.createElement("div",{className:"input-group-append"},v.createElement("button",{className:"btn btn-primary",type:"submit",disabled:this.disabled},v.createElement("i",{className:"fa fa-search"}),v.createElement("i",{className:"fa"}),u))))}}]),n}(v.Component),a=Object(p.a)(r.prototype,"disabled",[y.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(2),a=n(3),i=n(0),c=n(14),o=n.n(c),u=n(21),s=n(12),l=n(8),h=n(20),d=n(16),f=n.n(d),p=new(function(){function e(t){Object(r.a)(this,e),this.loader=void 0,this.onLoaded=void 0,this.map=Object(l.m)(new Map),void 0===t&&(t=function(e){return h.p.user(e)}),this.loader=t}return Object(a.a)(e,[{key:"use",value:function(e,t){e&&("object"===typeof e&&(e=e.id),e&&(this.onLoaded=t,e=Number(e),void 0===this.map.get(e)&&this.map.set(e,e)))}},{key:"getValue",value:function(e){var t=this;if(e){switch(typeof e){case"object":if(!(e=e.id))return}var n=this.map.get(e);if(n)switch(typeof n){default:return n;case"number":return n<0||(this.map.set(e,-e),this.loader(e).then((function(n){n||(n=null),t.map.set(e,n),t.onLoaded&&t.onLoaded(n)})).catch((function(e){console.error(e)}))),e}}}}]),e}())(void 0),v=(Object(s.a)((function(e){var t=e.className,n=e.style,r=e.id,a=e.altImage,c=e.noneImage,s=p.getValue(r);switch(typeof s){case"undefined":case"number":return i.createElement("div",{className:o()(t,"image-none"),style:n},c||i.createElement("i",{className:"fa fa-file-o"}))}var l=s.icon;return l?(!0===f.a.startsWith(l,":")&&(l=u.b.resUrl+l.substr(1)),i.createElement("img",{src:l,className:t,alt:"img",style:n,onError:function(e){e.currentTarget.src=a||"https://tv.jkchemical.com/imgs/0001.png"}})):i.createElement("div",{className:o()(t,"image-none"),style:n},i.createElement("i",{className:"fa fa-file-o"}))})),Object(s.a)((function(e){var t=e.id,n=e.user,r=e.render,a=e.onLoaded;if(null===n)return i.createElement(i.Fragment,null,"null");switch(typeof n){case"undefined":n=p.getValue(t);break;case"object":var c=n.id;m(c,a),n=p.getValue(c);break;case"number":m(n,a),n=p.getValue(n);break;case"string":m(Number(n),a),n=p.getValue(Number(n));break;default:n=void 0}switch(typeof n){case"undefined":case"number":return i.createElement(i.Fragment,null,n)}return r(n)})));function m(e,t){e&&("object"===typeof e&&(e=e.id),p.use(e,t))}},function(e,t){},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1),a=n.n(r),i=n(13),c=n(4),o=n(2),u=n(3),s=n(23),l=function(){function e(t){var n=this;Object(o.a)(this,e),this.uq=void 0,this.modifyMax=void 0,this.cacheTimer=void 0,this.loadIds=function(){n.clearCacheTimer();var e=n.uq.tuids;for(var t in e){e[t].cacheIds()}},this.uq=t}return Object(u.a)(e,[{key:"cacheTuids",value:function(e){this.clearCacheTimer(),this.cacheTimer=s.c.setTimeout("TuidsCache.cacheTuids",this.loadIds,e)}},{key:"clearCacheTimer",value:function(){void 0!==this.cacheTimer&&(s.c.clearTimeout(this.cacheTimer),this.cacheTimer=void 0)}},{key:"pullModify",value:function(e){if(void 0!==e){var t=Math.floor(Date.now()/1e3);void 0===this.modifyMax&&(this.modifyMax=this.uq.localModifyMax.get(),void 0===this.modifyMax&&(this.modifyMax={max:e,seconds:t},this.uq.localModifyMax.set(this.modifyMax)));var n=this.modifyMax,r=n.max;if(!(t-n.seconds<3600)&&!(e<=r)){var a=[],i=this.uq.tuids;for(var c in i)a.push(c);0!==a.length&&(this.modifyMax.seconds=t,this.innerPullModify(a.join("\t")))}}}},{key:"innerPullModify",value:function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c,o,u,s,l,h,d,f,p,v,m,b,y,k,g,w,O,j;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.uq,r=n.uqApi,c=n.tuids,o=this.modifyMax.max,e.next=4,r.queueModify(o,30,t);case 4:u=e.sent,s={},l=0,h=Object(i.a)(u.queue),e.prev=8,h.s();case 10:if((d=h.n()).done){e.next=24;break}if(f=d.value,p=f.id,v=f.entity,m=f.key){e.next=15;break}return e.abrupt("continue",22);case 15:if(void 0!==(b=c[v])){e.next=18;break}return e.abrupt("continue",22);case 18:void 0===(y=s[v])&&(y=s[v]={tuid:b,ids:[]}),y.ids.push(m),p>l&&(l=p);case 22:e.next=10;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(8),h.e(e.t0);case 29:return e.prev=29,h.f(),e.finish(29);case 32:e.t1=a.a.keys(s);case 33:if((e.t2=e.t1()).done){e.next=40;break}return k=e.t2.value,g=s[k],w=g.tuid,O=g.ids,e.next=38,w.modifyIds(O);case 38:e.next=33;break;case 40:j=Math.floor(Date.now()/1e3),this.modifyMax={max:l,seconds:j},this.uq.localModifyMax.set(this.modifyMax);case 43:case"end":return e.stop()}}),e,this,[[8,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(1),a=n.n(r),i=n(22),c=n(13),o=n(4),u=n(2),s=n(3),l=n(23),h=n(20),d=n(60),f=n(15),p=function(){function e(t,n){Object(u.a)(this,e),this.collection=void 0,this.tvs=void 0,this.name=void 0,this.appOwner=void 0,this.appName=void 0,this.localMap=void 0,this.localData=void 0,this.id=void 0,this.tvs=n||{},this.buildTVs(),this.collection={};var r=t.split("/");if(2!==r.length)throw new Error("tonvaApp name must be / separated, owner/app");this.appOwner=r[0],this.appName=r[1],this.localMap=l.c.localDb.map(t),this.localData=this.localMap.child("uqData")}return Object(s.a)(e,null,[{key:"load",value:function(){var t=Object(o.a)(a.a.mark((function t(n,r,o){var u,s,l,d,f,p,v,m,b,y,k;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=e.value=new e(n,o),s=u.appOwner,l=u.appName,d=u.localData,(f=d.get())&&f.version===r){t.next=14;break}return t.next=7,Object(h.i)(s,l);case 7:if((f=t.sent).id){t.next=10;break}return t.abrupt("return",["".concat(s,"/").concat(l,"\u4e0d\u5b58\u5728\u3002\u8bf7\u4ed4\u7ec6\u68c0\u67e5app\u5168\u540d\u3002")]);case 10:f.version=r,d.set(f),p=Object(c.a)(f.uqs);try{for(p.s();!(v=p.n()).done;)v.value.newVersion=!0}catch(a){p.e(a)}finally{p.f()}case 14:return b=(m=f).id,y=m.uqs,u.id=b,t.next=18,u.init(y);case 18:return t.next=20,u.load();case 20:if(0!==(k=t.sent).length){t.next=26;break}if(k.push.apply(k,Object(i.a)(u.setTuidImportsLocal())),0!==k.length){t.next=26;break}return e._uqs=u.buildUQs(),t.abrupt("return");case 26:e.errors=k;case 27:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),Object(s.a)(e,[{key:"addUq",value:function(e){this.collection[e.name]=e}},{key:"buildTVs",value:function(){for(var e in this.tvs){var t=this.tvs[e];if(void 0!==t){var n=e.toLowerCase();if(n!==e)for(var r in this.tvs[n]=t,t){var a=t[r];if(void 0!==a){var i=r.toLowerCase();i!==r&&(t[i]=a)}}}}}},{key:"init",value:function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i,o,u,s,l,h,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=Object(c.a)(t);try{for(r.s();!(i=r.n()).done;)o=i.value,u=o.uqOwner,s=o.uqName,l=u+"/"+s,h=new d.a(this,o,void 0,this.tvs[l]||this.tvs[s]),this.collection[l]=h,(f=l.toLowerCase())!==l&&(this.collection[f]=h),n.push(h.init())}catch(a){r.e(a)}finally{r.f()}return e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r,i,o,u,s,l,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t=[],n=[],this.collection)i=this.collection[r],n.push(i.loadEntities());return e.next=5,Promise.all(n);case 5:o=e.sent,u=Object(c.a)(o),e.prev=7,u.s();case 9:if((s=u.n()).done){e.next=17;break}if(l=s.value,void 0===(h=l)){e.next=15;break}return t.push(h),e.abrupt("continue",15);case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),u.e(e.t0);case 22:return e.prev=22,u.f(),e.finish(22);case 25:return e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[7,19,22,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"buildUQs",value:function(){var e=this,t=this,n={},r=function(r){for(var a=e.collection[r],i=a.uqName,c=i.toLowerCase(),o=a.entities,u=0,s=Object.keys(o);u<s.length;u++){var l=o[s[u]];o[l.name.toLowerCase()]=l}n[c]=new Proxy(o,{get:function(e,n,r){var a=e[n.toLowerCase()];if(void 0!==a)return a;var c="entity ".concat(i,".").concat(String(n)," not defined");console.error(c),t.showReload("UQ\u9519\u8bef\uff1a"+c)}})};for(var a in this.collection)r(a);return new Proxy(n,{get:function(e,n,r){var a=e[n.toLowerCase()];if(void 0!==a)return a;console.error("error in uqs"),t.showReload("\u4ee3\u7801\u9519\u8bef\uff1a\u65b0\u589e uq ".concat(String(n)))}})}},{key:"showReload",value:function(e){this.localMap.removeAll(),f.nav.showReloadPage(e)}},{key:"setTuidImportsLocal",value:function(){var e=[];for(var t in this.collection){var n,r=this.collection[t],a=Object(c.a)(r.tuidArr);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(!0===i.isImport){var o=this.setInner(i);o&&e.push(o)}}}catch(u){a.e(u)}finally{a.f()}}return e}},{key:"setInner",value:function(e){var t=e.from,n=t.owner+"/"+t.uq,r=this.collection[n];if(void 0===r)return"setInner(tuidImport: TuidImport): uq ".concat(n," is not loaded");var a=e.name,i=r.tuid(a);return void 0===i?"setInner(tuidImport: TuidImport): uq ".concat(n," has no Tuid ").concat(a):!0===i.isImport?"setInner(tuidImport: TuidImport): uq ".concat(n," Tuid ").concat(a," is import"):void e.setFrom(i)}}]),e}();p._uqs=void 0,p.value=void 0,p.errors=void 0},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ce}));var r,a,i,c,o,u,s,l,h,d,f,p,v,m,b,y=n(1),k=n.n(y),g=n(4),w=n(13),O=n(2),j=n(3),x=n(5),E=n(6),C=n(0),N=n(8),I=n(14),S=n.n(I),A=n(10),P=n(11),T=n(9),F=(n(18),n(22)),V=n(19),R=n(17),_=n(16),D=n.n(_),B=function e(){Object(O.a)(this,e)},U=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this)).func=void 0,r.func=e,r}return Object(j.a)(n,[{key:"check",value:function(e,t){var n=this.func(t);if(void 0!==n)switch(typeof n){case"undefined":return;case"string":return void e.push(n);default:return void e.push.apply(e,Object(F.a)(n))}}}]),n}(B),L=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this)).res=void 0,r.res=e,r}return n}(B),q=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"check",value:function(e,t){switch(typeof t){default:case"boolean":return;case"object":if(null!==t)return;break;case"string":if(t.trim().length>0)return;break;case"number":if(!1===isNaN(t))return;break;case"undefined":}e.push(this.res.required)}}]),n}(L),M=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r,a){var i;return Object(O.a)(this,n),(i=t.call(this,e)).minMsg=void 0,i.maxMsg=void 0,i.min=void 0,i.max=void 0,i.minMsg=D.a.template(e.min),i.maxMsg=D.a.template(e.max),i.min=r,i.max=a,i}return Object(j.a)(n,[{key:"check",value:function(e,t){if(void 0!==t&&null!==t){var n=Number(t);!0===isNaN(n)?e.push(this.res.number):this.checkMore(e,n)}}},{key:"checkMore",value:function(e,t){void 0!==this.min&&Number(t)<this.min&&e.push(this.minMsg({min:this.min})),void 0!==this.max&&Number(t)>this.max&&e.push(this.maxMsg({max:this.max}))}}]),n}(L),z=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"checkMore",value:function(e,t){Object(V.a)(Object(R.a)(n.prototype),"checkMore",this).call(this,e,t),!1===Number.isInteger(t)&&e.push(this.res.integer)}}]),n}(M),H=n(12),W=(r=function(){function e(t,n,r,o){var u=this;Object(O.a)(this,e),this.name=void 0,this.context=void 0,this.fieldProps=void 0,this.children=void 0,this._itemSchema=void 0,this._ui=void 0,this.defaultValue=void 0,this.value=void 0,this.rules=void 0,Object(A.a)(this,"errors",a,this),Object(A.a)(this,"contextErrors",i,this),this.readOnly=void 0,this.disabled=void 0,Object(A.a)(this,"visible",c,this),this.isChanging=void 0,this.onInputChange=function(e){u.changeValue(e.target.value,!0)},this.container=Object(H.a)((function(){if(!1===u.visible)return null;var e=u.context,t=e.form;if(!0===e.inNode)return u.render();var n=u.label;return!0===u.itemSchema.required&&!1!==t.props.requiredFlag&&null!==n&&(n=C.createElement(C.Fragment,null,n,"\xa0",C.createElement("span",{className:"text-danger"},"*"))),t.FieldContainer(n,u.renderBody())})),this.context=t;var s=n.name;if(this.name=s,this._itemSchema=n,this.fieldProps=r,this.children=o,this._ui=t.getUiItem(s),void 0===this.ui)this.readOnly=!1,this.disabled=!1,this.visible=!0;else{var l=this.ui,h=l.readOnly,d=l.disabled,f=l.visible;this.readOnly=!0===h,this.disabled=!0===d,this.visible=!(!1===f)}this.value=this.defaultValue=t.getValue(s)}return Object(j.a)(e,[{key:"hasError",get:function(){return this.errors.length+this.contextErrors.length>0}}]),Object(j.a)(e,[{key:"init",value:function(){if(this.rules=[],!0===this.itemSchema.required&&this.rules.push(new q(this.context.form.res)),this.buildRules(),void 0!==this.ui){var e=this.ui.rules;if(void 0!==e)if(!1!==Array.isArray(e)){var t,n=Object(w.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.rules.push(new U(r))}}catch(a){n.e(a)}finally{n.f()}}else this.rules.push(new U(e))}}},{key:"buildRules",value:function(){}},{key:"checkRules",value:function(){var e,t,n=[],r=Object(w.a)(this.rules);try{for(r.s();!(e=r.n()).done;){e.value.check(n,this.value)}}catch(a){r.e(a)}finally{r.f()}0===n.length?this.context.removeErrorWidget(this):(this.context.addErrorWidget(this),(t=this.errors).push.apply(t,n))}},{key:"setError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.errors.push(e):(t=this.errors).push.apply(t,Object(F.a)(e)))}},{key:"setContextError",value:function(e){var t;void 0!==e&&("string"===typeof e?this.contextErrors.push(e):(t=this.contextErrors).push.apply(t,Object(F.a)(e)))}},{key:"clearError",value:function(){this.errors.splice(0)}},{key:"clearContextError",value:function(){this.contextErrors.splice(0)}},{key:"parse",value:function(e){return e}},{key:"setElementValue",value:function(e){}},{key:"setDataValue",value:function(e){!0!==this.isChanging&&(this.context.initData[this.name]=this.value=this.parse(e))}},{key:"setValue",value:function(e){!0!==this.isChanging&&this.changeValue(e,!1)}},{key:"getValue",value:function(){return this.context.getValue(this.name)}},{key:"getReadOnly",value:function(){return this.readOnly}},{key:"getDisabled",value:function(){return this.disabled}},{key:"getVisible",value:function(){return this.visible}},{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"setVisible",value:function(e){this.visible=e}},{key:"changeValue",value:function(e,t){var n,r,a=this.value;void 0!==this.ui&&(n=this.ui.onChanging,r=this.ui.onChanged);var i=!0;void 0!==n&&(this.isChanging=!0,i=n(this.context,this.value,a),this.isChanging=!1),!0===i&&(this.setDataValue(e),!0!==t&&this.setElementValue(e),void 0!==r&&(this.isChanging=!0,r(this.context,this.value,a),this.isChanging=!1))}},{key:"renderBody",value:function(){var e;if(!1===this.hasError&&this.ui){var t=this.ui,n=t.discription,r=t.discriptionClassName;void 0===r&&(r="small text-muted"),e=C.createElement("span",{className:r},n)}return C.createElement(C.Fragment,null,this.render(),e)}},{key:"renderTemplet",value:function(){if(void 0!==this.children)return C.createElement(C.Fragment,null,this.children);if(void 0!==this.ui){var e=this.ui.Templet;return"function"===typeof e?e(this.value):e}}},{key:"renderErrors",value:function(){var e=[].concat(Object(F.a)(this.errors),Object(F.a)(this.contextErrors));if(0===e.length)return null;var t=!0===this.context.inNode?"span":"div";return e.map((function(e){return C.createElement(t,{key:e,className:"text-danger d-inline-block my-2 ml-3"},C.createElement(C.Fragment,null,C.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e))}))}},{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}},{key:"isOk",get:function(){return 0===this.errors.length}},{key:"className",get:function(){var e;return!1===this.context.inNode&&(e="form-control"),S()(e,this.context.form.FieldClass,this.ui&&this.ui.className)}},{key:"label",get:function(){var e;if(void 0===this.ui)e=this.name;else{var t=this.ui.label;e=null===t?null:t||this.name}return e}}]),e}(),a=Object(T.a)(r.prototype,"errors",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),i=Object(T.a)(r.prototype,"contextErrors",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(T.a)(r.prototype,"hasError",[N.g],Object.getOwnPropertyDescriptor(r.prototype,"hasError"),r.prototype),c=Object(T.a)(r.prototype,"visible",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(T.a)(r.prototype,"isOk",[N.g],Object.getOwnPropertyDescriptor(r.prototype,"isOk"),r.prototype),r),G=(o=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="text",e.input=void 0,Object(A.a)(e,"hasFocus",u,Object(P.a)(e)),e.onKeyDown=function(){var t=Object(g.a)(k.a.mark((function t(n){var r,a;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.internalOnKeyDown(n),13===n.keyCode){t.next=3;break}return t.abrupt("return");case 3:if(void 0!==(r=e.context.form.props.onEnter)){t.next=6;break}return t.abrupt("return");case 6:return e.changeValue(n.currentTarget.value,!0),e.input.blur(),t.next=10,r(e.name,e.context);case 10:void 0!==(a=t.sent)&&e.context.setError(e.name,a);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onBlur=function(t){e.onInputChange(t),e.checkRules(),e.context.checkContextRules(),e.hasFocus=!1},e.onFocus=function(t){e.clearError(),e.context.removeErrorWidget(Object(P.a)(e)),e.context.clearErrors(),e.hasFocus=!0},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){null!==this.input&&(this.input.value=e)}},{key:"internalOnKeyDown",value:function(e){}},{key:"onChange",value:function(e){}},{key:"setReadOnly",value:function(e){null!==this.input&&(this.input.readOnly=this.readOnly=e)}},{key:"setDisabled",value:function(e){null!==this.input&&(this.input.disabled=this.disabled=e)}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,C.createElement(C.Fragment,null,C.createElement("input",{ref:function(t){return e.input=t},className:S()(this.className,n),type:this.inputType,defaultValue:this.value,onChange:function(t){return e.onChange(t)},placeholder:this.placeholder,readOnly:this.readOnly,disabled:this.disabled,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,maxLength:this.itemSchema.maxLength}),this.renderErrors())}},{key:"ui",get:function(){return this._ui}},{key:"placeholder",get:function(){return this.ui&&this.ui.placeholder||this.name}}]),n}(W),u=Object(T.a)(o.prototype,"hasFocus",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),$=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.onInputChange=function(t){e.setValue(t.currentTarget.value)},e.onBlur=function(t){e.onInputChange(t),e.checkRules(),e.context.checkContextRules()},e.onFocus=function(t){e.clearError(),e.context.removeErrorWidget(Object(P.a)(e)),e.context.clearErrors()},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){this.input.value=e}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.renderTemplet();if(void 0!==t)return t;var n={};return!0===this.hasError?n["is-invalid"]=!0:n["required-item"]=!0===this.itemSchema.required,C.createElement(C.Fragment,null,C.createElement("textarea",{ref:function(t){return e.input=t},onBlur:this.onBlur,onFocus:this.onFocus,className:S()(this.className,n),rows:this.ui&&this.ui.rows,maxLength:this.itemSchema.maxLength,defaultValue:this.defaultValue,onChange:this.onInputChange}),this.renderErrors())}},{key:"itemSchema",get:function(){return this._itemSchema}},{key:"ui",get:function(){return this._ui}}]),n}(W),K=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="password",e}return n}(G),Q=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="url",e}return n}(G),J=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="email",e}return n}(G),X=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(j.a)(n,[{key:"buildRules",value:function(){Object(V.a)(Object(R.a)(n.prototype),"buildRules",this).call(this);var e=this.context.form.res,t=this.itemSchema,r=t.min,a=t.max;this.rules.push("integer"===this.itemSchema.type?new M(e,r,a):new z(e,r,a))}},{key:"parse",value:function(e){if(void 0!==e&&null!==e)return Number(e)}},{key:"itemSchema",get:function(){return this._itemSchema}}]),n}(G),Y=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="number",e}return Object(j.a)(n,[{key:"isValidKey",value:function(e){return 46===e||8===e||37===e||39===e||e>=48&&e<=57||e>=96&&e<=105||109===e||189===e}},{key:"internalOnKeyDown",value:function(e){var t=e.keyCode;window.event.returnValue=this.isValidKey(t)}}]),n}(X),Z=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="date",e}return n}(G),ee=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="datetime",e}return n}(G),te=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="time",e}return n}(G),ne=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="month",e}return n}(G),re=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.trueValue=void 0,e.falseValue=void 0,e.onInputChange=function(t){var n=!0===t.target.checked?e.trueValue:e.falseValue;e.setDataValue(n)},e.onClick=function(){e.context.clearErrors()},e}return Object(j.a)(n,[{key:"init",value:function(){if(Object(V.a)(Object(R.a)(n.prototype),"init",this).call(this),void 0!==this.ui){var e=this.ui,t=e.trueValue,r=e.falseValue;this.trueValue=void 0===t||t,this.falseValue=void 0!==r&&r}else this.trueValue=!0,this.falseValue=!1}},{key:"setElementValue",value:function(e){this.input.checked=e===this.trueValue}},{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=S()(this.className,"form-check-inline p-0"),n=C.createElement("input",{ref:function(t){return e.input=t},className:"align-self-center",type:"checkbox",defaultChecked:this.defaultValue,onChange:this.onInputChange,onClick:this.onClick});return!0===this.context.inNode?C.createElement("label",{className:t},n," ",this.ui&&this.ui.label||this.name):C.createElement("div",{className:t},C.createElement("label",{className:"w-100 h-100 mb-0 d-flex justify-content-center"},n))}},{key:"ui",get:function(){return this._ui}}]),n}(W),ae=(s=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).select=void 0,Object(A.a)(e,"readOnly",l,Object(P.a)(e)),e.onInputChange=function(t){e.setDataValue(t.target.value)},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){this.select.value=e}},{key:"setReadOnly",value:function(e){this.select.disabled=this.readOnly=!e}},{key:"setDisabled",value:function(e){this.select.disabled=this.disabled=e}},{key:"render",value:function(){var e=this;if(!0===this.readOnly){var t=this.ui.list.find((function(t){return t.value===e.value})),n=void 0===t?"(???)":t.title;return C.createElement("span",{className:"form-control w-min-6c"},n)}return C.createElement("select",{ref:function(t){return e.select=t},className:S()(this.className,"form-control"),defaultValue:this.defaultValue,onChange:this.onInputChange},this.ui.list.map((function(e,t){var n=e.title,r=e.value;return C.createElement("option",{className:undefined,key:t,value:r},n||r)})))}},{key:"ui",get:function(){return this._ui}}]),n}(W),l=Object(T.a)(s.prototype,"readOnly",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s),ie={height:"auto"},ce=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"render",value:function(){var e,t=this,n=this.ui,r=n.defaultValue,a=n.list;!0===this.context.isRow&&(e=this.context.rowKey);var i=S()(this.className,"py-0");return C.createElement("span",{className:i,style:ie},a.map((function(n,a){var i=n.value,c=n.title,o=t.name;return void 0!==e&&(o+="-"+e),C.createElement("label",{key:a,className:"form-radio-inline"},C.createElement("input",{ref:function(e){return t.inputs[a]=e},type:"radio",name:o,value:i,defaultChecked:(t.defaultValue||r)===i,onChange:t.onInputChange}),c||i)})))}},{key:"ui",get:function(){return this._ui}}]),n}(W),oe=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="range",e.input=void 0,e}return Object(j.a)(n,[{key:"setReadOnly",value:function(e){this.input.readOnly=this.readOnly=e}},{key:"setDisabled",value:function(e){this.input.disabled=this.disabled=e}},{key:"render",value:function(){var e=this,t=this.ui,n=t.min,r=t.max,a=t.step;return C.createElement(C.Fragment,null,C.createElement("input",{ref:function(t){return e.input=t},className:S()(this.className,"form-control","w-min-6c"),type:this.inputType,defaultValue:this.defaultValue,onChange:this.onInputChange,max:r,min:n,step:a}))}},{key:"ui",get:function(){return this._ui}}]),n}(W),ue=C.createElement("small",{className:"text-muted"},"[\u65e0]"),se=(h=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(A.a)(e,"value",d,Object(P.a)(e)),e.onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=e.ui&&e.ui.pickId)){t.next=4;break}return alert("no pickId defined!"),t.abrupt("return");case 4:return t.next=6,n(e.context,e.name,e.value);case 6:r=t.sent,e.setDataValue(r),e.clearError(),e.clearContextError(),e.checkRules();case 11:case"end":return t.stop()}}),t)}))),e}return Object(j.a)(n,[{key:"setReadOnly",value:function(e){this.readOnly=e}},{key:"setDisabled",value:function(e){this.disabled=e}},{key:"render",value:function(){var e,t;void 0!==this.ui&&(e=this.ui.placeholder,t=this.ui.Templet);var n,r={"form-control":!0,"required-item":!0===this.itemSchema.required,"cursor-pointer":!0,"is-invalid":this.hasError};if(void 0===this.value||null===this.value)n=e||ue,r["text-muted"]=!0;else if(void 0===t){var a;if(null===this.value)a="null";else switch(typeof this.value){case"undefined":a=ue;break;case"object":a=this.value.id;break;default:a=this.value}n=C.createElement(C.Fragment,null,a)}else n="function"===typeof t?t(this.value):t;return C.createElement(C.Fragment,null,C.createElement("div",{className:S()(r),onClick:this.onClick},n),this.renderErrors())}},{key:"ui",get:function(){return this._ui}}]),n}(W),d=Object(T.a)(h.prototype,"value",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h),le=function(e,t,n){return C.createElement("span",{className:"text-danger"},"!!data type ",e," only support ",(n||[]).join(", "),", can't use ui ",t,"!!")},he=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.clearError(),e.clearContextError(),n=e.itemSchema,r=n.name,"submit"!==n.type){t.next=6;break}return t.next=6,e.context.submit(r);case 6:case"end":return t.stop()}}),t)}))),e.observerRender=Object(H.a)((function(){var t,n,r,a=e.itemSchema,i=a.name,c=a.type;if(void 0!==e.ui){var o=e.ui.widget;if("button"!==o)return le(c,o,["button"]);t=e.ui.Templet,n=e.ui.className,r=e.ui.label}var u,s=e.context,l=s.form,h=s.hasError,d=e.context,f="submit"===c&&h;u=void 0!==e.children?e.children:"function"===typeof t?t():void 0!==t?t:r;var p=C.createElement("button",{className:n,type:"button",disabled:f,onClick:e.onClick},u||i);return!0===d.inNode?C.createElement(C.Fragment,null,p,e.renderErrors()):C.createElement("div",{className:l.ButtonClass},C.createElement("div",null,e.renderErrors()),p)})),e}return Object(j.a)(n,[{key:"render",value:function(){return C.createElement(this.observerRender)}},{key:"ui",get:function(){return this._ui}},{key:"label",get:function(){return null}}]),n}(W),de=(f=function(){function e(t,n,r,a,i){var c=this;if(Object(O.a)(this,e),this.subContexts=void 0,this.form=void 0,this.uiSchema=void 0,this.initData=void 0,this.inNode=void 0,this.widgets={},this.rules=void 0,this.isRow=void 0,Object(A.a)(this,"errors",p,this),Object(A.a)(this,"errorWidgets",v,this),this.renderErrors=Object(H.a)((function(){var e=c.errors;return 0===e.length?null:C.createElement(C.Fragment,null,e.map((function(e){return C.createElement("span",{key:e,className:"text-danger inline-block my-1 ml-3"},C.createElement("i",{className:"fa fa-exclamation-circle"})," \xa0",e)})))})),this.form=t,this.uiSchema=n,this.initData=r,this.inNode=a,this.isRow=i,void 0!==n){var o,u=n.rules;if(void 0!==u)this.rules=[],!1===Array.isArray(u)?this.rules.push(u):(o=this.rules).push.apply(o,Object(F.a)(u))}}return Object(j.a)(e,[{key:"getArrRowContexts",value:function(e){void 0===this.subContexts&&(this.subContexts={});var t=this.subContexts[e];return void 0===t&&(this.subContexts[e]=t={}),t}},{key:"getValue",value:function(e){return this.initData[e]}},{key:"setValue",value:function(e,t){this.initData[e]=t;var n=this.widgets[e];void 0!==n&&n.setValue(t)}},{key:"getDisabled",value:function(e){var t=this.widgets[e];if(void 0!==t)return t.getDisabled()}},{key:"setDisabled",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setDisabled(t)}},{key:"getReadOnly",value:function(e){var t=this.widgets[e];void 0!==t&&t.getReadOnly()}},{key:"setReadOnly",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setReadOnly(t)}},{key:"getVisible",value:function(e){var t=this.widgets[e];void 0!==t&&t.getVisible()}},{key:"setVisible",value:function(e,t){var n=this.widgets[e];void 0!==n&&n.setVisible(t)}},{key:"submit",value:function(){var e=Object(g.a)(k.a.mark((function e(t){var n,r,a,i,c,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkRules(),!0!==this.hasError){e.next=7;break}n="",r=Object(w.a)(this.errorWidgets);try{for(r.s();!(a=r.n()).done;)i=a.value,n+=i.name+":\n"+i.errors.join("\n")}catch(n){r.e(n)}finally{r.f()}return console.error(n),e.abrupt("return");case 7:if(void 0!==(c=this.form.props.onButtonClick)){e.next=11;break}return alert("button ".concat(t," clicked. you should define form onButtonClick")),e.abrupt("return");case 11:return e.next=13,c(t,this);case 13:if(void 0!==(o=e.sent)){e.next=16;break}return e.abrupt("return");case 16:this.setError(t,o);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkFieldRules",value:function(){for(var e in this.widgets)this.widgets[e].checkRules();if(void 0!==this.subContexts)for(var t in this.subContexts){var n=this.subContexts[t];for(var r in n)n[r].checkFieldRules()}}},{key:"checkContextRules",value:function(){if(this.clearErrors(),void 0!==this.rules){var e,t=Object(w.a)(this.rules);try{for(t.s();!(e=t.n()).done;){var n,r=(0,e.value)(this);if(void 0!==r)if(!0===Array.isArray(r))(n=this.errors).push.apply(n,Object(F.a)(r));else if("string"===typeof r)this.errors.push(r);else for(var a in r)this.setError(a,r[a])}}catch(s){t.e(s)}finally{t.f()}if(void 0!==this.subContexts)for(var i in this.subContexts){var c=this.subContexts[i];for(var o in c){var u=c[o];u.clearErrors(),u.checkContextRules()}}}}},{key:"setError",value:function(e,t){var n=this.widgets[e];void 0!==n&&(n.setContextError(t),this.addErrorWidget(n))}},{key:"clearContextErrors",value:function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearContextError()}}},{key:"clearWidgetsErrors",value:function(){for(var e in this.widgets){var t=this.widgets[e];void 0!==t&&t.clearError()}}},{key:"checkRules",value:function(){this.clearErrors(),this.clearWidgetsErrors(),this.checkFieldRules(),!0!==this.hasError&&this.checkContextRules()}},{key:"addErrorWidget",value:function(e){this.errorWidgets.findIndex((function(t){return t===e}))<0&&this.errorWidgets.push(e)}},{key:"removeErrorWidget",value:function(e){var t=this.errorWidgets.findIndex((function(t){return t===e}));t>=0&&this.errorWidgets.splice(t,1)}},{key:"checkHasError",value:function(){if(!0===this.errorWidgets.length+this.errors.length>0)return!0;if(void 0===this.subContexts)return!1;for(var e in this.subContexts){var t=this.subContexts[e];for(var n in t)if(!0===t[n].hasError)return!0}return!1}},{key:"clearErrors",value:function(){this.errors.splice(0),this.errorWidgets.splice(0),this.clearContextErrors()}},{key:"arrName",get:function(){}},{key:"hasError",get:function(){return this.checkHasError()}}]),e}(),p=Object(T.a)(f.prototype,"errors",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=Object(T.a)(f.prototype,"errorWidgets",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(T.a)(f.prototype,"hasError",[N.g],Object.getOwnPropertyDescriptor(f.prototype,"hasError"),f.prototype),f),fe=1,pe=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r,a,i){var c,o;Object(O.a)(this,n);var u=e.uiSchema;if(void 0!==u){var s=u.items;void 0!==s&&(o=s[r.name])}return(c=t.call(this,e.form,o,a,i,!0)).parentContext=void 0,c.arrSchema=void 0,c.rowKey=void 0,c.data=void 0,c.parentContext=e,c.arrSchema=r,c.rowKey=fe++,c.data=a,c}return Object(j.a)(n,[{key:"getItemSchema",value:function(e){return this.arrSchema.itemSchemas[e]}},{key:"getUiItem",value:function(e){if(void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)return t[e]}}},{key:"clearErrors",value:function(){Object(V.a)(Object(R.a)(n.prototype),"clearErrors",this).call(this),this.parentContext.clearErrors()}},{key:"arrName",get:function(){return this.arrSchema.name}},{key:"parentData",get:function(){return this.parentContext.data}}]),n}(de),ve=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e,r){return Object(O.a)(this,n),t.call(this,e,e.uiSchema,e.data,r,!1)}return Object(j.a)(n,[{key:"getItemSchema",value:function(e){return this.form.itemSchemas[e]}},{key:"getUiItem",value:function(e){var t=this.form.uiSchema;if(void 0!==t){var n=t.items;if(void 0!==n)return n[e]}}},{key:"data",get:function(){return this.form.data}}]),n}(de),me=C.createContext({}),be=Object(H.a)((function(e){var t,n,r,a,i=e.parentContext,c=e.arrSchema,o=e.children,u=c.name,s=c.arr,l=i.initData[u],h=i.form,d=i.getArrRowContexts(u),f=i.getUiItem(u),p=u,v=h.ArrContainer,m=h.RowContainer,b=h.RowSeperator,y=h.uiSchema;if(void 0!==y){var k=y.selectable,g=y.deletable,w=y.restorable;!0!==n&&(n=k),!0!==r&&(r=g),!0!==a&&(a=w)}if(void 0!==f){var O=f.widget,j=f.label,x=f.selectable,E=f.deletable,N=f.restorable,I=f.ArrContainer,A=f.RowContainer,P=f.RowSeperator;if(void 0!==x&&(n=x),void 0!==E&&(r=E),void 0!==N&&(a=N),void 0!==I&&(v=I),void 0!==A&&(m=A),void 0!==P&&(b=P),t=f.Templet,"arr"!==O)return le(c.type,O,["arr"]);p=j||p}var T=!0;return v(p,C.createElement(C.Fragment,null,l.map((function(e,u){var h,f,p=void 0;if(!1===T?p=b:T=!1,void 0!==o)h=new pe(i,c,e,!0),f=C.createElement(C.Fragment,null,o);else{var v=typeof t;"function"===v?(h=new pe(i,c,e,!0),f=C.createElement(Object(H.a)(t),e)):"object"===v?(h=new pe(i,c,e,!0),f=t):(h=new pe(i,c,e,!1),f=C.createElement(C.Fragment,null,s.map((function(e,t){return C.createElement(C.Fragment,{key:e.name},je(h,e,void 0))}))))}var y,k,g=h.rowKey;if(d[g]=h,!0===n){y=C.createElement("div",{className:"form-row-checkbox"},C.createElement("input",{type:"checkbox",onClick:function(t){var n=t.target.checked;e.$isSelected=n;var r=e.$source;void 0!==r&&(r.$isSelected=n),h.clearErrors()},defaultChecked:e.$isSelected}))}var w=!(void 0===e.$isDeleted||!1===e.$isDeleted);if(!0===r){var O=w?"fa-undo":"fa-trash";k=C.createElement("div",{className:"form-row-edit text-info",onClick:function(){if(!0===a){e.$isDeleted=!w;var t=e.$source;void 0!==t&&(t.$isDeleted=!w)}else{var n=l.indexOf(e);n>=0&&l.splice(n,1)}h.clearErrors()}},C.createElement("i",{className:S()("fa",O,"fa-fw")}))}var j=!0===n||!0===r?function(t){return C.createElement("fieldset",{disabled:w},C.createElement("div",{className:S()("d-flex",{deleted:w,"row-selected":e.$isSelected})},y,C.createElement("div",{className:!0===n&&!0===r?"form-row-content":"form-row-content-1"},t),k))}:function(e){return e};return C.createElement(me.Provider,{key:g,value:h},p,m(j(C.createElement(C.Fragment,null,C.createElement(h.renderErrors,null),f))))}))))})),ye=n(37),ke=n(51),ge=(m=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,Object(A.a)(e,"imageSrc",b,Object(P.a)(e)),e.onClick=Object(g.a)(k.a.mark((function t(){var n,r;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new ke.a(void 0,e.itemSchema,e.ui,e.ui.label,e.value),t.next=3,n.start();case 3:return null!==(r=t.sent)&&(e.setValue(r),e.imageSrc=r),t.next=7,n.end();case 7:case"end":return t.stop()}}),t)}))),e.observerRender=Object(H.a)((function(){var t,n=["bg-white p-1 d-flex justify-content-center"];return e.readOnly||e.disabled||(n.push("cursor-pointer"),t=e.onClick),C.createElement("div",{className:S()(n),onClick:t},C.createElement(ye.a,{src:e.imageSrc,className:"w-4c h-4c"}))})),e}return Object(j.a)(n,[{key:"init",value:function(){Object(V.a)(Object(R.a)(n.prototype),"init",this).call(this),this.imageSrc=this.value}},{key:"render",value:function(){return C.createElement(this.observerRender)}},{key:"ui",get:function(){return this._ui}}]),n}(W),b=Object(T.a)(m.prototype,"imageSrc",[N.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m),we=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e}return Object(j.a)(n,[{key:"setElementValue",value:function(e){for(var t in this.inputs){var n=this.inputs[t];n.checked=e===n.value}}},{key:"setReadOnly",value:function(e){for(var t in this.readOnly=e,this.inputs)this.inputs[t].readOnly=e}},{key:"setDisabled",value:function(e){for(var t in this.disabled=e,this.inputs)this.inputs[t].disabled=e}},{key:"ui",get:function(){return this._ui}}]),n}(W),Oe={id:{dataTypes:["id"],widget:se},text:{dataTypes:["integer","number","string"],widget:G},textarea:{dataTypes:["string"],widget:$},password:{dataTypes:["string"],widget:K},date:{dataTypes:["date"],widget:Z},datetime:{dataTypes:["date"],widget:ee},time:{dataTypes:["date"],widget:te},month:{dataTypes:["date"],widget:ne},select:{dataTypes:["integer","number","string","date","boolean"],widget:ae},url:{dataTypes:["string"],widget:Q},email:{dataTypes:["string"],widget:J},number:{dataTypes:["integer","number"],widget:X},updown:{dataTypes:["integer","number"],widget:Y},color:{},checkbox:{dataTypes:["boolean","integer","number"],widget:re},image:{dataTypes:["string"],widget:ge},checkboxes:{},radio:{dataTypes:["integer","number","string","date","boolean"],widget:ce},tagSingle:{dataTypes:["integer"],widget:function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){var e,t=this.ui,n=t.valuesView,r=t.wrapClassName;if(void 0===n)return C.createElement(C.Fragment,null,"valuesView must be defined");!0===this.context.isRow&&(e=this.context.rowKey);var a=S()(this.className,"py-0"),i=this.name;void 0!==e&&(i+="-"+e);var c={className:a,inputName:i,wrapClassName:r,onInputChange:this.onInputChange};return n.renderRadios(this.defaultValue,c)}}]),n}(we)},tagMulti:{dataTypes:["string"],widget:function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){var e;Object(O.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).defaultArr=void 0,e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.changeValue(n.join("|"),!0)},e}return Object(j.a)(n,[{key:"init",value:function(){Object(V.a)(Object(R.a)(n.prototype),"init",this).call(this);var e=this.defaultValue;switch(typeof e){default:this.defaultArr=[];break;case"string":this.defaultArr=e.split("|").map((function(e){return Number(e)}))}}},{key:"render",value:function(){var e=this.ui,t=e.valuesView,n=e.wrapClassName;if(void 0===t)return C.createElement(C.Fragment,null,"valuesView must be defined");var r={className:S()(this.className,"py-0"),inputs:this.inputs,wrapClassName:n,onInputChange:this.onInputChange};return t.renderChecks(this.defaultValue,r)}}]),n}(we)},range:{dataTypes:["integer"],widget:oe},button:{dataTypes:["button","submit"],widget:he}};function je(e,t,n,r){if(void 0===e)return null;if(void 0!==t){var a,i=t.name,c=t.type;switch(c){case"arr":var o=e.getItemSchema(i);return C.createElement(be,{parentContext:e,arrSchema:o,children:n})}var u=e.getUiItem(i);if(void 0===u)a=d(c);else{var s=u.widget;switch(s){default:if(void 0!==s)a=Oe[s].widget;void 0===a&&(a=d(c));break;case"custom":a=u.WidgetClass;break;case"group":return C.createElement("span",null,"impletment group")}}var l=e.widgets,h=new a(e,t,r,n);return h.init(),l[i]=h,C.createElement(h.container,null)}function d(e){switch(e){default:return G;case"id":return se;case"integer":return Y;case"number":return X;case"string":return G;case"date":return Z;case"boolean":return re;case"button":case"submit":return he}}}n(72);var xe=n(54),Ee=n(31),Ce=function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(e){var r;Object(O.a)(this,n),(r=t.call(this,e)).schema=void 0,r.itemSchemas=void 0,r.uiSchema=void 0,r.res=void 0,r.formContext=void 0,r.disposer=void 0,r.data=void 0,r.Container=void 0,r.FieldContainer=void 0,r.FieldClass=void 0,r.ButtonClass=void 0,r.watch=function(){void 0!==r.props.formData&&r.calcSelectOrDelete()},r.DefaultContainer=function(e){return C.createElement("form",{className:S()(r.props.className),onSubmit:function(e){return e.preventDefault()}},e)},r.DefaultFieldContainer=function(e,t){var n=r.props.fieldLabelSize;if(n>0){var a;null===e?n=0:a=C.createElement("label",{className:S()("col-sm-"+n,"col-form-label")},e);var i="col-sm-"+(12-n);return C.createElement("div",{className:"form-group row"},a,C.createElement("div",{className:i},t))}return C.createElement("div",{className:"form-group"},null===e?null:C.createElement("label",{className:"col-form-label"},e),t)},r.DefaultFieldClass=void 0,r.DefaultButtonClass="text-center py-2",r.DefaultRes=Object(Ee.a)(xe.a),r.ArrContainer=function(e,t){return C.createElement("div",null,C.createElement("div",{className:S()("small text-muted text-center bg-light py-1 px-3 mt-4 mb-1")},e),t)},r.RowContainer=function(e){var t=S()({"py-3":!0});return C.createElement("div",{className:t},e)},r.RowSeperator=C.createElement("div",{className:"border border-gray border-top"});var a=e.schema,i=e.uiSchema,c=e.Container,o=e.FieldContainer,u=e.FieldClass,s=e.ButtonClass,l=e.res;r.Container=c||r.DefaultContainer,r.FieldContainer=o||r.DefaultFieldContainer,r.FieldClass=void 0!==u&&""!==u&&null!==u?u:r.DefaultFieldClass,r.res=l||r.DefaultRes,r.ButtonClass=s||r.DefaultButtonClass,r.schema=a,r.itemSchemas={};var h,d=Object(w.a)(r.schema);try{for(d.s();!(h=d.n()).done;){var f=h.value;r.itemSchemas[f.name]=f}}catch(p){d.e(p)}finally{d.f()}return r.uiSchema=i,r.disposer=Object(N.f)(r.watch),r.data={},r}return Object(j.a)(n,[{key:"renderContent",value:function(){var e=this;this.initData(this.props.formData);var t,n=this.props.children;return void 0!==n?(this.formContext=new ve(this,!0),C.createElement(C.Fragment,null,n)):(void 0!==this.uiSchema&&(t=this.uiSchema.Templet),void 0!==t?(this.formContext=new ve(this,!0),"function"===typeof t?t(this.data):t):(this.formContext=new ve(this,!1),C.createElement(C.Fragment,null,this.schema.map((function(t,r){return C.createElement(C.Fragment,{key:r},je(e.formContext,t,n))})))))}},{key:"initData",value:function(e){if(void 0===e&&(e={}),void 0!==this.uiSchema){var t=this.uiSchema.items;if(void 0!==t)for(var n in t){var r=t[n].defaultValue;void 0!==r&&void 0===e[n]&&(e[n]=r)}}var a,i=Object(w.a)(this.schema);try{for(i.s();!(a=i.n()).done;){var c=a.value;this.initDataItem(c,this.data,e)}}catch(o){i.e(o)}finally{i.f()}}},{key:"initDataItem",value:function(e,t,n){var r=e.name,a=e.type;if("button"!==a)if("arr"===a){var i=e,c=i.arr;if(void 0!==c){var o,u=i.itemSchemas={},s=Object(w.a)(c);try{for(s.s();!(o=s.n()).done;){var l=o.value;u[l.name]=l}}catch(g){s.e(g)}finally{s.f()}var h=n[r];void 0===h?h=[]:!1===Array.isArray(h)&&(h=[h]);var d,f=[],p=Object(w.a)(h);try{for(p.s();!(d=p.n()).done;){var v,m=d.value,b={$source:m,$isSelected:m.$isSelected,$isDeleted:m.$isDeleted},y=Object(w.a)(c);try{for(y.s();!(v=y.n()).done;){var k=v.value;this.initDataItem(k,b,m)}}catch(g){y.e(g)}finally{y.f()}f.push(b)}}catch(g){p.e(g)}finally{p.f()}t[r]=Object(N.m)(f)}}else t[r]=n[r]}},{key:"calcSelectOrDelete",value:function(){var e,t=Object(w.a)(this.schema);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.arrItemOperated(n)}}catch(r){t.e(r)}finally{t.f()}}},{key:"arrItemOperated",value:function(e){var t=e.name;if("arr"===e.type&&void 0!==this.data){var n=this.data[t];if(void 0!==n){var r,a=e.arr,i=Object(w.a)(n);try{for(i.s();!(r=i.n()).done;){var c=r.value,o=c.$source;if(void 0!==o){var u=o.$isSelected,s=o.$isDeleted;c.$isSelected=u,c.$isDeleted=s;var l,h=Object(w.a)(a);try{for(h.s();!(l=h.n()).done;){var d=l.value;this.arrItemOperated(d)}}catch(f){h.e(f)}finally{h.f()}}}}catch(f){i.e(f)}finally{i.f()}}}}},{key:"componentDidMount",value:function(){var e=this.props.beforeShow;void 0!==e&&e(this.formContext)}},{key:"componentWillUnmount",value:function(){void 0!==this.disposer&&this.disposer()}},{key:"render",value:function(){var e=this.renderContent();return C.createElement(me.Provider,{value:this.formContext},C.createElement(this.formContext.renderErrors),this.Container(e))}},{key:"buttonClick",value:function(){var e=Object(g.a)(k.a.mark((function e(t){var n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formContext.checkRules(),!0!==this.formContext.hasError){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(n=this.formContext.form.props.onButtonClick)){e.next=7;break}return alert("you should define form onButtonClick"),e.abrupt("return");case 7:return e.next=9,n(t,this.formContext);case 9:if(void 0!==(r=e.sent)){e.next=12;break}return e.abrupt("return");case 12:this.formContext.setError(t,r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(C.Component);(function(e){Object(x.a)(n,e);var t=Object(E.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(j.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.children,r=this.context;if(void 0===r)return C.createElement("span",{className:"text-danger"},"!only in Form!");var a=r.getItemSchema(t),i=je(r,a,n,this.props);return void 0===i?C.createElement("span",{className:"text-danger"},"!!",t," is not defined!!"):i}}]),n}(C.Component)).contextType=me},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r,a=n(1),i=n.n(a),c=n(4),o=n(2),u=n(3),s=n(5),l=n(6),h=n(0),d=n.n(h),f=n(12),p=n(21),v=n(24),m=n(27),b=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(f.a)((function(t){var n=t.resolve,r=function(){if(e.verifyValue(),void 0===e.error){var t=e.newValue;n(t)}},a=h.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!e.isChanged,onClick:r},"\u4fdd\u5b58"),i=e.inputOptions(),c=i.type,o=i.max,u=i.min,s=i.step;return h.createElement(v.a,{header:e.label,right:a},h.createElement("div",{className:"m-3"},h.createElement("input",{type:c,onChange:e.onChange,onKeyDown:function(e){13===e.keyCode&&r()},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,min:u,max:o,step:s}),e.uiItem&&h.createElement("div",{className:"small muted m-2"},e.uiItem.placeholder),e.error&&h.createElement("div",{className:"text-danger"},e.error)))})),e}return Object(u.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=h.createElement(t.page,{resolve:e,reject:n});p.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"inputOptions",value:function(){return{type:"text"}}},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),y=n(51),k=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(f.a)((function(t){var n=t.resolve,r=e.itemSchema.name,a=e.uiItem.list,i=h.createElement("button",{className:"btn btn-sm btn-success align-self-center",disabled:!e.isChanged,onClick:function(){e.verifyValue(),void 0===e.error&&n(e.newValue)}},"\u4fdd\u5b58"),c=a?a.map((function(t,n){var a=t.title,i=t.value;return h.createElement("div",{key:n,className:"col"},h.createElement("label",{className:"px-3 py-2 cursor-pointer"},h.createElement("input",{name:r,type:"radio",value:i,onClick:function(){return e.onChange(i)},defaultChecked:i===e.value})," ",a||i," \xa0"))})):h.createElement(h.Fragment,null,"no list defined");return h.createElement(v.a,{header:"\u66f4\u6539"+e.label,right:i},h.createElement("div",{className:"m-3"},h.createElement("div",{className:"row row-cols-2 row-cols-sm-3 row-cols-md-4"},c)))})),e}return Object(u.a)(n,[{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=h.createElement(t.page,{resolve:e,reject:n});p.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),g=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(f.a)((function(t){var n=t.resolve,r=e.uiItem.list,a=r?r.map((function(t,r){var a=t.title,i=t.value;return h.createElement("div",{key:r,className:"px-3 py-2 cursor-pointer bg-white mb-1",onClick:function(){e.onChange(i),n(e.newValue)}},a||i)})):h.createElement(h.Fragment,null,"no list defined");return h.createElement(v.a,{header:"\u66f4\u6539"+e.label},h.createElement("div",{className:"my-3"},a))})),e}return Object(u.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=h.createElement(t.page,{resolve:e,reject:n});p.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),w=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t;var n=e.value;e.isChanged=e.newValue!==n},e.page=Object(f.a)((function(t){return h.createElement(v.a,{header:"\u66f4\u6539"+e.label},"ddd")})),e}return Object(u.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(i.a.mark((function e(n,r){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=t.uiItem.pickId)){e.next=4;break}return alert("IdItemEdit.pickId = undefined"),e.abrupt("return");case 4:return e.next=6,a(void 0,void 0,t.value);case 6:c=e.sent,t.onChange(c.id),n(c);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"internalEnd",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),O=n(19),j=n(17),x=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputs={},e.inputType=void 0,e.page=Object(f.a)((function(t){var n=t.resolve,r=h.createElement("button",{className:"btn btn-sm btn-success align-self-center",disabled:!e.isChanged,onClick:function(){e.verifyValue(),void 0===e.error&&n(e.newValue)}},"\u4fdd\u5b58");return h.createElement(v.a,{header:"\u66f4\u6539"+e.label,right:r},h.createElement("div",{className:"p-3"},e.renderInputs()))})),e}return Object(u.a)(n,[{key:"init",value:function(){void 0===this.value&&(this.value=void 0===this._uiItem?void 0:this._uiItem.defaultValue)}},{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=h.createElement(t.page,{resolve:e,reject:n});p.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e=this.uiItem.valuesView;return void 0===e?Object(O.a)(Object(j.a)(n.prototype),"renderContent",this).call(this):e.render(this.value)}},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),E=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="radio",e.onInputChange=function(t){var n=t.currentTarget;if(!1!==n.checked){e.newValue=Number(n.value);var r=e.value;e.isChanged=e.newValue!==r}},e}return Object(u.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderRadios(this.value,t)}}]),n}(x),C=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).inputType="checkbox",e.onInputChange=function(t){var n=[];for(var r in e.inputs){var a=e.inputs[r];!0===a.checked&&n.push(a.value)}e.newValue=n.join("|");var i=e.value;e.isChanged=e.newValue!==i},e}return Object(u.a)(n,[{key:"renderInputs",value:function(){var e=this.uiItem.valuesView,t={inputs:this.inputs,onInputChange:this.onInputChange};return e.renderChecks(this.value,t)}}]),n}(x),N=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.newValue=t.target.value;var n=e.value;e.isChanged=e.newValue!==n},e.onBlur=function(t){e.verifyValue()},e.onFocus=function(){e.error=void 0},e.page=Object(f.a)((function(t){var n=t.resolve,r=h.createElement("button",{className:"btn btn-sm btn-success align-self-center mr-2",disabled:!e.isChanged,onClick:function(){if(e.verifyValue(),void 0===e.error){var t=e.newValue;n(t)}}},"\u4fdd\u5b58");return h.createElement(v.a,{header:e.label,right:r},h.createElement("div",{className:"m-3"},h.createElement("textarea",{onChange:e.onChange,onKeyDown:function(e){},onBlur:e.onBlur,onFocus:e.onFocus,className:"form-control",defaultValue:e.value,rows:6}),e.uiItem&&h.createElement("div",{className:"small muted m-2"},e.uiItem.placeholder),e.error&&h.createElement("div",{className:"text-danger"},e.error)))})),e}return Object(u.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=h.createElement(t.page,{resolve:e,reject:n});p.b.push(r,n)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uiItem",get:function(){return this._uiItem}}]),n}(m.a),I=n(11),S=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).input=void 0,e.onChange=function(t){e.newValue=e.getValue(t.target.checked);var n=e.value;e.isChanged=e.newValue!==n,e.edit.onItemChanged(Object(I.a)(e),e.newValue)},e}return Object(u.a)(n,[{key:"internalStart",value:function(){var e=Object(c.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.input){e.next=2;break}return e.abrupt("return");case 2:if(void 0!==this.uiItem){e.next=5;break}return e.abrupt("return",this.input.checked);case 5:return t=this.input.checked,e.abrupt("return",this.getValue(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"end",value:function(){var e=Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t=this,n=this.uiItem.readOnly,r=!0===n;return!0!==n&&(e=this.onChange),d.a.createElement("input",{ref:function(e){return t.input=e},type:"checkbox",defaultChecked:this.value,disabled:r,onChange:e})}},{key:"getValue",value:function(e){var t=this.uiItem,n=t.trueValue,r=t.falseValue;return!0===e?null===n||void 0===n||n:null!==r&&void 0!==r&&r}},{key:"uiItem",get:function(){return this._uiItem}},{key:"editInRow",get:function(){return!0}}]),n}(m.a),A=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"inputOptions",value:function(){var e,t,n;return this._uiItem&&(e=this._uiItem.min,t=this._uiItem.max,n=this._uiItem.step),{type:"range",min:e,max:t,step:n}}}]),n}(b),P=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"inputOptions",value:function(){var e,t,n;return this._uiItem&&(e=this._uiItem.min,t=this._uiItem.max,n=this._uiItem.step),{type:"number",min:e,max:t,step:n}}}]),n}(b),T=Object(f.a)(r=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).defaultSepClassName="border-top edit-sep-light-gray",r.defaultRowContainerClassName="d-flex px-3 py-2 bg-white align-items-center",r.topBorder=void 0,r.bottomBorder=void 0,r.rowContainerClassName=void 0,r.sep=void 0,r.uiSchema=void 0,r.rowClick=function(){var e=Object(c.a)(i.a.mark((function e(t){var n,a,c,o,u,s,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=3;break}return alert("item has no edit"),e.abrupt("return");case 3:if(n=t.itemSchema,a=t.uiItem,c=t.value,!0!==t.editInRow){e.next=6;break}return e.abrupt("return");case 6:if(o=r.props,u=o.onItemChanged,s=o.onItemClick,!0!==o.stopEdit){e.next=9;break}return e.abrupt("return");case 9:if(!0!==(null===a||void 0===a?void 0:a.readOnly)){e.next=11;break}return e.abrupt("return");case 11:if(void 0===s){e.next=15;break}return e.next=14,s(n,a,c);case 14:return e.abrupt("return");case 15:if(void 0!==t){e.next=18;break}return alert("undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);"),e.abrupt("return");case 18:return e.prev=18,e.next=21,t.start();case 21:if((l=e.sent)===c){e.next=30;break}if(r.props.data[n.name]=l,void 0!==u){e.next=28;break}alert("".concat(n.name," value changed, new: ").concat(l,", pre: ").concat(c)),e.next=30;break;case 28:return e.next=30,u(n,l,c);case 30:return e.next=32,t.end();case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(18),console.log("no value changed"),console.error(e.t0);case 38:case"end":return e.stop()}}),e,null,[[18,34]])})));return function(t){return e.apply(this,arguments)}}();var a=e.topBorderClassName,u=e.bottomBorderClassName,s=e.sepClassName,l=e.rowContainerClassName,d=e.uiSchema;return r.topBorder=h.createElement("div",{className:a||r.defaultSepClassName}),r.bottomBorder=h.createElement("div",{className:u||r.defaultSepClassName}),r.rowContainerClassName=l||r.defaultRowContainerClassName,r.sep=h.createElement("div",{className:s||r.defaultSepClassName}),r.uiSchema=d&&d.items||{},r}return Object(u.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.schema;return h.createElement("div",null,this.topBorder,n.map((function(n,r){var a,o,u=t.props.stopEdit,s=n.name,l=void 0===t.uiSchema?void 0:t.uiSchema[s];void 0!==l&&(a=l.label||s,o=l.labelHide);var d=t.props.data[s],f=function(e,t,n,r,a){var i,c;if(void 0!==n)switch(n.widget){default:break;case"id":c=w;break;case"text":c=b;break;case"textarea":c=N;break;case"image":c=y.a;break;case"select":c=g;break;case"range":c=A;break;case"number":case"updown":c=P;break;case"checkbox":c=S;break;case"radio":i=new k(e,t,n,r,a);break;case"tagSingle":i=new E(e,t,n,r,a);break;case"tagMulti":i=new C(e,t,n,r,a)}if(void 0===i){if(void 0===c)switch(t.type){case"string":c=b;break;case"image":c=y.a;break;case"boolean":c=S;break;case"number":case"integer":c=A}if(void 0===c)return;i=new c(e,t,n,r,a)}return i.init(),i}(t,n,l,a,d),p=t.rowContainerClassName,v=f.editInRow;!1===v&&!0!==u&&(v=!1),!1===v&&(p+=" cursor-pointer");var m,O=!0===n.required&&h.createElement("span",{className:"text-danger"},"*"),j="flex-fill d-flex ";!0===o?m=void 0:(m=h.createElement("div",null,a," ",O),j+="justify-content-end");var x=h.createElement(h.Fragment,{key:r},e,h.createElement("div",{className:"d-flex align-items-center"+p,onClick:Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.rowClick(f);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},m,h.createElement("div",{className:j},void 0===f?void 0:f.renderContent()),!1===v&&h.createElement("div",{className:"w-2c text-right"},h.createElement("i",{className:"fa fa-angle-right"}))));return e=t.sep,x})),this.bottomBorder)}},{key:"onItemChanged",value:function(){var e=Object(c.a)(i.a.mark((function e(t,n){var r,a,c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.itemSchema,a=t.uiItem,c=t.value,this.props.data[r.name]=n,o=this.props,u=o.onItemChanged,!0!==o.stopEdit){e.next=5;break}return e.abrupt("return");case 5:if(!0!==(null===a||void 0===a?void 0:a.readOnly)){e.next=7;break}return e.abrupt("return");case 7:if(void 0!==u){e.next=11;break}alert("".concat(r.name," value changed, new: ").concat(n,", pre: ").concat(c)),e.next=13;break;case 11:return e.next=13,u(r,n,c);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(h.Component))||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return C}));var r=n(1),a=n.n(r),i=n(4),c=n(2),o=n(3),u=n(5),s=n(6),l=n(15),h=n(32),d=n(34),f=n(20),p=new(function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"userAppUnits",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-app-units",{app:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("user/user-name-nick-icon-from-id",{userId:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"userFromKey",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("tie/user-from-key",{key:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(f.b))("tv/",void 0),v=n(0),m=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){var t=e.predefinedUnit,n=l.nav.user,r=n?n.name:"[\u672a\u767b\u5f55]",a=d.UQsMan.value,i=a.appOwner,c=a.appName;return v.createElement(l.Page,{header:"APP\u65e0\u6cd5\u8fd0\u884c",logout:!0},v.createElement("div",{className:"m-3 text-danger container"},v.createElement("div",{className:"form-group row"},v.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u767b\u5f55\u7528\u6237"),v.createElement("div",{className:"col-sm text-body"},r)),v.createElement("div",{className:"form-group row"},v.createElement("div",{className:"col-sm-3 font-weight-bold"},"App"),v.createElement("div",{className:"col-sm text-body"},"".concat(i,"/").concat(c))),v.createElement("div",{className:"form-group row"},v.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u9884\u8bbe\u5c0f\u53f7"),v.createElement("div",{className:"col-sm text-body"},t||v.createElement("small",{className:""},"[\u65e0\u9884\u8bbe\u5c0f\u53f7]"))),v.createElement("div",{className:"form-group row"},v.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u53ef\u80fd\u539f\u56e0",v.createElement(l.FA,{name:"exclamation-triangle"})),v.createElement("div",{className:"col-sm text-body"},v.createElement("ul",{className:"p-0"},v.createElement("li",null,"\u6ca1\u6709\u5c0f\u53f7\u8fd0\u884c ",c),v.createElement("li",null,"\u7528\u6237 ",v.createElement("b",null,r)," \u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u4e00\u4e2a\u8fd0\u884c",c,"\u7684\u5c0f\u53f7"),t&&v.createElement("li",null,"\u9884\u8bbe\u5c0f\u53f7 ",v.createElement("b",null,t)," \u6ca1\u6709\u8fd0\u884cApp ",c)))),v.createElement("div",{className:"form-group row"},v.createElement("div",{className:"col-sm-3 font-weight-bold"},"\u5c0f\u53f7",t),v.createElement("div",{className:"col-sm text-body"},"\u9884\u8bbe\u5c0f\u53f7\u5b9a\u4e49\u5728 public/unit.json \u6587\u4ef6\u4e2d\u3002 \u5b9a\u4e49\u4e86\u8fd9\u4e2a\u6587\u4ef6\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u7531url\u76f4\u63a5\u542f\u52a8\u3002 \u7528\u6237\u7b2c\u4e00\u6b21\u8bbf\u95eeapp\u4e4b\u540e\uff0c\u4f1a\u7f13\u5b58\u5728localStorage\u91cc\u3002",v.createElement("br",null),"\u5982\u679c\u8981\u5220\u53bb\u7f13\u5b58\u7684\u9884\u5b9a\u4e49Unit\uff0clogout\u7136\u540e\u518dlogin\u3002"))))},e}return Object(o.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{predefinedUnit:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h.c),b=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];return(e=t.call.apply(t,[this].concat(o))).renderRow=function(e,t){var n=e.id,r=e.nick,a=e.name;return v.createElement(l.LMR,{className:"px-3 py-2",right:"id: "+n},v.createElement("div",null,r||a))},e.onRowClick=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f.f.unit=n.id,t.next=3,e.controller.start();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.page=function(){return v.createElement(l.Page,{header:"\u9009\u62e9\u5c0f\u53f7",logout:!0},v.createElement(l.List,{items:e.controller.appUnits,item:{render:e.renderRow,onClick:e.onRowClick}}))},e}return Object(o.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(h.c),y=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){return v.createElement(l.Page,{header:"ERROR"},v.createElement("div",{className:"m-3"},v.createElement("div",{className:"p-3 d-flex justify-content-center align-items-center"},v.createElement("button",{className:"btn btn-danger",onClick:l.nav.resetAll},"\u91cd\u542f\u7f51\u9875")),v.createElement("div",null,"Load Uqs \u53d1\u751f\u9519\u8bef\uff1a"),e.errors.map((function(e,t){return v.createElement("div",{key:t},e)}))))},e}return Object(o.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{errors:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h.c),k=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).page=function(e){var t=e.error;return v.createElement(l.Page,{header:"App start error!"},v.createElement("pre",null,"string"===typeof t?t:t.message))},e}return Object(o.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page,{error:t});case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h.c),g=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,void 0)).appConfig=void 0,r._uqs=void 0,r.name=void 0,r.noUnit=void 0,r.appUnits=void 0,r.appConfig=e||l.nav.navSettings;var a=r.appConfig,i=a.appName,o=a.noUnit;if(r.name=i,void 0===i)throw new Error('appName like "owner/app" must be defined in MainConfig');return r.noUnit=o,r}return Object(o.a)(n,[{key:"internalT",value:function(e){return Object(l.t)(e)}},{key:"setRes",value:function(e){Object(l.setGlobalRes)(e)}},{key:"hookElements",value:function(e){if(void 0!==e)for(var t in e){var n=document.getElementById(t);n&&e[t](n)}}},{key:"beforeStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.onRoute(),!1!==l.nav.isRouting){e.next=6;break}return t=this.appConfig,n=t.appName,r=t.version,i=t.tvs,e.next=6,d.UQsMan.load(n,r,i);case 6:if(this._uqs=d.UQsMan._uqs,c=d.UQsMan.errors,o=f.f.predefinedUnit,!(void 0!==(u=l.nav.user)&&u.id>0)){e.next=32;break}return e.next=13,p.userAppUnits(d.UQsMan.value.id);case 13:if(this.appUnits=e.sent,!0!==this.noUnit){e.next=16;break}return e.abrupt("return",!0);case 16:e.t0=this.appUnits.length,e.next=0===e.t0?19:1===e.t0?21:27;break;case 19:return this.showUnsupport(o),e.abrupt("return",!1);case 21:if(!(void 0===(s=this.appUnits[0].id)||s<0||void 0!==o&&s!==o)){e.next=25;break}return this.showUnsupport(o),e.abrupt("return",!1);case 25:return f.f.unit=s,e.abrupt("break",32);case 27:if(!(o>0&&void 0!==this.appUnits.find((function(e){return e.id===o})))){e.next=30;break}return f.f.unit=o,e.abrupt("break",32);case 30:return this.openVPage(b),e.abrupt("return",!1);case 32:if(void 0===c){e.next=35;break}return this.openVPage(y,c),e.abrupt("return",!1);case 35:return e.abrupt("return",!0);case 38:return e.prev=38,e.t1=e.catch(0),this.openVPage(k,e.t1),e.abrupt("return",!1);case 42:case"end":return e.stop()}}),e,this,[[0,38]])})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l.nav.resolveRoute();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"userFromId",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.userFromId(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"on",value:function(){return l.nav.on(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"onRoute",value:function(){}},{key:"showUnsupport",value:function(e){l.nav.clear(),this.openVPage(m,e)}},{key:"uqs",get:function(){return this._uqs}}]),n}(h.b);function w(e,t,n){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(a.a.mark((function e(t,n,r){var i,c,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=n.htmlTitle)&&(document.title=i),c=document.getElementsByTagName("html"),(o=c[0])&&(u=null===o||void 0===o?void 0:o.getAttribute("data-version"))&&(n.version=u),s=new t(n),e.next=8,s.start(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j=n(19),x=n(17),E=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e.res))._uqs=void 0,r._cApp=void 0,r._cApp=e,r._uqs=e&&e.uqs,r}return Object(o.a)(n,[{key:"internalT",value:function(e){var t=Object(j.a)(Object(x.a)(n.prototype),"internalT",this).call(this,e);return void 0!==t?t:this._cApp.internalT(e)}},{key:"newC",value:function(e,t){var n=new e(this.cApp);return n.init(t),n}},{key:"newSub",value:function(e,t){var n=new e(this);return n.init(t),n}},{key:"uqs",get:function(){return this._uqs}},{key:"cApp",get:function(){return this._cApp}}]),n}(h.b),C=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e.cApp))._owner=void 0,r._owner=e,r}return Object(o.a)(n,[{key:"internalT",value:function(e){var t=Object(j.a)(Object(x.a)(n.prototype),"internalT",this).call(this,e);return void 0!==t?t:this._owner.internalT(e)}},{key:"owner",get:function(){return this._owner}}]),n}(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r,a,i,c,o,u,s=n(2),l=n(3),h=n(5),d=n(6),f=n(0),p=n(14),v=n.n(p),m=n(12),b=n(16),y=n.n(b),k=n(9),g=n(8),w=(r=function(){function e(t){Object(s.a)(this,e),this.list=void 0,this.render=void 0,this.list=t}return Object(l.a)(e,[{key:"dispose",value:function(){}},{key:"renderContent",value:function(e,t){var n=this.list.props.item.render;return void 0===n?f.createElement("div",{className:"px-3 py-2"},JSON.stringify(e)):n(e,t)}},{key:"isPaged",get:function(){var e=this.list.props.items;return null!==e&&void 0!==e&&!1===Array.isArray(e)}},{key:"items",get:function(){var e=this.list.props.items;return null===e?null:void 0!==e?!0===Array.isArray(e)?e:e.items:void 0}},{key:"loading",get:function(){var e=this.list.props.items;if(null===e)return!1;if(void 0===e)return!0;var t=e;return void 0!==t.items&&t.loading}},{key:"selectedItems",get:function(){}}]),e}(),Object(k.a)(r.prototype,"loading",[g.g],Object.getOwnPropertyDescriptor(r.prototype,"loading"),r.prototype),r),O=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key,c=r.onClick;return f.createElement("li",{key:void 0===i?n:i(t),className:v()("va-row-clickable",a),onClick:function(){return c&&c(t)}},e.renderContent(t,n))},e}return n}(w),j=n(33),x=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t,n){var r=e.list.props.item,a=r.className,i=r.key;if("string"===typeof t){var c=v()("va-list-gap","px-3","pt-1");return f.createElement("li",{key:Object(j.a)(),className:c},t)}return f.createElement("li",{key:void 0===i?n:i(t),className:v()(a)},e.renderContent(t,n))},e}return n}(w),E=n(13),C=n(22),N=n(10),I=n(11),S=(n(18),a=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),r=t.call(this,e),Object(N.a)(r,"_items",i,Object(I.a)(r)),r.inputItems={},r.buildItems=function(){var e,t=r.list.props,n=t.items,a=t.isItemSelected,i=t.selectedItems,c=t.compare;if(void 0!==n)if(null!==n)if(e=!0===Array.isArray(n)?n:n.items,a){var o=e.map((function(e){return{selected:a(e),item:e,labelId:Object(j.a)()}}));r._items=o}else{var u;u=void 0===c?function(e,t){return e===t}:c;var s=e.map((function(e){return{selected:void 0!==i&&void 0!==i.find((function(t){return u(e,t)})),item:e,labelId:Object(j.a)()}}));r._items=s}else r._items=null;else r._items=void 0},r.render=function(e,t){var n=r.list.props.item.key;return f.createElement(r.row,{item:e,index:t,key:void 0===n?t:n(e)})},r.row=Object(m.a)((function(e){var t=e.item,n=e.index,a=r.list.props.item.className,i=t.labelId,c=t.selected,o=t.item;return f.createElement("li",{className:v()(a)},f.createElement("div",{className:"d-flex align-items-center px-3"},f.createElement("input",{ref:function(e){e&&(r.inputItems[i]=e)},className:"",type:"checkbox",value:"",id:i,defaultChecked:c,onChange:function(e){r.onSelect(t,e.target.checked)}}),f.createElement("label",{className:"",style:{flex:1,marginBottom:0},htmlFor:i},r.renderContent(o,n))))})),r.buildItems(),r.listenArraySplice(),r}return Object(l.a)(n,[{key:"listenArraySplice",value:function(){var e,t=this,n=this.list.props.items;void 0!==n&&(null!==n&&(e=!0===Array.isArray(n)?n:n.items,!0===Object(g.j)(n)&&Object(g.n)(e,(function(e){if("splice"===e.type){var n,r=e.index,a=e.removedCount,i=e.added,c=i&&i.map((function(e){return{selected:!1,item:e,labelId:Object(j.a)()}}));(n=t._items).splice.apply(n,[r,a].concat(Object(C.a)(c))),t.buildItems()}}),!0)))}},{key:"checkAll",value:function(e){for(var t in this.inputItems)this.inputItems[t].checked=e;var n,r=Object(E.a)(this._items);try{for(r.s();!(n=r.n()).done;){n.value.selected=e}}catch(a){r.e(a)}finally{r.f()}}},{key:"selectAll",value:function(){this.checkAll(!0),this.list.props.item.onSelect(void 0,!0,this.anySelected)}},{key:"unselectAll",value:function(){this.checkAll(!1),this.list.props.item.onSelect(void 0,!1,this.anySelected)}},{key:"onSelect",value:function(e,t){e.selected=t,this.list.props.item.onSelect(e.item,t,this.anySelected)}},{key:"items",get:function(){return this._items}},{key:"anySelected",get:function(){return this._items.some((function(e){return e.selected}))}},{key:"selectedItems",get:function(){return this._items.filter((function(e){return!0===e.selected})).map((function(e){return e.item}))}}]),n}(w),i=Object(k.a)(a.prototype,"_items",[g.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a),A=(n(113),n(31)),P=n(54),T=Object(m.a)((u=o=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).listBase=void 0,r.selectable=void 0,r._$scroll=function(e){console.log("############### items scroll to "+e)},r.buildBase(),r}return Object(l.a)(n,[{key:"buildBase",value:function(){var e=this.props.item,t=e.onClick;void 0!==e.onSelect?this.selectable=this.listBase=new S(this):this.listBase=void 0!==t?new O(this):new x(this)}},{key:"componentDidUpdate",value:function(e,t){!1===y.a.isEqual(this.props.item,e.item)&&(this.buildBase(),this.forceUpdate())}},{key:"componentWillUnmount",value:function(){this.listBase.dispose()}},{key:"selectAll",value:function(){this.selectable&&this.selectable.selectAll()}},{key:"unselectAll",value:function(){this.selectable&&this.selectable.unselectAll()}},{key:"render",value:function(){var e=this,t=this.props,r=t.className,a=t.header,i=t.footer,c=t.before,o=t.loading,u=t.none,s=t.onFocus;void 0===c&&(c="-"),void 0===o&&(o=function(){return f.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw text-info"})}),void 0===u&&(u=n.res.none);var l,h,d,p=this.listBase,m=p.items,b=p.loading;function y(e,t){if(e)switch(typeof e){default:case"string":return f.createElement("li",{className:"va-list-"+t},e);case"function":return f.createElement("li",{className:"va-list-"+t},e());case"object":return f.createElement("li",null,e)}}return l=null===m?y(c,"before"):void 0===m?y(o,"loading"):0===m.length?y(u,"none"):m.map((function(t,n){return e.listBase.render(t,n)})),!0===b&&m&&(h=y(o,"loading")),void 0!==s&&(d=-1),f.createElement("ul",{className:v()("va-list",r),onFocus:s,tabIndex:d},y(a,"header"),l,h,y(i,"footer"))}},{key:"selectedItems",get:function(){return this.listBase.selectedItems}}]),n}(f.Component),o.res=Object(A.a)(P.b),c=u))||c},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r,a=n(13),i=n(2),c=n(3),o=n(5),u=n(6),s=n(0),l=n(14),h=n.n(l),d=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"setValues",value:function(e){}}]),e}(),f=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(e){return s.createElement("div",{key:"_b_"+e,className:""},s.createElement("div",{className:"w-100"},s.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}})))}}]),n}(d),p=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this)).param=void 0,r.param=e,r}return Object(c.a)(n,[{key:"render",value:function(e){var t;switch(this.param){default:t="py-2";break;case"=":t="py-1";break;case"-":t="pb-1"}var n=h()(t);return s.createElement("div",{key:"_g_"+e,className:n})}}]),n}(d),v="justify-content-start",m="justify-content-center",b="justify-content-end",y=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).gridProps=void 0,a._prop=void 0,a.content=void 0,a.col=void 0,a.gridProps=e,a._prop=r,a.col=!0===e.labelFixLeft?"col":"col-sm",a}return Object(c.a)(n,[{key:"prop",get:function(){return this._prop}}]),Object(c.a)(n,[{key:"render",value:function(e){var t=this.prop,n=t.onClick,r=t.bk,a=h()({"cursor-pointer":void 0!==n,"bg-white":void 0===r,row:!0});return s.createElement("div",{key:e,className:a,onClick:n},this.renderLabel(),this.renderProp())}},{key:"renderLabel",value:function(){var e=this.prop.label;return void 0===e?null:s.createElement("label",{className:this.col+"-3 col-form-label"},e)}},{key:"renderProp",value:function(){var e,t,n=this.prop.label;switch(this.gridProps.alignValue){case"left":e=v;break;case"center":e=m;break;case"right":e=b}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}var r=this.col+(void 0===n?"-12":"-9"),a=h()(e,t,r,"d-flex");return s.createElement("div",{className:a},this.renderPropBody())}},{key:"renderPropBody",value:function(){return s.createElement("div",{className:"form-control-plaintext"},this.renderPropContent())}},{key:"renderPropContent",value:function(){return this.content}}]),n}(d),k=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}},{key:"prop",get:function(){return this._prop}}]),n}(y),g=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"setValues",value:function(e){this.content=void 0===e?void 0:e[this.prop.name]}},{key:"prop",get:function(){return this._prop}}]),n}(y),w=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"setValues",value:function(e){if(void 0===e)this.content=void 0;else{var t=this.prop.list;this.content="string"===typeof t?e[t]:void 0}}},{key:"renderPropBody",value:function(){var e=this.prop,t=e.list,n=e.row,r="string"===typeof t?this.content:t;return void 0===r?s.createElement("div",null):s.createElement("div",{className:"w-100"},r.map((function(e,t){return s.createElement(s.Fragment,{key:t},0===t?null:s.createElement("div",{style:{width:"100%",borderBottom:"1px solid #f0f0f0"}}),s.createElement(n,e))})))}},{key:"prop",get:function(){return this._prop}}]),n}(y),O=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"renderPropBody",value:function(){return this.prop.component}},{key:"renderProp",value:function(){var e,t,n,r=this.prop,a=r.label,i=r.full;switch(this.gridProps.alignValue){case"left":e=v;break;case"center":e=m;break;case"right":e=b}switch(this.prop.vAlign){case"top":t="align-items-start";break;default:case"center":t="align-items-center";break;case"bottom":t="align-items-end";break;case"stretch":t="align-items-stretch"}n=!0!==i?this.col+(void 0===a?"-12":"-9"):"w-100";var c=h()(e,t,n,"d-flex");return s.createElement("div",{className:c},this.renderPropBody())}},{key:"prop",get:function(){return this._prop}}]),n}(y),j=function(){function e(t,n){Object(i.a)(this,e),this.gridProps=void 0,this.props=void 0,this.rows=void 0,this.gridProps=t,this.props=n,this.buildRows()}return Object(c.a)(e,[{key:"buildRows",value:function(){this.rows=[];var e,t=!0,n=Object(a.a)(this.props);try{for(n.s();!(e=n.n()).done;){var r=e.value;if("string"===typeof r)this.rows.push(new p(r)),t=!0;else{t||this.rows.push(new f);var i=void 0;switch(r.type){default:continue;case"string":i=new k(this.gridProps,r);break;case"number":i=new g(this.gridProps,r);break;case"list":i=new w(this.gridProps,r);break;case"component":i=new O(this.gridProps,r)}this.rows.push(i),t=!1}}}catch(c){n.e(c)}finally{n.f()}}},{key:"setValues",value:function(e){var t,n=Object(a.a)(this.rows);try{for(n.s();!(t=n.n()).done;){t.value.setValues(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"render",value:function(){return this.rows.map((function(e,t){return e.render(String(t))}))}}]),e}(),x=n(12),E=Object(x.a)(r=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.rows,r=e.values,a=new j(this.props,n);a.setValues(r);var i=h()("container-fluid",t);return s.createElement("div",{className:i},a.render())}}]),n}(s.Component))||r},function(e,t,n){"use strict";var r,a,i=n(1),c=n.n(i),o=n(4),u=n(10),s=n(2),l=n(3),h=n(11),d=n(5),f=n(6),p=n(9),v=(n(18),n(0)),m=n(8),b=n(15),y=n(20);r=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],r.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},Object(u.a)(r,"data",a,Object(h.a)(r)),r.onItemChanged=function(){var e=Object(o.a)(c.a.mark((function e(t,n,a){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.name,e.next=3,y.p.userSetProp(i,n);case 3:r.data[i]=n,b.nav.user[i]=n,b.nav.saveLocalUser();case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var i=b.nav.user,l=i.nick,d=i.icon;return r.data={nick:l,icon:d},r}return Object(l.a)(n,[{key:"render",value:function(){return v.createElement(b.Page,{header:"\u4e2a\u4eba\u4fe1\u606f"},v.createElement(b.Edit,{schema:this.schema,uiSchema:this.uiSchema,data:this.data,onItemChanged:this.onItemChanged}))}}]),n}(v.Component),a=Object(p.a)(r.prototype,"data",[m.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null})},function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return R}));var r=n(13),a=n(11),i=n(1),c=n.n(i),o=n(4),u=n(2),s=n(3),l=n(19),h=n(17),d=n(5),f=n(6),p=n(16),v=n.n(p),m=n(29),b=n(28),y=n(8),k=n(97),g=function(){function e(t){Object(u.a)(this,e),this.queue=[],this.cache=y.m.map({},{deep:!1}),this.loading=!1,this.localArr=void 0,this.waitingIds=[],this.tuidInner=void 0,this.divName=void 0,this.tuidInner=t,this.initLocalArr()}return Object(s.a)(e,[{key:"initLocalArr",value:function(){this.localArr=this.tuidInner.cache.arr(this.tuidInner.name+".ids")}},{key:"useId",value:function(e,t){if(e&&!1!==Object(k.isNumber)(e))if(!0!==this.cache.has(e))if(this.tuidInner.cacheTuids(!0===t?70:20),this.cache.set(e,e),this.waitingIds.findIndex((function(t){return t===e}))>=0)this.moveToHead(e);else{if(this.queue.length>=1e3){var n=this.queue.shift();if(n===e)return void this.queue.push(n);if(!0===this.cache.has(n))this.cache.delete(n);else{var r=this.waitingIds.findIndex((function(e){return e===n}));this.waitingIds.splice(r,1)}}this.waitingIds.push(e),this.queue.push(e)}else this.moveToHead(e)}},{key:"moveToHead",value:function(e){var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.queue.push(e)}},{key:"getValue",value:function(e){return this.cache.get(e)}},{key:"remove",value:function(e){this.cache.delete(e);var t=this.queue.findIndex((function(t){return t===e}));this.queue.splice(t,1),this.localArr.removeItem(e)}},{key:"valueFromId",value:function(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}return this.getValue(t)}},{key:"resetCache",value:function(e){this.remove(e),this.useId(e)}},{key:"cacheValue",value:function(e){if(void 0===e)return!1;var t=this.getIdFromObj(e);if(void 0===t)return!1;var n=this.waitingIds.findIndex((function(e){return e===t}));return n>=0&&this.waitingIds.splice(n,1),this.cache.set(t,e),!0}},{key:"getIdFromObj",value:function(e){return this.tuidInner.getIdFromObj(e)}},{key:"cacheIds",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.waitingIds.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.loadIds();case 4:if(void 0!==(t=e.sent)&&0!==t.length){e.next=8;break}return this.waitingIds.splice(0,this.waitingIds.length),e.abrupt("return");case 8:this.cacheIdValues(t);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheIdValues",value:function(e){if(void 0!==e){var t,n=this.unpackTuidIds(e),a=Object(r.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;!1!==this.cacheValue(i)&&this.cacheTuidFieldValues(i)}}catch(c){a.e(c)}finally{a.f()}}}},{key:"modifyIds",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r,a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTuidIdsOrLocal(t);case 2:if(n=e.sent,0!==(r=n.filter((function(e){var t=e.indexOf("\t");t<0&&(t=e.length);var n=Number(e.substr(0,t));return void 0!==a.localArr.getItem(n)}))).length){e.next=6;break}return e.abrupt("return");case 6:this.cacheIdValues(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadIds",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,e.next=5,this.loadTuidIdsOrLocal(this.waitingIds);case 5:return t=e.sent,this.loading=!1,e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unpackTuidIds",value:function(e){return this.tuidInner.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.tuidInner.cacheTuidFieldValues(e)}},{key:"assureObj",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.cache.get(t),e.t0=typeof n,e.next="object"===e.t0?4:"number"===e.t0?5:7;break;case 4:return e.abrupt("return",n);case 5:return this.cache.set(t,t),e.abrupt("break",7);case 7:return e.next=9,this.loadTuidIdsOrLocal([t]);case 9:r=e.sent,this.cacheIdValues(r);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadTuidIdsOrLocal",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,a,i,o,u,s,l,h,d,f,p,m=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=[],i=Object(r.a)(t);try{for(i.s();!(o=i.n()).done;)u=o.value,(s=this.localArr.getItem(u))?n.push(s):a.push(u)}catch(c){i.e(c)}finally{i.f()}if(!((l=a.length)>0)){e.next=20;break}return e.next=8,this.tuidInner.loadTuidIds(this.divName,a);case 8:h=e.sent,d=function(e){var t=h[e];if(!t)return"continue";var r=t.indexOf("\t");r<0&&(r=t.length);var i=Number(t.substr(0,r));v.a.remove(a,(function(e){return e===i})),n.push(t),m.localArr.setItem(i,t)},f=0;case 11:if(!(f<l)){e.next=18;break}if("continue"!==d(f)){e.next=15;break}return e.abrupt("continue",15);case 15:f++,e.next=11;break;case 18:for(l=a.length,p=0;p<l;p++)this.localArr.setItem(a[p],"");case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),w=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e,r){var a;return Object(u.a)(this,n),(a=t.call(this,e)).div=void 0,a.divName=void 0,a.div=r,a.divName=r.name,a.localArr=e.cache.arr(e.name+".ids."+a.divName),a}return Object(s.a)(n,[{key:"initLocalArr",value:function(){}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"unpackTuidIds",value:function(e){return this.div.unpackTuidIds(e)}},{key:"cacheTuidFieldValues",value:function(e){this.div.cacheTuidFieldValues(e)}}]),n}(g),O=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).noCache=void 0,e.typeName="tuid",e.idName=void 0,e.cached=void 0,e.unique=void 0,e.isImport=!1,e}return Object(s.a)(n,[{key:"setSchema",value:function(e){Object(l.a)(Object(h.a)(n.prototype),"setSchema",this).call(this,e);var t=e.id;this.idName=t}},{key:"buildTuidBox",value:function(){return new _(this)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"stopCache",value:function(){this.noCache=!0}},{key:"cacheIds",value:function(){}},{key:"modifyIds",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"equ",value:function(e,t){return void 0!==e&&(void 0!==t&&("object"===typeof e?e.equ(t):"object"===typeof t?t.equ(e):e===t))}}]),n}(m.a),j=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e,r,i){var c;return Object(u.a)(this,n),(c=t.call(this,e,r,i)).divs=void 0,c.cacheFields=void 0,c.idCache=void 0,c.localArr=void 0,c.idCache=new g(Object(a.a)(c)),c.localArr=c.cache.arr(c.name+".whole"),!0===e.newVersion&&c.localArr.removeAll(),c}return Object(s.a)(n,[{key:"setSchema",value:function(e){Object(l.a)(Object(h.a)(n.prototype),"setSchema",this).call(this,e);var t=e.arrs;if(void 0!==t){this.divs={};var a,i=Object(r.a)(t);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=c.name,u=new D(this.uq,this,o);this.divs[o]=u,u.setSchema(c),u.buildFieldsTuid()}}catch(s){i.e(s)}finally{i.f()}}}},{key:"useId",value:function(e,t){!0!==this.noCache&&e&&this.idCache.useId(e,t)}},{key:"boxId",value:function(e){if(e){if("object"===typeof e)return e;this.useId(e);var t=this.uq.createBoxId;return t?t(this,e):{id:e}}}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"resetCache",value:function(e){"object"===typeof e&&(e=e.id),this.idCache.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return"object"===typeof t&&(t=t.id),e.next=5,this.idCache.assureObj(t);case 5:return e.abrupt("return",this.idCache.getValue(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){if(this.idCache.cacheIds(),void 0!==this.divs)for(var e in this.divs)this.divs[e].cacheIds()}},{key:"modifyIds",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.modifyIds(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuids",value:function(e){this.uq.cacheTuids(e)}},{key:"div",value:function(e){return this.divs&&this.divs[e]}},{key:"loadTuidIds",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new C(this,{divName:t,ids:n},!1).request();case 2:return(r=e.sent).length>0&&(this.cached=!0),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadMain",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"object"===typeof t&&(t=t.id),e.next=3,this.idCache.assureObj(t);case 3:return e.abrupt("return",this.idCache.valueFromId(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n,a,i,o,u,s,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&0!==t){e.next=2;break}return e.abrupt("return");case 2:"object"===typeof t&&(t=t.id),void 0,e.next=8;break;case 8:return e.next=10,new E(this,t).request();case 10:n=e.sent;case 12:if(void 0!==n){e.next=14;break}return e.abrupt("return");case 14:a=Object(r.a)(this.schema.fields),e.prev=15,a.s();case 17:if((i=a.n()).done){e.next=29;break}if(o=i.value,void 0!==(u=o.tuid)){e.next=22;break}return e.abrupt("continue",27);case 22:if(void 0!==(s=this.uq.getTuid(u))){e.next=25;break}return e.abrupt("continue",27);case 25:l=o.name,n[l]=s.boxId(n[l]);case 27:e.next=17;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(15),a.e(e.t0);case 34:return e.prev=34,a.f(),e.finish(34);case 37:return this.idCache.cacheValue(n),this.cacheTuidFieldValues(n),e.abrupt("return",n);case 40:case"end":return e.stop()}}),e,this,[[15,31,34,37]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema,n=t.fields,a=t.arrs;if(this.cacheFieldsInValue(e,n),void 0!==a){var i,c=Object(r.a)(a);try{for(c.s();!(i=c.n()).done;){var o=i.value,u=o.name,s=o.fields,l=e[u];if(void 0!==l){var h,d=this.div(u),f=Object(r.a)(l);try{for(f.s();!(h=f.n()).done;){var p=h.value;d.cacheValue(p),this.cacheFieldsInValue(p,s)}}catch(v){f.e(v)}finally{f.f()}}}}catch(v){c.e(v)}finally{c.f()}}}},{key:"buildFieldsTuid",value:function(){Object(l.a)(Object(h.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema,t=e.mainFields,r=e.$create,a=e.$update,i=e.stampOnMain;this.cacheFields=t||this.fields,!0===i&&(!0===r&&this.cacheFields.push({name:"$create",type:"timestamp",_tuid:void 0}),!0===a&&this.cacheFields.push({name:"$update",type:"timestamp",_tuid:void 0})),this.uq.buildFieldTuid(this.cacheFields)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}},{key:"save",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new N(this,{id:t,props:n}).request();case 2:return r=e.sent,void 0!==t&&(this.idCache.remove(t),this.localArr.removeItem(t)),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new P(this,{id:t,prop:n,value:r}).request();case 2:return this.idCache.remove(t),e.next=5,this.idCache.assureObj(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new S(this,{}).request();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.searchArr(void 0,t,n,r);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,a,i){var o,u,s,l,h,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={arr:void 0,owner:t,key:n,pageStart:a,pageSize:i},e.next=3,new I(this,o).request();case 3:u=e.sent,s=this.schema.fields,l=Object(r.a)(u);try{for(l.s();!(h=l.n()).done;)d=h.value,this.cacheFieldsInValue(d,s)}catch(c){l.e(c)}finally{l.f()}return e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r&&0!==r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,new A(this,{arr:t,owner:n,id:r}).request();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new T(this,{arr:t,owner:n,id:r,props:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new F(this,{arr:t,owner:n,id:r,order:a}).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"no",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new V(this,void 0).request();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasDiv",get:function(){return void 0!==this.divs}}]),n}(O),x=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"entity",get:function(){return this._entity}}]),n}(b.b),E=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(s.a)(n,[{key:"path",get:function(){return"tuid/".concat(this.entity.name,"/").concat(this.params)}}]),n}(x),C=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"buildParams",value:function(){return this.params.ids}},{key:"xresult",value:function(e){return e.split("\n")}},{key:"path",get:function(){var e=this.params.divName;return"tuidids/".concat(this.entity.name,"/").concat(void 0!==e?e:"$")}}]),n}(x),N=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"buildParams",value:function(){var e=this.entity.schema,t=e.fields,n=e.arrs,a=this.params,i=a.id,c=a.props,o={$id:i};if(this.transParams(o,c,t),void 0!==n){var u,s=Object(r.a)(n);try{for(s.s();!(u=s.n()).done;){var l=u.value,h=l.name,d=[],f=l.fields,p=c[h];if(void 0!==p){var v,m=Object(r.a)(p);try{for(m.s();!(v=m.n()).done;){var b=v.value,y={};this.transParams(y,b,f),d.push(y)}}catch(k){m.e(k)}finally{m.f()}}o[h]=d}}catch(k){s.e(k)}finally{s.f()}}return o}},{key:"transParams",value:function(e,t,n){if(void 0!==t){var a,i=Object(r.a)(n);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=c.name,u=c.tuid,s=c.type,l=t[o];if(void 0!==u)"object"===typeof l&&null!==l&&(l=l.id);else switch(s){case"date":l=this.entity.buildDateParam(l);break;case"datetime":l=this.entity.buildDateTimeParam(l)}e[o]=l}}catch(h){i.e(h)}finally{i.f()}}}},{key:"path",get:function(){return"tuid/".concat(this.entity.name)}}]),n}(x),I=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"path",get:function(){return"tuids/".concat(this.entity.name)}}]),n}(x),S=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(s.a)(n,[{key:"path",get:function(){return"tuid-all/".concat(this.entity.name)}}]),n}(x),A=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).method="GET",e}return Object(s.a)(n,[{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner,r=e.id;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/").concat(r)}}]),n}(x),P=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"path",get:function(){return"tuid-prop/".concat(this.entity.name,"/")}}]),n}(x),T=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"buildParams",value:function(){var e=this.params,t=e.id,n=e.props,r=v.a.clone(n);return r.$id=t,r}},{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}}]),n}(x),F=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"buildParams",value:function(){var e=this.params;return{bid:e.id,$order:e.order}}},{key:"path",get:function(){var e=this.params,t=e.arr,n=e.owner;return"tuid-arr-pos/".concat(this.entity.name,"/").concat(n,"/").concat(t,"/")}}]),n}(x),V=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"buildParams",value:function(){var e=new Date;return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}}},{key:"path",get:function(){return"tuid-no/".concat(this.entity.name,"/")}}]),n}(x),R=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e,r,a,i){var c;return Object(u.a)(this,n),(c=t.call(this,e,r,a)).tuidLocal=void 0,c.from=void 0,c.isImport=!0,c.from=i,c}return Object(s.a)(n,[{key:"setFrom",value:function(e){this.tuidLocal=e}},{key:"useId",value:function(e){this.tuidLocal.useId(e)}},{key:"boxId",value:function(e){return this.tuidLocal.boxId(e)}},{key:"valueFromId",value:function(e){return this.tuidLocal.valueFromId(e)}},{key:"resetCache",value:function(e){this.tuidLocal.resetCache(e)}},{key:"assureBox",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.assureBox(t);case 2:return e.abrupt("return",this.tuidLocal.valueFromId(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"div",value:function(e){return this.tuidLocal.div(e)}},{key:"loadMain",value:function(){var e=Object(o.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadMain(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.load(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.save(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveProp",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveProp(t,n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.all();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.search(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"searchArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.searchArr(t,n,r,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"loadArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.loadArr(t,n,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"saveArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.saveArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"posArr",value:function(){var e=Object(o.a)(c.a.mark((function e(t,n,r,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.posArr(t,n,r,a);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"no",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.tuidLocal.no();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasDiv",get:function(){return this.tuidLocal.hasDiv}}]),n}(O),_=function(){function e(t){Object(u.a)(this,e),this.tuid=void 0,this.ownerField=void 0,this.tuid=t}return Object(s.a)(e,[{key:"boxId",value:function(e){return this.tuid.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.tuid.getIdFromObj(e)}},{key:"useId",value:function(e){return this.tuid.useId(e)}},{key:"showInfo",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:alert("showInfo not implemented");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),D=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e,r,i){var c;return Object(u.a)(this,n),(c=t.call(this,e,i,0)).typeName="div",c.cacheFields=void 0,c.tuid=void 0,c.idName=void 0,c.idCache=void 0,c.tuid=r,c.idName="id",c.idCache=new w(r,Object(a.a)(c)),c}return Object(s.a)(n,[{key:"buildFieldsTuid",value:function(){Object(l.a)(Object(h.a)(n.prototype),"buildFieldsTuid",this).call(this);var e=this.schema.mainFields;this.uq.buildFieldTuid(this.cacheFields=e)}},{key:"buildTuidDivBox",value:function(e){return new B(this.tuid,this,e)}},{key:"getIdFromObj",value:function(e){return e[this.idName]}},{key:"cacheValue",value:function(e){this.idCache.cacheValue(e)}},{key:"useId",value:function(e,t){!0!==this.noCache&&this.idCache.useId(e,t)}},{key:"valueFromId",value:function(e){return this.idCache.getValue(e)}},{key:"assureBox",value:function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.assureObj(t);case 2:return e.abrupt("return",this.idCache.getValue(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cacheIds",value:function(){var e=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idCache.cacheIds();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cacheTuidFieldValues",value:function(e){var t=this.schema.fields;this.cacheFieldsInValue(e,t)}},{key:"unpackTuidIds",value:function(e){return this.unpackTuidIdsOfFields(e,this.cacheFields)}},{key:"owner",get:function(){return this.tuid}}]),n}(j),B=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e,r,a){var i;return Object(u.a)(this,n),(i=t.call(this,e)).ownerField=void 0,i.div=void 0,i.div=r,i.ownerField=a,i}return Object(s.a)(n,[{key:"boxId",value:function(e){return this.div.boxId(e)}},{key:"getIdFromObj",value:function(e){return this.div.getIdFromObj(e)}},{key:"useId",value:function(e){return this.div.useId(e)}}]),n}(_)},,,,function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ba}));var r=n(1),a=n.n(r),i=n(4),c=n(0),o=n.n(c),u=n(68),s=n.n(u);n(105),n(106),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}var h=n(7),d=(n(116),{appName:"Bruce/notes",version:"1.0.0",noUnit:!0,tvs:{},oem:void 0,htmlTitle:"\u5c0f\u5355"}),f=n(2),p=n(3),v=n(5),m=n(6),b=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"cApp",get:function(){return this._cApp}},{key:"uqs",get:function(){return this._uqs}}]),n}(h.CBase),y=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"cApp",get:function(){return this._cApp}},{key:"uqs",get:function(){return this._uqs}},{key:"owner",get:function(){return this._owner}}]),n}(h.CSub),k=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"newC",value:function(e){var t=new e(this);return t.init(),t}},{key:"uqs",get:function(){return this._uqs}}]),n}(h.CAppBase),g=n(9);function w(e,t){return function(n){return Object(h.TabCaptionComponent)(e,t,function(e){return!0===e?"text-primary":"text-muted"}(n))}}var O,j=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).render=function(t){var n=e.controller,r=n.cHome,a=n.cRelation,i=n.cDiscover,o=n.cMe,u=[{name:"home",caption:w(Object(h.t)("home"),"home"),content:r.tab},{name:"relation",caption:w(Object(h.t)("relation"),"user-plus"),content:a.tab,onShown:a.load},{name:"discover",caption:w(Object(h.t)("discover"),"arrows-alt"),content:i.tab,load:i.loadBookProjects},{name:"me",caption:w(Object(h.t)("me"),"user-o"),content:o.tab}];return c.createElement(h.Page,{tabsProps:{tabs:u}})},e}return Object(p.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.render,t,n);case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(h.VPage);function x(e){var t;switch(typeof e){case"object":t=e.id;break;case"number":t=e;break;default:return}return t}function E(e,t){return x(e)===x(t)}function C(e){if(/^(?:(?:[0-9])|(?:[0-2][0-3])|(?:[0-1][0-9])):[0-5][0-9]$/.test(e)){var t=e.split(":");return 60*Number(t[0])+Number(t[1])}var n=Number(e);return isNaN(n)||n>20||n<0?-1:60*n}function N(e){if(isNaN(e)||e<=0)return"";var t=Math.floor(e/60),n=Math.floor(e%60),r=n.toString();return n<10&&(r="0"+r),t.toString()+":"+r}function I(e){var t=e.type,n=e.content,r=e.flowContent;if(r){var a=JSON.parse(r);e.obj=a}else if(n)if("{"===n[0]){var i=JSON.parse(n);if(t===O.text)switch(i.check){case 1:e.type=O.textList;break;case 2:e.type=O.textCheckable}e.obj=i}else e.obj=n}!function(e){e[e.text=0]="text",e[e.task=1]="task",e[e.comment=2]="comment",e[e.folder=3]="folder",e[e.group=4]="group",e[e.groupFolder=5]="groupFolder",e[e.unit=6]="unit",e[e.assign=7]="assign",e[e.textList=8]="textList",e[e.textCheckable=9]="textCheckable",e[e.unitNote=10]="unitNote"}(O||(O={}));var S,A,P,T,F,V,R,_,D,B=n(13),U=n(11),L=n(10),q=(n(18),n(8)),M=n(12),z=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderContact=function(e,t){return o.a.createElement(h.UserView,{user:e,render:function(e){var n=e.name,r=e.nick,a=e.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-1-5c h-1-5c mr-2",src:a||".user-o"}),t||r||n)}})},e.renderContactItem=function(t,n){var r=t.contact,a=t.assigned;return o.a.createElement("div",{className:"px-3 py-2"},e.renderContact(r,a))},e}return Object(p.a)(n,[{key:"renderSelectedContact",value:function(e){var t=this;return e.map((function(e,n){var r=e.contact,a=e.assigned;return o.a.createElement("span",{key:n,className:"mr-3"},t.renderContact(r,a))}))}}]),n}(h.VPage),H=(S=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"anySelected",A,Object(U.a)(e)),Object(L.a)(e,"contacts",P,Object(U.a)(e)),Object(L.a)(e,"multiple",T,Object(U.a)(e)),e.list=void 0,e.options=void 0,e.buildRight=function(){var t;if(!0!==(null===(t=e.options)||void 0===t?void 0:t.single)){var n,r,a="btn btn-sm btn-success mr-1";return!1===e.multiple?o.a.createElement("button",{className:a,onClick:e.onToggleSelect},"\u591a\u9009"):e.contacts&&e.contacts.length>0?o.a.createElement("button",{className:a,onClick:e.onNext,disabled:!e.anySelected},null!==(n=null===(r=e.options)||void 0===r?void 0:r.action)&&void 0!==n?n:"\u9009\u4e2d","(",e.contacts.length,") ",o.a.createElement(h.FA,{name:"angle-right"})):o.a.createElement("button",{className:a,onClick:e.onToggleSelect},"\u5355\u9009")}},e.onToggleSelect=function(){e.multiple=!e.multiple},e.onContactSelect=function(t,n,r){e.anySelected=r,e.contacts=e.list.selectedItems},e.onContactClick=function(t){e.returnCall([t])},e.onNext=function(){e.returnCall(e.list.selectedItems)},e}return Object(p.a)(n,[{key:"init",value:function(e){this.options=e}},{key:"header",value:function(){var e,t;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.title)&&void 0!==e?e:"\u9009\u62e9"}},{key:"right",value:function(){return o.a.createElement(Object(M.a)(this.buildRight))}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n=e.controller.cApp.contacts;return t=!0===e.multiple?o.a.createElement(h.List,{ref:function(t){return e.list=t},items:n,item:{render:e.renderContactItem,onSelect:e.onContactSelect}}):o.a.createElement(h.List,{ref:function(t){return e.list=t},items:n,item:{render:e.renderContactItem,onClick:e.onContactClick}}),o.a.createElement("div",{className:""},t)})))}},{key:"back",get:function(){return"close"}}]),n}(z),A=Object(g.a)(S.prototype,"anySelected",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=Object(g.a)(S.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(g.a)(S.prototype,"multiple",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S),W=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).text={icon:"file-o",caption:e.t("noteText"),action:e.controller.showAddNoteTextPage,captionClass:"text-primary"},e.list={icon:"list",caption:e.t("noteList"),action:e.controller.showAddNoteListPage},e.checkable={icon:"check-square-o",caption:e.t("noteCheckable"),action:e.controller.showAddNoteCheckablePage},e.task={icon:"hand-pointer-o",caption:e.t("noteTask"),action:e.controller.showAddAssignPage,iconClass:"text-primary"},e.folder={icon:"folder",caption:e.t("noteFolder"),action:e.controller.showAddMyFolderPage,iconClass:"text-warning"},e.space={icon:"users",caption:e.t("noteCreateSpace"),action:e.controller.showAddGroupPage,iconClass:"text-danger"},e}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement(h.DropdownActions,{actions:this.dropdownActions,icon:"plus",itemIconClass:"text-info",className:"cursor-pointer btn btn-lg text-white p-1 mr-1"})}}]),n}(h.View),G=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"dropdownActions",get:function(){return[this.text,this.list,this.checkable,this.folder,void 0,this.space]}}]),n}(W),$=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"dropdownActions",get:function(){return[this.text,this.list,this.checkable,this.folder]}}]),n}(W),K=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"dropdownActions",get:function(){return[this.text,this.list,this.checkable,this.task,this.folder]}}]),n}(W),Q=n(25),J=n(22),X=n(19),Y=n(17),Z=(F=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).disableFrom=!1,Object(L.a)(e,"noteModel",V,Object(U.a)(e)),Object(L.a)(e,"noteItem",R,Object(U.a)(e)),Object(L.a)(e,"activeRelativeTab",_,Object(U.a)(e)),Object(L.a)(e,"caption",D,Object(U.a)(e)),e}return Object(p.a)(n,[{key:"init",value:function(e){this.noteItem=e}},{key:"lodeModel",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null===(t=this.owner.currentFold)||void 0===t?void 0:t.folderId,e.next=3,this.uqs.notes.GetNote.query({folder:n,note:this.noteItem.note});case 3:r=e.sent,(i=r.ret[0]).to=r.to,i.flow=r.flow,i.spawn=r.spawn,i.contain=r.contain,i.comments=r.comments,c=Object(B.a)(i.spawn);try{for(c.s();!(o=c.n()).done;)I(o.value)}catch(a){c.e(a)}finally{c.f()}this.noteModel=i;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"endContentInput",value:function(){return this.noteItem?Object(Q.a)({},this.noteItem.obj):{}}},{key:"showShareTo",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.owner.showShareTo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"SetNote",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(i.length>0&&void 0!==i[0])||i[0],n=this.endContentInput(),r=JSON.stringify(n),e.next=5,this.owner.editNote(t,this.noteItem,this.caption,r,n);case 5:this.updateChange();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateChange",value:function(){if(!this.noteItem)throw new Error("this.noteItem can not be undefined");this.noteItem.$update=new Date,this.caption&&this.caption!==this.noteItem.caption&&(this.noteItem.caption=this.caption),this.owner.itemChanged(this.noteItem)}},{key:"itemChanged",value:function(e){return this.noteItem.$update=e.$update,this.noteItem}},{key:"AddNote",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.endContentInput(),n=JSON.stringify(t),r=this.owner.currentFold.folderId,e.next=5,this.owner.addNote(r,this.caption,n,t,this.type);case 5:return i=e.sent,this.noteItem&&this.updateChange(),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isContentChanged",get:function(){return!1}},{key:"groupFolder",get:function(){if(this.noteItem){var e=this.noteItem.groupFolder;return e||this.noteItem.type!==O.groupFolder||(e=this.noteItem.note),e}}},{key:"isCaptionChanged",get:function(){var e;return this.caption!==(null===(e=this.noteItem)||void 0===e?void 0:e.caption)}},{key:"isNoteChanged",get:function(){return this.isContentChanged||this.isCaptionChanged}}]),n}(y),V=Object(g.a)(F.prototype,"noteModel",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(g.a)(F.prototype,"noteItem",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=Object(g.a)(F.prototype,"activeRelativeTab",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(g.a)(F.prototype,"caption",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(g.a)(F.prototype,"isNoteChanged",[q.g],Object.getOwnPropertyDescriptor(F.prototype,"isNoteChanged"),F.prototype),F);function ee(e,t){return o.a.createElement("span",{className:"fa-stack fa-lg"},o.a.createElement("i",{className:"fa fa-square-o fa-stack-2x "+t}),o.a.createElement("i",{className:"fa fa-stack-1x fa-"+e+" "+t}))}var te,ne,re,ae,ie,ce,oe,ue,se,le,he,de,fe,pe,ve,me,be,ye,ke,ge,we,Oe,je,xe,Ee,Ce=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).renderFrom=function(){var t=e.controller,n=t.noteItem,r=t.disableFrom;if(!n)return o.a.createElement("div",null,"noteItem undefined in renderFrom");var a=n.owner,i=n.assigned,c=n.from,u=c||a;if(!1===r&&!1===e.isMe(u)){return o.a.createElement("span",{className:"mr-3"},o.a.createElement(h.UserView,{user:u,render:function(e){var t,n=e.name,r=e.nick,a=e.icon,c="text-muted";return a&&(c+=" small",t=o.a.createElement(h.Image,{className:"w-1c h-1c mr-1",src:a})),o.a.createElement(o.a.Fragment,null,t," ",o.a.createElement("span",{className:c},i||r||n))}}))}},e.renderCommentFlag=function(){var t=e.controller.noteItem,n=t.commentCount,r=t.commentUnread;if(!(void 0===n||n<=0)){var a;if(r>0){var i=r>99?o.a.createElement(o.a.Fragment,null,"99",o.a.createElement("sup",null,"+")):r;a=o.a.createElement("div",{className:"unread-num"},i)}return o.a.createElement("span",{className:"mr-5 text-muted position-relative"},o.a.createElement(h.FA,{className:"mr-2",name:"comment-o"}),o.a.createElement("small",{className:""},n),a)}},e.onSendNote=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.cApp.loadRelation();case 2:e.controller.showShareTo();case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"content",value:function(){return this.renderBody()}},{key:"renderBody",value:function(){}},{key:"renderTopCaptionContent",value:function(){return o.a.createElement("div",{className:"bg-white"},this.renderTop(),o.a.createElement("div",{className:"py-2"},this.renderCaption(),this.renderContent()))}},{key:"renderTop",value:function(){return o.a.createElement("div",{className:"d-flex px-3 py-2 align-items-center border-top border-bottom bg-light"},this.renderIcon(),this.renderEditTime(),this.renderFrom())}},{key:"renderIcon",value:function(){}},{key:"renderEditTime",value:function(){var e,t,n=this.controller.noteItem,r=n.$create,a=n.$update;if(r&&a)return a.getTime()-r.getTime()>6e4?(t=o.a.createElement(h.FA,{className:"mr-1 text-info",name:"pencil"}),e=a):e=r,o.a.createElement("small",{className:"text-muted"},t,o.a.createElement("span",null,o.a.createElement(h.EasyTime,{date:e})))}},{key:"renderCaption",value:function(){var e=this.controller.caption;if(e)return o.a.createElement("div",{className:"pr-3"},o.a.createElement("div",null,o.a.createElement("b",null,e)))}},{key:"renderContent",value:function(){}},{key:"renderToCount",value:function(){var e=this.controller.noteItem.toCount;if(!(void 0===e||e<=0))return o.a.createElement("span",{className:"mr-5 text-muted"},o.a.createElement(h.FA,{className:"mr-2",name:"share"}),o.a.createElement("small",{className:""},e))}},{key:"renderSpawnCount",value:function(){var e=this.controller.noteItem.spawnCount;if(!(void 0===e||e<=0))return o.a.createElement("span",{className:"mr-5 text-muted"},o.a.createElement(h.FA,{className:"mr-2",name:"hand-pointer-o"}),o.a.createElement("small",{className:""},e))}},{key:"showActionEndPage",value:function(e){var t=this,n=e.content,r=e.onClick;this.openPage((function(){r=r||function(){return t.closePage()};var e=t.controller.caption;return o.a.createElement(h.Page,{header:e,back:"close"},o.a.createElement("div",{className:"border bg-white rounded m-5"},o.a.createElement("div",{className:"py-5 text-center"},n),o.a.createElement("div",{className:"border-top text-center py-3"},o.a.createElement("button",{className:"btn btn-outline-info",onClick:r},"\u8fd4\u56de"))))}))}},{key:"renderShareButton",value:function(){return o.a.createElement("span",{onClick:this.onSendNote,className:"cursor-pointer text-primary mr-5"},o.a.createElement(h.FA,{name:"share"}))}},{key:"renderEditButton",value:function(){var e=this;return o.a.createElement("span",{onClick:function(){return e.onEdit()},className:"cursor-pointer text-primary"},o.a.createElement(h.FA,{name:"pencil-square-o"}))}},{key:"renderStateSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===t?o.a.createElement("span",{className:"small text-danger"},o.a.createElement(h.FA,{className:"small mr-1",name:"stop"}),e):o.a.createElement("span",{className:"small text-success border border-success rounded px-2"},e)}},{key:"onEdit",value:function(){this.controller.showEditPage()}}]),n}(z),Ne=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderBody()}},{key:"renderBody",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:"d-block bg-white"},e.renderTopCaptionContent(),e.renderDirBottom())})))}},{key:"renderTopCaptionContent",value:function(){return o.a.createElement("div",{className:"bg-white"},this.renderTop(),o.a.createElement("div",{className:"py-2"},this.renderContent()))}},{key:"renderTop",value:function(){return o.a.createElement("div",{className:"d-flex pl-2 pr-3 py-2 border-top"},this.renderIcon(),o.a.createElement("div",null,this.renderCaption(),this.renderFrom()),o.a.createElement("div",{className:"ml-auto"},this.renderEditTime()))}},{key:"renderDirBottom",value:function(){var e=this.renderToCount(),t=this.renderSpawnCount(),n=this.renderCommentFlag();if(e||t||n)return o.a.createElement("div",{className:"d-flex align-items-center px-3 mb-1"},e,t,n,o.a.createElement("div",{className:"mr-auto"}))}},{key:"renderIcon",value:function(){var e;return this.controller.noteItem.unread>0&&(e=o.a.createElement("u",null)),o.a.createElement("div",{className:"mr-3 unread-dot"},this.controller.renderIcon(),e)}}]),n}(Ce),Ie=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderEditBottom",value:function(){var e=this;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex"},o.a.createElement("div",{className:"mr-auto"}),o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSave()},className:"btn btn-primary mr-3",disabled:!e.controller.isNoteChanged},"\u4fdd\u5b58"))}))),this.renderExButtons())}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.SetNote();case 2:this.closePage();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderExButtons",value:function(){}}]),n}(function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onCaptionChange=function(t){e.controller.caption=t.target.value.trim()},e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("notes")}},{key:"renderBody",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:"d-block"},e.renderTopCaptionContent(),e.renderEditBottom())})))}},{key:"renderTopCaptionContent",value:function(){return o.a.createElement("div",{className:""},this.renderCaptionInput(),o.a.createElement("div",{className:"mx-1 py-1 bg-white"},this.renderContent()))}},{key:"renderCaptionInput",value:function(){return o.a.createElement("div",{className:"py-2 px-1"},o.a.createElement("input",{type:"text",className:"w-100 border-0 form-control font-weight-bold",placeholder:"\u6807\u9898",maxLength:80,onChange:this.onCaptionChange,defaultValue:this.controller.caption}))}},{key:"renderEditBottom",value:function(){}},{key:"onDelete",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={caption:"\u8bf7\u786e\u8ba4",message:o.a.createElement("div",{className:"my-3"},o.a.createElement(h.FA,{name:"question-circle-o",size:"2x",className:"mr-3 text-danger"}),"\u771f\u7684\u8981\u5220\u9664\u8fd9\u4e2a\u5c0f\u5355\u5417\uff1f"),yes:"\u786e\u8ba4\u5220\u9664",no:"\u4e0d\u5220\u9664"},e.next=3,this.controller.confirm(t);case 3:if(e.t0=e.sent,"yes"!==e.t0){e.next=8;break}return e.next=7,this.controller.owner.hideNote(this.controller.noteItem.note,1);case 7:this.closePage(2);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderDeleteButton",value:function(){var e=this;return o.a.createElement("button",{className:"btn btn-outline-secondary mr-3",onClick:function(){return e.onDelete()}},"\u5220\u9664")}},{key:"back",get:function(){return"close"}}]),n}(Ce)),Se=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return this.t("notes")}},{key:"renderBody",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:"d-block"},e.renderTopCaptionContent(),e.renderViewBottom(),e.renderRelatives())})))}},{key:"renderTop",value:function(){var e;return!0===this.isMe(this.controller.noteItem.owner)&&(e=o.a.createElement("div",{className:"ml-auto"},this.renderEditButton())),o.a.createElement("div",{className:"d-flex px-3 py-3 border-top border-bottom bg-light"},this.renderIcon(),o.a.createElement("div",null,this.renderCaption(),o.a.createElement("div",{className:"d-flex align-items-center mt-1"},this.renderFrom(),o.a.createElement("span",{className:"mr-3"},this.renderEditTime()),e)))}},{key:"renderTopCaptionContent",value:function(){return o.a.createElement("div",{className:"bg-white"},this.renderTop(),o.a.createElement("div",{className:"py-2"},this.renderContent()))}},{key:"renderViewBottom",value:function(){return o.a.createElement("div",{className:"h-1c"})}},{key:"renderRelatives",value:function(){}},{key:"renderIcon",value:function(){return o.a.createElement("div",{className:"mr-3"},this.controller.renderIcon())}}]),n}(Ce),Ae=o.a.createElement("small",{className:"text-muted"},"[\u65e0]"),Pe=(te=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"hasError",ne,Object(U.a)(e)),Object(L.a)(e,"user",re,Object(U.a)(e)),e.onSearch=function(){var t=Object(i.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.userApi.fromKey(n);case 2:if(r=t.sent){t.next=6;break}return e.hasError=!0,t.abrupt("return");case 6:if(!e.controller.isMe(r.id)){t.next=8;break}return t.abrupt("return");case 8:e.user=r;case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFocus=function(){e.hasError=!1},e.onAddContact=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.addContact();case 2:e.closePage();case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){var e=this;return o.a.createElement("div",{className:"w-100 mr-1 d-flex"},o.a.createElement(h.SearchBox,{className:"flex-fill",onSearch:this.onSearch,onFocus:this.onFocus,placeholder:"\u641c\u7d22\u8054\u7cfb\u4eba"}),o.a.createElement("button",{className:"btn btn-sm btn-outline-info ml-1",onClick:function(){return e.closePage()}},"\u53d6\u6d88"))}},{key:"renderFields",value:function(){}},{key:"content",value:function(){var e=this,t=Object(M.a)((function(){if(!0===e.hasError)return o.a.createElement("div",{className:"p-4"},o.a.createElement(h.FA,{className:"text-danger mr-2",name:"times-circle"}),o.a.createElement(h.Muted,null,"\u8d26\u53f7\u4e0d\u5b58\u5728\u6216\u8005\u4e0d\u63a5\u53d7\u9080\u8bf7"));if(e.user){var t,n=e.user,r=n.name,a=n.nick,i=n.icon;return t=a?o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("b",null,a)),o.a.createElement("div",null,r)):o.a.createElement("div",null,o.a.createElement("b",null,r)),o.a.createElement("div",{className:"my-3 mx-3 border rounded"},o.a.createElement("div",{className:"p-4 d-flex bg-white rounded-top"},o.a.createElement(h.Image,{className:"w-3c h-3c mr-3",src:i||".user-o"}),t),e.renderFields(),o.a.createElement("div",{className:"py-3 px-4"},o.a.createElement("button",{className:"btn btn-primary",onClick:e.onAddContact},"\u589e\u52a0")))}}));return o.a.createElement(t)}}]),n}(h.VPage),ne=Object(g.a)(te.prototype,"hasError",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),re=Object(g.a)(te.prototype,"user",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te),Te=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tabShare={name:"share",visible:function(){return e.controller.noteItem.toCount>0},caption:function(t){var n,r=e.controller.noteItem.toCount;return r>0&&(n=o.a.createElement("small",null,r)),o.a.createElement(o.a.Fragment,null,o.a.createElement(h.FA,{className:"mr-2",name:"share"}),n)},render:function(){var t=e.controller.noteModel.to;if(t&&0!==t.length)return o.a.createElement("div",{className:"px-3 py-2"},o.a.createElement("small",{className:"text-muted mr-3"},"\u5df2\u5206\u4eab\u7ed9: "),t.map((function(t,n){var r=t.user,a=t.assigned;return o.a.createElement("span",{key:n,className:"mr-3"},e.renderContact(r,a))})))}},e.renderContact=function(e,t){return o.a.createElement(h.UserView,{user:e,render:function(e){var n=e.name,r=e.nick,a=e.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-1-5c h-1-5c mr-2",src:a||".user-o"}),t||r||n)}})},e}return Object(p.a)(n,[{key:"renderTabs",value:function(){var e=this,t=Object(M.a)((function(){var t=e.controller.activeRelativeTab,n=e.tabs.filter((function(e){var t;return null===(t=e.visible)||void 0===t?void 0:t.call(e)}));if(0!==n.length){var r=n.find((function(e){return e.name===t}));return r||(r=n[0]),o.a.createElement("div",{className:"bg-white"},o.a.createElement("div",{className:"d-flex px-3 pt-3"},n.map((function(t){var n=t.name,a=t.caption,i=t===r;return e.renderTab(i,n,a(i))}))),o.a.createElement("div",{className:"border-top",style:{marginTop:"-1px"}},r.render()||o.a.createElement("div",{className:"p-3"},Ae)))}}));return o.a.createElement(t)}},{key:"render",value:function(){return this.renderTabs()}},{key:"renderTab",value:function(e,t,n){var r=this,a=!0===e?" bg-white":" bg-light text-muted border-bottom";return o.a.createElement("div",{key:t,className:"border-left border-top border-right rounded-top px-3 py-2 cursor-pointer"+a,onClick:function(){return r.controller.activeRelativeTab=t}},n)}},{key:"tabs",get:function(){return[this.tabShare]}}]),n}(Ce),Fe=(ae=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"changed",ie,Object(U.a)(e)),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"toString",value:function(){}},{key:"fromString",value:function(e){}},{key:"startInput",value:function(){this.changed=!1}},{key:"endInput",value:function(e){this.buildObj(e)}},{key:"renderDirContent",value:function(){return this.renderViewContent()}},{key:"reset",value:function(e){this.fromString(e),this.startInput(),this.changed=!0}},{key:"isEmpty",get:function(){return!0}}]),n}(h.Controller),ie=Object(g.a)(ae.prototype,"changed",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ae),Ve=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.doneItems,n=t.uncheckedItems,r=t.checkedItems;return o.a.createElement("div",{className:"mb-2"},n.map((function(t,n){return e.renderCheckItem(t)})),e.renderCheckedItems(r))})))}}]),n}(h.View),Re=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderCheckItem",value:function(e){var t,n=this,r=e.key,a=e.text,i=e.checked,c="ml-3 ";return!0===i?(c+="text-muted ",t=o.a.createElement("del",null,a)):t=a,o.a.createElement("label",{key:r,className:"d-flex mx-3 align-items-center form-check mb-0"},o.a.createElement("input",{className:"form-check-input mr-3 mt-0",type:"checkbox",defaultChecked:i,"data-key":r,onChange:function(t){return n.onCheckChange(e,t.currentTarget.checked)}}),o.a.createElement("div",{className:"form-control-plaintext "+c},t))}},{key:"onCheckChange",value:function(e,t){e.checked=t}},{key:"renderCheckedItems",value:function(e){var t=this,n=e.length;if(n>0)return o.a.createElement("div",{className:"border-top py-2"},o.a.createElement("div",{className:"px-3 pt-2 small text-muted"},n,"\u9879\u5b8c\u6210"),e.map((function(e,n){return t.renderCheckItem(e)})))}}]),n}(Ve),_e=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderCheckItem",value:function(e){var t,n,r=e.key,a=e.text,i="ml-3 ";return!0===e.checked?(i+="text-muted ",t=o.a.createElement("del",null,a),n="check-square"):(t=a,n="square-o"),o.a.createElement("div",{key:r,className:"d-flex mx-3 align-items-center"},o.a.createElement(h.FA,{name:n}),o.a.createElement("div",{className:"py-1 "+i},t))}},{key:"renderCheckedItems",value:function(e){var t=this;if(e.length>0)return o.a.createElement("div",{className:""},e.map((function(e,n){return t.renderCheckItem(e)})))}}]),n}(Ve),De=(ce=function(){function e(t){var n=this;Object(f.a)(this,e),this.props=void 0,Object(L.a)(this,"focusables",oe,this),this.currentFocusable=void 0,this.inputingText=void 0,this.focuseTimeout=void 0,this.renderItem=function(e){return!0===e.focused?n.renderInputItem(e):n.renderTextItem(e)},this.onAddNewEnter=function(e){13===e.keyCode&&(e.currentTarget.value="",n.addNewItem())},this.input=void 0,this.onKeyDown=function(e){13===e.keyCode&&(n.currentFocusable.focused=!1,e.currentTarget.value="",n.inputingText=void 0,n.currentFocusable=void 0)},this.onBlur=function(e){n.currentFocusable.focused=!1,n.currentFocusable=void 0},this.onChange=function(e){var t=e.target.value;n.inputingText=t,n.currentFocusable&&n.setItemText(n.currentFocusable.item,t),n.props.onChanged()},this.inputRef=function(e){e&&"hidden"!==window.getComputedStyle(e).visibility&&(n.input=e)},this.onBlurAddNew=function(e){e.currentTarget.value="",n.addNewItem()},this.props=t;var r=t.items;this.focusables=r?r.map((function(e){return{item:Object(q.o)(e),focused:!1}})):[]}return Object(p.a)(e,[{key:"getList",value:function(){return this.focusables.map((function(e){return Object(q.o)(e.item)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",null,e.focusables.map(e.renderItem),e.renderNewInput())})))}},{key:"renderTextItem",value:function(e){var t=this,n=e.item,r=this.getItemKey(n),a=this.getItemText(n);return o.a.createElement("div",{key:r,className:"d-flex mr-3 align-items-stretch"},this.renderItemHeader(n),o.a.createElement("div",{className:"flex-fill py-2",onMouseDown:function(){return t.onItemClick(e)}},a))}},{key:"renderItemHeader",value:function(e){return o.a.createElement("span",null,"item")}},{key:"onItemClick",value:function(e){var t=this;this.currentFocusable&&(this.currentFocusable.focused=!1),this.currentFocusable=e,e.focused=!0,this.focuseTimeout&&(clearTimeout(this.focuseTimeout),this.focuseTimeout=void 0),this.focuseTimeout=setTimeout((function(){var e;null===(e=t.input)||void 0===e||e.focus(),console.log("this.input "+(t.input?"null":"focus"))}),10)}},{key:"renderInputItem",value:function(e){var t=e.item,n=this.getItemKey(t);return o.a.createElement("div",{key:n,className:"d-flex mr-3 align-items-stretch"},this.renderItemHeader(t),this.renderInput(e))}},{key:"renderInput",value:function(e){return o.a.createElement("input",{type:"text",className:"flex-fill form-control",defaultValue:this.getItemText(null===e||void 0===e?void 0:e.item),ref:this.inputRef,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onChange:this.onChange})}},{key:"renderNewInput",value:function(){return o.a.createElement("div",{className:"d-flex mr-3 my-2 align-items-center"},o.a.createElement("div",{className:"w-3c w-min-3c w-max-3c text-center"},o.a.createElement(h.FA,{name:"plus",className:"text-info mt-1",fixWidth:!0})),o.a.createElement("input",{className:"flex-fill form-control",type:"text",placeholder:"\u65b0\u589e",onBlur:this.onBlurAddNew,onChange:this.onChange,onKeyDown:this.onAddNewEnter}))}},{key:"addNewItem",value:function(){this.inputingText&&0!==this.inputingText.trim().length&&(this.focusables.push({item:this.newItem(this.props.uniqueKey(),this.inputingText.trimRight()),focused:!1}),this.inputingText=void 0)}}]),e}(),oe=Object(g.a)(ce.prototype,"focusables",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce),Be=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onCheckChange=function(t,n){t.checked=n,e.props.onChanged()},e}return Object(p.a)(n,[{key:"getItemKey",value:function(e){return e.key}},{key:"getItemText",value:function(e){return null===e||void 0===e?void 0:e.text}},{key:"setItemText",value:function(e,t){e&&(e.text=t)}},{key:"newItem",value:function(e,t){return{key:e,text:t,checked:!1}}},{key:"renderItemHeader",value:function(e){var t=this;return o.a.createElement("label",{className:"w-3c w-min-3c w-max-3c text-center mb-0"},o.a.createElement("input",{className:"mt-3",type:"checkbox",defaultChecked:e.checked,onChange:function(n){return t.onCheckChange(e,n.currentTarget.checked)}}))}}]),n}(De),Ue=(ue=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).listInput=void 0,Object(L.a)(e,"items",se,Object(U.a)(e)),e.itemKey=1,e}return Object(p.a)(n,[{key:"init",value:function(e){e&&(this.itemKey=e.itemKey,this.items=e.items)}},{key:"startInput",value:function(){var e=this;Object(X.a)(Object(Y.a)(n.prototype),"startInput",this).call(this),this.listInput=new Be({items:this.items,uniqueKey:function(){return e.itemKey++},onChanged:function(){return e.changed=!0}})}},{key:"renderInput",value:function(){return this.listInput.render()}},{key:"renderViewContent",value:function(){return this.renderView(Re)}},{key:"renderDirContent",value:function(){return this.renderView(_e)}},{key:"endInput",value:function(e){this.items=this.listInput.getList(),this.buildObj(e)}},{key:"buildObj",value:function(e){e.itemKey=this.itemKey,e.items=this.items,delete e.content}},{key:"toString",value:function(){var e;return null===(e=this.items)||void 0===e?void 0:e.map((function(e){return e.text})).join("\n")}},{key:"fromString",value:function(e){var t,n=this;e&&(this.items=[],this.itemKey=1,(t=this.items).push.apply(t,Object(J.a)(e.split("\n").filter((function(e,t){return e.trim().length>0})).map((function(e,t){return{key:n.itemKey++,text:e,checked:!1}})))))}},{key:"isEmpty",get:function(){return 0===this.listInput.getList().length}},{key:"doneItems",get:function(){var e,t=[],n=[],r=Object(B.a)(this.items);try{for(r.s();!(e=r.n()).done;){var a=e.value;!0===a.checked?n.push(a):t.push(a)}}catch(i){r.e(i)}finally{r.f()}return{uncheckedItems:t,checkedItems:n}}}]),n}(Fe),se=Object(g.a)(ue.prototype,"items",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(g.a)(ue.prototype,"doneItems",[q.g],Object.getOwnPropertyDescriptor(ue.prototype,"doneItems"),ue.prototype),ue),Le=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.items;return o.a.createElement("ul",{className:"note-content-list px-3 my-2"},t.map((function(e,t){var n=e.key,r=e.text;return o.a.createElement("li",{key:n,className:"ml-3 pt-1 pb-2 align-items-center"},r)})))})))}}]),n}(h.View),qe=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"getItemKey",value:function(e){return e.key}},{key:"getItemText",value:function(e){return null===e||void 0===e?void 0:e.text}},{key:"setItemText",value:function(e,t){e&&(e.text=t)}},{key:"newItem",value:function(e,t){return{key:e,text:t}}},{key:"renderItemHeader",value:function(e){return o.a.createElement("div",{className:"w-3c w-min-3c w-max-3c pt-2 text-center"},"\u25cf")}}]),n}(De),Me=(le=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).listInput=void 0,Object(L.a)(e,"items",he,Object(U.a)(e)),e.itemKey=1,e}return Object(p.a)(n,[{key:"init",value:function(e){this.itemKey=e.itemKey,this.items=e.items}},{key:"startInput",value:function(){var e=this;Object(X.a)(Object(Y.a)(n.prototype),"startInput",this).call(this),this.listInput=new qe({items:this.items,uniqueKey:function(){return e.itemKey++},onChanged:function(){return e.changed=!0}})}},{key:"renderInput",value:function(){return this.listInput.render()}},{key:"renderViewContent",value:function(){return this.renderView(Le)}},{key:"endInput",value:function(e){this.items=this.listInput.getList(),this.buildObj(e)}},{key:"buildObj",value:function(e){e.itemKey=this.itemKey,e.items=this.items,delete e.content}},{key:"toString",value:function(){var e;return null===(e=this.items)||void 0===e?void 0:e.map((function(e){return e.text})).join("\n")}},{key:"fromString",value:function(e){var t,n=this;e&&(this.items=[],this.itemKey=1,(t=this.items).push.apply(t,Object(J.a)(e.split("\n").filter((function(e,t){return e.trim().length>0})).map((function(e,t){return{key:n.itemKey++,text:e}})))))}},{key:"isEmpty",get:function(){return 0===this.items.length}}]),n}(Fe),he=Object(g.a)(le.prototype,"items",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),le),ze=(de=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"noteContent",fe,Object(U.a)(e)),Object(L.a)(e,"changedNoteContent",pe,Object(U.a)(e)),e}return Object(p.a)(n,[{key:"init",value:function(e){var t;switch(typeof e){default:case"undefined":break;case"string":this.noteContent=e.trim();break;case"object":this.noteContent=null===(t=e.content)||void 0===t?void 0:t.trim()}}},{key:"endInput",value:function(e){void 0!==this.changedNoteContent&&(this.noteContent=this.changedNoteContent,this.changedNoteContent=void 0),this.buildObj(e)}},{key:"buildObj",value:function(e){e.content=this.changedNoteContent||this.noteContent,delete e.itemKey,delete e.items}},{key:"isEmpty",get:function(){return void 0===this.noteContent||0===this.noteContent.trim().length}}]),n}(Fe),fe=Object(g.a)(de.prototype,"noteContent",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=Object(g.a)(de.prototype,"changedNoteContent",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de),He=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"px-3 my-2"},this.renderParagraphs(this.controller.noteContent))}},{key:"renderParagraphs",value:function(e){return it(e)}}]),n}(h.View),We=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onContentChange=function(t){e.controller.changedNoteContent=t.target.value,e.controller.changed=!0},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"py-1 px-1"},o.a.createElement(Object(M.a)((function(){return e.renderContentTextArea()}))))}},{key:"renderContentTextArea",value:function(){return o.a.createElement("textarea",{rows:10,className:"w-100 border-0 form-control",placeholder:this.t("content"),maxLength:2e4,defaultValue:this.controller.noteContent,onChange:this.onContentChange})}}]),n}(h.View),Ge=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(We),$e=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"px-3 my-2"},this.renderParagraphs(this.controller.noteContent))}}]),n}(He),Ke=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderInput",value:function(){return this.renderView(Ge)}},{key:"renderViewContent",value:function(){return this.renderView($e)}},{key:"toString",value:function(){return this.changedNoteContent||this.noteContent}},{key:"fromString",value:function(e){this.noteContent=e.trim()}}]),n}(ze),Qe=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(We),Je=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(He),Xe=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderInput",value:function(){return this.renderView(Qe)}},{key:"renderViewContent",value:function(){return this.renderView(Je)}}]),n}(ze),Ye=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u5df2\u53d1\u9001"}},{key:"content",value:function(){var e=this;return o.a.createElement("div",{className:"m-5 border rounded bg-white"},o.a.createElement("div",{className:"p-5 text-center border-bottom"},"\u5df2\u53d1\u9001"),o.a.createElement("div",{className:"text-center py-3"},o.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.backPage()}},"\u8fd4\u56de")))}},{key:"back",get:function(){return"close"}}]),n}(z),Ze=(ve=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"anyChanged",me,Object(U.a)(e)),e.list=void 0,e.onContactSelect=function(t,n,r){var a=t.already;(!0===n&&0===a||!1===n&&a>0)&&(e.anyChanged=!0)},e.onNext=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.list.selectedItems,t.next=3,e.controller.onContactsSelected(n);case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u6536\u4ef6\u4eba"}},{key:"right",value:function(){var e=this,t=Object(M.a)((function(){return o.a.createElement("button",{className:"btn btn-sm btn-primary mr-1",onClick:e.onNext,disabled:!e.anyChanged},"\u4e0b\u4e00\u6b65 ",o.a.createElement(h.FA,{name:"angle-right"}))}));return o.a.createElement(t)}},{key:"content",value:function(){var e=this,t=this.controller.groupContacts;return o.a.createElement("div",{className:""},o.a.createElement(h.List,{ref:function(t){return e.list=t},items:t,item:{render:this.renderContactItem,onSelect:this.onContactSelect},isItemSelected:function(e){return e.already}}))}},{key:"back",get:function(){return"close"}}]),n}(z),me=Object(g.a)(ve.prototype,"anyChanged",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ve),et=(be=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r,c){var o;return Object(f.a)(this,n),(o=t.call(this,e)).currentGroupFolder=void 0,o.currentNoteItem=void 0,Object(L.a)(o,"groupContacts",ye,Object(U.a)(o)),Object(L.a)(o,"contacts",ke,Object(U.a)(o)),o.onSendOut=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.contacts.map((function(e){var t=e.contact;if(t)return"object"===typeof t?t.id:t})),e.next=3,o.sendOut(t);case 3:o.popToTopPage(),o.openVPage(Ye);case 5:case"end":return e.stop()}}),e)}))),o.currentGroupFolder=r,o.currentNoteItem=c,o}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetContacts.page({groupFolder:this.currentGroupFolder,note:this.currentNoteItem.note},0,50,!0);case 2:t=e.sent,this.groupContacts=t.$page,this.startAction(),this.openVPage(Ze);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onContactsSelected",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.contacts=t,e.next=3,this.afterContactsSelected();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b),ye=Object(g.a)(be.prototype,"groupContacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke=Object(g.a)(be.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be),tt=(ge=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"anySelected",we,Object(U.a)(e)),Object(L.a)(e,"contacts",Oe,Object(U.a)(e)),Object(L.a)(e,"multiple",je,Object(U.a)(e)),e.list=void 0,e.options=void 0,e.buildRight=function(){var t;if(!0!==(null===(t=e.options)||void 0===t?void 0:t.single)){var n,r,a="btn btn-sm btn-success mr-1";return!1===e.multiple?o.a.createElement("button",{className:a,onClick:e.onToggleSelect},"\u591a\u9009"):e.contacts&&e.contacts.length>0?o.a.createElement("button",{className:a,onClick:e.onNext,disabled:!e.anySelected},null!==(n=null===(r=e.options)||void 0===r?void 0:r.action)&&void 0!==n?n:"\u9009\u4e2d","(",e.contacts.length,") ",o.a.createElement(h.FA,{name:"angle-right"})):o.a.createElement("button",{className:a,onClick:e.onToggleSelect},"\u5355\u9009")}},e.onToggleSelect=function(){e.multiple=!e.multiple},e.onContactSelect=function(t,n,r){e.anySelected=r,e.contacts=e.list.selectedItems},e.onContactClick=function(t){e.returnCall([t])},e.onNext=function(){e.returnCall(e.list.selectedItems)},e}return Object(p.a)(n,[{key:"init",value:function(e){this.options=e}},{key:"header",value:function(){var e,t;return null!==(e=null===(t=this.options)||void 0===t?void 0:t.title)&&void 0!==e?e:"\u9009\u62e9"}},{key:"right",value:function(){return o.a.createElement(Object(M.a)(this.buildRight))}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n=e.controller.contacts;return t=!0===e.multiple?o.a.createElement(h.List,{ref:function(t){return e.list=t},items:n,item:{render:e.renderContactItem,onSelect:e.onContactSelect}}):o.a.createElement(h.List,{ref:function(t){return e.list=t},items:n,item:{render:e.renderContactItem,onClick:e.onContactClick}}),o.a.createElement("div",{className:""},t)})))}},{key:"back",get:function(){return"close"}}]),n}(z),we=Object(g.a)(ge.prototype,"anySelected",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Oe=Object(g.a)(ge.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=Object(g.a)(ge.prototype,"multiple",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ge),nt=(xe=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"contacts",Ee,Object(U.a)(e)),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadContacts();case 2:this.openVPage(tt);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"SetContacts",value:function(e){this.contacts=[];var t,n=Object(B.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=Object(Q.a)({},r);this.contacts.push(a)}}catch(i){n.e(i)}finally{n.f()}}},{key:"callSelectContact",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.vCall(tt,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b),Ee=Object(g.a)(xe.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe),rt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).hourminutes=void 0,e.onHoursChange=function(t){var n=C(t.target.value);n<0&&(n=void 0),e.hourminutes=n},e.onHoursBlur=function(t){C(t.target.value)<0&&(t.target.value="",e.hourminutes=void 0)},e.onNext=function(){var t=void 0!==e.hourminutes?e.hourminutes:e.controller.hourminutes;e.returnCall(t)},e}return Object(p.a)(n,[{key:"header",value:function(){return"\u8f93\u5165\u5de5\u65f6"}},{key:"content",value:function(){var e=this,t=function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"flex-fill ml-2 mr-2 mt-2 "},o.a.createElement("input",{className:"flex-fill form-control border-0",type:"text",defaultValue:N(e.controller.hourminutes),placeholder:"2.5\u6216\u80052:30\u8868\u793a\u4e24\u4e2a\u534a\u5c0f\u65f6",autoFocus:!0,onBlur:function(t){return e.onHoursBlur(t)},onChange:function(t){return e.onHoursChange(t)}})),o.a.createElement("button",{onClick:function(){return e.onNext()},className:"btn btn-primary ml-2 mt-2"},"\u786e\u8ba4"))};return o.a.createElement(t)}},{key:"back",get:function(){return"close"}}]),n}(z),at=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).hourminutes=void 0,e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(rt);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"inputHours",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hourminutes=t,e.next=3,this.vCall(rt);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b);function it(e){if(e)return o.a.createElement(o.a.Fragment,null,e.trimRight().split("\n").map((function(e,t){var n;if(e){n="";for(var r=e.length,a=0;a<r;a++){switch(e.charCodeAt(a)){case 32:n+="\u2000";continue}break}n+=e.substr(a)}else n="\xa0";return o.a.createElement("div",{key:t,className:"pt-1 pb-2"},n)})))}var ct,ot,ut,st,lt,ht,dt,ft,pt,vt,mt,bt,yt,kt,gt,wt,Ot,jt,xt,Et,Ct,Nt,It,St=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).noteKey=function(e){return e.noteItem.note},e.renderItemInFolder=function(e,t){return o.a.createElement("div",{className:"d-block mb-2 bg-white"},e.renderDirItem(t))},e}return Object(p.a)(n,[{key:"afterBack",value:function(){this.controller.owner.popFolder()}},{key:"header",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.noteItem;return t?t.caption:e.t("notes")})))}},{key:"right",value:function(){return this.controller.owner.renderFolderDropDown()}},{key:"top",value:function(){var e=this,t=this.controller.noteItem;if(t){var n,r,a=t.content,i=JSON.parse(a);if(i){var c=i.content;n=null===c||void 0===c?void 0:c.trimEnd()}else n="\u6574\u7406\u5c0f\u5355";if(this.isMe(this.controller.noteItem.owner))r=o.a.createElement(o.a.Fragment,null,o.a.createElement(h.FA,{className:"mr-3 text-warning py-3",name:t.toCount>0?"folder-open":"folder",size:"3x"}),o.a.createElement("div",{className:"small text-muted py-3"},this.renderParagraphs(n)));else{var u=t.owner,s=t.assigned;r=o.a.createElement(h.UserView,{user:u,render:function(t){var r=t.name,a=t.nick,i=t.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-3c h-3c mr-2 my-3",src:i||".user-o"}),o.a.createElement("div",{className:"py-3"},o.a.createElement("div",{className:"small"},s||a||r),o.a.createElement("div",{className:"small text-muted py-3"},e.renderParagraphs(n))))}})}return o.a.createElement("div",{className:"d-flex ml-3"},r,o.a.createElement("div",{className:"ml-auto align-self-stretch cursor-pointer px-3 d-flex align-items-center",onClick:function(t){t.stopPropagation(),e.controller.showFolderView()}},o.a.createElement(h.FA,{name:"ellipsis-h"})))}}},{key:"content",value:function(){var e=this,t=this.controller,n=t.notesPager,r=t.showNoteItem;return o.a.createElement("div",null,o.a.createElement(Object(M.a)((function(){return e.top()}))),o.a.createElement(h.List,{className:"",items:n,item:{render:this.renderItemInFolder,key:this.noteKey,onClick:r,className:"notes"}}))}},{key:"renderParagraphs",value:function(e){return it(e)}},{key:"renderListView",value:function(){return this.content()}}]),n}(Ce),At=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n,r=e.controller.noteItem,a=r.toCount,i=r.unread;a>0&&(t=o.a.createElement("small",{className:"ml-4 text-muted"},o.a.createElement(h.FA,{name:"share",className:"mr-1"}),a)),i>0&&(n=o.a.createElement("u",null));var c=o.a.createElement("div",{className:"unread-dot mr-3"},o.a.createElement(h.FA,{name:"folder",className:"text-warning",size:"lg",fixWidth:!0}),n);return o.a.createElement("div",{className:"d-block bg-white"},o.a.createElement("div",{className:"d-flex px-3 py-2 align-items-center"},c,o.a.createElement("b",{className:""},r.caption),t))})))}}]),n}(Ce),Pt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"tabs",get:function(){return[this.tabShare]}}]),n}(Te),Tt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.noteItem;return t?t.caption:e.t("notes")})))}},{key:"renderRelatives",value:function(){return this.renderVm(Pt)}},{key:"renderContent",value:function(){return this.controller.cContent.renderViewContent()}},{key:"back",get:function(){return"close"}}]),n}(Se),Ft=(ct=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"cContent",ot,Object(U.a)(e)),e.folderId=void 0,e.notesPager=void 0,e.currentNoteItem=void 0,e.showNoteItem=function(){var t=Object(i.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=e.currentNoteItem=n.noteItem).unread=0,r.commentUnread=0,t.next=5,n.lodeModel();case 5:return t.abrupt("return",n.showViewPage());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"init",value:function(e){var t;Object(X.a)(Object(Y.a)(n.prototype),"init",this).call(this,e),this.cContent=new Xe(this.res),e&&(this.caption=e.caption,this.cContent.init(e.obj));var r=null===(t=this.noteItem)||void 0===t?void 0:t.note;this.folderId=r||-Ea.notes,this.notesPager=new h.QueryPager(this.uqs.notes.GetNotes,void 0,void 0,!0),this.notesPager.setItemConverter(this.getItemConverter())}},{key:"getItemConverter",value:function(){return this.owner.noteItemConverter}},{key:"load",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.notesPager.first({folderId:this.folderId,withX:0});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new h.QueryPager(this.uqs.notes.GetNotes,5,5,!1),e.next=3,t.first({folderId:this.folderId,withX:1});case 3:if(n=t.items)for(r=n.length,i=this.notesPager.items,c=function(e){var t=n[e],r=t.note,a=t.x,c=i.findIndex((function(e){return e.noteItem.note===r}));if(c>=0&&i.splice(c,1),0===a){var o=u.owner.noteItemConverter(t,void 0);i.unshift(o)}},o=r-1;o>=0;--o)c(o);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"itemChanged",value:function(e){var t=this.notesPager.items,n=t.findIndex((function(t){return t.noteItem===e}));if(n>0){var r=t.splice(n,1);t.unshift.apply(t,Object(J.a)(r))}return this.noteItem}},{key:"renderListView",value:function(){return new St(this).renderListView()}},{key:"showViewPage",value:function(){this.owner.openFolder(this)}},{key:"showFolderView",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.noteItem){e.next=3;break}return e.abrupt("return");case 3:return t.unread=0,t.commentUnread=0,e.next=7,this.lodeModel();case 7:this.showFolderViewPage();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showFolderViewPage",value:function(){this.openVPage(Tt)}},{key:"addNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i,c){var o,u,s,l,h,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 0,o={groupFolder:this.groupFolder,folder:t,caption:n,content:r,type:c,sub:0},e.next=4,this.uqs.notes.AddNote.submit(o);case 4:return u=e.sent,s=u.note,l=new Date,h={seconds:void 0,owner:this.user.id,note:s,type:c,caption:n,content:r,x:0,assigned:void 0,from:void 0,fromAssigned:void 0,state:void 0,unread:0,obj:i,$create:l,$update:l},c===O.folder&&(h.groupFolder=this.groupFolder),(d=this.owner.createCNoteBase(h)).init(h),t===this.folderId&&this.notesPager.items.unshift(d),e.abrupt("return",d);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"editNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i,c){var o,u,s,l,h,d,f,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this.uqs.notes.SetNote,s=n.note,l=n.type,e.next=4,u.submit({note:s,caption:r,content:i,type:l},t);case 4:s===(null===(o=this.noteItem)||void 0===o?void 0:o.note)?(this.noteItem.caption=r,this.noteItem.content=i,this.noteItem.obj=c):(h=this.notesPager.items,(d=h.findIndex((function(e){return e.noteItem.note===s})))>=0&&(f=h.splice(d,1),(p=f[0]).noteItem.caption=r,p.noteItem.content=i,p.noteItem.obj=c,h.unshift(p)));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"hideNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.HideNote.submit({note:t,x:n});case 2:(r=this.notesPager.items.findIndex((function(e){return e.noteItem.note===t})))>=0&&this.notesPager.items.splice(r,1);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderDirItem",value:function(e){return new At(this).render()}},{key:"addGroup",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){var i,c,o,u,s,l,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.AddGroup.submit({caption:t,content:n,members:r});case 2:return i=e.sent,c=i.group,o=i.folder,u=new Date,s=O.groupFolder,l={seconds:void 0,owner:this.user.id,note:o,type:s,caption:t,content:n,x:0,assigned:void 0,from:void 0,fromAssigned:void 0,state:void 0,groupFolder:c,unread:0,obj:void 0,$create:u,$update:u},(h=this.owner.createCNoteBase(l)).init(l),this.notesPager.items.unshift(h),e.abrupt("return",h);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"taskUpdateState",value:function(e){var t=this.notesPager.items,n=e.note,r=t.findIndex((function(e){return e.noteItem.note===n}));if(r>=0){t.splice(r,1);var a=this.getItemConverter()(e,void 0);t.unshift(a)}}},{key:"isContentChanged",get:function(){return this.cContent.changed}}]),n}(Z),ot=Object(g.a)(ct.prototype,"cContent",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(g.a)(ct.prototype,"isContentChanged",[q.g],Object.getOwnPropertyDescriptor(ct.prototype,"isContentChanged"),ct.prototype),ct),Vt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n=e.controller.noteItem,r=n.toCount,a=n.unread;return r>0&&(t=o.a.createElement("small",{className:"ml-4 text-muted"},o.a.createElement(h.FA,{name:"share",className:"mr-1"}),r)),o.a.createElement("div",{className:"d-block bg-white"},o.a.createElement("div",{className:"d-flex pl-2 pr-3 py-2 align-items-center"},o.a.createElement("div",{className:"unread-dot mr-3"},ee("users","text-warning"),a>0&&o.a.createElement("u",null)),o.a.createElement("b",{className:"text-primary"},n.caption),t))})))}}]),n}(Ce),Rt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u7a7a\u95f4\u6210\u5458"}},{key:"right",value:function(){return o.a.createElement("div",{className:"cursor-pointer btn btn-lg text-white p-1 mr-1",onClick:this.controller.showAddMember},o.a.createElement(h.FA,{name:"plus"}))}},{key:"content",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"text-success px-3 py-2 bg-white border-bottom"},"[\u81ea\u5df1]"),o.a.createElement(h.List,{items:this.controller.members,item:{render:this.renderContactItem}}))}}]),n}(z),_t=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.noteItem,n=t?t.caption:e.t("noteSpace");return o.a.createElement("div",null,n)})))}},{key:"right",value:function(){return this.isMe(this.controller.groupOwner)?new Dt(this.controller.owner,this.controller).render():this.controller.owner.renderSpaceDropDown()}},{key:"top",value:function(){var e=this.controller.noteItem;if(e){var t="\u7fa4",n=e.content;if(n){var r=JSON.parse(n);if(r){var a=r.content;t=(t=null===a||void 0===a?void 0:a.trimEnd()).replace(/(\r|\n)/g," ")}}return o.a.createElement("div",{className:"px-3 py-3 d-flex cursor-pointer align-items-center",onClick:this.controller.showSpaceContent},o.a.createElement(h.FA,{className:"mr-3 mt-1 text-warning",name:"users",size:"2x"}),o.a.createElement("div",{className:"text-muted mr-3",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},t))}}}]),n}(St),Dt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;return Object(f.a)(this,n),(a=t.call(this,e)).cSpace=void 0,a.cSpace=r,a}return Object(p.a)(n,[{key:"dropdownActions",get:function(){var e={icon:"user-o",caption:this.t("\u6210\u5458\u589e\u51cf"),action:this.cSpace.showAddMember,iconClass:"text-success"};return[this.text,this.list,this.checkable,this.task,this.folder,void 0,e]}}]),n}(W),Bt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return this.t("noteFolder")}},{key:"renderContent",value:function(){return this.controller.cContent.renderInput()}}]),n}(Ie),Ut=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u7f16\u8f91\u7a7a\u95f4"}},{key:"renderEditBottom",value:function(){var e=this;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex"},o.a.createElement("div",{className:"mr-auto"}),o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSave()},className:"btn btn-primary mr-3",disabled:!e.controller.isNoteChanged},"\u4fdd\u5b58"))}))))}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.SetGroup();case 2:this.closePage();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"back",get:function(){return"close"}}]),n}(Bt),Lt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u8be6\u60c5"}},{key:"right",value:function(){var e;return this.isMe(this.controller.groupOwner)&&(e=o.a.createElement("span",{className:"mr-2"},this.renderEditButton())),e}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.noteItem;if(t){var n,r="\u7a7a\u95f4",a=t.caption,i=t.content;if(i){var c=JSON.parse(i);if(c){var u=c.content;r=null===u||void 0===u?void 0:u.trimEnd()}}n=o.a.createElement("div",{className:""},o.a.createElement("div",{className:"d-flex py-3 px-3"},o.a.createElement(h.FA,{className:"mr-3 text-warning",name:"users",size:"2x"}),o.a.createElement("div",null,a)),o.a.createElement("div",{className:"bg-white px-3 py-2"},it(r)));var s=e.controller.memberCount,l=e.controller.members.filter((function(e,t){return 1===e.already}));return o.a.createElement("div",null,n,o.a.createElement("div",{className:"d-flex mt-2 align-items-end"},o.a.createElement("div",{className:"ml-3 mb-2 small text-muted"},s,"\u6210\u5458"),e.isMe(e.controller.groupOwner)?o.a.createElement("div",{className:"ml-auto cursor-pointer text-success border border-success rounded bg-white px-1 mr-2 mb-1",onClick:e.controller.showAddMember},o.a.createElement(h.FA,{name:"plus"})):void 0),o.a.createElement("div",null,o.a.createElement("div",{className:"text-success px-3 py-2 bg-white border-bottom"},"[\u81ea\u5df1]"),l.length>0&&o.a.createElement(h.List,{items:l,item:{render:e.renderContactItem}})))}})))}}]),n}(Ce),qt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onContactSelect=function(t,n,r){e.controller.selectMember(t,n)},e}return Object(p.a)(n,[{key:"header",value:function(){return"\u9009\u62e9\u6210\u5458"}},{key:"content",value:function(){return o.a.createElement("div",null,o.a.createElement(h.List,{items:this.controller.contacts,item:{render:this.renderContactItem,onSelect:this.onContactSelect},isItemSelected:function(e){return e.already>0}}))}}]),n}(z),Mt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u65b0\u5efa\u7fa4"}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.addGroup();case 2:return this.closePage(),e.abrupt("return");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ut),zt=(ut=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).groupId=void 0,e.groupOwner=void 0,Object(L.a)(e,"memberCount",st,Object(U.a)(e)),Object(L.a)(e,"members",lt,Object(U.a)(e)),Object(L.a)(e,"contacts",ht,Object(U.a)(e)),e.showMembers=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadMembers();case 2:e.openVPage(Rt);case 3:case"end":return t.stop()}}),t)}))),e.showSpaceContent=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadMembers();case 2:e.openVPage(Lt);case 3:case"end":return t.stop()}}),t)}))),e.showAddMember=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadContacts();case 2:return t.next=4,e.loadMembers();case 4:e.openVPage(qt);case 5:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"showFolder",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.load(),e.next=3,this.loadSpace();case 3:this.openVPage(_t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadSpace",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetGroupFolderMemberCount.query({folder:this.folderId});case 2:t=e.sent,n=t.ret[0],r=n.group,i=n.count,c=n.owner,this.groupId=r,this.groupOwner=c,this.memberCount=i;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadMembers",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetGroupMembers.query({group:this.groupId});case 2:t=e.sent,n=t.ret,(r=n.findIndex((function(e){return i.isMe(e.contact)})))>=0&&n.splice(r,1),this.members=n;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadContacts",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetGroupContacts.query({group:this.groupId});case 2:t=e.sent,n=t.ret,(r=n.findIndex((function(e){return i.isMe(e.contact)})))>=0&&n.splice(r,1),this.contacts=n;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderIcon",value:function(){return ee("users","text-warning")}},{key:"renderDirItem",value:function(){return new Vt(this).render()}},{key:"showAddPage",value:function(){this.openVPage(Mt)}},{key:"showEditPage",value:function(){this.openVPage(Ut)}},{key:"selectMember",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=this.contacts.findIndex((function(e){return E(e.contact,t.contact)})))<0)){e.next=3;break}return e.abrupt("return");case 3:if(i=this.contacts[r],!n){e.next=10;break}return e.next=7,this.uqs.notes.AddGroupMember.submit({group:this.groupId,member:i.contact});case 7:i.already=1,e.next=13;break;case 10:return e.next=12,this.uqs.notes.RemoveGroupMember.submit({group:this.groupId,member:i.contact});case 12:i.already=0;case 13:(c=this.members.findIndex((function(e){return E(e.contact,t.contact)})))>=0?this.members[c].already=i.already:n&&this.members.push(Object(Q.a)({},i));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"endContentInput",value:function(){var e=this.noteItem?Object(Q.a)({},this.noteItem.obj):{};return this.cContent.endInput(e),e}},{key:"addGroup",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.endContentInput(),n=JSON.stringify(t),e.next=4,this.owner.rootFold.addGroup(this.caption,n,[]);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"SetGroup",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(i.length>0&&void 0!==i[0])||i[0],n=this.endContentInput(),r=JSON.stringify(n),e.next=5,this.editGroup(t,this.noteItem,this.caption,r,n);case 5:this.updateChange();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editGroup",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i,c){var o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this.uqs.notes.SetGroup,s=n.note,e.next=4,u.submit({group:this.groupId,caption:r,content:i},t);case 4:s===(null===(o=this.noteItem)||void 0===o?void 0:o.note)&&(this.noteItem.caption=r,this.noteItem.content=i,this.noteItem.obj=c);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"type",get:function(){return O.groupFolder}}]),n}(Ft),st=Object(g.a)(ut.prototype,"memberCount",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=Object(g.a)(ut.prototype,"members",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=Object(g.a)(ut.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut),Ht=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"type",get:function(){return O.folder}}]),n}(Ft),Wt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"getItemConverter",value:function(){var e=this;return function(t,n){var r=e.owner.noteItemConverter(t,n);return r.disableFrom=!0,r}}}]),n}(Ht),Gt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u7f16\u8f91\u76ee\u5f55"}},{key:"renderEditBottom",value:function(){var e=this;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex"},o.a.createElement("div",{className:"mr-auto"}),o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSave()},className:"btn btn-primary mr-3",disabled:!e.controller.isNoteChanged},"\u4fdd\u5b58"))}))))}},{key:"back",get:function(){return"close"}}]),n}(Bt),$t=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u65b0\u5efa\u5c0f\u5355\u5939"}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.AddNote();case 2:return this.closePage(),e.abrupt("return");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Gt),Kt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderViewBottom",value:function(){return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex align-items-end"},this.renderShareButton())}}]),n}(Tt),Qt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(St),Jt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderIcon",value:function(){return ee(this.noteItem.toCount>0?"files-o":"file-o","text-info")}},{key:"showAddPage",value:function(){this.openVPage($t)}},{key:"showEditPage",value:function(){this.openVPage(Gt)}},{key:"showFolderViewPage",value:function(){this.openVPage(Kt)}},{key:"showFolder",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.load(),this.openVPage(Qt);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"endContentInput",value:function(){var e=this.noteItem?Object(Q.a)({},this.noteItem.obj):{};return this.cContent.endInput(e),e}}]),n}(Wt),Xt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(St),Yt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderIcon",value:function(){return ee("folder","text-warning")}},{key:"showAddPage",value:function(){}},{key:"showEditPage",value:function(){}},{key:"showFolder",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.load(),this.openVPage(Xt);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Wt),Zt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderIcon",value:function(){}},{key:"showAddPage",value:function(){}},{key:"showEditPage",value:function(){}},{key:"showFolder",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.load();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ht),en=n(16),tn=n.n(en),nn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).projectFileds=[{name:"name",type:"string",maxLength:100,required:!0},{name:"caption",type:"string",maxLength:100},{name:"memo",type:"string",maxLength:100},{name:"ratioX",type:"integer",min:1},{name:"ratioY",type:"integer",min:1},{name:"readUnit",type:"string",maxLength:20},{name:"submit",type:"submit"}],e.projectUISchema={items:{name:{label:"\u540d\u79f0",placeholder:"\u79d1\u76ee\u540d\u79f0"},caption:{label:"\u6807\u9898",placeholder:"\u79d1\u76ee\u663e\u793a\u6807\u9898"},memo:{label:"\u8bf4\u660e",placeholder:"\u79d1\u76ee\u8bf4\u660e"},ratioX:{label:"\u5206\u5b50",defaultValue:1,discription:"\u57fa\u672c\u5355\u4f4d\u6362\u7b97\u5206\u5b50\uff0c\u9ed8\u8ba41"},ratioY:{label:"\u5206\u6bcd",defaultValue:1,discription:"\u57fa\u672c\u5355\u4f4d\u6362\u7b97\u5206\u6bcd\uff0c\u9ed8\u8ba41"},readUnit:{label:"\u8ba1\u91cf\u5355\u4f4d",placeholder:"\u663e\u793a\u51fa\u6765\u7684\u8ba1\u91cf\u5355\u4f4d"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-primary"}}},e.onClickAdd=function(){e.controller.project=void 0,e.openPageElement(o.a.createElement(h.Page,{header:"\u65b0\u589e\u79d1\u76ee"},o.a.createElement(h.Form,{className:"m-3",schema:e.projectFileds,uiSchema:e.projectUISchema,fieldLabelSize:2,onButtonClick:e.onSubmitNewProject})))},e.onSubmitNewProject=function(){var t=Object(i.a)(a.a.mark((function t(n,r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveBookProject(r.data);case 2:e.closePage();case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.renderProject=function(e,t){var n=e.name,r=e.caption,a=e.memo,i=e.ratioX,c=e.ratioY,u=e.readUnit;return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("b",null,null!==r&&void 0!==r?r:n)," ",o.a.createElement("small",{className:"ml-3 text-muted"},a),o.a.createElement("span",{className:"ml-auto"},n," = ",i," / ",c," ",u))},e.onClickProject=function(t){e.controller.project=t,e.openPageElement(o.a.createElement(h.Page,{header:"\u7f16\u8f91\u79d1\u76ee"},o.a.createElement(h.Form,{className:"m-3",formData:e.controller.project,schema:e.projectFileds,uiSchema:e.projectUISchema,fieldLabelSize:2,onButtonClick:e.onSubmitNewProject})))},e}return Object(p.a)(n,[{key:"header",value:function(){return"\u673a\u6784\u79d1\u76ee"}},{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",onClick:this.onClickAdd},o.a.createElement(h.FA,{name:"plus"}))}},{key:"content",value:function(){return o.a.createElement("div",{className:"my-3"},o.a.createElement(h.List,{items:this.controller.bookProjects,item:{render:this.renderProject,onClick:this.onClickProject}}))}}]),n}(z),rn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderProject=function(e,t){var n=e.name,r=e.caption,a=e.memo,i=e.ratioX,c=e.ratioY,u=e.readUnit;return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("b",null,null!==r&&void 0!==r?r:n)," ",o.a.createElement("small",{className:"ml-3 text-muted"},a),o.a.createElement("span",{className:"ml-auto"},n," = ",i," / ",c," ",u))},e.onClickProject=function(e){},e.onAddSub=function(){e.openPageElement(o.a.createElement(h.Page,{header:"\u8c03\u6574\u79d1\u76ee"},o.a.createElement("div",{className:"mt-3 mb-1 small mx-3"},"\u5df2\u663e\u793a\u79d1\u76ee"),o.a.createElement(h.List,{items:e.controller.unitedProjects,item:{render:e.renderUnitedProject}}),o.a.createElement("div",{className:"mt-3 mb-1 small mx-3"},"\u53ef\u663e\u793a\u79d1\u76ee"),o.a.createElement(h.List,{items:e.controller.unitableProjects,item:{render:e.renderUnitableProject}})))},e.renderUnitedProject=function(t,n){var r=t.name,a=t.caption,i=t.memo,c=t.ratioX,u=t.ratioY,s=t.readUnit,l=n>=e.controller.unitedProjects.length-1?"invisible":"",d=n<=0?"invisible":"";return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("b",null,null!==a&&void 0!==a?a:r)," ",o.a.createElement("small",{className:"ml-3 text-muted"},i),o.a.createElement("span",{className:"ml-auto"},r," = ",c," / ",u," ",s),o.a.createElement("button",{className:"btn btn-sm btn-outline-dark ml-3",onClick:function(){return e.controller.setProjectDisplay(t,!1)}},o.a.createElement(h.FA,{name:"minus"})),o.a.createElement("button",{className:"btn btn-sm btn-outline-info ml-3 "+l,onClick:function(){return e.controller.setProjectDown(n)}},o.a.createElement(h.FA,{name:"arrow-down"})),o.a.createElement("button",{className:"btn btn-sm btn-outline-info ml-3 "+d,onClick:function(){return e.controller.setProjectUp(n)}},o.a.createElement(h.FA,{name:"arrow-up"})))},e.renderUnitableProject=function(t,n){var r=t.name,a=t.caption,i=t.memo,c=t.ratioX,u=t.ratioY,s=t.readUnit;return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("b",null,null!==a&&void 0!==a?a:r)," ",o.a.createElement("small",{className:"ml-3 text-muted"},i),o.a.createElement("span",{className:"ml-auto"},r," = ",c," / ",u," ",s),o.a.createElement("button",{className:"btn btn-sm btn-success ml-3",onClick:function(){return e.controller.setProjectDisplay(t,!0)}},o.a.createElement(h.FA,{name:"plus"})))},e}return Object(p.a)(n,[{key:"header",value:function(){return"\u663e\u793a\u79d1\u76ee"}},{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",onClick:this.onAddSub},"\u589e\u51cf")}},{key:"content",value:function(){return o.a.createElement("div",{className:"my-3"},o.a.createElement(h.List,{items:this.controller.unitedProjects,item:{render:this.renderProject,onClick:this.onClickProject}}))}}]),n}(z),an=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).projectFileds=[{name:"caption",type:"string",maxLength:100,required:!0},{name:"submit",type:"submit"}],e.projectUISchema={items:{caption:{label:"\u540d\u79f0",placeholder:"\u62a5\u8868\u540d\u79f0"},submit:{widget:"button",label:"\u63d0\u4ea4",className:"btn btn-primary"}}},e.onClickAdd=function(){e.controller.report=void 0,e.openPageElement(o.a.createElement(h.Page,{header:"\u65b0\u589e\u62a5\u8868"},o.a.createElement(h.Form,{className:"m-3",schema:e.projectFileds,uiSchema:e.projectUISchema,fieldLabelSize:2,onButtonClick:e.onSubmitNewReport})))},e.onSubmitNewReport=function(){var t=Object(i.a)(a.a.mark((function t(n,r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.saveBookReport(r.data);case 2:e.closePage();case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.renderProject=function(e,t){var n=e.caption;return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("b",null,n))},e.onClickReport=function(t){e.controller.report=t;var n=new h.CStringEdit(e.res),r={label:"\u62a5\u8868\u540d\u79f0",onValueChange:e.controller.changeReportName};e.openPageElement(o.a.createElement(h.Page,{header:"\u7f16\u8f91\u62a5\u8868"},o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement("small",{className:"text-muted"},"\u62a5\u8868\u540d\u79f0:")," \xa0",n.render(t.caption,r))))},e}return Object(p.a)(n,[{key:"header",value:function(){return"\u62a5\u8868\u8bbe\u8ba1"}},{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",onClick:this.onClickAdd},o.a.createElement(h.FA,{name:"plus"}))}},{key:"content",value:function(){return o.a.createElement("div",{className:"my-3"},o.a.createElement(h.List,{items:this.controller.bookReports,item:{render:this.renderProject,onClick:this.onClickReport}}))}}]),n}(z),cn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onNewUnit=function(){e.openVPage(sn)},e.renderUnitRow=function(e,t){return o.a.createElement(Object(M.a)((function(){var t=e.caption,n=e.memberCount;return o.a.createElement("div",{className:"px-3 py-2 align-items-center d-flex"},o.a.createElement("div",null,o.a.createElement(h.FA,{className:"text-warning mr-3",name:"sitemap"}),o.a.createElement("span",null,t)),o.a.createElement("span",{className:"ml-auto small"},o.a.createElement(h.FA,{name:"user-o",className:"small text-info mr-2"})," ",n))})))},e.onUnitRow=function(t){e.controller.showUnitAdmin(t)},e.onNewMember=function(){e.openVPage(pn)},e.renderMemberRow=function(t,n){var r=t.member,a=t.assigned,i=t.role,c=t.discription,u=[];return(i&It.owner)===It.owner&&u.push(o.a.createElement(h.FA,{key:"owner",className:"text-danger ml-2",name:"flag"})),(i&It.admin)===It.admin&&u.push(o.a.createElement("span",{key:"admin",className:"ml-2"},"\u7ba1\u7406\u5458")),o.a.createElement("div",{className:"px-3 py-2 cursor-pointer align-items-center"},o.a.createElement("div",{className:"mr-3"},e.renderContact(r,a)),o.a.createElement("div",{className:"small text-muted"},c),o.a.createElement("span",{className:"ml-auto small"},u))},e.onClickMember=function(t){e.openVPage(vn,t)},e}return Object(p.a)(n,[{key:"content",value:function(){var e=this.controller.unit,t=e.content;return o.a.createElement("div",null,this.renderParent(),o.a.createElement("div",{className:"m-3"},o.a.createElement("div",null,o.a.createElement(Object(M.a)((function(){return o.a.createElement("b",null,e.caption)}))),this.renderEditUnitName(),this.renderUnitID()),t&&o.a.createElement("div",null,"content")),o.a.createElement("div",{className:"my-5"},this.renderProjects(),this.renderUnitProjects()),this.renderMembersAndUnits())}},{key:"renderParent",value:function(){}},{key:"renderEditUnitName",value:function(){}},{key:"renderUnitID",value:function(){}},{key:"renderProjects",value:function(){}},{key:"renderReportDesign",value:function(){}},{key:"renderUnitProjects",value:function(){return o.a.createElement("div",{className:"mt-3 px-3 py-2 d-flex bg-white cursor-pointer align-items-center",onClick:this.controller.showUnitProjects},o.a.createElement("span",null,"\u79d1\u76ee\u663e\u793a"),o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}))}},{key:"renderMembersAndUnits",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderMembers(),o.a.createElement("div",{className:"mt-5"}),this.renderUnits())}},{key:"renderMembers",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"d-flex align-items-end px-3 my-2"},o.a.createElement("div",{className:"small text-muted"},"\u6210\u5458"),o.a.createElement("button",{className:"ml-auto btn btn-sm btn-primary",onClick:this.onNewMember},o.a.createElement(h.FA,{name:"plus"})," \u6210\u5458")),o.a.createElement(h.List,{items:this.controller.members,item:{render:this.renderMemberRow,onClick:this.onClickMember}}))}},{key:"renderUnits",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"d-flex align-items-end px-3 my-2"},o.a.createElement("div",{className:"small text-muted"},"\u4e0b\u7ea7\u5355\u4f4d"),o.a.createElement("button",{className:"ml-auto btn btn-sm btn-primary",onClick:this.onNewUnit},o.a.createElement(h.FA,{name:"plus"})," \u5355\u4f4d")),o.a.createElement(h.List,{items:this.controller.units,item:{render:this.renderUnitRow,onClick:this.onUnitRow}}))}}]),n}(z),on=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,"\u673a\u6784 ",e.controller.unit.caption)})))}},{key:"renderUnitID",value:function(){return o.a.createElement("small",{className:"text-muted ml-3"},"ID=",this.controller.unit.id)}},{key:"renderReportDesign",value:function(){return o.a.createElement("div",{className:"px-3 py-2 d-flex bg-white cursor-pointer",onClick:this.controller.showDesignReports},o.a.createElement("span",null,"\u62a5\u8868\u8bbe\u8ba1"),o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}))}},{key:"renderProjects",value:function(){return o.a.createElement("div",{className:"px-3 py-2 d-flex bg-white cursor-pointer border-bottom",onClick:this.controller.showRootProjects},o.a.createElement("span",null,"\u673a\u6784\u79d1\u76ee"),o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}))}},{key:"renderMembersAndUnits",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderUnits(),o.a.createElement("div",{className:"mt-5"}),this.renderMembers())}}]),n}(cn),un=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).onEditUnitName=function(){var t=o.a.createElement("button",{className:"btn btn-sm btn-success mr-1",onClick:e.onUnitNameSubmit},"\u63d0\u4ea4");e.openPageElement(o.a.createElement(h.Page,{header:"\u540d\u79f0",right:t},o.a.createElement("div",{className:"m-3"},o.a.createElement("input",{type:"text",className:"form-control",defaultValue:e.controller.unit.caption,onChange:e.onUnitNameChange,maxLength:100,onKeyDown:e.onUnitNameKeyDown}))))},e.unitName=void 0,e.onUnitNameChange=function(t){e.unitName=t.target.value},e.onUnitNameKeyDown=function(t){13===t.keyCode&&e.onUnitNameSubmit()},e.onUnitNameSubmit=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.setUnitName(e.unitName);case 2:e.controller.unit.caption=e.unitName,e.closePage();case 4:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,e.controller.unit.caption)})))}},{key:"renderParent",value:function(){var e=this.controller.parent;return o.a.createElement("div",{className:"m-3 small"},o.a.createElement("span",{className:"text-muted"},"\u4e0a\u7ea7\uff1a"),o.a.createElement("b",{className:"text-primary"},e.caption))}},{key:"renderUnitID",value:function(){return o.a.createElement("small",{className:"text-muted"},"ID=",this.controller.unit.id)}},{key:"renderEditUnitName",value:function(){return o.a.createElement("span",{className:"cursor-pointer align-self-stretch",onClick:this.onEditUnitName},o.a.createElement(h.FA,{className:"text-info mx-3",name:"pencil-square-o"}))}}]),n}(cn),sn=(dt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"input",ft,Object(U.a)(e)),Object(L.a)(e,"error",pt,Object(U.a)(e)),e.onChange=function(t){e.input=t.currentTarget.value},e.onKeyDown=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(13!==n.keyCode){t.next=3;break}return t.next=3,e.onCreate();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onCreate=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.createUnit(e.input.trim());case 2:if(!((n=t.sent)>0)){t.next=6;break}return e.closePage(),t.abrupt("return");case 6:t.t0=n,t.next=-1===t.t0?11:-2===t.t0?13:9;break;case 9:return e.error="\u9519\u8bef\u7f16\u53f7\uff1a"+n,t.abrupt("break",15);case 11:return e.error="\u65e0\u5efa\u5355\u4f4d\u6743\u9650",t.abrupt("break",15);case 13:return e.error="\u5355\u4f4d\u91cd\u540d",t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u65b0\u589e\u5355\u4f4d"}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n;return e.error&&(n=o.a.createElement("div",{className:"my-3 text-danger"},e.error)),o.a.createElement("div",{className:"m-3"},o.a.createElement("div",{className:""},o.a.createElement("input",{type:"text",className:"form-control",maxLength:100,placeholder:"\u5355\u4f4d\u540d\u79f0",onChange:e.onChange,onKeyDown:e.onKeyDown})),n,o.a.createElement("div",{className:"my-2"},o.a.createElement("button",{className:"btn btn-primary",disabled:0===(null===(t=e.input)||void 0===t?void 0:t.trim().length),onClick:e.onCreate},"\u65b0\u5efa\u5355\u4f4d")))})))}}]),n}(h.VPage),ft=Object(g.a)(dt.prototype,"input",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=Object(g.a)(dt.prototype,"error",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt),ln={name:"isAdmin",type:"boolean",required:!1},hn={widget:"checkbox",label:"\u7ba1\u7406\u5458"},dn=[{name:"assigned",type:"string",required:!1,maxLength:100},{name:"discription",type:"string",required:!1,maxLength:100}],fn={items:{assigned:{widget:"text",label:"\u8d4b\u4e88\u540d\u5b57",placeholder:"\u6210\u5458\u7684\u771f\u5b9e\u59d3\u540d"},discription:{widget:"text",label:"\u8bf4\u660e",placeholder:"\u804c\u79f0\uff0c\u804c\u52a1\u6216\u8005\u5c97\u4f4d\u4fe1\u606f"},isAdmin:hn}},pn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).form=void 0,e}return Object(p.a)(n,[{key:"renderFields",value:function(){var e=this;return o.a.createElement(h.Form,{ref:function(t){return e.form=t},className:"m-3",schema:dn,uiSchema:fn,fieldLabelSize:2})}},{key:"addContact",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.form.data,n=t.assigned,r=t.discription,e.next=3,this.controller.addMember(this.user.id,n,r);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Pe),vn=(vt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"item",mt,Object(U.a)(e)),e.onItemChanged=function(){var t=Object(i.a)(a.a.mark((function t(n,r,i){var c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("isAdmin"!==(c=n.name)){t.next=6;break}return t.next=4,e.controller.setUnitMemberAdmin(e.item,r);case 4:t.next=8;break;case 6:return t.next=8,e.controller.setUnitMemberProp(e.item,c,r);case 8:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"init",value:function(e){this.item=e,hn.readOnly=(this.item.role&It.owner)===It.owner}},{key:"header",value:function(){return"\u8be6\u60c5"}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.item,n=t.assigned,r=t.discription,a={isAdmin:0!==(e.item.role&(It.admin|It.unitAdmin)),assigned:n,discription:r};return o.a.createElement("div",null,o.a.createElement(h.Edit,{className:"m-3",data:a,schema:[ln].concat(dn),uiSchema:fn,onItemChanged:e.onItemChanged}))})))}}]),n}(z),mt=Object(g.a)(vt.prototype,"item",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt),mn=(bt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).isChanged=!1,e.root=void 0,e.parent=void 0,Object(L.a)(e,"unit",yt,Object(U.a)(e)),Object(L.a)(e,"units",kt,Object(U.a)(e)),Object(L.a)(e,"members",gt,Object(U.a)(e)),e.rootProjects=void 0,Object(L.a)(e,"unitedProjects",wt,Object(U.a)(e)),Object(L.a)(e,"unitableProjects",Ot,Object(U.a)(e)),e.showUnitProjects=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadUnitProjects();case 2:e.openVPage(rn);case 3:case"end":return t.stop()}}),t)}))),e.setProjectDisplay=function(){var t=Object(i.a)(a.a.mark((function t(n,r){var i,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!0===r?(i=e.unitableProjects,c=e.unitedProjects,n.orderNo=e.unitedProjects.length+1):(i=e.unitedProjects,c=e.unitableProjects,n.orderNo=void 0),(o=i.findIndex((function(e){return e===n})))>=0&&(i.splice(o,1),c.push(n)),t.next=5,e.setUnitProjects();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.setProjectDown=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.unitedProjects.splice(n,1),(r=e.unitedProjects).splice.apply(r,[n+1,0].concat(Object(J.a)(i))),t.next=4,e.setUnitProjects();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.setProjectUp=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.unitedProjects.splice(n,1),(r=e.unitedProjects).splice.apply(r,[n-1,0].concat(Object(J.a)(i))),t.next=4,e.setUnitProjects();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(e,t,n){this.root=e,this.parent=t,this.unit=n}},{key:"renderIcon",value:function(){return ee("sitemap","text-primary")}},{key:"renderDirItem",value:function(e){}},{key:"showAddPage",value:function(){}},{key:"showEditPage",value:function(){}},{key:"getVUnitAdmin",value:function(){return un}},{key:"showViewPage",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=-this.unit.id,e.next=3,this.uqs.notes.GetUnit.query({unitNote:n});case 3:if(r=e.sent,this.unit=r.ret[0],void 0!==this.unit){e.next=8;break}throw new Error("not unit for note="+n);case 8:this.units=r.units,this.members=this.moveOwnerMemberToTop(r.members),this.openVPage(this.getVUnitAdmin(),void 0,t);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveOwnerMemberToTop",value:function(e){var t,n=[],r=0,a=0,i=Object(B.a)(e);try{for(i.s();!(t=i.n()).done;){var c=t.value,o=c.role;(o&It.owner)!==It.owner?(o&It.admin)!==It.admin?n.push(c):(n.splice(a,0,c),a++):(n.splice(r,0,c),r++,a++)}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"showUnitAdmin",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new bn(this.cApp)).init(this.root,this.unit,t),e.next=4,n.showViewPage((function(){var e=n.isChanged;e&&(r.isChanged=e)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createUnit",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.CreateUnit.submit({parent:this.parent.id,name:t,content:void 0});case 2:return n=e.sent,(r=n.id)>0&&this.units.push({id:r,caption:t,content:void 0,role:7,memberCount:0}),this.isChanged=!0,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setUnitName",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.SetUnitName.submit({unit:this.unit.id,name:t});case 2:this.parent.caption=t,this.isChanged=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addMember",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.AddUnitMember.submit({unit:this.unit.id,member:t,assigned:n,discription:r});case 2:this.members.push({member:t,assigned:n,discription:r,role:0}),this.isChanged=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setUnitMemberAdmin",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=It.admin|It.unitAdmin,i=n?r:0,e.next=4,this.uqs.notes.SetUnitMemberRole.submit({unit:this.unit.id,member:t.member,roleMask:r,role:i});case 4:t.role&=~r,t.role|=i,this.isChanged=!0;case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUnitMemberProp",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.SetUnitMemberProp.submit({unit:this.unit.id,member:t.member,prop:n,value:r});case 2:t[n]=r,this.isChanged=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"loadUnitProjects",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetUnitProjects.query({rootUnit:this.root.id,unit:this.unit.id});case 2:t=e.sent,n=t.ret,this.rootProjects=n,r=[],i=[],c=Object(B.a)(n);try{for(c.s();!(o=c.n()).done;)u=o.value,u.orderNo>0?r.push(u):i.push(u)}catch(a){c.e(a)}finally{c.f()}if(0===r.length){for(s=0;s<n.length;s++)i[s].orderNo=s+1;r=i,i=[]}this.unitedProjects=r,this.unitableProjects=i;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUnitProjects",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={unit:this.unit.id,projects:this.unitedProjects.map((function(e){return{project:e.id,orderNo:e.orderNo}}))},e.next=3,this.uqs.notes.SetUnitProjects.submit(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"type",get:function(){return O.unitNote}}]),n}(b),yt=Object(g.a)(bt.prototype,"unit",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Object(g.a)(bt.prototype,"units",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=Object(g.a)(bt.prototype,"members",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Object(g.a)(bt.prototype,"unitedProjects",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Object(g.a)(bt.prototype,"unitableProjects",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt),bn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return n}(mn),yn=(jt=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).project=void 0,Object(L.a)(e,"bookProjects",xt,Object(U.a)(e)),e.report=void 0,Object(L.a)(e,"bookReports",Et,Object(U.a)(e)),e.showRootProjects=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadBookProjects();case 2:e.openVPage(nn);case 3:case"end":return t.stop()}}),t)}))),e.showDesignReports=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.loadBookReports();case 2:e.openVPage(an);case 3:case"end":return t.stop()}}),t)}))),e.changeReportName=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.report.caption=n;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"getVUnitAdmin",value:function(){return on}},{key:"loadBookProjects",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetRootUnitProjects.query({rootUnit:this.unit.id});case 2:t=e.sent,this.bookProjects=t.ret;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveBookProject",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(n=this.project)||void 0===n?void 0:n.id,t.rootUnit=this.unit.id,e.next=4,this.uqs.notes.BookProject.save(r,t);case 4:i=e.sent,t.id=i.id,this.project?tn.a.merge(this.project,t):this.bookProjects.push(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadBookReports",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetRootUnitReports.query({rootUnit:this.unit.id});case 2:t=e.sent,this.bookReports=t.ret;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveBookReport",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(n=this.report)||void 0===n?void 0:n.id,t.rootUnit=this.unit.id,e.next=4,this.uqs.notes.BookReport.save(r,t);case 4:i=e.sent,t.id=i.id,this.report?tn.a.merge(this.report,t):this.bookReports.push(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(mn),xt=Object(g.a)(jt.prototype,"bookProjects",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=Object(g.a)(jt.prototype,"bookReports",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt),kn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n,r=e.controller.noteItem,a=r.toCount,i=r.unread;a>0&&(t=o.a.createElement("small",{className:"ml-4 text-muted"},o.a.createElement(h.FA,{name:"share",className:"mr-1"}),a)),i>0&&(n=o.a.createElement("u",null));var c=o.a.createElement("div",{className:"unread-dot mr-3"},e.controller.renderIcon(),n);return o.a.createElement("div",{className:"d-block bg-white"},o.a.createElement("div",{className:"d-flex pl-2 pr-3 py-2 align-items-center"},c,o.a.createElement("b",{className:"text-primary"},r.caption),t))})))}}]),n}(Ce),gn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onAdmin=function(){e.controller.showRootAdmin()},e.renderUnitRow=function(e,t){return o.a.createElement(Object(M.a)((function(){var t=e.caption;return o.a.createElement("div",{className:"px-3 py-2 align-items-center"},o.a.createElement(h.FA,{className:"text-warning mr-3",name:"sitemap"}),o.a.createElement("span",null,t))})))},e.onUnitRow=function(){alert("unit")},e}return Object(p.a)(n,[{key:"header",value:function(){return this.controller.noteItem.caption}},{key:"right",value:function(){if((this.controller.unit.role&It.admin)===It.admin)return o.a.createElement("button",{className:"btn btn-success btn-sm mr-2",onClick:this.onAdmin},"\u7ba1\u7406")}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller,n=t.unit,r=t.units,a=n.id,i=n.caption,c=n.content;return o.a.createElement("div",null,o.a.createElement("div",{className:"m-3"},"note: ",a," ",o.a.createElement("br",null),"caption: ",i," ",o.a.createElement("br",null),"content: ",c," ",o.a.createElement("br",null)),o.a.createElement("div",{className:"d-flex align-items-end px-3 my-2"},o.a.createElement("div",{className:"small text-muted"},"\u5355\u4f4d")),o.a.createElement(h.List,{items:r,item:{render:e.renderUnitRow,onClick:e.onUnitRow}}))})))}}]),n}(Ce);!function(e){e[e.owner=1]="owner",e[e.admin=2]="admin",e[e.unitAdmin=4]="unitAdmin"}(It||(It={}));var wn=(Ct=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).unit=void 0,Object(L.a)(e,"units",Nt,Object(U.a)(e)),e.cUnitAdmins=[],e.curUnitAdmin=void 0,e.isChanged=!1,e}return Object(p.a)(n,[{key:"renderIcon",value:function(){return ee("sitemap","text-primary")}},{key:"renderDirItem",value:function(e){return new kn(this).render()}},{key:"showAddPage",value:function(){}},{key:"showEditPage",value:function(){}},{key:"loadUnits",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.noteItem.note,e.next=3,this.uqs.notes.GetUnit.query({unitNote:t});case 3:if(n=e.sent,this.unit=n.ret[0],void 0!==this.unit){e.next=8;break}throw new Error("not unit for note="+t);case 8:this.units=n.units;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showFolder",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadUnits();case 2:this.openVPage(gn);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showRootAdmin",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.curUnitAdmin=new yn(this.cApp),this.curUnitAdmin.init(this.unit,void 0,{id:-this.noteItem.note}),e.next=4,this.curUnitAdmin.showViewPage((function(){t.curUnitAdmin.isChanged&&(t.units=void 0,t.loadUnits())}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"type",get:function(){return O.unitNote}}]),n}(Ft),Nt=Object(g.a)(Ct.prototype,"units",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct);var On,jn,xn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderComments=function(){var t=e.controller.cNote.noteModel.comments,n=t.length;if(0!==n)return o.a.createElement("div",{className:"py-3"},t.map((function(t){return e.renderComment(t)})),n>=10&&o.a.createElement("div",{className:"px-3 pt-3 cursor-pointer text-primary text-right small",onClick:e.showMoreComments},"\u66f4\u591a\u8bc4\u8bba..."))},e.showMoreComments=function(){e.openPageElement(o.a.createElement(h.Page,{header:"\u8bc4\u8bba"},o.a.createElement("div",{className:"text-muted p-3"},"\u66f4\u591a\u8bc4\u8bba\u6b63\u5728\u5f00\u53d1\u4e2d ...")))},e}return Object(p.a)(n,[{key:"render",value:function(){return this.renderComments()}},{key:"renderComment",value:function(e){var t=this,n=e.id,r=e.owner,a=e.assigned,i=e.content,c=e.$update;return o.a.createElement(h.UserView,{key:n,user:r,render:function(e){var n,r,u=e.id,s=e.name,l=e.nick;!0===t.isMe(u)?(r="text-success",n="[\u6211]"):(r="text-primary-dark",n=a||l||s);var d=o.a.createElement("span",{className:r+" mr-2"},n,":");return o.a.createElement("div",{className:"mt-1 d-flex bg-white pt-2"},o.a.createElement("div",{className:"mx-3"},o.a.createElement("div",{className:"small text-muted"},o.a.createElement(h.EasyTime,{date:c})),o.a.createElement("div",{className:""},t.renderCommentContent(d,i))))}})}},{key:"renderCommentContent",value:function(e,t){if(t)return o.a.createElement(o.a.Fragment,null,t.trimRight().split("\n").map((function(t,n){var r;if(t){r="";for(var a=t.length,i=0;i<a;i++){switch(t.charCodeAt(i)){case 32:r+="\u2000";continue}break}r+=t.substr(i)}else r="\xa0";return 0===n&&(r=o.a.createElement(o.a.Fragment,null,e,r)),o.a.createElement("div",{key:n,className:"pb-1"},r)})))}}]),n}(h.View),En=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).comment=void 0,e.onCommentChange=function(t){e.comment=t.target.value},e.onCommentSubmit=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.onAddComment(e.comment);case 2:e.closePage();case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u8bc4\u8bba"}},{key:"content",value:function(){return o.a.createElement("textarea",{rows:10,className:"w-100 border-0 form-control",placeholder:"\u8bf7\u8f93\u5165",maxLength:2e4,onChange:this.onCommentChange})}},{key:"right",value:function(){return o.a.createElement("button",{className:"btn btn-sm btn-success mr-1",onClick:this.onCommentSubmit},"\u63d0\u4ea4")}}]),n}(h.VPage),Cn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).onComment=function(){var t=o.a.createElement("button",{className:"btn btn-sm btn-success mr-1",onClick:e.onCommentSubmit},"\u63d0\u4ea4");e.openPageElement(o.a.createElement(h.Page,{header:"\u8bc4\u8bba",right:t},o.a.createElement("textarea",{rows:10,className:"w-100 border-0 form-control",placeholder:"\u8bf7\u8f93\u5165",maxLength:2e4,onChange:e.onCommentChange})))},e.comment=void 0,e.onCommentChange=function(t){e.comment=t.target.value},e.onCommentSubmit=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.onAddComment(e.comment);case 2:e.closePage();case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"flex-fill rounded-pill mr-3 border bg-white px-3 py-1 small cursor-pointer",onClick:this.onComment},"\u5199\u8bc4\u8bba...")}},{key:"renderButton",value:function(){return o.a.createElement("span",{className:"cursor-pointer text-primary mr-5",onClick:this.onComment},o.a.createElement(h.FA,{name:"comment-o"}))}}]),n}(h.View),Nn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cNote=void 0,e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(e){this.cNote=e}},{key:"renderCommentsList",value:function(){return this.renderView(xn)}},{key:"showAddCommentPage",value:function(){this.openVPage(En)}},{key:"onAddComment",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cNote.addComment(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderWriteComment",value:function(){return this.renderView(Cn)}},{key:"renderCommentButton",value:function(){return new Cn(this).renderButton()}}]),n}(h.Controller),In=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).cComments=void 0,e.addComment=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uqs.notes.AddComment.submit({note:e.noteModel.id,content:n});case 2:r=t.sent,(i=r.comment)&&(e.noteItem.commentCount++,e.noteModel.comments.unshift({id:i,content:n,owner:e.user.id,assigned:void 0,$create:new Date,$update:new Date}),e.activeRelativeTab="comment",e.updateChange());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"init",value:function(e){Object(X.a)(Object(Y.a)(n.prototype),"init",this).call(this,e),this.cComments=new Nn(this.res),this.cComments.init(this),e&&(this.caption||(this.caption=e.caption))}}]),n}(Z),Sn=n(38);!function(e){e[e.Start=0]="Start",e[e.Done=1]="Done",e[e.Pass=2]="Pass",e[e.Fail=3]="Fail",e[e.Rated=4]="Rated",e[e.Canceled=5]="Canceled"}(jn||(jn={}));var An=(On={},Object(Sn.a)(On,jn.Start,{content:"\u5f85\u529e",isEnd:!1}),Object(Sn.a)(On,jn.Done,{content:"\u5df2\u529e",isEnd:!0}),Object(Sn.a)(On,jn.Pass,{content:"\u7b7e\u6536",isEnd:!0}),Object(Sn.a)(On,jn.Fail,{content:"\u62d2\u7b7e",isEnd:!0}),Object(Sn.a)(On,jn.Rated,{content:"\u5df2\u8bc4\u4ef7",isEnd:!0}),Object(Sn.a)(On,jn.Canceled,{content:"\u5df2\u53d6\u6d88",isEnd:!0}),On);function Pn(e){var t=e.type,n=e.state;if(t===O.task){switch(n){case jn.Done:if(e.obj.checker)return{content:"\u5f85\u9a8c\u6536",isEnd:!1};if(e.obj.rater)return{content:"\u5f85\u8bc4\u5206",isEnd:!1};break;case jn.Pass:if(e.obj.rater)return{content:"\u5f85\u8bc4\u5206",isEnd:!1}}return function(e,t){if(e===O.task)return An[t]}(t,n)}}var Tn,Fn,Vn,Rn,_n,Dn,Bn,Un,Ln,qn,Mn,zn,Hn,Wn,Gn,$n,Kn,Qn,Jn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).tabComment={name:"comment",visible:function(){return e.controller.noteItem.commentCount>0},caption:function(t){var n,r=e.controller.noteItem.commentCount;return r>0&&(n=o.a.createElement("small",null,r)),o.a.createElement(o.a.Fragment,null,o.a.createElement(h.FA,{className:"mr-2",name:"comment-o"}),n)},render:function(){return e.controller.cComments.renderCommentsList()}},e.tabFlow={name:"flow",visible:function(){var t;return(null===(t=e.controller.noteModel)||void 0===t?void 0:t.flow.length)>0},caption:function(e){return o.a.createElement(o.a.Fragment,null,"\u6d41\u7a0b")},render:function(){var t=e.controller.noteModel.flow;if(t&&0!==t.length)return o.a.createElement("div",null,"flow: ",t.length)}},e}return Object(p.a)(n,[{key:"tabs",get:function(){return[this.tabComment,this.tabShare,this.tabFlow]}}]),n}(Te),Xn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"tabs",get:function(){return[this.tabComment,this.tabShare]}}]),n}(Jn),Yn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderSpawn=function(t,n){var r=t.owner,a=t.assigned,i=Pn(t),c=i.content,u=i.isEnd;return o.a.createElement("div",{className:"px-3 py-2 bg-light border-top",onClick:function(n){return e.controller.showSpawn(t)}},e.renderContact(r,a),o.a.createElement("div",{className:"ml-2"}),e.renderStateSpan(c,u))},e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("noteTask")}},{key:"renderRelatives",value:function(){return this.renderVm(Xn)}},{key:"right",value:function(){var e=[{icon:"hand-pointer-o",caption:"\u590d\u5236\u4efb\u52a1",action:this.controller.duplicateAssign,iconClass:"text-primary"}];return o.a.createElement(h.DropdownActions,{actions:e,icon:"plus",itemIconClass:"text-info",className:"cursor-pointer btn btn-lg text-white p-1 mr-1"})}},{key:"footer",value:function(){return this.renderFooter()}},{key:"renderFooter",value:function(){return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex align-items-center"},this.controller.cComments.renderWriteComment())}},{key:"renderContent",value:function(){return this.controller.cContent.renderDirContent()}},{key:"renderViewBottom",value:function(){var e=this.controller,t=e.noteItem,n=e.noteModel;if(!1!==this.isMe(t.owner)){var r,a=n.spawn;return r=0===a.length?o.a.createElement("div",{className:"px-3 py-2"},o.a.createElement("button",{className:"btn btn-primary",onClick:this.controller.showAssignTo},"\u5206\u6d3e")):o.a.createElement("div",{className:"my-3"},o.a.createElement("div",{className:"d-flex px-3 py-2 align-items-end"},o.a.createElement("div",{className:"small text-muted pt-2 pb-1"},"\u5df2\u5206\u6d3e")),o.a.createElement(h.List,{items:a,item:{render:this.renderSpawn,className:"notes"}})),o.a.createElement("div",{className:"bg-light"},r)}}},{key:"renderEditButton",value:function(){}}]),n}(Se),Zn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"onButtonSend",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.saveAndAssingTo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderExButtons",value:function(){}},{key:"renderEditBottom",value:function(){var e=this;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex"},o.a.createElement("div",{className:"mr-auto"}),o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSend()},className:"btn btn-primary mr-3",disabled:e.controller.isNoteEmpty},"\u5206\u6d3e"))}))),this.renderExButtons())}}]),n}(function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).onClickHours=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new at(e.controller.owner),t.next=3,n.inputHours(e.controller.assignhours);case 3:r=t.sent,e.closePage(),void 0!==r&&(e.controller.assignhours=r);case 6:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("noteTask")}},{key:"renderTopCaptionContent",value:function(){return o.a.createElement("div",{className:""},this.renderCaptionInput(),o.a.createElement("div",{className:"mx-1 py-1 bg-white"},this.renderContent()),this.renderTaskAdditions())}},{key:"renderContent",value:function(){return this.controller.cContent.renderInput()}},{key:"renderParam",value:function(e){var t=e.label,n=e.values,r=e.onClick;return o.a.createElement("div",{key:t,className:"px-3 py-2 bg-white d-flex align-items-center border-bottom",onClick:r},o.a.createElement("div",{className:"text-muted mr-3 w-5c"},t),o.a.createElement("div",{className:"flex-fill mr-3 "},n||Ae),r?o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}):void 0)}},{key:"renderTaskAdditions",value:function(){var e=this,t=[{label:"\u5206\u6d3e\u5de5\u65f6",values:this.renderAssignHours(),onClick:this.onClickHours}];return o.a.createElement("div",null,t.map((function(t){return e.renderParam(t)})))}},{key:"renderAssignHours",value:function(){return o.a.createElement("div",{className:"flex-fill mr-3 "},N(this.controller.assignhours))}},{key:"renderExButtons",value:function(){return o.a.createElement(o.a.Fragment,null,this.renderDeleteButton())}}]),n}(Ie)),er=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderContent",value:function(){return this.controller.cContent.renderDirContent()}}]),n}(Ne),tr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).cNoteAssign=void 0,e.renderContact=function(e,t){if(!e)return Ae;var n=e.contact,r=e.assigned;return o.a.createElement(h.UserView,{user:n,render:function(e){var t=e.name,n=e.nick,a=e.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-1c h-1c mr-1",src:a||".user-o"}),o.a.createElement("span",{className:"mr-3"},r||n||t))}})},e.onClickHours=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new at(e.cNoteAssign.owner),t.next=3,n.inputHours(e.cNoteAssign.assignhours);case 3:r=t.sent,e.closePage(),void 0!==r&&(e.cNoteAssign.assignhours=r);case 6:case"end":return t.stop()}}),t)}))),e.onItemChange=function(t){e.cNoteAssign.point=Number(t.currentTarget.value)},e.onItemKeyDown=function(e){},e.onClickChecker=Object(i.a)(a.a.mark((function t(){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new nr(e.cNoteAssign.owner,"\u68c0\u67e5\u4eba")).SetContacts(e.controller.GetAssignToContacts()),r={title:"\u68c0\u67e5\u4eba",single:!0},t.next=5,n.callSelectContact(r);case 5:i=t.sent,e.closePage(),e.cNoteAssign.checker=i[0];case 8:case"end":return t.stop()}}),t)}))),e.onClickRater=Object(i.a)(a.a.mark((function t(){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new nr(e.cNoteAssign.owner,"\u8bc4\u4ef7\u4eba")).SetContacts(e.controller.GetAssignToContacts()),r={title:"\u8bc4\u4ef7\u4eba",single:!0},t.next=5,n.callSelectContact(r);case 5:i=t.sent,e.closePage(),e.cNoteAssign.rater=i[0];case 8:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"init",value:function(){this.cNoteAssign=this.controller.cNoteAssign}},{key:"header",value:function(){return"\u5206\u6d3e\u4efb\u52a1"}},{key:"renderParam",value:function(e){var t=e.label,n=e.values,r=e.onClick;return o.a.createElement("div",{key:t,className:"px-3 py-2 bg-white d-flex cursor-pointer align-items-center border-bottom",onClick:r},o.a.createElement("div",{className:"text-muted mr-3 w-5c"},t),o.a.createElement("div",{className:"flex-fill mr-3 "},n||Ae),r?o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}):void 0)}},{key:"content",value:function(){var e=this,t=[{label:"\u5de5\u65f6",values:this.renderHours(),onClick:this.onClickHours},{label:"\u68c0\u67e5\u4eba",values:this.renderChecker(),onClick:this.onClickChecker},{label:"\u8bc4\u4ef7\u4eba",values:this.renderRater(),onClick:this.onClickRater}];return o.a.createElement("div",{className:"py-2"},this.cNoteAssign.renderDirItem(0),t.map((function(t){return e.renderParam(t)})),o.a.createElement("div",{className:"px-3 py-2"},o.a.createElement("button",{className:"btn btn-primary",onClick:this.controller.onSendOut},"\u53d1\u9001")))}},{key:"renderPoint",value:function(){return o.a.createElement("input",{className:"flex-fill form-control border-0",type:"number",step:"1",min:"1",defaultValue:this.cNoteAssign.point,onChange:this.onItemChange,onKeyDown:this.onItemKeyDown})}},{key:"renderHours",value:function(){var e=N(this.cNoteAssign.assignhours);return o.a.createElement("div",{className:"flex-fill form-control border-0"},e)}},{key:"renderChecker",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return e.renderContact(e.cNoteAssign.checker)})))}},{key:"renderRater",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return e.renderContact(e.cNoteAssign.rater)})))}},{key:"back",get:function(){return"close"}}]),n}(h.VPage),nr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;return Object(f.a)(this,n),(a=t.call(this,e.cApp)).cNotes=void 0,a.title=void 0,a.cNotes=e,a.title=r,a}return Object(p.a)(n,[{key:"SetContacts",value:function(e){this.contacts=[];var t,n=Object(B.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=Object(Q.a)({},r);a.already=0,this.contacts.push(a)}}catch(i){n.e(i)}finally{n.f()}}},{key:"loadContacts",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(nt),rr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(f.a)(this,n);var c=r.owner.currentFold,o=c.groupFolder,u=c.currentNoteItem;return(a=t.call(this,e,o,u)).cNoteAssign=void 0,a.replaceTop=void 0,a.cNoteAssign=r,a.replaceTop=i,a}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.GetContacts.page({groupFolder:this.currentGroupFolder,note:void 0},0,50,!0);case 2:t=e.sent,this.groupContacts=t.$page,this.groupContacts.push({contact:this.user.id,assigned:"[\u81ea\u5df1]",already:0}),this.replaceTop?this.replaceVPage(Ze):(this.startAction(),this.openVPage(Ze));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"GetAssignToContacts",value:function(){return this.groupContacts}},{key:"sendOut",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cNoteAssign.assignTask(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterContactsSelected",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(tr);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"GetContacts",get:function(){return this.uqs.notes.GetAssignToContacts}}]),n}(et),ar=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller.getItems(),n=t.uncheckedItems,r=t.checkedItems;return o.a.createElement("div",{className:"mb-2"},n.map((function(t,n){return e.renderCheckItem(t)})),e.renderCheckedItems(r))})))}}]),n}(h.View),ir=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderCheckItem",value:function(e){var t,n=this,r=e.key,a=e.text,i=e.checked,c="ml-3 ";return!0===i?(c+="text-muted ",t=o.a.createElement("del",null,a)):t=a,o.a.createElement("div",{key:r,className:"d-flex mx-3 align-items-center form-check"},o.a.createElement("input",{className:"form-check-input mr-3 mt-0",type:"checkbox",defaultChecked:i,disabled:!this.controller.allowCheck,onChange:function(e){return n.controller.onCheckChange(r,e.currentTarget.checked)},"data-key":r}),o.a.createElement("div",{className:"form-control-plaintext "+c},t))}},{key:"renderCheckedItems",value:function(e){var t=this,n=e.length;if(n>0)return o.a.createElement("div",{className:"border-top py-2"},o.a.createElement("div",{className:"px-3 pt-2 small text-muted"},n,"\u9879\u5b8c\u6210"),e.map((function(e,n){return t.renderCheckItem(e)})))}}]),n}(ar),cr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderCheckItem",value:function(e){var t,n,r=e.key,a=e.text,i="ml-3 ";return!0===e.checked?(i+="text-muted ",t=o.a.createElement("del",null,a),n="check-square"):(t=a,n="square-o"),o.a.createElement("div",{key:r,className:"d-flex mx-3 align-items-center"},o.a.createElement(h.FA,{name:n}),o.a.createElement("div",{className:"py-1 "+i},t))}},{key:"renderCheckedItems",value:function(e){var t=this;if(e.length>0)return o.a.createElement("div",{className:""},e.map((function(e,n){return t.renderCheckItem(e)})))}}]),n}(ar),or=(Tn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).allowCheck=void 0,e.inputingText=void 0,Object(L.a)(e,"items",Fn,Object(U.a)(e)),e.itemKey=1,e}return Object(p.a)(n,[{key:"init",value:function(e){e&&void 0!==e.itemKey&&void 0!==e.items&&(this.itemKey=e.itemKey,this.items=e.items)}},{key:"renderInput",value:function(){}},{key:"renderViewContent",value:function(){return this.renderView(ir)}},{key:"renderDirContent",value:function(){return this.renderView(cr)}},{key:"endInput",value:function(e){this.addNewItem(),this.buildObj(e)}},{key:"buildObj",value:function(e){e.itemKey=this.itemKey,e.items=this.items}},{key:"toString",value:function(){var e;return null===(e=this.items)||void 0===e?void 0:e.map((function(e){return e.text})).join("\n")}},{key:"fromString",value:function(e){var t,n=this;e&&(this.items=[],this.itemKey=1,(t=this.items).push.apply(t,Object(J.a)(e.split("\n").filter((function(e,t){return e.trim().length>0})).map((function(e,t){return{key:n.itemKey++,text:e,checked:!1}})))))}},{key:"onCheckChange",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.items.find((function(e){return e.key===t})))&&(r.checked=n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addNewItem",value:function(){if(void 0!==this.inputingText){var e=this.inputingText.trim();0!==e.length&&(this.items.push({key:this.itemKey++,text:e,checked:!1}),this.changed=!0,this.inputingText=void 0)}}},{key:"getItems",value:function(){var e,t=[],n=[],r=Object(B.a)(this.items);try{for(r.s();!(e=r.n()).done;){var a=e.value;!0===a.checked?n.push(a):t.push(a)}}catch(i){r.e(i)}finally{r.f()}return{uncheckedItems:t,checkedItems:n}}}]),n}(Fe),Fn=Object(g.a)(Tn.prototype,"items",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Tn),ur=(Vn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cContent=void 0,Object(L.a)(e,"checkInfo",Rn,Object(U.a)(e)),Object(L.a)(e,"rateInfo",_n,Object(U.a)(e)),e.checker=void 0,e.rater=void 0,e.checkInfoInput=void 0,e.rateInfoInput=void 0,e.rateValue=void 0,e.rateValueInput=void 0,e.assignhours=void 0,Object(L.a)(e,"hours",Dn,Object(U.a)(e)),e.point=void 0,e}return Object(p.a)(n,[{key:"init",value:function(e){if(Object(X.a)(Object(Y.a)(n.prototype),"init",this).call(this,e),this.cContent=new or(this.res),e){var t=e.obj;this.initobj(t)}this.cContent.allowCheck=this.allowCheck}},{key:"initobj",value:function(e){e&&(this.cContent.init(e),this.checkInfo=e.checkInfo,this.checkInfoInput=this.checkInfo,this.rateInfo=e.rateInfo,this.rateInfoInput=this.rateInfo,this.rateValue=e.rateValue,this.rateValueInput=this.rateValue,this.checker=e.checker,this.rater=e.rater,this.assignhours=e.assignhours,this.hours=e.hours,this.point=e.point)}},{key:"endContentInput",value:function(){var e=Object(X.a)(Object(Y.a)(n.prototype),"endContentInput",this).call(this);return this.checkInfo?e.checkInfo=this.checkInfo:delete e.checkInfo,this.rateInfo?e.rateInfo=this.rateInfo:delete e.rateInfo,void 0!==this.rateValue?e.rateValue=this.rateValue:delete e.rateValue,void 0!==this.checker&&(e.checker=this.checker),void 0!==this.rater&&(e.rater=this.rater),e.assignhours=this.assignhours,e.hours=this.hours,e.point=this.point,this.cContent.endInput(e),e}},{key:"updateCheckInfo",value:function(e){this.checkInfoInput=e}},{key:"updateRateInfo",value:function(e){this.rateInfoInput=e}},{key:"showAddPage",value:function(){}},{key:"showEditPage",value:function(){}},{key:"renderIcon",value:function(){return ee("tasks","text-success")}},{key:"checkSaveInfo",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,this.rateInfo!==this.rateInfoInput&&(this.rateInfo=this.rateInfoInput,t=!0),this.checkInfo!==this.checkInfoInput&&(this.checkInfo=this.checkInfoInput,t=!0),this.rateValue!==this.rateValueInput&&(this.rateValue=this.rateValueInput,t=!0),!t){e.next=7;break}return e.next=7,this.saveX();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveX",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.noteItem.note,n=this.endContentInput(),r=JSON.stringify(n),i={note:t,content:r},e.next=6,this.uqs.notes.SetNoteX.submit(i,!1);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"type",get:function(){return O.task}},{key:"allowCheck",get:function(){return!1}}]),n}(In),Rn=Object(g.a)(Vn.prototype,"checkInfo",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Object(g.a)(Vn.prototype,"rateInfo",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Object(g.a)(Vn.prototype,"hours",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vn),sr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"tabs",get:function(){return[this.tabComment]}}]),n}(Jn),lr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).onCheckChange=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("task")}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:""},e.renderTopCaptionContent(),e.renderTaskAdditions(),e.renderViewBottom(),e.renderRelatives())})))}},{key:"renderContent",value:function(){return this.controller.cContent.renderViewContent()}},{key:"footer",value:function(){return this.renderFooter()}},{key:"renderFooter",value:function(){var e;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex align-items-center"},null===(e=this.controller.cComments)||void 0===e?void 0:e.renderWriteComment())}},{key:"renderDirView",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:"d-block bg-white"},o.a.createElement("div",{className:"bg-white"},e.renderTaskDirTop(),o.a.createElement("div",{className:"py-2"},e.controller.cContent.renderDirContent())),e.renderDirBottom())})))}},{key:"renderTop",value:function(){return o.a.createElement("div",{className:"d-flex px-3 py-3 border-top border-bottom bg-light"},this.renderIcon(),o.a.createElement("div",null,this.renderCaption(),o.a.createElement("div",null,this.renderFrom(),o.a.createElement("span",{className:"mr-3"},this.renderEditTime()))))}},{key:"renderTaskDirTop",value:function(){return o.a.createElement("div",{className:"d-flex pr-3 pl-2 py-2"},this.renderIcon(),o.a.createElement("div",null,this.renderCaption(),this.renderFrom()),o.a.createElement("span",{className:"ml-auto"},this.renderEditTime()))}},{key:"renderDirBottom",value:function(){var e=this.renderToCount(),t=this.renderSpawnCount(),n=this.renderCommentFlag();if(e||t||n)return o.a.createElement("div",{className:"d-flex align-items-center px-3 mb-1"},e,t,n,o.a.createElement("div",{className:"mr-auto"}))}},{key:"renderCaption",value:function(){var e=this.controller.caption,t=e?o.a.createElement("b",{className:"text-primary"},e):o.a.createElement("span",{className:"text-info"},"\u4efb\u52a1");return o.a.createElement("div",{className:"pr-3"},o.a.createElement("span",{className:"mr-2"},t)," ",this.renderState())}},{key:"renderParam",value:function(e){var t=e.label,n=e.values,r=e.onClick;return o.a.createElement("div",{key:t,className:"px-3 py-2 bg-white d-flex align-items-center border-bottom",onClick:r},o.a.createElement("div",{className:"text-muted mr-3 w-5c"},t),o.a.createElement("div",{className:"flex-fill mr-3 "},n||Ae),r?o.a.createElement(h.FA,{className:"ml-auto",name:"angle-right"}):void 0)}},{key:"renderTaskAdditions",value:function(){var e=this;return o.a.createElement("div",null,this.additionRows.map((function(t){return e.renderParam(t)})))}},{key:"renderPoint",value:function(){return o.a.createElement("div",{className:"flex-fill form-control border-0"},this.controller.point)}},{key:"renderAssignHours",value:function(){return o.a.createElement("div",{className:"flex-fill form-control border-0"},N(this.controller.assignhours))}},{key:"renderHours",value:function(){return o.a.createElement("div",{className:"flex-fill form-control border-0"},N(this.controller.hours))}},{key:"renderViewBottom",value:function(){}},{key:"renderRelatives",value:function(){return this.renderVm(sr)}},{key:"renderState",value:function(){return o.a.createElement(o.a.Fragment,null,"state")}},{key:"renderCheckItem",value:function(e,t){var n,r=e.key,a=e.text,i=e.checked,c="form-control-plaintext ml-3 ";return!0===i?(c+="text-muted",n=o.a.createElement("del",null,a)):n=a,o.a.createElement("label",{key:r,className:"d-flex mx-3 my-0 align-items-center form-check"},o.a.createElement("input",{className:"form-check-input mr-3 mt-0",type:"checkbox",defaultChecked:i,onChange:this.onCheckChange,"data-key":r,disabled:!t}),o.a.createElement("div",{className:c},n))}},{key:"back",get:function(){return"close"}},{key:"additionRows",get:function(){return[{label:"\u5206\u6d3e\u5de5\u65f6",values:this.renderAssignHours()},{label:"\u5b9e\u9645\u5de5\u65f6",values:this.renderHours()}]}}]),n}(Se),hr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){var e=this.controller.taskStateResult;return this.renderStateSpan(e.content,e.isEnd)}},{key:"renderTaskAdditions",value:function(){var e=this,t=[{label:"\u5206\u6d3e\u5de5\u65f6",values:this.renderAssignHours()},{label:"\u5b9e\u9645\u5de5\u65f6",values:this.renderHours()}],n=this.controller.noteItem.obj,r=n.checker,a=n.rater;return o.a.createElement("div",null,t.map((function(t){return e.renderParam(t)})),r?this.renderChecker():void 0,a?this.renderRater():void 0)}},{key:"renderChecker",value:function(){return o.a.createElement("div",null,"\u68c0\u67e5\u4eba")}},{key:"renderRater",value:function(){return o.a.createElement("div",null,"\u8bc4\u5206\u4eba")}}]),n}(lr),dr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(hr),fr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(hr)}},{key:"renderDirItem",value:function(e){return this.renderView(dr)}},{key:"initModelData",value:function(){if(void 0!==this.noteModel&&void 0!==this.noteModel.flowContent){this.noteItem.flowContent=this.noteModel.flowContent,I(this.noteItem);var e=this.noteItem.obj;this.initobj(e)}}},{key:"allowCheck",get:function(){return!1}},{key:"taskStateResult",get:function(){return Pn(this.noteItem)}}]),n}(ur),pr=(Bn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).cContent=void 0,Object(L.a)(e,"checker",Un,Object(U.a)(e)),Object(L.a)(e,"rater",Ln,Object(U.a)(e)),e.point=100,Object(L.a)(e,"assignhours",qn,Object(U.a)(e)),Object(L.a)(e,"changed",Mn,Object(U.a)(e)),e.duplicateAssign=function(){var t=Object(Q.a)({},e.noteItem);t.obj=JSON.parse(t.content),t.commentCount=0,t.commentUnread=0,t.note=void 0,e.closePage(),e.owner.duplicateAssign(t)},e.saveAndAssingTo=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.AddNote();case 2:return n=t.sent,(r=new rr(e.cApp,n,!0)).SetTopKey(e.TopKey),t.next=7,r.start();case 7:case"end":return t.stop()}}),t)}))),e.showAssignTo=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new rr(e.cApp,Object(U.a)(e)),t.next=3,n.start();case 3:case"end":return t.stop()}}),t)}))),e.assignTask=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i,c,o,u,s,l,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=e.noteItem.note,o=e.noteItem,u=o.caption,s=o.content,l=JSON.parse(s),e.checker?l.checker=x(e.checker.contact):delete l.checker,e.rater?l.rater=x(e.rater.contact):delete l.rater,l.assignhours=e.assignhours,l.point=e.point,h={groupFolder:e.owner.currentFold.groupFolder,folder:e.owner.currentFold.folderId,note:c,caption:u,content:JSON.stringify(l),tos:n.map((function(e){return{to:e}})),checker:null===(r=e.checker)||void 0===r?void 0:r.contact,rater:null===(i=e.rater)||void 0===i?void 0:i.contact,point:e.point},t.next=10,e.uqs.notes.AssignTask.submit(h);case 10:return t.next=12,e.lodeModel();case 12:e.noteItem.spawnCount=e.noteModel.spawn.length;case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showSpawn=function(){var t=Object(i.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new fr(e.owner)).init(n),t.next=4,r.lodeModel();case 4:r.initModelData(),r.showViewPage();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"init",value:function(e){var t;Object(X.a)(Object(Y.a)(n.prototype),"init",this).call(this,e),this.cContent=new Ue(this.res),e&&(this.caption=e.caption,t=e.obj,this.assignhours=t.assignhours),this.cContent.init(t)}},{key:"renderIcon",value:function(){return ee("list","text-primary")}},{key:"endContentInput",value:function(){var e=this.noteItem?Object(Q.a)({},this.noteItem.obj):{};return this.cContent.endInput(e),e.assignhours=this.assignhours,e}},{key:"renderDirItem",value:function(e){return this.renderView(er)}},{key:"showViewPage",value:function(){this.openVPage(Yn)}},{key:"showEditPage",value:function(){}},{key:"showAddPage",value:function(){this.cContent.startInput(),this.startAction(),this.openVPage(Zn)}},{key:"isContentChanged",get:function(){return this.changed||this.cContent.changed}},{key:"type",get:function(){return O.assign}},{key:"isNoteEmpty",get:function(){return void 0===this.caption||0===this.caption.trim().length||this.cContent.isEmpty}}]),n}(In),Un=Object(g.a)(Bn.prototype,"checker",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Object(g.a)(Bn.prototype,"rater",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qn=Object(g.a)(Bn.prototype,"assignhours",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Mn=Object(g.a)(Bn.prototype,"changed",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(g.a)(Bn.prototype,"isContentChanged",[q.g],Object.getOwnPropertyDescriptor(Bn.prototype,"isContentChanged"),Bn.prototype),Object(g.a)(Bn.prototype,"isNoteEmpty",[q.g],Object.getOwnPropertyDescriptor(Bn.prototype,"isNoteEmpty"),Bn.prototype),Bn),vr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"tabs",get:function(){return[this.tabComment,this.tabShare]}}]),n}(Jn),mr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,e.controller.header)})))}}]),n}(h.View),br=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return this.renderVm(mr)}},{key:"renderRelatives",value:function(){return this.renderVm(vr)}},{key:"footer",value:function(){return this.renderFooter()}},{key:"renderFooter",value:function(){return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex align-items-center"},this.renderShareButton(),this.controller.cComments.renderWriteComment())}},{key:"renderContent",value:function(){return this.controller.cContent.renderViewContent()}}]),n}(Se),yr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).dropdownActions={text:{icon:"file-o",caption:e.t("noteText"),action:e.controller.changeToText},list:{icon:"list",caption:e.t("noteList"),action:e.controller.changeToList},checkable:{icon:"check-square-o",caption:e.t("noteCheckable"),action:e.controller.changeToCheckable}},e}return Object(p.a)(n,[{key:"header",value:function(){return this.renderVm(mr)}},{key:"renderContent",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t=e.controller,n=t.cType,r=t.cContent;return o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"d-none"},n),r.renderInput())})))}},{key:"renderEditBottom",value:function(){var e=this;return o.a.createElement("div",{className:"py-2 pl-3 bg-light border-top d-flex"},this.renderButtonLeft(),o.a.createElement("div",{className:"mr-auto"}),o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSave()},className:"btn btn-primary mr-3",disabled:!e.controller.isNoteChanged},"\u4fdd\u5b58"))}))),this.renderExButtons())}},{key:"renderExButtons",value:function(){return this.renderDeleteButton()}},{key:"renderButtonLeft",value:function(){var e=this;return o.a.createElement(h.DropdownActions,{actions:this.controller.dropdowns.map((function(t){return e.dropdownActions[t]})),icon:"th-list",itemIconClass:"text-info",isRight:!1,className:"cursor-pointer btn btn-lg p-1 mr-1"})}}]),n}(Ie),kr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).onSaveAndSendNote=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.AddNote();case 2:return n=t.sent,e.closePage(),t.next=6,n.cApp.loadRelation();case 6:n.showShareTo();case 7:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return o.a.createElement(o.a.Fragment,null,"\u65b0\u5efa")}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.AddNote();case 2:return this.closePage(),e.abrupt("return");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderExButtons",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return e.renderShareButton()})))}},{key:"renderShareButton",value:function(){return o.a.createElement("button",{onClick:this.onSaveAndSendNote,className:"btn btn-outline-primary mr-3"},"\u53d1\u7ed9")}}]),n}(yr),gr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderContent",value:function(){return this.controller.cContent.renderDirContent()}}]),n}(Ne),wr=(zn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"header",Hn,Object(U.a)(e)),Object(L.a)(e,"cType",Wn,Object(U.a)(e)),Object(L.a)(e,"dropdowns",Gn,Object(U.a)(e)),Object(L.a)(e,"cContent",$n,Object(U.a)(e)),e.changeToText=function(){if(e.cType!==O.text){var t=e.cContent.toString();e.createTextContent(),e.cContent.reset(t),e.noteItem&&(e.noteItem.type=O.text)}},e.changeToList=function(){if(e.cType!==O.textList){var t=e.cContent.toString();e.createListContent(),e.cContent.reset(t),e.noteItem&&(e.noteItem.type=O.textList)}},e.changeToCheckable=function(){if(e.cType!==O.textCheckable){var t=e.cContent.toString();e.createCheckableContent(),e.cContent.reset(t),e.noteItem&&(e.noteItem.type=O.textCheckable)}},e}return Object(p.a)(n,[{key:"createTextContent",value:function(){this.header=this.t("noteText"),this.cContent=new Ke(this.res),this.cType=O.text,this.dropdowns=["list","checkable"]}},{key:"createListContent",value:function(){this.header=this.t("noteList"),this.cContent=new Me(this.res),this.cType=O.textList,this.dropdowns=["text","checkable"]}},{key:"createCheckableContent",value:function(){this.header=this.t("noteCheckable"),this.cContent=new Ue(this.res),this.cType=O.textCheckable,this.dropdowns=["text","list"]}},{key:"init",value:function(e){if(Object(X.a)(Object(Y.a)(n.prototype),"init",this).call(this,e),e){if(void 0===this.cContent)throw new Error("this.cContent should have created");this.cContent.init(e.obj)}}},{key:"renderIcon",value:function(){return ee("file-o","text-info")}},{key:"endContentInput",value:function(){var e=this.noteItem?Object(Q.a)({},this.noteItem.obj):{};return this.cContent.endInput(e),e}},{key:"renderDirItem",value:function(e){return this.renderView(gr)}},{key:"showViewPage",value:function(){this.openVPage(br)}},{key:"showEditPage",value:function(){this.cContent.startInput(),this.openVPage(yr)}},{key:"showAddPage",value:function(){this.cContent.startInput(),this.openVPage(kr)}},{key:"isContentChanged",get:function(){return this.cContent.changed}},{key:"type",get:function(){return this.cType}}]),n}(In),Hn=Object(g.a)(zn.prototype,"header",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wn=Object(g.a)(zn.prototype,"cType",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Object(g.a)(zn.prototype,"dropdowns",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$n=Object(g.a)(zn.prototype,"cContent",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(g.a)(zn.prototype,"isContentChanged",[q.g],Object.getOwnPropertyDescriptor(zn.prototype,"isContentChanged"),zn.prototype),zn),Or=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).onClickHours=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new at(e.controller.owner),t.next=3,n.inputHours(e.controller.hours);case 3:r=t.sent,e.closePage(),void 0!==r&&(e.controller.hours=r);case 6:case"end":return t.stop()}}),t)}))),e.onDone=Object(i.a)(a.a.mark((function t(){var n,r,i,c,u,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.DoneTask();case 2:e.closePage(),n=e.controller.noteItem.obj,r=n.checker,i=n.rater,void 0===r&&void 0===i?c=o.a.createElement("div",{className:"text-danger"},o.a.createElement(h.FA,{className:"mr-1",name:"stop"}),"\u4efb\u52a1\u5b8c\u6210"):(u=r?o.a.createElement("div",{className:"px-3 py-2 bg-white d-flex border-bottom"},o.a.createElement("div",{className:"text-muted mr-3 w-5c"},"\u68c0\u67e5\u4eba"),o.a.createElement("div",{className:"mr-3 "},e.renderContact(r))):void 0,s=i?o.a.createElement("div",{className:"px-3 py-2 bg-white d-flex border-bottom"},o.a.createElement("div",{className:"text-muted mr-3 w-5c"},"\u8bc4\u5206\u4eba"),o.a.createElement("div",{className:"mr-3 "},e.renderContact(i))):void 0,c=o.a.createElement("div",null,o.a.createElement("div",{className:"text-success"},"\u4efb\u52a1\u5b8c\u6210"),u,s)),e.showActionEndPage({content:c});case 7:case"end":return t.stop()}}),t)}))),e.renderContact=function(e){if(!e)return Ae;return o.a.createElement(h.UserView,{user:e,render:function(e){var t=e.name,n=e.nick,r=e.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-1c h-1c mr-1",src:r||".user-o"}),o.a.createElement("span",{className:"mr-3"},n||t))}})},e}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u5f85\u529e")}},{key:"renderViewBottom",value:function(){var e,t=this.controller.noteItem.owner;return!0===this.isMe(t)&&(e=o.a.createElement("button",{onClick:this.onDone,className:"btn btn-primary mx-3"},"\u5b8c\u6210")),o.a.createElement("div",{className:"py-2 bg-light border-top d-flex"},e,o.a.createElement("div",{className:"mr-auto"}),undefined)}},{key:"renderHours",value:function(){return o.a.createElement("div",{className:"flex-fill form-control border-0"},N(this.controller.hours))}},{key:"additionRows",get:function(){return[{label:"\u5206\u6d3e\u5de5\u65f6",values:this.renderAssignHours()},{label:"\u5b9e\u9645\u5de5\u65f6",values:this.renderHours(),onClick:this.onClickHours}]}}]),n}(lr),jr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Or),xr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(Or)}},{key:"renderDirItem",value:function(e){return this.renderView(jr)}},{key:"DoneTask",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.noteItem,n=t.note,r=t.caption,i=this.endContentInput(),c=JSON.stringify(i),o={groupFolder:this.owner.currentFold.groupFolder,folder:this.owner.currentFold.folderId,note:x(n),content:c,caption:r,hours:this.hours},e.next=6,this.uqs.notes.DoneTask.submit(o);case 6:this.noteItem.state=jn.Done,this.noteItem.flowContent=c,this.noteItem.$update=new Date,this.owner.currentFold.taskUpdateState(this.noteItem);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"allowCheck",get:function(){return this.isMe(this.noteItem.owner)}},{key:"taskStateResult",get:function(){return{content:"\u5f85\u529e",isEnd:!1}}}]),n}(ur),Er=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){var e=this.controller.noteItem.obj;if(e){if(e.checker)return this.renderStateSpan("\u5f85\u9a8c\u6536");if(e.rater)return this.renderStateSpan("\u5f85\u8bc4\u5206")}return this.renderStateSpan("\u5df2\u529e",!0)}}]),n}(lr),Cr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Er),Nr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderDirItem",value:function(e){return this.renderView(Cr)}},{key:"showViewPage",value:function(){this.openVPage(Er)}},{key:"taskStateResult",get:function(){return{content:"\u5df2\u529e",isEnd:!0}}}]),n}(ur),Ir=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u5df2\u53d6\u6d88",!0)}}]),n}(lr),Sr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Ir),Ar=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderDirItem",value:function(e){return this.renderView(Sr)}},{key:"showViewPage",value:function(){this.openVPage(Ir)}},{key:"taskStateResult",get:function(){return{content:"\u5df2\u53d6\u6d88",isEnd:!1}}}]),n}(ur),Pr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){var e=this.controller.noteItem.obj;if(e&&e.rater)return this.renderStateSpan("\u5f85\u8bc4\u4ef7");return this.renderStateSpan("\u7b7e\u6536",!0)}}]),n}(lr),Tr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Pr),Fr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(Pr)}},{key:"renderDirItem",value:function(e){return this.renderView(Tr)}},{key:"taskStateResult",get:function(){return{content:"\u7b7e\u6536",isEnd:!0}}}]),n}(ur),Vr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u62d2\u7b7e",!0)}}]),n}(lr),Rr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Vr),_r=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(Vr)}},{key:"renderDirItem",value:function(e){return this.renderView(Rr)}},{key:"taskStateResult",get:function(){return{content:"\u62d2\u7b7e",isEnd:!0}}}]),n}(ur),Dr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u5df2\u8bc4\u4ef7",!0)}}]),n}(lr),Br=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Dr),Ur=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(Dr)}},{key:"renderDirItem",value:function(e){return this.renderView(Br)}},{key:"taskStateResult",get:function(){return{content:"\u5df2\u8bc4\u4ef7",isEnd:!0}}}]),n}(ur),Lr=(Kn=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r){var c;return Object(f.a)(this,n),c=t.call(this,e),Object(L.a)(c,"disabled",Qn,Object(U.a)(c)),c.inputText=void 0,c.props=void 0,c.onUpdate=function(){c.disabled=!0,c.openPageElement(o.a.createElement(Object(M.a)((function(){var e=function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==c.disabled){e.next=2;break}return e.abrupt("return");case 2:return t=c.inputText.trim(),e.next=5,c.props.onUpdate(t);case 5:c.closePage();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=o.a.createElement("button",{className:"btn btn-sm btn-success mr-2",disabled:c.disabled,onClick:e},"\u4fdd\u5b58");return o.a.createElement(h.Page,{header:c.props.header,back:"close",right:t},o.a.createElement("div",{className:"p-3"},o.a.createElement("input",{className:"form-control",type:"text",onChange:function(e){c.inputText=e.target.value,c.disabled=c.props.content===c.inputText},onKeyDown:function(t){13===t.keyCode&&e()},defaultValue:c.props.content})))}))))},c.props=r,c.inputText=c.props.content,c}return Object(p.a)(n,[{key:"render",value:function(e){return this.props=e,this.inputText=this.props.content,o.a.createElement(o.a.Fragment,null)}}]),n}(h.View),Qn=Object(g.a)(Kn.prototype,"disabled",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kn),qr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).onDiscribeChange=function(t){var n=t.target.value;n.length<=0&&(n=void 0),e.controller.updateCheckInfo(n)},e.onDiscribeKeyDown=function(t){13===t.keyCode&&e.controller.checkSaveInfo()},e.onCheck=function(){var t=Object(i.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.checkTask(n);case 2:e.closePage(),r=n?o.a.createElement("span",{className:"text-success"},o.a.createElement(h.FA,{name:"check"})," \u9a8c\u6536\u901a\u8fc7"):o.a.createElement("span",{className:"text-secondary"},o.a.createElement(h.FA,{name:"check"})," \u9a8c\u6536\u4e0d\u901a\u8fc7"),e.showActionEndPage({content:r});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.resultPage=function(t){var n=t.pass,r=e.controller.caption,a=n?o.a.createElement("span",{className:"text-success"},o.a.createElement(h.FA,{name:"check"})," \u9a8c\u6536\u901a\u8fc7"):o.a.createElement("span",{className:"text-secondary"},o.a.createElement(h.FA,{name:"check"})," \u9a8c\u6536\u4e0d\u901a\u8fc7");return o.a.createElement(h.Page,{header:r,back:"close"},o.a.createElement("div",{className:"border bg-white rounded m-5"},o.a.createElement("div",{className:"py-5 text-center"},a),o.a.createElement("div",{className:"border-top text-center py-3"},o.a.createElement("button",{className:"btn btn-outline-info",onClick:function(){return e.closePage()}},"\u8fd4\u56de"))))},e}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u5f85\u9a8c\u6536")}},{key:"renderCheckItem",value:function(e){var t,n=this,r=e.key,c=e.text,u=e.checked,s=e.checkInfo,l="form-control-plaintext ml-3 ";!0===u?(l+="text-muted",t=o.a.createElement("del",null,c)):t=c;var d={onUpdate:function(){var t=Object(i.a)(a.a.mark((function t(r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.controller.setCheckInfo(e,r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),content:s,header:"\u9a8c\u6536\u4e8b\u9879\u8bf4\u660e"},f=new Lr(this.controller,d);return o.a.createElement("div",{key:r,className:"d-flex"},o.a.createElement("label",{className:"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check"},o.a.createElement("input",{className:"form-check-input mr-3 mt-0",type:"checkbox",defaultChecked:u,"data-key":r,disabled:!this.controller.allowCheck}),o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:l},t),s&&o.a.createElement("div",{className:"mt-1 ml-3 small"},o.a.createElement(h.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info cursor-ponter",onClick:f.onUpdate},s)))),o.a.createElement("div",{className:"p-2 cursor-pointer",onClick:f.onUpdate},o.a.createElement(h.FA,{name:"pencil-square-o text-info"})))}},{key:"renderOrtherContent",value:function(){var e=this.controller.checkInfo;return o.a.createElement("div",{className:"px-3 py-2 d-flex align-items-center border-bottom"},o.a.createElement("div",{className:"text-muted mr-1 w-5c"},"\u9a8c\u6536\u610f\u89c1"),o.a.createElement("div",{className:"flex-fill mr-3 "},o.a.createElement("input",{className:"flex-fill form-control border-0",type:"text",step:"1",min:"1",defaultValue:e,onChange:this.onDiscribeChange,onKeyDown:this.onDiscribeKeyDown})))}},{key:"renderViewBottom",value:function(){var e=this,t=o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){return e.onCheck(!0)},className:"btn btn-success mx-3"},o.a.createElement(h.FA,{name:"check"})," \u901a\u8fc7"),o.a.createElement("button",{onClick:function(){return e.onCheck(!1)},className:"btn btn-outline-secondary mx-3"},o.a.createElement(h.FA,{name:"times"})," \u4e0d\u901a\u8fc7"));return o.a.createElement(o.a.Fragment,null,this.renderOrtherContent(),o.a.createElement("div",{className:"py-2 bg-light border-top d-flex"},t,o.a.createElement("div",{className:"mr-auto"})))}}]),n}(lr),Mr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(qr),zr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(qr)}},{key:"renderDirItem",value:function(e){return this.renderView(Mr)}},{key:"checkTask",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkSaveInfo();case 2:return n=this.noteItem.note,r=this.endContentInput(),i=JSON.stringify(r),c={groupFolder:this.owner.currentFold.groupFolder,folder:this.owner.currentFold.folderId,note:x(n),action:t?1:2,content:i},e.next=8,this.uqs.notes.CheckTask.submit(c);case 8:this.noteItem.state=t?jn.Pass:jn.Fail,this.noteItem.flowContent=i,this.noteItem.$update=new Date,this.owner.currentFold.taskUpdateState(this.noteItem);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setCheckInfo",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n||0===n.length?delete t.checkInfo:t.checkInfo=n,e.next=3,this.saveX();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"taskStateResult",get:function(){return{content:"check",isEnd:!1}}}]),n}(ur),Hr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).rateValue=0,e.onDiscribeChange=function(t){var n=t.target.value;n.length<=0&&(n=void 0),e.controller.updateRateInfo(n)},e.onDiscribeKeyDown=function(t){13===t.keyCode&&e.controller.checkSaveInfo()},e.onChange=function(t){e.rateValue=Number(t.target.value)},e.onRate=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.rateTask(e.rateValue);case 2:e.closePage(),n=o.a.createElement(o.a.Fragment,null,"\u8bc4\u4ef7\u5b8c\u6210"),e.showActionEndPage({content:n});case 5:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"renderState",value:function(){return this.renderStateSpan("\u5f85\u8bc4\u4ef7")}},{key:"renderCheckItem",value:function(e){var t,n=e.key,r=e.text,a=e.checked,i=e.checkInfo,c="form-control-plaintext ml-3 ";return!0===a?(c+="text-muted",t=o.a.createElement("del",null,r)):t=r,o.a.createElement("label",{key:n,className:"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check"},o.a.createElement("input",{className:"form-check-input mr-3 mt-0",type:"checkbox",defaultChecked:a,"data-key":n,disabled:!this.controller.allowCheck}),o.a.createElement("div",{className:"flex-grow-1"},o.a.createElement("div",{className:c},t),i&&o.a.createElement("div",{className:"mt-1 ml-3 small"},o.a.createElement(h.FA,{name:"comment-o",className:"mr-2 text-primary"}),o.a.createElement("span",{className:"text-info cursor-ponter"},i))))}},{key:"renderOrtherContent",value:function(){var e=this.controller,t=e.rateInfo,n=e.checkInfo;return o.a.createElement("div",null,n&&o.a.createElement("div",{className:"px-3 py-2 d-flex align-items-center border-bottom"},o.a.createElement("div",{className:"text-muted mr-1 w-5c"},"\u9a8c\u6536\u610f\u89c1"),o.a.createElement("div",{className:"flex-fill mr-3 "},o.a.createElement("input",{className:"flex-fill form-control border-0",type:"text",step:"1",min:"1",defaultValue:n,disabled:!0}))),o.a.createElement("div",{className:"px-3 py-2 d-flex align-items-center border-bottom"},o.a.createElement("div",{className:"text-muted mr-1 w-5c"},"\u8bc4\u5206\u610f\u89c1"),o.a.createElement("div",{className:"flex-fill mr-3 "},o.a.createElement("input",{className:"flex-fill form-control border-0",type:"text",step:"1",min:"1",defaultValue:t,onChange:this.onDiscribeChange,onKeyDown:this.onDiscribeKeyDown}))))}},{key:"renderViewBottom",value:function(){var e=this,t=o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){return e.onRate()},className:"btn btn-success mx-3"},"\u8bc4\u4ef7"));return o.a.createElement("div",null,this.renderOrtherContent(),this.renderValueRadio(),o.a.createElement("div",{className:"py-2 bg-light border-top d-flex"},t,o.a.createElement("div",{className:"mr-auto"})))}},{key:"renderValueRadio",value:function(){var e=this;return o.a.createElement("div",{className:"my-3"},[{val:2,text:"\u5353\u8d8a"},{val:1,text:"\u8c22\u8c22"}].map((function(t,n){var r=t.val,a=t.text;return o.a.createElement("label",{key:n,className:"mb-0 mx-3"},o.a.createElement("input",{className:"mr-1",type:"radio",value:r,defaultChecked:e.rateValue===r,name:"ratevalue",onChange:e.onChange}),a)})))}}]),n}(lr),Wr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return this.renderDirView()}}]),n}(Hr),Gr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"showViewPage",value:function(){this.openVPage(Hr)}},{key:"renderDirItem",value:function(e){return this.renderView(Wr)}},{key:"rateTask",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.rateValueInput=t,e.next=3,this.checkSaveInfo();case 3:return n=this.noteItem.note,r=this.endContentInput(),i=JSON.stringify(r),c={groupFolder:this.owner.currentFold.groupFolder,folder:this.owner.currentFold.folderId,note:x(n),value:t,content:i},e.next=9,this.uqs.notes.RateTask.submit(c);case 9:this.noteItem.state=jn.Rated,this.noteItem.flowContent=i,this.noteItem.$update=new Date,this.owner.currentFold.taskUpdateState(this.noteItem);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRateInfo",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n||0===n.length?delete t.rateInfo:t.rateInfo=n,e.next=3,this.saveX();case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"taskStateResult",get:function(){return{content:"rate",isEnd:!0}}}]),n}(ur);var $r,Kr,Qr,Jr,Xr,Yr,Zr,ea,ta,na,ra,aa,ia,ca,oa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"\u64cd\u4f5c"}},{key:"content",value:function(){return o.a.createElement("div",{className:""},o.a.createElement("div",{className:"text-muted small px-3 py-1 mt-2"},"\u6536\u4ef6\u4eba"),o.a.createElement("div",{className:"border rounded p-3 mb-3"},this.renderSelectedContact(this.controller.contacts)),o.a.createElement("div",{className:"px-3 py-2 cursor-pointer bg-white mt-1",onClick:this.controller.onSendOut},"\u5206\u4eab\u5185\u5bb9"))}}]),n}(z),ua=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;Object(f.a)(this,n);var i=r.currentFold,c=i.groupFolder,o=i.currentNoteItem;return void 0===o&&(o=i.noteItem),(a=t.call(this,e,c,o)).cNotes=void 0,a.cNotes=r,a}return Object(p.a)(n,[{key:"sendOut",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cNotes.sendNoteTo(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"afterContactsSelected",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(oa);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"GetContacts",get:function(){return this.uqs.notes.GetShareContacts}}]),n}(et),sa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).foldStack=void 0,e.rootFold=void 0,e.currentFold=void 0,e.noteItem=void 0,e.noteItemConverter=function(t,n){I(t);var r=e.createCNoteBase(t);return r.init(t),r},e.showAddNoteTextPage=function(){e.createCNoteText().showAddPage()},e.showAddNoteListPage=function(){e.createCNoteList().showAddPage()},e.showAddNoteCheckablePage=function(){e.createCNoteCheckable().showAddPage()},e.showAddMyFolderPage=function(){var t=new Jt(Object(U.a)(e));t.init(void 0),t.showAddPage()},e.showAddGroupPage=function(){var t=new zt(Object(U.a)(e));t.init(void 0),t.showAddPage()},e.showAddAssignPage=function(){var t=new pr(Object(U.a)(e));t.init(void 0),t.showAddPage()},e.duplicateAssign=function(t){var n=new pr(Object(U.a)(e));n.init(t),n.showAddPage()},e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.rootFold=this.currentFold=this.newSub(Zt),this.foldStack=[]}},{key:"itemChanged",value:function(e){var t=this.currentFold.itemChanged(e);if(this.foldStack.length>0){var n,r=Object(B.a)(this.foldStack);try{for(r.s();!(n=r.n()).done;){t=n.value.itemChanged(t)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"openFolder",value:function(e){this.foldStack.push(this.currentFold),this.currentFold=e,this.currentFold.showFolder()}},{key:"popFolder",value:function(){this.currentFold=this.foldStack.pop()}},{key:"createCNoteBase",value:function(e){switch(e.type){default:throw Error("unknown type");case O.text:return this.createCNoteText();case O.textList:return this.createCNoteList();case O.textCheckable:return this.createCNoteCheckable();case O.folder:return function(e,t){return!0===e.isMe(t.owner)?new Jt(e):new Yt(e)}(this,e);case O.task:return function(e,t){switch(t.state){default:case jn.Start:return new xr(e);case jn.Done:return t&&e.isMe(t.obj.checker)?new zr(e):new Nr(e);case jn.Pass:return t&&e.isMe(t.obj.rater)?new Gr(e):new Fr(e);case jn.Fail:return new _r(e);case jn.Rated:return new Ur(e);case jn.Canceled:return new Ar(e)}}(this,e);case O.group:throw Error("type group undefined");case O.groupFolder:return new zt(this);case O.unit:throw Error("type unit undefined");case O.assign:return new pr(this);case O.unitNote:return function(e){return new wn(e)}(this)}}},{key:"createCNoteText",value:function(){var e=new wr(this);return e.createTextContent(),e}},{key:"createCNoteList",value:function(){var e=new wr(this);return e.createListContent(),e}},{key:"createCNoteCheckable",value:function(){var e=new wr(this);return e.createCheckableContent(),e}},{key:"load",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentFold.load();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentFold.refresh();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i,c){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentFold.addNote(t,n,r,i,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"editNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n,r,i,c){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentFold.editNote(t,n,r,i,c);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"sendNoteTo",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentFold,r=n.groupFolder,void 0===(i=n.currentNoteItem)&&(i=this.currentFold.noteItem),c=i.note,o=t.join("|"),e.next=6,this.uqs.notes.SendNoteTo.submit({groupFolder:r,note:c,tos:o});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hideNote",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currentFold.hideNote(t,n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderNotesView",value:function(){return this.currentFold.renderListView()}},{key:"renderHomeDropDown",value:function(){return new G(this).render()}},{key:"renderFolderDropDown",value:function(){return new $(this).render()}},{key:"renderSpaceDropDown",value:function(){return new K(this).render()}},{key:"showShareTo",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ua(this.cApp,this),e.next=3,t.start();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callSelectContact",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.vCall(H,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b),la=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.controller.cNotes,t=this.controller.cNotes.renderHomeDropDown();return o.a.createElement(h.Page,{header:this.t("home"),right:t},e.renderNotesView())}}]),n}(h.VPage),ha=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).cNotes=void 0,e.tab=function(){return e.renderView(la)},e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cNotes.refresh();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.cNotes=this.newC(sa)}},{key:"load",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cNotes.load();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(b),da=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"addContact",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.controller.AddContact(this.user.id);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Pe),fa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).renderContact=function(t,n){var r=t.contact,a=t.assigned;return o.a.createElement(h.UserView,{user:r,render:function(n){var r=n.name,i=n.nick,c=n.icon;return o.a.createElement("div",{className:"px-3 py-2 cursor-pointer",onClick:function(){return e.controller.onShowContact(t)}},o.a.createElement(h.Image,{className:"w-2c h-2c mr-3",src:c||".user-o"}),a||i||r)}})},e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("relation")}},{key:"right",value:function(){var e=this;return o.a.createElement("button",{className:"btn btn-sm btn-primary mr-1",onClick:function(){return e.openVPage(da)}},o.a.createElement(h.FA,{name:"user-plus"}))}},{key:"content",value:function(){return o.a.createElement("div",{className:""},o.a.createElement(h.List,{items:this.controller.contacts,item:{render:this.renderContact}}))}}]),n}(h.VPage),pa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onEditAlias=function(){e.controller.onEditAssigned()},e}return Object(p.a)(n,[{key:"init",value:function(e){}},{key:"header",value:function(){return" "}},{key:"content",value:function(){var e=this,t=this.controller.contact.contact;return o.a.createElement("div",null,o.a.createElement(h.UserView,{user:t,render:function(t){var n=t.id,r=t.name,a=t.nick,i=t.icon,c=e.controller.contact.assigned;return o.a.createElement("div",{className:"p-3 d-flex"},o.a.createElement(h.Image,{className:"w-3c h-3c mr-4",src:i||".user-o"}),o.a.createElement("div",null,o.a.createElement("div",{className:"h6"},o.a.createElement("b",null,c||a||r)),o.a.createElement("div",null,o.a.createElement(h.Muted,null,"id: "),n),o.a.createElement("div",null,o.a.createElement(h.Muted,null,"\u7528\u6237\u540d: "),r),a&&o.a.createElement("div",null,o.a.createElement(h.Muted,null,"\u522b\u540d: "),a)))}}),o.a.createElement(Object(M.a)((function(){return o.a.createElement("div",{className:"px-3 py-2 bg-white d-flex align-items-center border-bottom cursor-pointer",onClick:e.onEditAlias},o.a.createElement("div",{className:"text-muted mr-3 w-4c"},"\u5907\u6ce8\u540d"),o.a.createElement("div",{className:"flex-fill w-100 border-0 form-control mr-auto"},e.controller.contact.assigned||o.a.createElement(h.Muted,null,"[\u65e0]")),o.a.createElement(h.FA,{name:"angle-right"}))}))))}}]),n}(h.VPage),va=($r=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"assigned",Kr,Object(U.a)(e)),e.onChange=function(t){e.assigned=t.target.value.trim()},e.onKeyDown=function(t){13===t.keyCode&&(e.btnSaveDisabled||e.onButtonSave())},e}return Object(p.a)(n,[{key:"init",value:function(e){var t;this.assigned=null===(t=this.controller.contact)||void 0===t?void 0:t.assigned}},{key:"header",value:function(){return"\u7f16\u8f91"}},{key:"right",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{onClick:function(){return e.onButtonSave()},className:"btn btn-sm btn-success mr-1",disabled:e.btnSaveDisabled},"\u4fdd\u5b58"))})))}},{key:"onButtonSave",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.controller.SaveContactAssign(this.assigned),this.closePage();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"content",value:function(){return o.a.createElement("div",{className:"border rounded"},o.a.createElement("div",{className:"bg-white"},o.a.createElement("div",{className:"px-3 py-2 bg-white d-flex align-items-center border-bottom"},o.a.createElement("div",{className:"text-muted mr-3 w-4c"},"\u5907\u6ce8\u540d"),o.a.createElement("input",{type:"text",className:"flex-fill w-100 border-0 form-control",maxLength:80,autoFocus:!0,onChange:this.onChange,onKeyDown:this.onKeyDown,defaultValue:this.assigned}))))}},{key:"btnSaveDisabled",get:function(){return this.assigned===this.controller.contact.assigned}}]),n}(h.VPage),Kr=Object(g.a)($r.prototype,"assigned",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(g.a)($r.prototype,"btnSaveDisabled",[q.g],Object.getOwnPropertyDescriptor($r.prototype,"btnSaveDisabled"),$r.prototype),$r),ma=(Qr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),Object(L.a)(e,"contact",Jr,Object(U.a)(e)),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(e){this.contact=Object(Q.a)({},e)}},{key:"SaveContactAssign",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.owner.SaveContactAssign(this.contact,t);case 2:this.contact.assigned=t;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showContact",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(pa);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onEditAssigned",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(va);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(y),Jr=Object(g.a)(Qr.prototype,"contact",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qr),ba=(Xr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).loaded=!1,Object(L.a)(e,"contacts",Yr,Object(U.a)(e)),e.tab=function(){return e.renderView(fa)},e.load=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==e.loaded){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.uqs.notes.GetMyContacts.page({},0,500,!0);case 4:r=t.sent,(n=e.contacts).push.apply(n,Object(J.a)(r.$page)),e.loaded=!0;case 7:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"AddContact",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.AddContact.submit({contact:t});case 2:this.contacts.unshift({contact:t,assigned:void 0});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onShowContact",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.newSub(ma,t).showContact();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"SaveContactAssign",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={contact:t.contact,assigned:n},e.next=3,this.uqs.notes.SetContactAssinged.submit(r);case 3:void 0!==(i=this.contacts.find((function(e){return e.contact===t.contact})))&&(i.assigned=n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b),Yr=Object(g.a)(Xr.prototype,"contacts",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xr),ya=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).renderRootUnit=function(e,t){var n=e.id,r=e.owner,a=e.name,i=e.tonvaUnit,c=e.x,u=o.a.createElement("small",{className:"text-muted"},"ID=",n),s=0!==c?o.a.createElement("del",null,a," ",u):o.a.createElement(o.a.Fragment,null,o.a.createElement("b",null,a)," ",u);return o.a.createElement("div",{className:"px-3 py-2 align-items-center "},o.a.createElement("div",{className:"mr-3"},s),o.a.createElement("div",{className:"small text-muted d-flex align-items-center"},o.a.createElement(h.UserView,{user:r,render:function(e){var t=e.name,n=e.nick,r=e.icon;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.Image,{className:"w-1-5c h-1-5c mr-2",src:r||".user-o"}),n||t)}})),i&&o.a.createElement("div",{className:"ml-auto small text-muted"},"tonva=",i))},e.onClickRootUnit=function(t){var n=t.name;e.openPageElement(o.a.createElement(h.Page,{header:n},o.a.createElement(h.Edit,{schema:[{name:"name",type:"string"},{name:"tonvaUnit",type:"integer"},{name:"x",type:"boolean"}],uiSchema:{items:{name:{widget:"text",label:"\u673a\u6784\u540d\u79f0"},tonvaUnit:{widget:"number",label:"Tonva Unit"},x:{widget:"checkbox",label:"\u505c\u7528",trueValue:1,falseValue:0}}},data:t,onItemChanged:function(){var n=Object(i.a)(a.a.mark((function n(r,i,c){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.onItemChanged(t,r,i,c);case 2:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()})))},e.onItemChanged=function(){var t=Object(i.a)(a.a.mark((function t(n,r,i,c){var o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r.name,t.next="name"===t.t0?3:"tonvaUnit"===t.t0?9:"x"===t.t0?12:15;break;case 3:if((o=i.trim())!==c.trim()){t.next=6;break}return t.abrupt("break",15);case 6:return t.next=8,e.controller.changeRootUnitName(n,o);case 8:return t.abrupt("break",15);case 9:return t.next=11,e.controller.changeRootUnitTonva(n,i);case 11:return t.abrupt("break",15);case 12:return t.next=14,e.controller.changeRootUnitX(n,i);case 14:return t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u7ba1\u7406\u5458"}},{key:"content",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{className:"px-3 py-3 bg-white border-bottom"},o.a.createElement("div",null,o.a.createElement("b",{className:"text-info"},"\u4e3a\u7528\u6237\u521b\u5efa\u673a\u6784")),o.a.createElement("div",null,"\u7ed9\u6307\u5b9a\u7528\u6237\u521b\u5efa\u673a\u6784\u3002\u673a\u6784\u4e0b\u9762\u7684\u90e8\u95e8\u548c\u6210\u5458\uff0c\u7531\u673a\u6784\u6240\u6709\u8005\u521b\u5efa\u3002"),o.a.createElement("div",{className:"my-2"},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return e.openVPage(ka)}},"\u521b\u5efa"))),o.a.createElement(h.List,{items:this.controller.rootUnits,item:{render:this.renderRootUnit,onClick:this.onClickRootUnit}}))}}]),n}(h.VPage),ka=(Zr=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"hasError",ea,Object(U.a)(e)),Object(L.a)(e,"user",ta,Object(U.a)(e)),Object(L.a)(e,"inputName",na,Object(U.a)(e)),e.onKeyDown=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.hasError=!1,13!==n.keyCode){t.next=4;break}return t.next=4,e.onNext();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onChange=function(t){e.inputName=t.currentTarget.value},e.onNext=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.search(e.inputName.trim());case 2:!1===e.hasError&&(e.controller.unitOwner=e.user,e.openVPage(ga));case 3:case"end":return t.stop()}}),t)}))),e.search=function(){var t=Object(i.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.userApi.fromKey(n);case 2:if(r=t.sent){t.next=6;break}return e.hasError=!0,t.abrupt("return");case 6:e.user=r;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u673a\u6784\u6240\u6709\u8005"}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n;return!0===e.hasError&&(n=o.a.createElement("div",{className:"my-3 text-danger"},"\u7528\u6237\u4e0d\u5b58\u5728\uff01")),o.a.createElement("div",{className:"m-3"},o.a.createElement("div",null,o.a.createElement("input",{type:"text",className:"form-control",maxLength:100,placeholder:"\u7528\u6237",onFocus:function(){return e.hasError=!1},onKeyDown:e.onKeyDown,onChange:e.onChange})),n,o.a.createElement("div",{className:"my-2"},o.a.createElement("button",{className:"btn btn-primary",disabled:0===(null===(t=e.inputName)||void 0===t?void 0:t.trim().length),onClick:e.onNext},"\u4e0b\u4e00\u6b65")))})))}}]),n}(h.VPage),ea=Object(g.a)(Zr.prototype,"hasError",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ta=Object(g.a)(Zr.prototype,"user",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),na=Object(g.a)(Zr.prototype,"inputName",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zr),ga=(ra=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return e=t.call.apply(t,[this].concat(c)),Object(L.a)(e,"input",aa,Object(U.a)(e)),e.onChange=function(t){e.input=t.currentTarget.value},e.onKeyDown=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(13!==n.keyCode){t.next=3;break}return t.next=3,e.onCreate();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onCreate=Object(i.a)(a.a.mark((function t(){var n,r,i,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.createRootUnit({name:e.input.trim(),content:void 0,owner:e.controller.user.id});case 2:n=t.sent,r="\u9519\u8bef",i="text-danger",t.t0=n,t.next=-1===t.t0?11:-2===t.t0?13:7;break;case 7:return r="\u6210\u529f",i="text-success",c="\u673a\u6784\u521b\u5efa\u6210\u529f\uff01",t.abrupt("break",15);case 11:return c="\u65e0\u6743\u521b\u5efa\u673a\u6784",t.abrupt("break",15);case 13:return c="\u673a\u6784\u540d\u79f0\u5df2\u7ecf\u88ab\u4f7f\u7528\u4e86",t.abrupt("break",15);case 15:e.openPageElement(o.a.createElement(h.Page,{header:r,afterBack:function(){return e.closePage(3)},back:"close"},o.a.createElement("div",{className:"m-3 "+i},c)));case 16:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"header",value:function(){return"\u65b0\u5efa\u673a\u6784"}},{key:"content",value:function(){var e=this;return o.a.createElement(Object(M.a)((function(){var t,n=e.controller.unitOwner,r=n.icon,a=n.name,i=n.nick;return o.a.createElement("div",{className:"m-3"},o.a.createElement("div",{className:"my-2"},"\u6240\u6709\u8005: ",o.a.createElement(h.Image,{className:"w-2c h-2c",src:r})," ",null!==i&&void 0!==i?i:a," "),o.a.createElement("div",null,o.a.createElement("input",{type:"text",className:"form-control",maxLength:100,placeholder:"\u673a\u6784\u540d\u79f0",onChange:e.onChange,onKeyDown:e.onKeyDown})),o.a.createElement("div",{className:"my-2"},o.a.createElement("button",{className:"btn btn-primary",disabled:0===(null===(t=e.input)||void 0===t?void 0:t.trim().length),onClick:e.onCreate},"\u521b\u5efa\u673a\u6784")))})))}}]),n}(h.VPage),aa=Object(g.a)(ra.prototype,"input",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ra),wa=(ia=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(f.a)(this,n),(r=t.call(this,e)).schema=[{name:"nick",type:"string"},{name:"icon",type:"image"}],r.uiSchema={items:{nick:{widget:"text",label:"\u522b\u540d",placeholder:"\u597d\u7684\u522b\u540d\u66f4\u65b9\u4fbf\u8bb0\u5fc6"},icon:{widget:"image",label:"\u5934\u50cf"}}},Object(L.a)(r,"data",ca,Object(U.a)(r)),r.onItemChanged=function(){var e=Object(i.a)(a.a.mark((function e(t,n,i){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.name,e.next=3,h.userApi.userSetProp(c,n);case 3:r.data[c]=n,h.nav.user.name=n,h.nav.saveLocalUser();case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),r.page=function(){var e,t=Object(U.a)(r),n=t.schema,a=t.uiSchema,i=t.data,o=t.onItemChanged;return 2===(2&r.controller.role)&&(e=c.createElement("div",{className:"px-3 py-2 cursor-pointer bg-white border-bottom",onClick:r.controller.showAdmin},"\u7ba1\u7406\u5458")),c.createElement(h.Page,{header:"\u4e2a\u4eba\u4fe1\u606f"},c.createElement(h.Edit,{schema:n,uiSchema:a,data:i,onItemChanged:o}),e)};var o=h.nav.user,u=o.nick,s=o.icon;return r.data={nick:u,icon:s},r}return Object(p.a)(n,[{key:"open",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openPage(this.page);case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h.VPage),ca=Object(g.a)(ia.prototype,"data",[q.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ia),Oa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),u=0;u<r;u++)c[u]=arguments[u];return(e=t.call.apply(t,[this].concat(c))).onExit=function(){h.nav.showLogout()},e.changePassword=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.nav.changePassword();case 2:case"end":return e.stop()}}),e)}))),e.meInfo=Object(M.a)((function(){var t=h.nav.user;if(void 0===t)return null;var n=t.id,r=t.name,a=t.nick,i=t.icon;return o.a.createElement(h.LMR,{className:"py-2 cursor-pointer w-100",left:o.a.createElement(h.Image,{className:"w-3c h-3c mr-3",src:i||".user-o"}),right:o.a.createElement(h.FA,{className:"align-self-end",name:"angle-right"}),onClick:e.controller.showEditMe},o.a.createElement("div",null,o.a.createElement("div",null,ja(r,a)),o.a.createElement("div",{className:"small"},o.a.createElement("span",{className:"text-muted"},"ID:")," ",n>1e4?n:String(n+1e4).substr(1))))})),e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("me")}},{key:"content",value:function(){var e,t=h.nav.user,n=["",{type:"component",component:o.a.createElement("div",{className:"w-100 d-flex justify-content-between"},o.a.createElement(h.IconText,{iconClass:"text-info mr-2",icon:"smile-o",text:this.t("aboutTheApp")}),o.a.createElement("div",{className:"py-2 small"},"V",d.version))}];if(void 0===t)(e=n).push({type:"component",component:o.a.createElement("button",{className:"btn btn-success w-100 my-2",onClick:function(){return h.nav.logout()}},o.a.createElement(h.FA,{name:"sign-out",size:"lg"})," ",this.t("pleaseLogin"))});else{var r,a=["",{type:"component",bk:"",component:o.a.createElement("button",{className:"btn btn-danger w-100",onClick:this.onExit},o.a.createElement(h.FA,{name:"sign-out",size:"lg"})," ",this.t("logout"))}];(r=e=["",{type:"component",component:o.a.createElement(this.meInfo,null)},"",{type:"component",component:o.a.createElement(h.IconText,{iconClass:"text-info mr-2",icon:"key",text:this.t("changePassword")}),onClick:this.changePassword}]).push.apply(r,n.concat(a))}return o.a.createElement(h.PropGrid,{rows:Object(J.a)(e),values:{}})}}]),n}(h.VPage);function ja(e,t){return t?o.a.createElement(o.a.Fragment,null,o.a.createElement("b",null,t," \xa0 ",o.a.createElement("small",{className:"muted"},e))):o.a.createElement("b",null,e)}var xa,Ea,Ca=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).role=void 0,e.unitOwner=void 0,e.rootUnits=void 0,e.tab=function(){return e.renderView(Oa)},e.showEditMe=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.uqs.notes.GetSystemRole.query({});case 2:r=t.sent,e.role=null===(n=r.ret[0])||void 0===n?void 0:n.role,e.openVPage(wa);case 5:case"end":return t.stop()}}),t)}))),e.showAdmin=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.rootUnits=new h.QueryPager(e.uqs.notes.GetRootUnits,void 0,void 0,!0),e.rootUnits.first({}),e.openVPage(ya);case 3:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"createRootUnit",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.CreateRootUnit.submit(t);case 2:return n=e.sent,e.abrupt("return",n.id);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeRootUnitName",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.ChangeRootUnitProp.submit({unit:t.id,prop:"name",value:n});case 2:t.name=n;case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"changeRootUnitTonva",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.ChangeRootUnitProp.submit({unit:t.id,prop:"tonvaUnit",value:n});case 2:t.tonvaUnit=n;case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"changeRootUnitX",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.ChangeRootUnitProp.submit({unit:t.id,prop:"x",value:n});case 2:t.x=n;case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(b),Na=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onTaskReport=function(){alert("\u5b9e\u73b0\u4e2d")},e.onOtherReport=function(){alert("\u5b9e\u73b0\u4e2d")},e.items=[{icon:void 0,caption:"\u4efb\u52a1\u62a5\u8868",onClick:e.onTaskReport},{icon:void 0,caption:"\u5176\u5b83\u62a5\u8868",onClick:e.onOtherReport},"-",{icon:void 0,caption:"\u4efb\u52a1\u62a5\u8868",onClick:e.onTaskReport},{icon:void 0,caption:"\u5176\u5b83\u62a5\u8868",onClick:e.onOtherReport}],e}return Object(p.a)(n,[{key:"header",value:function(){return this.t("discover")}},{key:"content",value:function(){var e=o.a.createElement(h.FA,{name:"angle-right"});return o.a.createElement("div",{className:"py-3"},this.controller.cBook.renderBook(),this.items.map((function(t,n){if("string"===typeof t)return o.a.createElement("div",{key:n,className:"pt-2"});var r=t.icon,a=t.caption,i=t.onClick,c=o.a.createElement(h.FA,{name:r});return o.a.createElement(h.LMR,{key:n,className:"px-3 py-2 cursor-pointer bg-white mb-1",onClick:i,left:c,right:e},a)})))}}]),n}(h.VPage),Ia=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).onProject=function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.controller.showProjectFlow(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.controller.projectSums;if(0!==t.length)return o.a.createElement("div",{className:"px-3 mb-3 border-top"},t.map((function(t){var n=t.id,r=t.name,a=t.debitMonth,i=t.debitWeek,c=t.debitDay;return o.a.createElement("div",{key:n,className:"row py-3 align-items-end border-bottom bg-white cursor-pointer",onClick:function(){return e.onProject(t)}},o.a.createElement("div",{className:"col text-center"},r),e.renderNumber("\u4eca\u5929",c),e.renderNumber("\u672c\u5468",i),e.renderNumber("\u672c\u6708",a),o.a.createElement("div",{className:"mx-3"},o.a.createElement(h.FA,{name:"angle-right"})))})))}},{key:"renderNumber",value:function(e,t){return o.a.createElement("div",{className:"text-center col"},o.a.createElement("small",{className:"text-muted"},e),o.a.createElement("br",null),o.a.createElement("span",null,null!==t&&void 0!==t?t:0))}}]),n}(h.View),Sa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).projectSum=void 0,e.renderFlowItem=function(t){var n=t.stamp,r=t.memo,a=t.debit,i=t.credit;return o.a.createElement("div",{className:"px-3 py-2 d-flex cursor-pointer",onClick:function(){return e.controller.showFlowItem(t)}},o.a.createElement("div",{className:"w-8c"},o.a.createElement(h.EasyTime,{date:n})),o.a.createElement("div",{className:"w-5c text-right"},a),o.a.createElement("div",{className:"w-5c text-right"},i),o.a.createElement("div",{className:"ml-5"},r))},e}return Object(p.a)(n,[{key:"init",value:function(e){this.projectSum=e}},{key:"header",value:function(){return"\u660e\u7ec6 - "+this.projectSum.name}},{key:"content",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"px-3 py-2 d-flex"},o.a.createElement("div",{className:"w-8c"},"\u65e5\u671f"),o.a.createElement("div",{className:"w-5c text-right"},o.a.createElement(h.FA,{name:"plus"})),o.a.createElement("div",{className:"w-5c text-right"},o.a.createElement(h.FA,{name:"minus"}))),o.a.createElement(h.List,{items:this.controller.projectDetailPager,item:{render:this.renderFlowItem}}))}}]),n}(h.VPage),Aa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).projectSums=void 0,e.projectDetailPager=void 0,e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadBookProjects",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.uqs.notes.GetBookProjects.query({user:this.user.id,at:void 0},!0);case 2:t=e.sent,this.projectSums=t.ret;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderBook",value:function(){return this.renderView(Ia)}},{key:"showProjectFlow",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.projectDetailPager=new h.QueryPager(this.uqs.notes.GetProjectFlow),this.projectDetailPager.first({project:t.id}),this.openVPage(Sa,t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showFlowItem",value:function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.note,e.next=3,this.uqs.notes.GetNoteItemFromId.query({note:n});case 3:r=e.sent,I(i=r.ret[0]),(c=this.cApp.cHome.cNotes.createCNoteBase(i)).init(i),c.showViewPage();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(b),Pa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).cBook=void 0,e.loadBookProjects=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cBook.loadBookProjects();case 2:case"end":return t.stop()}}),t)}))),e.tab=function(){return e.renderView(Na)},e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){this.cBook=this.newC(Aa)}}]),n}(b),Ta=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"VTestMe"}},{key:"content",value:function(){return o.a.createElement("div",null,"VTestMe")}}]),n}(h.VPage),Fa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"header",value:function(){return"VTestAB"}},{key:"content",value:function(){var e=this;return o.a.createElement("div",null,"VTestAB",o.a.createElement("button",{onClick:function(){return e.go((function(){return e.openVPage(Ta)}),"/bbbb/cccc")}},"To Me"))}}]),n}(h.VPage),Va={$zh:{home:"\u9996\u9875",relation:"\u5173\u7cfb",discover:"\u53d1\u73b0",me:"\u6211",changePassword:"\u4fee\u6539\u5bc6\u7801",aboutTheApp:"\u5173\u4e8e\u672cAPP",logout:"\u9000\u51fa\u767b\u5f55",pleaseLogin:"\u767b\u5f55",notes:"\u5c0f\u5355",task:"\u4efb\u52a1",assign:"\u4f5c\u4e1a\u5355",noteSpace:"\u7fa4",noteText:"\u6587\u5b57\u5355",noteList:"\u5217\u8868\u5355",noteCheckable:"\u52fe\u9009\u5355",noteTask:"\u5e03\u7f6e\u4efb\u52a1",noteFolder:"\u5c0f\u5355\u5939",noteCreateSpace:"\u65b0\u5efa\u7fa4",content:"\u5185\u5bb9"},$en:{home:"Home",relation:"Relation",discover:"Discover",me:"Me",changePassword:"Change password",aboutTheApp:"About the APP",logout:"Logout",pleaseLogin:"Login",notes:"Notes",task:"Task",assign:"Assign",noteSpace:"Group",noteText:"Text",noteList:"List",noteCheckable:"Checkable",noteTask:"Task",noteFolder:"Folder",noteCreateSpace:"Create Group",content:"Content"}},Ra=[10,3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60],_a=(xa=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(f.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).timer=void 0,e.cHome=void 0,e.cRelation=void 0,e.cDiscover=void 0,e.cMe=void 0,e.tick=0,e.gapIndex=0,e.callTick=Object(i.a)(a.a.mark((function t(){var n,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.user){t.next=3;break}return t.abrupt("return");case 3:if(++e.tick,!(e.tick<Ra[e.gapIndex])){t.next=6;break}return t.abrupt("return");case 6:return e.tick=0,e.gapIndex<Ra.length-1&&++e.gapIndex,t.next=10,e.uqs.notes.$Poked.query(void 0,!1);case 10:if(n=t.sent,void 0!==(r=n.ret[0])){t.next=14;break}return t.abrupt("return");case 14:if(r.poke){t.next=16;break}return t.abrupt("return");case 16:e.gapIndex=1,e.cHome.refresh(),t.next=22;break;case 20:t.prev=20,t.t0=t.catch(0);case 22:case"end":return t.stop()}}),t,null,[[0,20]])}))),e}return Object(p.a)(n,[{key:"internalStart",value:function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setRes(Va),!0!==t){e.next=4;break}return e.next=4,this.initMySetting();case 4:if(!1!==this.isRouting){e.next=7;break}return e.next=7,this.startHome();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startHome",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cHome=this.newC(ha),this.cRelation=this.newC(ba),this.cDiscover=this.newC(Pa),this.cMe=this.newC(Ca),this.cHome.load(),this.showMain(),this.timer=setInterval(this.callTick,1e3);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initMySetting",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=-(new Date).getTimezoneOffset()/60,e.next=3,this.uqs.notes.InitMySetting.submit({timezone:t},!0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onDispose",value:function(){clearInterval(this.timer),this.timer=void 0}},{key:"startMe",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(Ta);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startAB",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.openVPage(Fa);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRoute",value:function(){var e=this;this.on({"/a/b":function(){e.startAB()},"/c/d":function(){},"/eeee/:action/:id":function(e,t){},"/bbbb/cccc":function(){e.startMe()}}),this.on((function(){e.startHome()}))}},{key:"loadRelation",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cRelation.load();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showMain",value:function(e){this.openVPage(j,e,this.dispose)}},{key:"contacts",get:function(){return this.cRelation.contacts}}]),n}(k),Object(g.a)(xa.prototype,"contacts",[q.g],Object.getOwnPropertyDescriptor(xa.prototype,"contacts"),xa.prototype),xa);function Da(){return(Da=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.nav.setSettings(d),t=function(){var e=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.start)(_a,d,t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(h.NavView,{onLogined:e})},s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(t,null)),document.getElementById("root")),l();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ba(){h.nav.setSettings(d);var e=document.createElement("div");e.id="app",document.body.appendChild(e);var t=function(){var e=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.start)(_a,d,t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(h.NavView,{onLogined:e})};s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(t,null)),e)}!function(e){e[e.notes=1]="notes"}(Ea||(Ea={})),"undefined"!=typeof wx&&wx.getSystemInfoSync||function(){Da.apply(this,arguments)}()}],[[117,1,2]]]);
//# sourceMappingURL=main.41e660d0.chunk.js.map