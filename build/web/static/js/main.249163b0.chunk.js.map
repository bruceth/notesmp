{"version":3,"sources":["tonva/index.ts","tonva/components/index.ts","tonva/net/guestApi.ts","tonva/net/caller.ts","tonva/net/netToken.ts","tonva/components/fetchErrorView.tsx","tonva/components/reloadPage.tsx","tonva/img/logo.svg","tonva/entry/tools.tsx","tonva/entry/register.tsx","tonva/components/nav.tsx","tonva/entry/login.tsx","tonva/tool/cacheIds.ts","tonva/tool/local.ts","tonva/tool/getObjPropIgnoreCase.ts","tonva/components/page/page.tsx","tonva/net/appBridge.ts","tonva/vm/controller.tsx","tonva/vm/view.tsx","tonva/vm/vpage.tsx","tonva/vm/components/CStringEdit.tsx","tonva/components/edit/itemEdit.tsx","tonva/uq/caller.ts","tonva/uq/entity.ts","tonva/net/httpChannel.ts","tonva/net/httpChannelUI.ts","tonva/net/uqApi.ts","tonva/res/res.ts","tonva/tool/uid.ts","tonva/uq/index.ts","tonva/uq/query.ts","tonva/net/wsChannel.ts","tonva/components/image.tsx","tonva/tool/user.ts","tonva/net/host.ts","tonva/res/formRes.ts","tonva/res/listRes.ts","tonva/res/entry/login.ts","tonva/res/entry/register.ts","tonva/components/page/scrollView.tsx","tonva/uq/action.ts","tonva/components/simple/LMR.tsx","tonva/components/simple/Badge.tsx","tonva/components/simple/FA.tsx","tonva/components/simple/IconText.tsx","tonva/components/simple/Muted.tsx","tonva/tool/localDb.ts","tonva/uq/tuid/reactBoxId.tsx","tonva/components/loading.tsx","tonva/tool/env.ts","tonva/uq/tuid/index.ts","tonva/net/apiBase.ts","tonva/components/edit/imageItemEdit.tsx","tonva/tool/pageItems.ts","tonva/net/messageHub.ts","tonva/components/navigo.ts","tonva/components/page/pageHeader.tsx","tonva/components/page/tabs.tsx","tonva/components/resUploader.tsx","tonva/uq/uqMan.ts","tonva/uq/sheet.ts","tonva/uq/book.ts","tonva/uq/history.ts","tonva/uq/map.ts","tonva/uq/pending.ts","tonva/uq/tag/tagView.tsx","tonva/uq/tag/tag.ts","tonva/components/page/index.ts","tonva/components/schema/index.ts","tonva/components/rules/index.ts","tonva/components/dropDownActions/index.tsx","tonva/components/easyDate/index.tsx","tonva/components/media.tsx","tonva/components/searchBox.tsx","tonva/components/userIcon.tsx","tonva/uq/tuid/tuidsCache.ts","tonva/uq/uqsMan.ts","tonva/components/form/rules/index.ts","tonva/components/form/widgets/widget.tsx","tonva/components/form/widgets/textWidget.tsx","tonva/components/form/widgets/textareaWidget.tsx","tonva/components/form/widgets/passwordWidget.tsx","tonva/components/form/widgets/numberWidget.tsx","tonva/components/form/widgets/updownWidget.tsx","tonva/components/form/widgets/dateWidget.tsx","tonva/components/form/widgets/checkBoxWidget.tsx","tonva/components/form/widgets/selectWidget.tsx","tonva/components/form/widgets/radioWidget.tsx","tonva/components/form/widgets/rangeWidget.tsx","tonva/components/form/widgets/idWidget.tsx","tonva/components/form/widgets/unknown.tsx","tonva/components/form/widgets/buttonWidget.tsx","tonva/components/form/context.tsx","tonva/components/form/widgets/arrComponent.tsx","tonva/components/form/widgets/imageWidget.tsx","tonva/components/form/widgets/tagWidget.tsx","tonva/components/form/widgets/factory.tsx","tonva/components/form/form.tsx","tonva/components/form/field.tsx","tonva/components/edit/stringItemEdit.tsx","tonva/components/edit/radioItemEdit.tsx","tonva/components/edit/selectItemEdit.tsx","tonva/components/edit/idItemEdit.tsx","tonva/components/edit/tagItemEdit.tsx","tonva/components/edit/textAreaItemEdit.tsx","tonva/components/edit/checkBoxItemEdit.tsx","tonva/components/edit/rangeItemEdit.tsx","tonva/components/edit/numberItemEdit.tsx","tonva/components/edit/edit.tsx","tonva/app/centerApi.ts","tonva/app/vMain.tsx","tonva/app/CAppBase.ts","tonva/app/start.ts","tonva/app/CBase.ts","tonva/components/list/base.tsx","tonva/components/list/clickable.tsx","tonva/components/list/static.tsx","tonva/components/list/selectable.tsx","tonva/components/list/index.tsx","tonva/components/propGrid/row.tsx","tonva/components/propGrid/propView.tsx","tonva/components/propGrid/PropGrid.tsx","tonva/entry/meInfo.tsx","tonva/uq/tuid/idCache.ts","tonva/uq/tuid/tuid.ts","serviceWorker.ts","tapp/appConfig.ts","tapp/appName.ts","tapp/CBase.ts","tapp/main.tsx","notes/model.ts","notes/views/VBasePage.tsx","notes/views/VSelectContact.tsx","notes/views/VNotesDropDown.tsx","notes/noteBase/CNoteBase.tsx","notes/noteBase/VNoteBase.tsx","notes/noteBase/VNoteBaseDir.tsx","notes/noteBase/VNoteBaseEdit.tsx","notes/noteBase/VNoteBaseForm.tsx","notes/noteBase/VNoteBaseView.tsx","tool/none.tsx","tool/VAddContact.tsx","notes/noteBase/VRelativesBase.tsx","notes/components/content/CContent.ts","notes/components/content/checkable/VBase.tsx","notes/components/content/checkable/VView.tsx","notes/components/content/checkable/VItem.tsx","notes/components/content/ListInputBase.tsx","notes/components/content/checkable/CheckableListInput.tsx","notes/components/content/checkable/CCheckable.ts","notes/components/content/list/VView.tsx","notes/components/content/list/ListInput.tsx","notes/components/content/list/CList.ts","notes/components/content/textBase/CTextBase.ts","notes/components/content/textBase/VTextBaseView.tsx","notes/components/content/textBase/VTextBaseInput.tsx","notes/components/content/text/VInput.tsx","notes/components/content/text/VView.tsx","notes/components/content/text/CText.ts","notes/components/content/folder/VInput.tsx","notes/components/content/folder/VView.tsx","notes/components/content/folder/CFolder.ts","notes/components/to/VSent.tsx","notes/components/to/VTo.tsx","notes/components/to/CTo.ts","notes/components/selectContact/VSelectContact.tsx","notes/components/selectContact/CSelectContact.ts","notes/components/inputHours/VInputHours.tsx","notes/components/inputHours/CInputHours.ts","notes/components/renderParagraphs.tsx","notes/container/views/VFolder.tsx","notes/container/unitNote/model.ts","notes/container/views/VFolderDir.tsx","notes/container/views/VFolderRelatives.tsx","notes/container/views/VFolderView.tsx","notes/container/CContainer.ts","notes/container/space/VSpaceDir.tsx","notes/container/space/VSpaceMembers.tsx","notes/container/space/VSpaceView.tsx","notes/container/views/VContainerForm.tsx","notes/container/space/VSpaceEdit.tsx","notes/container/space/VContentView.tsx","notes/container/space/VContacts.tsx","notes/container/space/VSpaceAdd.tsx","notes/container/space/CSpace.ts","notes/container/CFolder.ts","notes/container/folderMy/VFolderMyEdit.tsx","notes/container/folderMy/VFolderMyAdd.tsx","notes/container/folderMy/VFolderMyView.tsx","notes/container/folderMy/VFolderMy.tsx","notes/container/folderMy/CFolderMy.ts","notes/container/folderShare/VFolderShare.tsx","notes/container/folderShare/CFolderShare.ts","notes/container/folderRoot/CFolderRoot.ts","notes/container/unitNote/admin/VRootProjects.tsx","notes/container/unitNote/admin/VUnitProjects.tsx","notes/container/unitNote/admin/VReportsAdmin.tsx","notes/container/unitNote/admin/VUnitAdmin.tsx","notes/container/unitNote/admin/CUnitAdmin.ts","notes/container/unitNote/VUnitNoteDir.tsx","notes/container/unitNote/VUnitNoteView.tsx","notes/container/unitNote/CUnitNote.ts","notes/note/components/comments/VCommentsList.tsx","notes/note/task/TaskState.ts","notes/note/components/comments/VAddComment.tsx","notes/note/components/comments/VWriteComment.tsx","notes/note/components/comments/CComments.ts","notes/note/CNote.ts","notes/note/views/VRelativesNoteBase.tsx","notes/note/assign/VAssignRelatives.tsx","notes/note/assign/VAssignView.tsx","notes/note/assign/VAssignAdd.tsx","notes/note/assign/VAssignEdit.tsx","notes/note/assign/VAssignDir.tsx","notes/note/assign/VAssignParams.tsx","notes/note/assign/CAssignTo.ts","notes/note/task/content/VBase.tsx","notes/note/task/content/VView.tsx","notes/note/task/content/VItem.tsx","notes/note/task/content/CTaskContent.ts","notes/note/task/CNoteTask.ts","notes/note/task/VTaskRelatives.tsx","notes/note/task/VTaskView.tsx","notes/note/task/VTaskObserver.tsx","notes/note/task/CTaskObserver.ts","notes/note/assign/CNoteAssign.ts","notes/note/text/VTextRelatives.tsx","notes/note/text/VTextHeader.tsx","notes/note/text/VTextView.tsx","notes/note/text/VTextEdit.tsx","notes/note/text/VTextAdd.tsx","notes/note/text/VTextDir.tsx","notes/note/text/CNoteText.ts","notes/note/task/start/VTaskStart.tsx","notes/note/task/start/CTaskStart.ts","notes/note/task/done/VTaskDone.tsx","notes/note/task/done/CTaskDone.ts","notes/note/task/canceled/VTaskCanceled.tsx","notes/note/task/canceled/CTaskCanceled.ts","notes/note/task/pass/VTaskPass.tsx","notes/note/task/pass/CTaskPass.ts","notes/note/task/fail/VTaskFail.tsx","notes/note/task/fail/CTaskFail.ts","notes/note/task/rated/VTaskRated.tsx","notes/note/task/rated/CTaskRated.ts","notes/note/task/VEditTextItem.tsx","notes/note/task/check/VTaskCheck.tsx","notes/note/task/check/CTaskCheck.ts","notes/note/task/rate/VRateTask.tsx","notes/note/task/rate/CTaskRate.ts","notes/views/VActions.tsx","notes/CShareTo.ts","notes/CNotes.ts","notes/container/index.ts","notes/note/task/index.ts","notes/container/unitNote/index.ts","home/VHome.tsx","home/CHome.ts","relation/VAdd.tsx","relation/VRelation.tsx","relation/contact/VContact.tsx","relation/contact/VEditAssigned.tsx","relation/contact/CContact.ts","relation/CRelation.ts","me/VAdmin.tsx","me/VEditMe.tsx","me/VMe.tsx","me/CMe.ts","tapp/uqs.ts","discover/VDiscover.tsx","book/VBook.tsx","book/VFlow.tsx","book/CBook.ts","discover/CDiscover.ts","tapp/VTestMe.tsx","tapp/VTestAB.tsx","tapp/res/index.ts","tapp/res/zh.ts","tapp/res/en.ts","tapp/CApp.ts","index.tsx"],"names":["guestApi","this","get","ret","decodeGuestToken","guest","token","unitName","unit","CenterApiBase","undefined","Caller","params","waiting","method","_params","netToken","userId","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","error","err","i","push","key","style","wordWrap","className","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","reload","clearInterval","timerHandler","nav","seconds","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","tonvaTop","loginTop","src","logo","alt","senders","caption","regex","mobileRegex","emailRegex","getSender","un","find","v","test","logMark","RegisterController","accountPageCaption","accountLabel","accountSubmitCaption","passwordPageCaption","passwordSubmitCaption","successText","login","account","userApi","user","pwd","password","retUser","alert","userLogined","openVPage","AccountPage","VerifyPage","PasswordPage","accounts","RegSuccess","registerReturn","isExists","accountError","sendVerify","oem","toVerify","nick","country","mobile","mobileCountry","email","verify","Number","register","clear","toSuccess","regReturn","Controller","ForgetController","resetPassword","schema","name","required","maxLength","res","resLang","registerRes","page","controller","marginLeft","marginRight","uiSchema","onButtonClick","onSubmit","onEnter","requiredFlag","privacyEntry","context","clearContextErrors","value","getValue","sender","setError","length","checkAccount","items","widget","label","placeholder","openPage","VPage","onVerifyChanged","prev","setDisabled","onChanged","submit","disabled","checkVerify","toPassword","typeText","extra","values","form","data","rePwd","setValue","execute","users","map","Login","loginRes","username","console","log","callback","clickReg","start","clickForget","footer","margin","withBack","isMobile","RegExp","navigator","userAgent","logs","stackKey","NavView","waitCount","upgradeUq","isHistoryBack","navBack","tick","Date","now","stack","len","window","self","top","postMessage","confirmClose","pop","fetchError","wait","set","addEventListener","isRouting","init","waitTimeHandler","env","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","removeCeased","history","pushState","ceased","refresh","item","dispose","level","p","backLevel","popAndDispose","elWait","elError","testing","left","zIndex","index","visibility","position","local","LocalData","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","ev","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","showPrivacyPage","privacy","getPrivacyContent","privacyPage","getPrivacy","html","content","__html","marked","dangerouslySetInnerHTML","Promise","race","serviceWorker","ready","registration","unregister","location","plus","webview","webView","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","language","culture","messageHub","dispatch","unitJsonPath","fetch","unitRes","json","remove","process","isMiniprogram","el","document","getElementById","innerText","loadUnitJson","innerHTML","JSON","parse","envUnit","REACT_APP_UNIT","isDevelopment","id","getPredefinedUnitName","unitFromName","unitId","settings","navSettings","origin","pathname","toLowerCase","_","endsWith","substr","host","hash","pos","getExHashPos","hashParam","substring","ws","resHost","centerHost","resUrl","resUrlFromHost","wsHost","setCenterUrl","Error","setGuest","exHash","getExHash","appInFrame","setAppInFrame","parent","loadPredefinedUnit","predefinedUnit","onerror","onunhandledrejection","onselectstart","oncontextmenu","startWait","notLogined","logined","endWait","navigo","Navigo","on","absolute","navigate","showPage","isUserLogin","onLogined","me","icon","logoutApis","stringify","saveLocalUser","showAppView","internalLogined","defaultTop","headers","indexOf","http","text","loginView","lv","logout","logoutClear","cp","ChangePasswordPage","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","apiId","sheetType","sheetId","sheet","includes","uh","appUrl","String","open","date","getTime","toTimeString","step","href","r","parser","DOMParser","htmlDoc","parseFromString","elHtml","getElementsByTagName","newVersion","getAttribute","g","observable","maxCount","arr","ids","dict","loadId","shift","delete","_loadIds","_loadId","setItem","e","Map","localDb","child","_user","_guest","_unit","forEach","d","getObjPropIgnoreCase","obj","prop","keys","Object","Page","observer","tabsProps","tabsView","TabsView","right","headerClassName","afterBack","webNav","inWebNav","pageHeaderProps","center","rph","renderPageHeader","elFooter","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","uqTokens","logoutUqTokens","appsInFrame","val","isBridged","subFrameStarted","evt","subWin","setSubAppWindow","hidden","hideFrameBack","clone","initSubWin","onReceiveAppApiMessage","apiName","db","parts","split","param","uqOwner","uqName","appOwner","appName","uqTokenApi","onAppApiReturn","urlTest","action","uqTokenActions","realUrl","getUrlOrTest","appHash","slice","lastIndexOf","u","uid","getUnit","realUnit","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","startsWith","buildAppUq","uqToken","centerToken","at","opener","appUq","brideCenterApis","bridgeCenterApi","body","callId","o","from","callCenterapi","directCall","result","bca","_t","isDev","unregisterReceiveHandler","receiveHandlerId","onDispose","onMessageReceive","onMessage","t","str","internalT","pageWebNav","getPageWebNav","getWebNav","navHeader","navRawHeader","navFooter","navRawFooter","VNavHeader","VNavRawHeader","VNavFooter","VNavRawFooter","renderView","$lang","$district","merge","l","vp","replaceOpen","render","onEvent","registerReceiveHandler","beforeStart","internalStart","afterStart","_resolve_$","onClosePage","go","topPageKey","yes","no","classNames","closePage","buttons","View","isMe","vm","vCall","returnCall","imageClassName","textClassName","renderUser","replacePage","backPage","ceasePage","popToTopPage","_onClosePage","retOnClosePage","openPageElement","renderPage","replacePageElement","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","CStringEdit","onChange","newValue","target","preValue","isChanged","onBlur","verifyValue","onFocus","onEdit","onValueChange","onSave","createElement","onKeyDown","keyCode","defaultValue","renderValue","renderPencil","ItemEdit","edit","itemSchema","uiItem","_itemSchema","_uiItem","internalEnd","divValue","labelHide","templet","Templet","list","rules","nv","Array","isArray","verifyRule","rule","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","uqApi","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","rebuildSchema","buildEntities","setSchema","ver","uqVersion","en","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageStart","pageSize","ln","chars","codeBackSlash","charCodeAt","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","fieldMaps","sys","cache","localMap","jName","fields","arrFields","returns","f","loadEntitySchema","buildFieldsTuid","loadValues","setJName","buildFieldTuid","buildArrFieldsTuid","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","buildDateTimeParam","getFullYear","getMonth","getDate","_tuid","getIdFromObj","dt","Math","floor","toISOString","packRow","arrData","packArr","join","row","ch","escape","boxId","unpackRow","unpackArr","ch0","c","fLen","to","reverseNT","n","isNaN","p0","vals","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","showError","timeout","post","urlPrefix","caller","buildOptions","path","h","encodeURI","innerFetch","k","innerFetchResult","buildError","ex","retErr","that","timeOutHandler","wxfetch","statusText","jres","ct","then","retJson","retError","catch","buildHeaders","CenterHttpChannel","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","UqApi","basePath","access","showWaiting","channelUI","acc","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","centerChannel","centerChannelUI","loginedUserId","uqTokensName","localCache","nowTick","appUqParams","call","loadAppUqs","uqs","decodeUserToken","languages","toUpperCase","setResOptions","resGlobal","setRes","setGlobalRes","ALPHABET","rtn","charAt","random","QueryPager","query","firstSize","itemObservable","appendPosition","$page","sortOrder","order","idFieldName","_items","startIndex","getPageId","load","splice","newItem","newId","oldItem","oldId","PageItems","Query","isPaged","size","more","startField","array","deep","pageCaller","request","queryCaller","table","subAppWindow","postWsToSubApp","win","WsBase","wsBaseSeed","wsBaseId","WebSocket","onopen","onmessage","wsMessage","onclose","receive","netThis","connect","send","Image","altImage","currentTarget","jwtDecode","uqDebugHost","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","https","fetchOptions","mode","getCenterHost","getResHost","promises","hostArr","findIndex","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","debugHost","getUrlOrDebug","urlDebug","fetchLocalCheck","formRes","number","integer","min","max","zh","listRes","none","Scroller","scrollTo","scrollTop","offsetHeight","scrollTimeGap","ScrollViewBase","bottomTime","topTime","refDiv","div","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","toString","eachChild","Component","ScrollView","ref","WebNavScrollView","vHeader","vFooter","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","b","badge","color","badgeAlign","badgeVertical","cn","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","Muted","__ls","getItem","removeItem","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","removeAll","ks","unshift","saveIndex","ls","TuidContent","tuidName","s","uqStringify","ReactBoxId","isUndefined","boxName","assureBox","valueFromId","tuidValue","nullUI","ttv","divObj","bi","logContent","boxIdContent","Loading","testingTags","wx","pn","isTesting","tag","ms","args","global","handle","getHttpChannel","callFetch","put","ImageItemEdit","resId","onSaved","isFirst","scrollToTop","scrollIntoView","topDiv","scrollToBottom","bottomDiv","changing","pageItemAction","itemConverter","divId","loadResults","pageList","beforeLoad","loaded","allLoaded","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","loading","onLoad","setPageStart","onLoaded","reverse","computed","handlerSeed","anyHandlers","msgHandlers","handler","seed","args0","handlerId","$type","useHash","_routes","_onLocationChange","root","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","isPushStateAvailable","_genericHooks","_historyUpdateMethod","_cLoc","_listen","updatePageLinks","cleanUrl","match","names","reduce","decodeURIComponent","route","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","filter","m","findMatchedRoutes","colonExp","matched","routeExp","fallbackURL","matched0","cleanGETParam","hooks","exHooks","before","shouldRoute","after","_getRoot","_historyUpdate","arg0","arg1","orderedRoutes","sort","compareUrlDepth","uses","_add","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","manageHooks","_callLeave","isHashedRoot","timout","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","tagName","getLinkPath","preventDefault","status","pause","destroy","as","replaceState","cLocRoot","isHashChangeAPIAvailable","cached","check","querySelectorAll","lastRouteResolved","leave","onBack","vBack","debugLogout","role","showLogout","rightView","Tab","onShown","selected","_content","contentBuilder","TabCaptionComponent","tabClick","tab","selectedTab","tabArr","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","tabBg","sep","notifyCircle","notify","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","display","ResUploader","upload","formData","buildFormData","onFilesChange","files","fileName","maxSize","fileInput","FormData","file","append","multiple","formatSize","pointLength","units","toFixed","xlargeSize","mediumSize","ImageUploader","onFileChange","fileError","uploaded","enableUploadButton","suffix","imageTypes","reader","FileReader","readAsDataURL","onload","srcImage","setSize","imgBaseSize","desImgSize","desImage","compress","img","width","height","srcImgWidth","srcImgHeight","w","scale","desImgWidth","round","desImgHeight","canvas","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","resUploader","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","defaultChecked","levelDiv","padding","AudioUploader","audioTypes","fileSize","uploading","UqMan","uqData","createBoxId","tvs","actions","sheets","queries","books","maps","histories","pendings","tags","tuids","createBoxIdFromTVs","tuidArr","actionArr","sheetArr","queryArr","bookArr","mapArr","historyArr","pendingArr","tagArr","clearTuids","localModifyMax","localAccess","trim","tuidsCache","TuidsCache","accesses","loadAccess","buildTuids","buildAccess","newTuid","entityName","fromType","fromObj","defer","cacheTuids","TuidImport","TuidInner","book","Book","Tag","History","pending","Pending","Sheet","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","buildSheet","build","mainFields","buildTuidBox","owner","ownerField","buildTuidDivBox","modifyMax","states","ops","op","discription","app","SaveCaller","flow","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","count","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","AllCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","checked","renderCheck","wrapClassName","inputs","inputName","onInputChange","input","coll","lines","line","ext","_view","DropdownActions","handleDocumentClick","dropdownOpen","button","contains","menu","toggle","isRight","itemIconClass","itemCaptionClass","hasIcon","some","data-toggle","aria-expanded","captionClass","aria-hidden","onTouchStart","timeRes","md","month","ymd","year","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","appendTime","dPart","hm","EasyTime","SearchBox","allowEmptySearch","initKey","onSearch","inputSize","inputClassName","buttonText","userCache","loader","UserView","noneImage","idProp","useUser","use","loadIds","clearCacheTimer","cacheIds","cacheTimer","tuidCached","innerPullModify","tuidLists","queueModify","group","queue","modify","modifyIds","UQsMan","tonvaAppName","buildTVs","collection","localData","uqsMan","uqAppData","retErrors","setTuidImportsLocal","_uqs","buildUQs","errors","uqTVs","lj","uqsData","promiseInits","uqFullName","lower","loadEntities","uqMan","Proxy","receiver","showReload","isImport","setInner","tuidImport","fromName","iName","setFrom","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","template","maxMsg","checkMore","RuleInt","isInteger","Widget","fieldProps","changeValue","container","visible","inNode","FieldContainer","renderBody","_ui","getUiItem","readOnly","contextErrors","buildRules","removeErrorWidget","addErrorWidget","isChanging","initData","fromElement","onChanging","allowChange","setDataValue","setElementValue","elDiscription","hasError","discriptionClassName","errorList","fieldClass","FieldClass","uiLabel","TextWidget","inputType","internalOnKeyDown","blur","checkRules","checkContextRules","hasFocus","clearErrors","renderTemplet","renderErrors","TextAreaWidget","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","rowKey","isRow","RangeWidget","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","observerRender","widgetType","ButtonClass","Context","widgets","subContexts","arrRowContexts","itemName","getDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","errorWidgets","ew","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","checkHasError","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","imageSrc","end","TagWidget","widgetsFactory","textarea","datetime","time","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","def","defaultArr","renderChecks","range","typeWidget","getItemSchema","getTypeWidget","WidgetClass","Form","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","fieldLabelSize","labelView","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","Container","autorun","formContext","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","contextType","StringItemEdit","inputOptions","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","CheckBoxItemEdit","onItemChanged","RangeItemEdit","NumberItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","rowClick","itemEdit","editInRow","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","rowContainerClassName","topBorder","bottomBorder","ie","createItemEdit","divLabel","requireFlag","centerApi","userName","VUnsupportedUnit","VUnitSelect","renderRow","onRowClick","appUnit","setAppUnit","appUnits","VErrorsPage","VStartError","CAppBase","config","appConfig","noUnit","elements","nRole","roleDefines","roles","onRoute","userAppUnits","result1","showUnsupport","appUnitId","resolveRoute","userFromId","CApp","htmlTitle","html0","cApp","CBase","_cApp","hasRole","wn","CSub","_owner","getWebNave","ownerWNs","own","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","isItemSelected","selectedItems","compare","retItems","labelId","comp","selectItem","si","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","anySelected","List","buildBase","listBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","valueAlignStart","valueAlignCenter","valueAlignEnd","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","PropView","buildRows","isGap","setValues","PropGrid","propView","userSetProp","IdCache","tuidLocal","waitingIds","divName","tuidInner","initLocalArr","localArr","isNumber","has","moveToHead","_id","useId","tuidValues","cacheIdValues","unpackTuidIds","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","netIds","loadTuidIds","netRet","IdDivCache","Tuid","typeName","idName","TuidBox","noCache","id1","id2","equ","idCache","divs","tuidDiv","TuidDiv","resetCache","assureObj","IdsCaller","GetCaller","cacheFieldsInValue","arrValues","$create","$update","stampOnMain","cacheFields","unpackTuidIdsOfFields","SavePropCaller","searchArr","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","loadMain","save","saveProp","search","loadArr","saveArr","posArr","hasDiv","TuidBoxDiv","Boolean","hostname","CUqBase","CUqSub","CUqApp","EnumNoteType","VMain","cHome","cRelation","cDiscover","cMe","loadBookProjects","numberFromId","compareID","checkHourMinutes","taskTimeToString","initNoteItemObj","flowContent","textList","textCheckable","VBasePage","renderContact","assigned","renderContactItem","contact","contacts","VSelectContact","buildRight","single","onToggleSelect","onNext","onContactSelect","onContactClick","VNotesDropDown","showAddNoteTextPage","showAddNoteListPage","checkable","showAddNoteCheckablePage","task","showAddAssignPage","folder","showAddMyFolderPage","space","showAddGroupPage","dropdownActions","VHomeDropdown","VFolderDropdown","VSpaceDropdown","CNoteBase","disableFrom","noteItem","folderId","currentFold","notes","GetNote","note","noteModel","spawn","contain","comments","showShareTo","endContentInput","noteContent","editNote","updateChange","itemChanged","addNote","groupFolder","isContentChanged","isCaptionChanged","renderIcon","VNoteBase","renderFrom","disableOwnerFrom","vImage","cnName","renderCommentFlag","commentCount","commentUnread","vCU","cu","onSendNote","loadRelation","renderTop","renderCaption","renderEditTime","create","update","toCount","spawnCount","isEnd","showEditPage","VNoteBaseDir","renderTopCaptionContent","renderDirBottom","divToCount","renderToCount","divSpawnCount","renderSpawnCount","divComment","dot","unread","VNoteBaseEdit","onButtonSave","isNoteChanged","renderExButtons","SetNote","onCaptionChange","renderEditBottom","renderCaptionInput","hideNote","onDelete","VNoteBaseView","renderViewBottom","renderRelatives","vEditButton","renderEditButton","VAddContact","fromKey","onAddContact","addContact","renderFields","VRelativesBase","tabShare","isAction","vCount","activeRelativeTab","isActive","renderTab","marginTop","renderTabs","tabName","tabContent","CContent","changed","buildObj","renderViewContent","fromString","startInput","VBase","doneItems","uncheckedItems","checkedItems","renderCheckItem","renderCheckedItems","VView","data-key","onCheckChange","checkedCount","VItem","ListInputBase","renderItem","focusable","focused","renderInputItem","renderTextItem","onAddNewEnter","addNewItem","currentFocusable","inputingText","setItemText","inputRef","getComputedStyle","onBlurAddNew","focusables","toJS","renderNewInput","getItemKey","getItemText","renderItemHeader","onMouseDown","focuseTimeout","focus","renderInput","uniqueKey","trimRight","CheckableListInput","CCheckable","itemKey","listInput","getList","ci","ListInput","CList","CTextBase","changedNoteContent","VTextBaseView","renderParagraphs","VTextBaseInput","onContentChange","renderContentTextArea","VInput","CText","CFolder","VSent","VTo","anyChanged","onContactsSelected","groupContacts","CTo","currentGroupFolder","currentNoteItem","onSendOut","toList","sendOut","GetContacts","startAction","afterContactsSelected","CSelectContact","loadContacts","VInputHours","onHoursChange","hourminutes","onHoursBlur","autoFocus","CInputHours","EnumUnitRole","EnumPeriod","VFolder","noteKey","renderItemInFolder","cNoteBase","renderDirItem","popFolder","renderFolderDropDown","paragraphs","contentString","trimEnd","stopPropagation","showFolderView","notesPager","showNoteItem","VFolderDir","vIcon","VFolderRelatives","VFolderView","renderVm","cContent","CContainer","lodeModel","showViewPage","EnumSpecFolder","GetNotes","setItemConverter","getItemConverter","noteItemConverter","withX","newnotes","newitems","cNoteItem","fItem","renderListView","openFolder","showFolderViewPage","sub","AddNote","fromAssigned","createCNoteBase","theItems","theItem","HideNote","members","AddGroup","VSpaceDir","VSpaceMembers","showAddMember","VSpaceView","groupOwner","renderSpaceDropDown","showSpaceContent","whiteSpace","overflow","textOverflow","cNotes","cSpace","addMember","VContainerForm","VSpaceEdit","SetGroup","VContentView","memberCount","VContacts","selectMember","VSapceAdd","addGroup","CSpace","showMembers","loadMembers","loadSpace","GetGroupFolderMemberCount","resulte","groupId","GetGroupMembers","GetGroupContacts","AddGroupMember","member","RemoveGroupMember","mi","endInput","rootFold","editGroup","CFolderDisableItemFrom","queryResults","VFolderMyEdit","VFolderMyAdd","VFolderMyView","renderShareButton","VFolderMy","CFolderMy","VFolderShare","CFolderShare","CFolderRoot","VRootProjects","projectFileds","projectUISchema","memo","ratioX","ratioY","readUnit","onClickAdd","project","onSubmitNewProject","saveBookProject","renderProject","onClickProject","bookProjects","VUnitProjects","onAddSub","unitedProjects","renderUnitedProject","unitableProjects","renderUnitableProject","downVisible","upVisible","setProjectDisplay","setProjectDown","setProjectUp","VReportsAdmin","report","onSubmitNewReport","saveBookReport","onClickReport","cNameEdit","changeReportName","bookReports","VAdminBase","onNewUnit","VNewUnit","renderUnitRow","unitItem","onUnitRow","showUnitAdmin","onNewMember","VNewMember","renderMemberRow","admin","onClickMember","VEditMember","renderParent","renderEditUnitName","renderUnitID","renderProjects","renderUnitProjects","renderMembersAndUnits","showUnitProjects","renderMembers","renderUnits","VRootAdmin","showDesignReports","showRootProjects","VUnitAdmin","onEditUnitName","onUnitNameSubmit","onUnitNameChange","onUnitNameKeyDown","setUnitName","onCreate","createUnit","vError","adminSchema","isAdminUI","isAdmin","setUnitMemberAdmin","setUnitMemberProp","unitAdmin","CAdminBase","loadUnitProjects","orderNo","setUnitProjects","unitNote","GetUnit","moveOwnerMemberToTop","getVUnitAdmin","pOwner","pAdmin","cUnitAdmin","CUnitAdmin","CreateUnit","SetUnitName","AddUnitMember","roleMask","SetUnitMemberRole","SetUnitMemberProp","GetUnitProjects","rootUnit","projects","rootProjects","SetUnitProjects","CRootAdmin","loadBookReports","GetRootUnitProjects","BookProject","GetRootUnitReports","BookReport","VUnitNoteDir","VUnitNoteView","onAdmin","showRootAdmin","unitProjectsSum","projectSums","renderProjectSums","memberProjectsSum","memberItem","onMemberRow","myProjectsSum","debit","unitProjectsSums","memberProjectsSums","CUnitNote","cUnitAdmins","period","GetMySum","buildMyProjectsSum","GetUnitSum","subSum","memberSum","buildUnitProjectsSums","buildMemberProjectsSums","unitSums","subRow","credit","projectSum","memberSums","mySums","loadUnits","loadMySum","day","loadProjectsSum","curUnitAdmin","EnumTaskState","VCommentsList","renderComments","cNote","renderComment","showMoreComments","comment","divUserName","renderCommentContent","vUser","VAddComment","onCommentChange","onCommentSubmit","onAddComment","VWriteComment","onComment","CComments","addComment","renderButton","CNote","AddComment","commentId","cComments","stateContents","Start","Done","Pass","Fail","Rated","Canceled","getTaskItemState","checker","rater","GetTaskStateContent","VRelativesNoteBase","tabComment","renderCommentsList","tabFlow","VAssignRelatives","VAssignView","renderSpawn","showSpawn","renderStateSpan","duplicateAssign","renderWriteComment","renderDirContent","showAssignTo","VAssignAdd","saveAndAssingTo","onButtonSend","isNoteEmpty","onClickHours","chours","inputHours","assignhours","renderTaskAdditions","additionRows","renderAssignHours","renderParam","renderDeleteButton","VAssignDir","VAssignParams","cNoteAssign","onItemChange","point","onItemKeyDown","onClickChecker","cSelectContact","CNotesSelectContact","SetContacts","GetAssignToContacts","callSelectContact","onClickRater","renderHours","renderChecker","renderRater","CAssignTo","replaceTop","replaceVPage","assignTask","getItems","allowCheck","CTaskContent","CNoteTask","initobj","checkInfo","checkInfoInput","rateInfo","rateInfoInput","rateValue","rateValueInput","hours","saveX","noteId","SetNoteX","VTaskRelatives","VTaskView","renderTaskDirTop","divCaption","renderState","VTaskObserver","taskStateResult","VTaskObserverDir","renderDirView","CTaskObserver","CNoteAssign","cAssignTo","SetTopKey","TopKey","cObj","tos","AssignTask","initModelData","assign","isEmpty","VTextRelatives","VTextHeader","VTextView","VTextEdit","changeToText","changeToList","changeToCheckable","cType","renderButtonLeft","dropdowns","VTextAdd","onSaveAndSendNote","cnewNote","VTextDir","CNoteText","createTextContent","createListContent","createCheckableContent","VTaskStart","onDone","DoneTask","contentChecker","contentRater","showActionEndPage","VTaskStartDir","CTaskStart","taskUpdateState","VTaskDone","VTaskDoneDir","CTaskDone","VTaskCanceled","VTaskCanceledDir","CTaskCanceled","VTaskPass","VTaskPassDir","CTaskPass","VTaskFail","VTaskFailDir","CTaskFail","VTaskRated","VTaskRatedDir","CTaskRated","VEditTextItemInput","onUpdate","onClickSave","inputText","VTaskCheck","onDiscribeChange","updateCheckInfo","onDiscribeKeyDown","checkSaveInfo","onCheck","pass","checkTask","resultPage","eprops","setCheckInfo","vEdit","renderOrtherContent","VTaskCheckDir","CTaskCheck","CheckTask","VTaskRate","updateRateInfo","onRate","rateTask","renderValueRadio","VTaskRateDir","CTaskRate","RateTask","VActions","renderSelectedContact","CShareTo","sendNoteTo","GetShareContacts","CNotes","createCNoteText","showAddPage","createCNoteList","createCNoteCheckable","cFolder","cGroup","newSub","foldStack","folderNoteItem","foldItem","showFolder","createCFolder","createCNoteTask","createCUnitNote","SendNoteTo","cShareTo","VHome","cNodes","renderHomeDropDown","renderNotesView","CHome","newC","VAdd","AddContact","VRelation","onShowContact","VContact","onEditAlias","onEditAssigned","VEditAssigned","btnSaveDisabled","SaveContactAssign","CContact","CRelation","GetMyContacts","showContact","SetContactAssinged","VAdmin","renderRootUnit","tonvaUnit","vId","vName","onClickRootUnit","changeRootUnitName","changeRootUnitTonva","changeRootUnitX","VUser","rootUnits","unitOwner","VUnit","createRootUnit","VEditMe","vAdmin","showAdmin","VMe","onExit","changePassword","meInfo","showEditMe","userSpan","aboutRows","logOutRows","CMe","GetSystemRole","GetRootUnits","CreateRootUnit","ChangeRootUnitProp","VDiscover","onTaskReport","onOtherReport","testBus","cBook","renderBook","VBook","onProject","showProjectFlow","debitMonth","debitWeek","debitDay","renderNumber","VFlow","renderFlowItem","flowItem","stamp","showFlowItem","projectDetailPager","CBook","GetProjectFlow","projectFlowItem","GetNoteItemFromId","CDiscover","TestBusBootProject","VTestMe","VTestAB","home","relation","discover","aboutTheApp","pleaseLogin","noteSpace","noteText","noteList","noteCheckable","noteTask","noteFolder","noteCreateSpace","gaps","gapIndex","callTick","$Poked","poke","initMySetting","startHome","showMain","timer","timezone","getTimezoneOffset","InitMySetting","startAB","queryStr","startMe","initTabName","setSettings","App","ReactDOM","StrictMode","createApp","appendChild","getSystemInfoSync","startApp"],"mappings":"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","file":"static/js/main.249163b0.chunk.js","sourcesContent":["export * from './tool';\nexport * from './net';\nexport * from './components';\nexport * from './entry';\nexport * from './uq';\nexport * from './app';\nexport * from './vm';\n","export * from './navigo';\nexport * from './nav';\nexport * from './page';\nexport * from './schema';\nexport * from './form';\nexport * from './edit';\nexport * from '../res/res';\nexport * from './loading';\nexport * from './image';\nexport * from './resUploader';\nexport * from './rules';\nexport * from './list';\nexport * from './dropDownActions';\nexport * from './easyDate';\nexport * from './propGrid';\nexport * from './simple';\nexport * from './media';\nexport * from './searchBox';\nexport * from './userIcon';\n\n","import { decodeGuestToken } from '../tool/user';\nimport { CenterApiBase } from './uqApi';\n\nexport class GuestApi extends CenterApiBase {\n    async guest(): Promise<any> {\n        //let guest = nav.local.guest.get();\n        let ret = await this.get('', {});\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeGuestToken(ret);\n            case 'object':\n                let guest = decodeGuestToken(ret.token);\n                return guest;\n        }\n    }\n\n    async unitFromName(unitName:string): Promise<number> {\n        let ret = await this.get(unitName);\n        return ret && ret.unit;\n    }\n}\n\nexport const guestApi = new GuestApi('tv/guest/', undefined);\n","export abstract class Caller<T> {\n    protected readonly _params: T;\n    constructor(params: T, waiting: boolean) {\n        this._params = params;\n        this.waiting = waiting;\n    }\n    protected get params():any {return this._params;}\n    buildParams():any {return this.params;}\n    method: string  = 'POST';\n    abstract get path(): string;\n    get headers(): {[header:string]: string} {return undefined}\n    waiting: boolean;\n}\n","\nimport {setCenterToken} from './uqApi';\nimport {WSChannel} from './wsChannel';\n\nexport const netToken = {\n    set(userId:number, token:string) {\n        setCenterToken(userId, token);\n        WSChannel.setCenterToken(token);\n    },\n    clear() {\n        setCenterToken(0, undefined);\n        WSChannel.setCenterToken(undefined);\n    }\n};\n","import * as React from 'react';\nimport {FetchError} from '../net/fetchError';\nimport { refetchApi } from '../net';\nimport { Page } from './page/page';\n\nexport interface FetchErrorProps extends FetchError {\n    clearError: ()=>void\n}\n\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\n    private reApi = async () => {\n        this.props.clearError();\n        const {channel, url, options, resolve, reject} = this.props;\n        await refetchApi(channel, url, options, resolve, reject);\n    }\n    private close = async () => {\n        this.props.clearError();\n    }\n    render() {\n        let {error, url} = this.props;\n        let errContent:any;\n        if (typeof error === 'object') {\n            let err = [];\n            for (let i in error) {\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\n            }\n            errContent = <ul>{err}</ul>;\n        }\n        else {\n            errContent = <div>{error}</div>;\n        }\n        return <div>\n            <article>\n\t\t\t\t<main className=\"va-error\">\n\t\t\t\t\t<div>网络出现问题</div>\n\t\t\t\t\t<div>点击重新访问</div>\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\n\t\t\t\t\t{errContent}\n\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t<button type='button' onClick={this.reApi}>重新API</button>\n\t\t\t\t\t\t<button type='button' onClick={this.close}>关闭</button>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n            </article>\n        </div>;\n    }\n}\n\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\n    return <Page header=\"系统提醒\">\n        <div className=\"px-3\">{message}</div>\n    </Page>;\n}","import * as React from 'react';\nimport { nav } from './nav';\nimport { Page } from './page/page';\n\ninterface Props {\n    message: string,\n    seconds: number\n}\n\ninterface State {\n    seconds: number\n}\n\nexport class ReloadPage extends React.Component<Props, State> {\n    private timerHandler:any;\n    constructor(props:Props) {\n\t\tsuper(props);\n\t\tlet {seconds} = props;\n\t\tif (seconds===undefined) return;\n        this.state = {seconds};\n\t\tif (seconds <= 0) return;\n        this.timerHandler = setInterval(() => {\n\t\t\tlet {seconds} = this.state;\n            seconds--;\n            if (seconds <= 0) {\n                this.reload();\n            }\n            else {\n                this.setState({seconds: seconds});\n            }\n        }, 1000);\n    }\n    private reload = () => {\n        clearInterval(this.timerHandler);\n        nav.reload();\n    }\n    render() {\n\t\tlet {seconds} = this.state;\n\t\tlet title:string, msg:string;\t\t\n\t\tif (seconds > 0) {\n\t\t\ttitle = '程序升级中...';\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\n\t\t}\n\t\telse {\n\t\t\ttitle = '程序需要升级';\n\t\t\tmsg = '请点击下面按钮重启';\n\t\t}\n        return <Page header={false}>\n            <div className=\"text-center p-5\">\n                <div className=\"text-info py-5\">\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\n\t\t\t\t\t<br/>\n\t\t\t\t\t{msg}\n                    <br/>\n                    <span className=\"small text-muted\">{this.props.message}</span>\n                </div>\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\n            </div>\n        </Page>;\n    }\n}\n\ninterface ConfirmReloadPageProps {\n    confirm: (ok: boolean)=>Promise<void>;\n}\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\n    return <Page header=\"升级软件\" back=\"close\">\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\n            <div className=\"text-center text-info\">\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\n            </div>\n            <div className=\"text-center mt-5\">\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\n            </div>\n        </div>\n    </Page>;\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\n}\n","export default __webpack_public_path__ + \"static/media/logo.103b5fa1.svg\";","import * as React from 'react';\nimport { nav, mobileRegex, emailRegex } from '../components';\nimport logo from '../img/logo.svg';\n//const logo = require('../img/logo.svg');\n\nexport function tonvaTop() {\n    return nav.loginTop(<div className=\"d-flex align-items-center position-relative\">\n        <img className=\"App-logo h-3c position-absolute\" src={logo} alt=\"img\" />\n        <div className=\"h3 flex-fill text-center\"><span className=\"text-primary mr-3\">同</span>\n            <span className=\"text-danger\">花</span>\n        </div>\n    </div>);\n}\n\ninterface Sender {\n    type: string;\n    caption: string;\n    regex: RegExp;\n}\n\nconst senders:Sender[] = [\n    {type:'mobile', caption:'手机号', regex: mobileRegex},\n    {type:'email', caption:'邮箱', regex: emailRegex}\n];\n\nexport function getSender(un: string):Sender {\n    let sender = senders.find(v => v.regex.test(un) === true);\n    return sender;\n}","import * as React from 'react';\nimport {nav, Page, Schema, UiSchema, UiTextItem, UiPasswordItem, UiButton, Form, Context, resLang, StringSchema, NumSchema} from '../components';\nimport { Controller, VPage } from '../vm';\nimport { userApi, RegisterParameter } from '../net';\nimport '../css/va-form.css';\nimport { RegisterRes, registerRes } from '../res';\nimport { tonvaTop, getSender } from './tools';\n\nexport interface Values {\n    user: string;\n    pwd: string;\n    rePwd: string;\n    country?: string;\n    mobile?: string;\n    email?: string;\n}\n/*\nclass AccountInput extends TextWidget {\n    @observable private buttonDisabled: boolean = true;\n    private onClick = () => {\n        let {onButtonClick} = this.context.form.props;\n        if (onButtonClick === undefined) return;\n        onButtonClick(this.name, this.context);\n    }\n    protected onChange(evt: React.ChangeEvent<any>) {\n        this.buttonDisabled = (evt.target.value.trim().length === 0);\n    }\n    render() {\n        return <>\n            <div className=\"input-group\">\n                <input ref={input=>this.input = input}\n                            className=\"form-control\"\n                            type={this.inputType}\n                            defaultValue={this.value}\n                            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\n                            placeholder='手机号/邮箱'\n                            readOnly={this.readOnly}\n                            disabled={this.disabled}\n                            onKeyDown = {this.onKeyDown}\n                            onFocus = {(evt: React.FocusEvent<any>) => this.onFocus(evt)}\n                            onBlur={(evt: React.FocusEvent<any>) => this.onBlur(evt)}\n                            maxLength={(this.itemSchema as StringSchema).maxLength} />\n                <div className=\"input-group-append\">\n                    <button className=\"btn btn-sm btn-outline-primary\"\n                        type=\"button\" disabled={this.buttonDisabled}\n                        onClick={this.onClick}>\n                        <small>发送验证码</small>\n                    </button>\n                </div>\n            </div>\n            {this.renderErrors()}\n        </>;\n    }\n}\n*/\nexport class RegisterController extends Controller {\n    account: string;\n    type:'mobile'|'email';\n    password: string;\n    verify: string;\n\n    accountPageCaption = '注册账号';\n    accountLabel = '注册账号';\n    accountSubmitCaption = '注册新账号'; \n    passwordPageCaption = '账号密码';\n    passwordSubmitCaption = '注册新账号'; \n    successText = '注册成功';\n\n    protected async internalStart() {\n        this.openVPage(AccountPage);\n    }\n\n    toVerify(account:string) {\n        this.account = account;\n        this.openVPage(VerifyPage);\n    }\n\n    toPassword() {\n        this.openVPage(PasswordPage);\n    }\n\n    toSuccess(accounts?:any[]) {\n        this.openVPage(RegSuccess, accounts);\n    }\n\n    login = async (account?:string) => {\n        let retUser = await userApi.login({user: account || this.account, pwd: this.password, guest: nav.guest});\n        if (retUser === undefined) {\n            alert('something wrong!');\n            return;\n        }\n        await nav.userLogined(retUser);\n    }\n\n    private regReturn(registerReturn:number):string {\n        let msg:any;\n        switch (registerReturn) {\n            default: \n                return '服务器发生错误';\n            case 4:\n                return '验证码错误';\n            case 0:\n                return;\n            case 1:\n                msg = '用户名 ' + this.account;\n                break;\n            case 2:\n                msg = '手机号 +' + this.account;\n                break;\n            case 3:\n                msg = '邮箱 ' + this.account;\n                break;\n        }\n        return msg + ' 已经被注册过了';\n    }\n\n    async checkAccount():Promise<string> {\n        let ret = await userApi.isExists(this.account);\n        let error = this.accountError(ret);\n        if (error !== undefined) return error;\n        ret = await userApi.sendVerify(this.account, this.type, nav.oem);\n        this.toVerify(this.account);\n        return;\n    }\n\n    protected accountError(isExists: number) {\n        if (isExists > 0) return '已经被注册使用了';\n    }\n\n    async execute() {\n        let params: RegisterParameter = {\n            nick: undefined,\n            user: this.account, \n            pwd: this.password,\n            country: undefined,\n            mobile: undefined,\n            mobileCountry: undefined,\n            email: undefined,\n            verify: this.verify\n        }\n        switch (this.type) {\n            case 'mobile':\n                params.mobile = Number(this.account);\n                params.mobileCountry=86;\n                break;\n            case 'email':\n                params.email = this.account;\n                break;\n        }\n        let ret = await userApi.register(params);\n        if (ret === 0) {\n            nav.clear();\n            this.toSuccess();\n            return;\n        }\n        let error = this.regReturn(ret)\n        return error;\n    }\n}\n\nexport class ForgetController extends RegisterController {\n    accountPageCaption = '密码找回';\n    accountLabel = '账号';\n    accountSubmitCaption = '注册新账号'; \n    passwordPageCaption = '重置密码';\n    passwordSubmitCaption = '提交'; \n    successText = '成功修改密码';\n\n    async execute():Promise<any> {\n        let ret = await userApi.resetPassword(this.account, this.password, this.verify, this.type);\n        nav.clear();\n        this.toSuccess(ret);\n        return undefined;\n    }\n\n    protected accountError(isExists: number) {\n        if (isExists === 0) return '请输入正确的账号';\n    }\n}\n\nclass AccountPage extends VPage<RegisterController> {\n    private schema: Schema = [\n        {name: 'user', type: 'string', required: true, maxLength: 100} as StringSchema,\n        {name: 'verify', type: 'submit'},\n    ]\n    private uiSchema: UiSchema;\n\n    protected res: RegisterRes = resLang(registerRes);\n    async open() {\n        this.uiSchema = {\n            items: {\n                user: {\n                    widget: 'text',\n                    label: this.controller.accountLabel,\n                    placeholder: '手机号或邮箱',\n                } as UiTextItem, \n                verify: {widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '发送验证码'} as UiButton,\n            }\n        }\n                \n            this.openPage(this.page);\n    }\n\n    private page = ():JSX.Element => {\n        return <Page header={this.controller.accountPageCaption}>\n            <div className=\"w-max-20c my-5 py-5\"\n                style={{marginLeft:'auto', marginRight:'auto'}}>\n                {tonvaTop()}\n                <div className=\"h-3c\" />\n                <Form schema={this.schema} uiSchema={this.uiSchema} \n                    onButtonClick={this.onSubmit}\n                    onEnter={this.onEnter} \n                    requiredFlag={false} />\n                {nav.privacyEntry()}\n            </div>\n        </Page>;\n    }\n\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\n        context.clearContextErrors();\n        let user = 'user';\n        let value = context.getValue(user);\n        let sender = getSender(value);\n        if (sender === undefined) {\n            context.setError(user, '必须是手机号或邮箱');\n            return;\n        }\n        let type:'mobile'|'email' = sender.type as 'mobile'|'email';\n        if (type === 'mobile') {\n            if (value.length !== 11 || value[0] !== '1') {\n                context.setError(user, '请输入正确的手机号');\n                return;\n            }\n        }\n        this.controller.account = value;\n        this.controller.type = type;\n        let ret = await this.controller.checkAccount();\n        if (ret !== undefined) context.setError(user, ret);\n    }\n\n    private onEnter = async (name:string, context:Context):Promise<string> => {\n        if (name === 'user') {\n            return await this.onSubmit('verify', context);\n        }\n    }\n}\n\nclass VerifyPage extends VPage<RegisterController> {\n    private schema: Schema = [\n        {name: 'verify', type: 'number', required: true, maxLength: 6} as NumSchema,\n        {name: 'submit', type: 'submit'},\n    ]\n\n    private onVerifyChanged = (context:Context, value:any, prev:any) => {\n        context.setDisabled('submit', !value || (value.length !== 6));\n    }\n    private uiSchema: UiSchema = {\n        items: {\n            verify: {\n                widget: 'text',\n                label: '验证码',\n                placeholder: '请输入验证码',\n                onChanged: this.onVerifyChanged,\n            } as UiTextItem, \n            submit: {\n                widget: 'button', \n                className: 'btn btn-primary btn-block mt-3', \n                label: '下一步 >',\n                disabled: true\n            } as UiButton,\n        }\n    }\n    async open() {\n        this.openPage(this.page);\n    }\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\n        let verify = this.controller.verify = context.getValue('verify');\n        let ret = await userApi.checkVerify(this.controller.account, verify);\n        if (ret === 0) {\n            context.setError('verify', '验证码错误');\n            return;\n        }\n        this.controller.toPassword();\n    }\n\n    private onEnter = async (name:string, context:Context):Promise<string> => {\n        if (name === 'verify') {\n            return await this.onSubmit('submit', context);\n        }\n    }\n    private page = ():JSX.Element => {\n        let typeText:string, extra:any;\n        switch (this.controller.type) {\n            case 'mobile': typeText = '手机号'; break;\n            case 'email': \n                typeText = '邮箱'; \n                extra = <><span className=\"text-danger\">注意</span>: 有可能误为垃圾邮件，请检查<br/></>;\n                break;\n        }\n        return <Page header=\"验证码\">\n            <div className=\"w-max-20c my-5 py-5\"\n                style={{marginLeft:'auto', marginRight:'auto'}}>\n                验证码已经发送到{typeText}<br/>\n                <div className=\"py-2 px-3 my-2 text-primary bg-light\"><b>{this.controller.account}</b></div>\n                {extra}\n                <div className=\"h-1c\" />\n                <Form schema={this.schema} uiSchema={this.uiSchema} \n                    onButtonClick={this.onSubmit} \n                    onEnter={this.onEnter}\n                    requiredFlag={false} />\n            </div>\n        </Page>\n    }\n}\n\nclass PasswordPage extends VPage<RegisterController> {\n    private schema: Schema = [\n        {name: 'pwd', type: 'string', required: true, maxLength: 100} as StringSchema,\n        {name: 'rePwd', type: 'string', required: true, maxLength: 100} as StringSchema,\n        {name: 'submit', type: 'submit'},\n    ]\n    private uiSchema: UiSchema;\n    async open() {\n        this.uiSchema = {\n            items: {\n                pwd: {widget: 'password', placeholder: '密码', label: '密码'} as UiPasswordItem,\n                rePwd: {widget: 'password', placeholder: '重复密码', label: '重复密码'} as UiPasswordItem,\n                submit: {widget: 'button', className: 'btn btn-primary btn-block mt-3', label: this.controller.passwordSubmitCaption} as UiButton,\n            }\n        }\n        this.openPage(this.page);\n    }\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\n        let values = context.form.data;\n        let {pwd, rePwd} = values;\n        let error:string;\n        if (!pwd || pwd !== rePwd) {\n            context.setValue('pwd', '');\n            context.setValue('rePwd', '');\n            error = '密码错误，请重新输入密码！';\n            context.setError('pwd', error);\n        }\n        else {\n            this.controller.password = pwd;\n            error = await this.controller.execute();\n            if (error !== undefined) {\n                nav.push(<Page header=\"注册不成功\"><div className=\"p-5 text-danger\">{error}</div></Page>);\n            }\n        }\n        return error;\n    }\n    private onEnter = async (name:string, context:Context):Promise<string> => {\n        if (name === 'rePwd') {\n            return await this.onSubmit('submit', context);\n        }\n    }\n    private page = ():JSX.Element => {\n        return <Page header={this.controller.passwordPageCaption}>\n            <div className=\"w-max-20c my-5 py-5\"\n                style={{marginLeft:'auto', marginRight:'auto'}}>\n                注册账号<br/>\n                <div className=\"py-2 px-3 my-2 text-primary bg-light\"><b>{this.controller.account}</b></div>\n                <div className=\"h-1c\" />\n                <Form schema={this.schema} uiSchema={this.uiSchema}                    \n                    onButtonClick={this.onSubmit}\n                    onEnter={this.onEnter}\n                    requiredFlag={false} />\n            </div>\n        </Page>\n    }\n}\n\nclass RegSuccess extends VPage<RegisterController> {\n    async open(users: any[]) {\n        this.openPage(this.page, {users:users});\n    }\n\n    private page = ({users}:{users:any[]}) => {\n        const {account, successText, login} = this.controller;\n        if (users === undefined) {\n            return <Page header={false}>\n                <div className=\"container w-max-30c\">\n                    <div className=\"my-5\">\n                        <div className=\"py-5\">\n                            账号 <strong className=\"text-primary\">{account} </strong> {successText}！\n                        </div>\n                        <button className=\"btn btn-success btn-block\" type=\"button\" onClick={()=>login(undefined)}>\n                            直接登录\n                        </button>\n                    </div>\n                </div>\n            </Page>;\n        }\n        else {\n            return <Page header={false}>\n                <div className=\"container w-max-30c\">\n                    <div className=\"my-5\">\n                        <div className=\"py-5 text-success\">{successText}</div>\n                        {users.map((v:any) => {\n                            let {name} = v;\n                            return <div className=\"py-2 cursor-pointer\" onClick={()=>login(name)}>\n                                登录账号 <strong className=\"text-primary\">{name} </strong>\n                            </div>\n                        })}\n                    </div>\n                </div>\n            </Page>;\n        }\n    }\n}\n","import * as React from 'react';\nimport {observable} from 'mobx';\nimport marked from 'marked';\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\nimport {Page} from './page/page';\nimport {netToken} from '../net/netToken';\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\nimport {FetchError} from '../net/fetchError';\nimport {appUrl, setAppInFrame, getExHash, getExHashPos} from '../net/appBridge';\nimport {LocalData, env} from '../tool';\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, appInFrame, host, resUrlFromHost, messageHub} from '../net';\n//import { WsBase, wsBridge } from '../net/wsChannel';\nimport { resOptions } from '../res/res';\nimport { Loading } from './loading';\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from './navigo';\nimport _ from 'lodash';\nimport 'font-awesome/css/font-awesome.min.css';\nimport '../css/va-form.css';\nimport '../css/va.css';\nimport '../css/animation.css';\nimport { FA } from './simple';\nimport { userApi } from '../net';\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\nimport lv from '../entry/login'\n\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\n    'BlackBerry|Windows Phone|'  +\n    'Opera Mini|IEMobile|Mobile' , \n    'i');\nconst isMobile = regEx.test(navigator.userAgent);\n\n/*\nexport const mobileHeaderStyle = isMobile? {\n    minHeight:  '3em'\n} : undefined;\n*/\n//const logo = require('../img/logo.svg');\nlet logMark: number;\nconst logs:string[] = [];\n\nexport interface Props //extends React.Props<Nav>\n{\n    onLogined: (isUserLogin?:boolean)=>Promise<void>;\n    notLogined?: ()=>Promise<void>;\n};\nlet stackKey = 1;\nexport interface StackItem {\n    key: number;\n    view: JSX.Element;\n    ceased: boolean;\n    confirmClose?: ()=>Promise<boolean>;\n    disposer?: ()=>void;\n}\nexport interface NavViewState {\n    stack: StackItem[];\n    wait: 0|1|2;\n    fetchError: FetchError\n}\n\nexport class NavView extends React.Component<Props, NavViewState> {\n    private stack: StackItem[];\n    private htmlTitle: string;\n    private waitCount: number = 0;\n    private waitTimeHandler?: NodeJS.Timer;\n\n    constructor(props:Props) {\n        super(props);\n        this.stack = [];\n        this.state = {\n            stack: this.stack,\n            wait: 0,\n            fetchError: undefined\n        };\n        nav.set(this);\n    }\n    async componentDidMount()\n    {\n\t\twindow.addEventListener('popstate', this.navBack);\n\t\tif (nav.isRouting === false) await nav.init();\n        await nav.start();\n    }\n\n    get level(): number {\n        return this.stack.length;\n    }\n\n    startWait() {\n        if (this.waitCount === 0) {\n            this.setState({wait: 1});\n            this.waitTimeHandler = env.setTimeout(\n                'NavView.startWait',\n                () => {\n                    this.waitTimeHandler = undefined;\n                    this.setState({wait: 2});\n                },\n                1000) as NodeJS.Timer;\n        }\n        ++this.waitCount;\n        this.setState({\n            fetchError: undefined,\n        });\n    }\n\n    endWait() {\n        env.setTimeout(\n            undefined, //'NavView.endWait',\n            () => {\n            /*\n            this.setState({\n                fetchError: undefined,\n            });*/\n            --this.waitCount;\n            if (this.waitCount === 0) {\n                if (this.waitTimeHandler !== undefined) {\n                    env.clearTimeout(this.waitTimeHandler);\n                    this.waitTimeHandler = undefined;\n                }\n                this.setState({wait: 0});\n            }\n        },100);\n    }\n\n    async onError(fetchError: FetchError)\n    {\n        let err = fetchError.error;\n        if (err !== undefined) {\n            if (err.unauthorized === true) {\n                await nav.showLogin(undefined);\n                return;\n            }\n            switch (err.type) {\n                case 'unauthorized':\n                    await nav.showLogin(undefined);\n                    return;\n                case 'sheet-processing':\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\n                    return;\n            }\n        }\n        this.setState({\n            fetchError: fetchError,\n        });\n    }\n\n    private upgradeUq = () => {\n        nav.start();\n    }\n\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        this.show(<Page header={false}>\n            <div>\n                UQ升级了，请点击按钮升级 <br />\n                <small className=\"text-muted\">{uq} ver-{version}</small>\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\n            </div>\n        </Page>)\n    }\n\n    show(view: JSX.Element, disposer?: ()=>void): number {\n        this.clear();\n        return this.push(view, disposer);\n    }\n\n    push(view: JSX.Element, disposer?: ()=>void): number {\n        this.removeCeased();\n        if (this.stack.length > 0) {\n            window.history.pushState('forward', null, null);\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key,\n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        this.refresh();\n        //console.log('push: %s pages', this.stack.length);\n        return key;\n    }\n\n    replace(view: JSX.Element, disposer?: ()=>void): number {\n        let item:StackItem = undefined;\n        let stack = this.stack;\n        if (stack.length > 0) {\n            item = stack.pop();\n            //this.popAndDispose();\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key, \n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        if (item !== undefined) this.dispose(item.disposer);\n        this.refresh();\n        //console.log('replace: %s pages', this.stack.length);\n        return key;\n    }\n\n    ceaseTop(level:number = 1) {\n        let p = this.stack.length - 1;\n        for (let i=0; i<level; i++, p--) {\n            if (p < 0) break;\n            let item = this.stack[p];\n            item.ceased = true;\n        }\n    }\n\n    pop(level:number = 1) {\n        let stack = this.stack;\n        let len = stack.length;\n        //console.log('pop start: %s pages level=%s', len, level);\n        if (level <= 0 || len <= 1) return;\n        if (len < level) level = len;\n        let backLevel = 0;\n        for (let i = 0; i < level; i++) {\n            if (stack.length === 0) break;\n            //stack.pop();\n            this.popAndDispose();\n            ++backLevel;\n        }\n        if (backLevel >= len) backLevel--;\n        this.refresh();\n        if (this.isHistoryBack !== true) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(backLevel);\n            //window.addEventListener('popstate', this.navBack);\n        }\n        //console.log('pop: %s pages', stack.length);\n    }\n\n    popTo(key: number) {\n        if (key === undefined) return;\n        if (this.stack.find(v => v.key === key) === undefined) return;\n        while (this.stack.length >0) {\n            let len = this.stack.length;\n            let top = this.stack[len-1];\n            if (top.key === key) break;\n            this.pop();\n        }\n    }\n\n    topKey():number {\n        let len = this.stack.length;\n        if (len === 0) return undefined;\n        return this.stack[len-1].key;\n    }\n\n    removeCeased() {\n        for (;;) {\n            let p=this.stack.length-1;\n            if (p < 0) break;\n            let top = this.stack[p];\n            if (top.ceased === false) break;\n            let item = this.stack.pop();\n            let {disposer} = item;\n            this.dispose(disposer);\n        }\n        this.refresh();\n    }\n\n    private popAndDispose() {\n        this.removeCeased();\n        let item = this.stack.pop();\n\t\tif (item === undefined) return;\n\t\t//if (nav.isRouting) {\n\t\t//\twindow.history.back();\n\t\t//}\n        let {disposer} = item;\n        this.dispose(disposer);\n        this.removeCeased();\n        return item;\n    }\n\n    private dispose(disposer:()=>void) {\n        if (disposer === undefined) return;\n        let item = this.stack.find(v => v.disposer === disposer);\n        if (item === undefined) disposer();\n    }\n\n    clear() {\n        let len = this.stack.length;\n        while (this.stack.length > 0) this.popAndDispose();\n        //this.refresh();\n        if (len > 1) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(len-1);\n            //window.addEventListener('popstate', this.navBack);\n        }\n    }\n\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        let top = stack[len-1];\n        top.confirmClose = confirmClose;\n    }\n\n    private isHistoryBack:boolean = false;\n    navBack = () => {\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\n        let tick = Date.now();\n        this.isHistoryBack = true;\n        this.back(true);\n        this.isHistoryBack = false;\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\n    }\n\n    back = async (confirm:boolean = true) => {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        if (len === 1) {\n            if (window.self !== window.top) {\n                window.top.postMessage({type:'pop-app'}, '*');\n            }\n            return;\n        }\n        let top = stack[len-1];\n        if (confirm===true && top.confirmClose) {\n            if (await top.confirmClose()===true) this.pop();\n        }\n        else {\n            this.pop();\n        }\n    }\n\n    confirmBox(message?:string): boolean {\n        return window.confirm(message);\n    }\n    clearError = () => {\n        this.setState({fetchError: undefined});\n    }\n    render() {\n        const {wait, fetchError} = this.state;\n        let stack = this.state.stack;\n        let top = stack.length - 1;\n        let elWait = null, elError = null;\n        switch (wait) {\n            case 1:\n                elWait = <div className=\"va-wait va-wait1\">\n                </div>;\n                break;\n            case 2:\n                elWait = <div className=\"va-wait va-wait2\">\n                    <Loading />\n                </div>;\n                break;\n        }\n        if (fetchError)\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\n        let test = nav.testing===true && \n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\n                <FA className=\"text-warning\" name=\"info-circle\" />\n            </span>;\n        return <>\n\t\t\t{stack.map((item, index) => {\n\t\t\t\tlet {key, view} = item;\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\n\t\t\t\t\t{view}\n\t\t\t\t</div>\n\t\t\t})}\n\t\t\t{elWait}\n\t\t\t{elError}\n\t\t\t{test}\n        </>;\n    }\n\n    private refresh() {\n        this.setState({stack: this.stack });\n    }\n}\n\nexport interface NavSettings {\n    oem?: string;\n    loginTop?: JSX.Element;\n    privacy?: string;\n}\n\nexport class Nav {\n    private nav:NavView;\n    //private ws: WsBase;\n    private wsHost: string;\n    private local: LocalData = new LocalData();\n\tprivate navigo: Navigo;\n\tisRouting: boolean = false;\n\tnavSettings: NavSettings;\n    @observable user: User/*InNav*/ = undefined;\n    testing: boolean;\n    language: string;\n    culture: string;\n    resUrl: string;\n\n    constructor() {\n        let {lang, district} = resOptions;\n        this.language = lang;\n        this.culture = district;\n\t\tthis.testing = false;\n    }\n\n    get guest(): number {\n        let guest = this.local.guest;\n        if (guest === undefined) return 0;\n        let g = guest.get();\n        if (g === undefined) return 0;\n        return g.guest;\n    }\n\n    set(nav:NavView) {\n        //this.logo = logo;\n        this.nav = nav;\n\t}\n\t/*\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\n        //if (this.ws === undefined) return;\n        return messageHub.onReceiveAny(handler);\n    }\n\n    unregisterReceiveHandler(handlerId:number) {\n        //if (this.ws === undefined) return;\n        if (handlerId === undefined) return;\n        messageHub.endReceive(handlerId);\n    }\n\t*/\n    async onReceive(msg:any) {\n        //if (this.ws === undefined) return;\n        await messageHub.dispatch(msg);\n    }\n\n\tprivate async loadUnitJson() {\n\t\ttry {\n\t\t\tlet unitJsonPath = this.unitJsonPath();\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\n\t\t\tlet res = await unitRes.json();\n\t\t\treturn res.unit;\n\t\t}\n\t\tcatch (err1) {\n\t\t\tthis.local.unit.remove();\n\t\t\treturn;\n\t\t}\n\t}\n\n    private async getPredefinedUnitName() {\t\n        if (process.env.isMiniprogram) {\n            return '百灵威';\n        }\n\t\tlet el = document.getElementById('unit');\n\t\tif (el) {\n\t\t\treturn el.innerText;\n\t\t}\n\t\tel = document.getElementById('unit.json');\n\t\tif (!el) {\n\t\t\treturn await this.loadUnitJson();\n\t\t}\n\t\ttry {\n            let json = el.innerHTML;\n            let res = JSON.parse(json);\n            return res.unit;\n        }\n        catch (err) {\n\t\t\treturn await this.loadUnitJson();\n        }\n    }\n\n    private async loadPredefinedUnit() {\n        let envUnit = process.env.REACT_APP_UNIT;\n        if (envUnit !== undefined) {\n            return Number(envUnit);\n        }\n        let unitName:string;\n        let unit = this.local.unit.get();\n        if (unit !== undefined) {\n            if (env.isDevelopment !== true) return unit.id;\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n            if (unit.name === unitName) return unit.id;\n        }\n        else {\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n        }\n        let unitId = await guestApi.unitFromName(unitName);\n        if (unitId !== undefined) {\n            this.local.unit.set({id: unitId, name: unitName});\n        }\n        return unitId;\n    }\n\n    setSettings(settings?: NavSettings) {\n        this.navSettings = settings;\n    }\n\n    get oem():string {\n        return this.navSettings && this.navSettings.oem;\n    }\n\n    hashParam: string;\n    private centerHost: string;\n    private arrs = ['/test', '/test/'];\n    private unitJsonPath():string {\n        let {origin, pathname} = window.location; //document.location;\n\t\tpathname = pathname.toLowerCase();\n        for (let item of this.arrs) {\n            if (_.endsWith(pathname, item) === true) {\n                pathname = pathname.substr(0, pathname.length - item.length);\n                break;\n            }\n        }\n        if (_.endsWith(pathname, '/') === true || _.endsWith(pathname, '\\\\') === true) {\n            pathname = pathname.substr(0, pathname.length-1);\n        }\n        return origin + pathname + '/unit.json';\n    }\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\n\t\tdebugger;\n        console.error('windowOnError');\n        console.error(error);\n    }\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\n\t\tdebugger;\n        console.error('windowOnUnhandledRejection');\n        console.error(ev.reason);\n    }\n    private windowOnClick = (ev: MouseEvent) => {\n        console.error('windowOnClick');\n    }\n    private windowOnMouseMove = (ev: MouseEvent) => {\n        console.log('navigator.userAgent: ' + navigator.userAgent);\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\n    }\n    private windowOnScroll = (ev: Event) => {\n        console.log('scroll event');\n\t}\n\t\n\tasync init() {\n\t\tthis.testing = env.testing;\n        await host.start(this.testing);\n        //if (document.location) {\n            let hash = window.location.hash;\n            if (hash !== undefined && hash.length > 0) {\n                let pos = getExHashPos();\n                if (pos < 0) pos = undefined;\n                this.hashParam = hash.substring(1, pos);\n            }\n        //}\n        \n\t\tlet {url, ws, resHost} = host;\n\t\tthis.centerHost = url;\n\t\tthis.resUrl = resUrlFromHost( resHost);\n\t\tthis.wsHost = ws;\n\t\tsetCenterUrl(url);\n\n\t\tlet guest:Guest = this.local.guest.get();\n\t\tif (guest === undefined) {\n\t\t\tguest = await guestApi.guest();\n\t\t}\n\t\tif (!guest) {\n\t\t\tdebugger;\n\t\t\tthrow Error('guest can not be undefined');\n\t\t}\n\t\tnav.setGuest(guest);\n\n\t\tlet exHash = getExHash();\n\t\tlet appInFrame = setAppInFrame(exHash);\n\t\tif (exHash !== undefined && window !== window.parent) {\n\t\t\t// is in frame\n\t\t\tif (appInFrame !== undefined) {\n\t\t\t\t//this.ws = wsBridge;\n\t\t\t\tconsole.log('this.ws = wsBridge in sub frame');\n\t\t\t\t//nav.user = {id:0} as User;\n\t\t\t\tif (window.self !== window.parent) {\n\t\t\t\t\twindow.parent.postMessage({type:'sub-frame-started', hash: appInFrame.hash}, '*');\n\t\t\t\t}\n\t\t\t\t// 下面这一句，已经移到 appBridge.ts 里面的 initSubWin，也就是响应从main frame获得user之后开始。\n\t\t\t\t//await this.showAppView();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet predefinedUnit = await this.loadPredefinedUnit();\n\t\tappInFrame.predefinedUnit = predefinedUnit;\n\t}\n\n    async start() {\n        try {\n\t\t\twindow.onerror = this.windowOnError;\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\n            //window.addEventListener('click', this.windowOnClick);\n            //window.addEventListener('mousemove', this.windowOnMouseMove);\n            //window.addEventListener('touchmove', this.windowOnMouseMove);\n            //window.addEventListener('scroll', this.windowOnScroll);\n            if (isMobile === true) {\n                document.onselectstart = function() {return false;}\n                document.oncontextmenu = function() {return false;}\n            }\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\n\t\t\tnav.clear();\n\t\t\tthis.startWait();\n            \n            let user: User = this.local.user.get();\n            if (user === undefined) {\n                let {notLogined} = this.nav.props;\n                if (notLogined !== undefined) {\n                    await notLogined();\n                }\n                else {\n                    await nav.showLogin(undefined);\n                }\n                return;\n            }\n\n            await nav.logined(user);\n        }\n        catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tdebugger;\n        }\n        finally {\n            this.endWait();\n        }\n\t}\n\n\tresolveRoute() {\n\t\tif (this.isRouting === false) return;\n\t\tif (this.navigo === undefined) return;\n\t\tthis.navigo.resolve();\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\tif (this.navigo === undefined) {\n\t\t\tthis.navigo = new Navigo();\n\t\t}\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\n\t}\n\n\tnavigate(url:string, absolute?:boolean) {\n\t\tthis.clear();\n\t\treturn this.navigo.navigate(url, absolute);\n\t}\n\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tif (this.navigo !== undefined) {\n\t\t\tthis.navigate(url, absolute);\n\t\t}\n\t\telse {\n\t\t\tshowPage();\n\t\t}\n\t}\n\n    async showAppView(isUserLogin?: boolean) {\n        let {onLogined} = this.nav.props;\n        if (onLogined === undefined) {\n            nav.push(<div>NavView has no prop onLogined</div>);\n            return;\n        }\n        nav.clear();\n        await onLogined(isUserLogin);\n    }\n\n    setGuest(guest: Guest) {\n        this.local.guest.set(guest);\n        netToken.set(0, guest.token);\n    }\n\n    saveLocalUser() {\n        this.local.user.set(this.user);\n    }\n\n    async loadMe() {\n        let me = await userApi.me();\n        this.user.icon = me.icon;\n        this.user.nick = me.nick;\n    }\n\n\tprivate async internalLogined(user: User, callback: (user:User)=>Promise<void>, isUserLogin:boolean) {\n        logoutApis();\n        console.log(\"logined: %s\", JSON.stringify(user));\n        this.user = user;\n        this.saveLocalUser();\n\t\tnetToken.set(user.id, user.token);\n\t\tnav.clear();\n\n        if (callback !== undefined) //this.loginCallbacks.has)\n            callback(user);\n            //this.loginCallbacks.call(user);\n        else {\n            await this.showAppView(isUserLogin);\n        }\n\t}\n\n\t// 缓冲登录\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\n\t\tawait this.internalLogined(user, callback, false);\n    }\n\n\t// 用户操作之后登录\n    async userLogined(user: User, callback?: (user:User)=>Promise<void>) {\n\t\tawait this.internalLogined(user, callback, true);\n    }\n\n    //wsConnect() {\n        //let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\n        //ws.connect();\n    //}\n\n    loginTop(defaultTop:JSX.Element) {\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\n    }\n\n    privacyEntry() {\n        if (!this.getPrivacyContent()) return;\n        return <div className=\"text-center\">\n            <button className=\"btn btn-sm btn-link\"\n                onClick={this.showPrivacyPage}>\n                <small className=\"text-muted\">隐私政策</small>\n            </button>\n        </div>;\n    }\n\n    private getPrivacyContent():string {\n        if (!this.navSettings) return;\n        let {privacy} = this.navSettings;\n        return privacy;\n    }\n\n    showPrivacyPage = () => {\n        let privacy = this.getPrivacyContent();\n        if (privacy) {\n            this.privacyPage(privacy);\n        }\n        else {\n            nav.push(<Page header=\"隐私政策\">\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\n            </Page>);\n        }\n    }\n\n    private privacyPage = async (privacy:string) => {\n        let html = await this.getPrivacy(privacy);\n        let content = {__html: marked(html)};\n        nav.push(<Page header=\"隐私政策\">\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\n        </Page>);\n    }\n\n    private async getPrivacy(privacy:string):Promise<string> {\n        //const headers = new Headers({\n        //    \"Content-Type\":'text/plain'\n        //})\n        let headers:{[name:string]: string} = {}; //new Headers();\n        headers['Content-Type'] = 'text/plain';\n        let pos = privacy.indexOf('://');\n        if (pos > 0) {\n            let http = privacy.substring(0, pos).toLowerCase();\n            if (http === 'http' || http === 'https') {\n                try {\n                    let res = await fetch(privacy, {\n                        method:'GET',\n                        headers: headers,\n                    });\n                    let text = await res.text();\n                    return text;\n                }\n                catch (err) {\n                    return err.message;\n                }\n            }\n        }\n        return privacy;\n    }\n\n    async showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\n        //let lv = await import('../entry/login');\n        \n        let loginView = React.createElement(\n\t\t\tlv, \n\t\t\t{withBack, callback}\n\t\t);\n        if (withBack !== true) {\n            this.nav.clear();\n            this.pop();\n        }\n        this.nav.push(loginView);\n    }\n\n    async showLogout(callback?: ()=>Promise<void>) {\n        let footer = <div className=\"text-center justify-content-center\">\n            <button className=\"btn btn-outline-danger\" onClick={this.resetAll}>升级软件</button>\n        </div>;\n        nav.push(<Page header=\"安全退出\" back=\"close\" footer={footer}>\n            <div className=\"my-5 mx-1 border border-info bg-white rounded p-3 text-center\">\n                <div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\n                <div className=\"mt-3 text-center\">\n                        <button className=\"btn btn-danger\" onClick={()=>this.logout(callback)}>安全退出</button>\n                </div>\n            </div>\n        </Page>);\n    }\n\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\n        appInFrame.unit = undefined;\n        this.local.logoutClear();\n        this.user = undefined; //{} as User;\n        logoutApis();\n        let guest = this.local.guest.get();\n        setCenterToken(0, guest && guest.token);\n\t\t//this.ws = undefined;\n\t\tthis.clear();\n        if (callback === undefined)\n            await nav.start();\n        else\n            await callback();\n    }\n\n    async changePassword() {\n        let cp = await import('../entry/changePassword');\n        nav.push(<cp.ChangePasswordPage />);\n    }\n\n    get level(): number {\n        return this.nav.level;\n    }\n    startWait() {\n        this.nav?.startWait();\n    }\n    endWait() {\n        this.nav?.endWait();\n    }\n    async onError(error: FetchError) {\n        await this.nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await this.nav.showUpgradeUq(uq, version);\n    }\n\n    show (view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.show(view, disposer);\n    }\n    push(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.push(view, disposer);\n    }\n    replace(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.replace(view, disposer);\n    }\n    pop(level:number = 1) {\n        this.nav.pop(level);\n    }\n    topKey():number {\n        return this.nav.topKey();\n    }\n    popTo(key:number) {\n        this.nav.popTo(key);\n    }\n    clear() {\n        this.nav?.clear();\n    }\n    navBack() {\n        this.nav.navBack();\n    }\n    ceaseTop(level?:number) {\n        this.nav.ceaseTop(level);\n    }\n    removeCeased() {\n        this.nav.removeCeased();\n    }\n    async back(confirm:boolean = true) {\n        await this.nav.back(confirm);\n    }\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.nav.regConfirmClose(confirmClose);\n    }\n    confirmBox(message?:string): boolean {\n        return this.nav.confirmBox(message);\n    }\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\n            let uh = sheetId === undefined?\n                    appUrl(url, unitId) :\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\n            console.log('navToApp: %s', JSON.stringify(uh));\n            nav.push(<article className='app-container'>\n                <span id={uh.hash} onClick={()=>this.back()} /*style={mobileHeaderStyle}*/>\n                    <i className=\"fa fa-arrow-left\" />\n                </span>\n                {\n                    // eslint-disable-next-line \n                    <iframe src={uh.url} title={String(sheetId)} />\n                }\n            </article>, \n            ()=> {\n                resolve();\n            });\n        });\n    }\n\n    navToSite(url: string) {\n        // show in new window\n        window.open(url);\n    }\n\n    get logs() {return logs};\n    log(msg:string) {\n        logs.push(msg);\n    }\n    logMark() {\n        let date = new Date();\n        logMark = date.getTime();\n        logs.push('log-mark: ' + date.toTimeString());\n    }\n    logStep(step:string) {\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\n    }\n\n    showReloadPage(msg: string) {\n        let seconds = -1;\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\n\t\t/*\n\t\tif (seconds > 0) {\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\n\t\t}\n\t\t*/\n    }\n\n    reload = async () => {\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\n            setTimeout(resolve, 100);\n        });\n\n        if ('serviceWorker' in navigator) {\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\n            if (registration) registration.unregister();\n        }\n        //window.document.location.reload();\n        window.location.reload();\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\n\t\tlet plus = (window as any).plus;\n\t\tif (plus) {\n\t\t\tlet webview = plus.webview;\n\t\t\tif (webview) {\n\t\t\t\tif (webview.reload) webview.reload(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet webView = plus.webView;\n\t\t\t\tif (webView) {\n\t\t\t\t\tif (webView.reload) webView.reload(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//plus.webview.reload(true)\n\t\t}\n    }\n\n    resetAll = () => {\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\n            if (ok === true) {\n                this.showReloadPage('彻底升级');\n\t\t\t\tlocalStorage.clear();\n\t\t\t\t/*\n                this.local.readToMemory();\n                env.localDb.removeAll();\n\t\t\t\tthis.local.saveToLocalStorage();\n\t\t\t\t*/\n            }\n            else {\n                this.pop();\n            }\n            return;\n        }} />);\n    }\n\n    async checkVersion():Promise<string> {\n        let {href} = document.location;\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\n        let ret = await fetch(href);\n        let r = await ret.text();\n        let parser = new DOMParser();\n        let htmlDoc = parser.parseFromString(r, 'text/html');\n        let elHtml = htmlDoc.getElementsByTagName('html');\n        let newVersion = elHtml[0].getAttribute('data-version');\n        return newVersion;\n    }\n}\nexport const nav: Nav = new Nav();\n\nexport class TonvaView extends NavView {\n\n}\n","import * as React from 'react';\nimport {nav, Page, Form, Schema, UiSchema, UiTextItem, UiPasswordItem, Context, UiButton, resLang, StringSchema} from '../components';\nimport { RegisterController, ForgetController } from './register';\nimport { userApi } from '../net';\nimport { LoginRes, loginRes } from '../res';\nimport { tonvaTop, getSender } from './tools';\nimport { User } from '../tool/user';\n\nconst schema: Schema = [\n    {name: 'username', type: 'string', required: true, maxLength: 100} as StringSchema,\n    {name: 'password', type: 'string', required: true, maxLength: 100} as StringSchema,\n    {name: 'login', type: 'submit'},\n];\n\nexport interface LoginProps {\n    withBack?: boolean;\n    callback?: (user:User) => Promise<void>;\n    //top?: any;\n}\n\nexport default class Login extends React.Component<LoginProps> {\n    private res: LoginRes = resLang(loginRes);\n    private uiSchema: UiSchema = {\n        items: {\n            username: {placeholder: '手机/邮箱/用户名', label: '登录账号'} as UiTextItem,\n            password: {widget: 'password', placeholder: '密码', label: '密码'} as UiPasswordItem,\n            login: {widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '登录'} as UiButton,\n        }\n    }\n\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\n        let values = context.form.data;\n        let un = values['username'];\n        let pwd = values['password'];\n        if (pwd === undefined) {\n            return 'something wrong, pwd is undefined';\n        }\n        let user = await userApi.login({\n            user: un,\n            pwd: pwd,\n            guest: nav.guest,\n        });\n\n        if (user === undefined) {\n            let sender = getSender(un);\n            let type:string = sender !== undefined? sender.caption : '用户名';\n            return type + '或密码错！';\n        }\n\t\tconsole.log(\"onLoginSubmit: user=%s pwd:%s\", user.name, user.token);\n        await nav.userLogined(user, this.props.callback);\n    }\n    private onEnter = async (name:string, context:Context):Promise<string> => {\n        if (name === 'password') {\n            return await this.onSubmit('login', context);\n        }\n    }\n    private clickReg = () => {\n        //nav.replace(<RegisterView />);\n        let register = new RegisterController(undefined);\n        register.start();\n    }\n    private clickForget = () => {\n        let forget = new ForgetController(undefined);\n        forget.start();\n    }\n    render() {\n        let footer = <div><div className=\"d-block\">\n            <div className='text-center'>\n                <button className=\"btn btn-link\" style={{margin:'0px auto'}}\n                    onClick={this.clickReg}>\n                    注册账号\n                </button>\n            </div>\n            {nav.privacyEntry()}\n        </div>\n        </div>;\n        let header:string|boolean|JSX.Element = false;\n        if (this.props.withBack === true) {\n            header = '登录';\n        }\n        return <Page header={header} footer={footer}>\n            <div className=\"d-flex p-5 flex-column justify-content-center align-items-center\">\n                <div className=\"flex-fill\" />\n                <div className=\"w-20c\">\n                    {tonvaTop()}\n                    <div className=\"h-2c\" />\n                    <Form schema={schema} uiSchema={this.uiSchema} \n                        onButtonClick={this.onSubmit} \n                        onEnter={this.onEnter}\n                        requiredFlag={false} />\n                    <button className=\"btn btn-link btn-block\"\n                        onClick={() => this.clickForget()}>\n                        忘记密码\n                    </button>\n                </div>\n                <div className=\"flex-fill\" />\n                <div className=\"flex-fill\" />\n            </div>\n        </Page>;\n    }\n}\n","import {observable} from 'mobx';\n\nexport interface Id {\n    id: number;\n}\n\nexport abstract class CacheIds<T extends Id> {\n    constructor(maxCount:number = 100) {\n        this.maxCount = maxCount;\n    }\n    private maxCount:number;\n    private arr:T[] = [];\n    @observable dict = new Map<number, T>();\n\n    loadIds(ids:number[]) {\n        let arr:number[] = [];\n        for (let id of ids) {\n            if (id === null) continue;\n            let item = this.dict.get(id);\n            if (item === undefined) {\n                arr.push(id);\n                item = {id:id} as T;\n                this.dict.set(id, item);\n            }\n        }                \n        this.loadId(arr);\n    }\n\n    get(id:number):T {\n        if (id === undefined || id === null) return null;\n        let item = this.dict.get(id);\n        if (item === undefined) {\n            this.dict.set(id, {id:id} as T);\n            this.loadId([id]);\n            item = this.dict.get(id);\n        }\n        return item;\n    }\n    private setItem(id:number, item:T) {\n        if (item === undefined) {\n            this.dict.set(id, null);\n            this.arr.push({id: id} as T);\n        }\n        else {\n            this.dict.set(id, item);\n            this.arr.push(item);\n        }\n        if (this.arr.length > this.maxCount) {\n            item = this.arr.shift();\n            this.dict.delete(item.id);\n        }\n    }\n    private async loadId(ids:number[]) {\n        let items = await this._loadIds(ids);\n        if (items === undefined) {\n            for (let id of ids) {\n                if (id === null) continue;\n                let item = await this._loadId(id);\n                this.setItem(id, item);\n            }\n        }\n        else {\n            for (let id of ids) {\n                let item = items.find(v => v.id === id);\n                this.setItem(id, item);\n            }\n        }\n    }\n\n    protected abstract async _loadIds(ids:number[]):Promise<T[]>;\n    protected abstract async _loadId(id:number):Promise<T>;\n}\n","import { env } from './env';\n\nexport class LocalData {\n    user = env.localDb.child('user');\n    guest = env.localDb.child('guest');\n    unit = env.localDb.child('unit');\n\n    private _user:string;\n    private _guest:string;\n    private _unit:string;\n    readToMemory() {\n        this._user = this.user.get();\n        this._guest = this.guest.get();\n        this._unit = this.unit.get();\n    }\n    saveToLocalStorage() {\n        this.user.set(this._user);\n        this.guest.set(this._guest);\n        this.unit.set(this._unit);\n    }\n\n    logoutClear() {\n        [\n            this.user,\n            this.unit,\n        ].forEach(d => d.remove());\n    }\n}\n","export function getObjPropIgnoreCase(obj:any, prop:string):any {\n\tif (!obj) return;\n\tif (!prop) return;\n\tlet keys = Object.keys(obj);\n\tprop = prop.toLowerCase();\n\tfor (let key of keys) {\n\t\tif (key.toLowerCase() === prop) return obj[key];\n\t}\n\treturn;\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport {PageHeaderProps, renderPageHeader} from './pageHeader';\nimport { TabsProps, TabsView } from './tabs';\nimport { ScrollProps, ScrollView, PageWebNav, WebNavScrollView } from './scrollView';\n\nexport interface IVPage {\n\tcontent():JSX.Element;\n\theader():JSX.Element;\n\tfooter():JSX.Element;\n}\n\nexport interface PageProps extends ScrollProps {\n    back?: 'close' | 'back' | 'none';\n    header?: boolean | string | JSX.Element;\n    right?: JSX.Element;\n    footer?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n\theaderClassName?: string;\n\tclassName?: string;\n\tafterBack?: () => void;\n\ttabsProps?: TabsProps;\n\twebNav?: PageWebNav;\n}\n\n@observer\nexport class Page extends React.Component<PageProps> {\n\tprivate tabsView: TabsView;\n    constructor(props: PageProps) {\n\t\tsuper(props);\n\t\tlet {tabsProps} = props;\n\t\tif (tabsProps) {\n\t\t\tthis.tabsView = new TabsView(tabsProps);\n\t\t}\n\t}\n\n\tprivate renderHeader() {\n\t\tconst {back, header, right, headerClassName, afterBack, logout} = this.props;\n\t\tif (header === false) return;\n\t\tconst {webNav} = this.props;\n\t\tlet inWebNav = false;\n\t\tlet pageHeaderProps:PageHeaderProps = {\n\t\t\tback,\n\t\t\tcenter: header as any,\n\t\t\tright,\n\t\t\tlogout,\n\t\t\tclassName: headerClassName,\n\t\t\tafterBack,\n\t\t};\n\t\tif (webNav !== undefined) {\n\t\t\tinWebNav = true;\n\t\t\tlet {renderPageHeader: rph} = webNav;\n\t\t\tif (rph) return rph(pageHeaderProps);\n\t\t}\n\t\telse {\n\t\t\tinWebNav = false;\n\t\t}\n\t\treturn renderPageHeader(pageHeaderProps, inWebNav);\n\t\t/*\n\t\tlet pageHeader = header !== false && <PageHeader \n\t\t\tback={back} \n\t\t\tcenter={header as any}\n\t\t\tright={right}\n\t\t\tlogout={this.props.logout}\n\t\t\tclassName={headerClassName}\n\t\t\tafterBack={afterBack}\n\t\t\t/>;\n\t\treturn pageHeader;\n\t\t*/\n\t}\n\n\tprivate renderFooter() {\n\t\tconst {footer, webNav} = this.props;\n\t\tif (!footer) return;\n\t\tlet elFooter = <footer>{footer}</footer>;\n\t\tif (webNav) return elFooter;\n\t\treturn <>\n\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\n\t\t\t{elFooter}\n\t\t</>;\n\t}\n\n    render() {\n\t\tif (this.tabsView) {\n\t\t\treturn React.createElement(this.tabsView.content);\n\t\t}\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className, webNav} = this.props;\n\t\tlet content = <>\n\t\t\t{this.renderHeader()}\n\t\t\t<main>{children}</main>\n\t\t\t{this.renderFooter()}\n\t\t</>;\n\t\tif (webNav) {\n\t\t\treturn <WebNavScrollView\n\t\t\t\tonScroll={onScroll}\n\t\t\t\tonScrollTop={onScrollTop}\n\t\t\t\tonScrollBottom={onScrollBottom}\n\t\t\t\tclassName={className}\n\t\t\t\twebNav={webNav}\n\t\t\t>\n\t\t\t\t{content}\n\t\t\t</WebNavScrollView>;\n\t\t}\n\t\telse {\n\t\t\treturn <ScrollView\n\t\t\t\tonScroll={onScroll}\n\t\t\t\tonScrollTop={onScrollTop}\n\t\t\t\tonScrollBottom={onScrollBottom}\n\t\t\t\tclassName={className}\n\t\t\t>\n\t\t\t\t{content}\n\t\t\t</ScrollView>;\n\t\t}\n\t}\n}\n","import _ from 'lodash';\nimport {nav} from '../components';\nimport {uid} from '../tool/uid';\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\nimport {setSubAppWindow} from './wsChannel';\nimport { host } from './host';\n\nexport interface UqToken {\n    name: string;\n    db: string;\n    url: string;\n    token: string;\n}\nconst uqTokens:{[uqName:string]: UqToken}  = {};\nexport function logoutUqTokens() {\n    for (let i in uqTokens) {\n        uqTokens[i] = undefined;\n    }\n}\n\nexport interface AppInFrame {\n    hash: string;\n    unit: number;       // unit id\n    page?: string;\n    param?: string[];\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\n}\nconst appsInFrame:{[key:string]:AppInFrame} = {};\n\nclass AppInFrameClass implements AppInFrame {\n    hash: string;\n    private _unit: number;\n    get unit(): number {return this._unit;}       // unit id\n    set unit(val:number) { this._unit=val;}\n    page?: string;\n    param?: string[];\n}\n\nexport let appInFrame:AppInFrame = new AppInFrameClass();\n/* {\n    hash: undefined,\n    get unit():number {return } undefined, //debugUnitId,\n    page: undefined;\n    param: undefined,\n}*/\n\nexport function isBridged():boolean {\n    if (process.env.isMiniprogram)\n        return false;\n    return window.self !== window.parent;\n}\n\nwindow.addEventListener('message', async function(evt) {\n    var message = evt.data;\n    switch (message.type) {\n        case 'sub-frame-started':\n            subFrameStarted(evt);\n            break;\n        case 'ws':\n            //wsBridge.receive(message.msg);\n            await nav.onReceive(message.msg);\n            break;\n        case 'init-sub-win':\n            await initSubWin(message);\n            break;\n        case 'pop-app':\n            window.console.log('///\\\\\\\\\\\\ pop-app');\n            nav.navBack();\n            break;\n        case 'center-api':\n            await callCenterApiFromMessage(evt.source as Window, message);\n            break;\n        case 'center-api-return':\n            bridgeCenterApiReturn(message);\n            break;\n        case 'app-api':\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\n            (evt.source as Window).postMessage({\n                type: 'app-api-return', \n                apiName: message.apiName,\n                db: ret.db,\n                url: ret.url,\n                token: ret.token} as any, \"*\");\n            break;\n        case 'app-api-return':\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\n            console.log('await onAppApiReturn(message);');\n            await onAppApiReturn(message);\n            break;\n        default:\n\t\t\tif ((message.source as string) && _.startsWith(message.source, 'react-devtools') === true) break;\n            window.console.log('message: %s', JSON.stringify(message));\n            break;\n    }\n});\n\nfunction subFrameStarted(evt:any) {\n    var message = evt.data;\n    let subWin = evt.source as Window;\n    setSubAppWindow(subWin);\n    hideFrameBack(message.hash);\n    let msg:any = _.clone(nav.user);\n    msg.type = 'init-sub-win';\n    subWin.postMessage(msg, '*');\n}\nfunction hideFrameBack(hash:string) {\n    let el = document.getElementById(hash);\n    if (el !== undefined) el.hidden = true;\n}\nasync function initSubWin(message:any) {\n    console.log('initSubWin: set nav.user', message);\n    let user = nav.user = message; // message.user;\n    setCenterToken(user.id, user.token);\n    await nav.showAppView();\n}\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\n    let appInFrame = appsInFrame[hash];\n    if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\n    //let unit = getUnit();\n    let {unit, predefinedUnit} = appInFrame;\n    unit = unit || predefinedUnit;\n    if (!unit) {\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\n    }\n    let parts = apiName.split('/');\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\n    let ret = await uqTokenApi.uq(param);\n    let {db, url, token} = ret;\n    return {name: apiName, db:db, url: url, token: token};\n}\n\nasync function onAppApiReturn(message:any) {\n    let {apiName, db, url, urlTest, token} = message;\n    let action = uqTokenActions[apiName];\n    if (action === undefined) {\n        throw new Error('error app api return');\n        //return;\n    }\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\n    //action.url = realUrl;\n    //action.token = token;\n    action.resolve({\n        name: apiName,\n        db: db,\n        url: realUrl,\n        token: token,\n    } as UqToken);\n}\n\nexport function setAppInFrame(appHash: string):AppInFrame {\n    if (appHash) {\n        let parts = appHash.split('-');\n        let len = parts.length;\n        if (len > 0) {\n            let p = 1;\n            appInFrame.hash = parts[p++];\n            if (len>0) appInFrame.unit = Number(parts[p++]);\n            if (len>1) appInFrame.page = parts[p++];\n            if (len>2) appInFrame.param = parts.slice(p++);\n        }\n    }\n    return appInFrame;\n}\n\nexport function getExHashPos():number {\n    let hash = window.location.hash;\n    if (hash !== undefined && hash.length > 0) {\n        let pos = hash.lastIndexOf('#tv-');\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\n        return pos;\n    }\n    return -1;\n}\n\nexport function getExHash():string {\n    let pos = getExHashPos();\n    if (pos < 0) return undefined;\n    return window.location.hash.substring(pos);\n}\n\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\n    let u:string;\n    for (;;) {\n        u = uid();\n        let a = appsInFrame[u];\n        if (a === undefined) {\n            appsInFrame[u] = {hash:u, unit:unitId};\n            break;\n        }\n    }\n    url += '#tv-' + u + '-' + unitId;\n    if (page !== undefined) {\n        url += '-' + page;\n        if (param !== undefined) {\n            for (let i=0; i<param.length; i++) {\n                url += '-' + param[i];\n            }\n        }\n    }\n    return {url: url, hash: u};\n}\n\nfunction getUnit():number {\n\tlet {unit, predefinedUnit} = appInFrame;\n    let realUnit = unit || predefinedUnit;\n    if (realUnit === undefined) {\n        throw new Error('no unit defined in unit.json or not logined in');\n\t}\n    return realUnit;\n}\n\ninterface UqTokenAction {\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\n    reject: (reason?: any) => void;\n}\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string, appOwner:string, appName:string):Promise<void> {\n    if (!isBridged()) {\n        let unit = getUnit();\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName, appOwner, appName});\n        if (uqToken.token === undefined) uqToken.token = centerToken;\n        let {db, url, urlTest} = uqToken;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        console.log('realUrl: %s', realUrl);\n        uqToken.url = realUrl;\n        uqTokens[uq] = uqToken;\n        return uqToken;\n    }\n    console.log(\"**** before buildAppUq ****\", appInFrame);\n    let bp = uqTokenActions[uq];\n    if (bp !== undefined) return;\n    return new Promise<void>((resolve, reject) => {\n        uqTokenActions[uq] = {\n            resolve: async (at:any) => {\n                let {db, url, token} = await at;\n                uqTokens[uq] = {\n                    name: uq,\n                    db: db,\n                    url: url,\n                    token: token,\n                };\n                uqTokenActions[uq] = undefined;\n                console.log(\"**** after buildAppUq ****\", appInFrame);\n                resolve();\n            },\n            reject: reject,\n        };\n        (window.opener || window.parent).postMessage({\n            type: 'app-api',\n            apiName: uq,\n            hash: appInFrame.hash,\n        }, \"*\");\n    });\n}\n\nexport function appUq(uq:string):UqToken {\n    let uts = uqTokens;\n    return uts[uq];\n}\n\ninterface BridgeCenterApi {\n    id: string;\n    resolve: (value?:any)=>any;\n    reject: (reason?:any)=>void;\n}\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\n    return await new Promise<any>(async (resolve, reject) => {\n        let callId:string;\n        for (;;) {\n            callId = uid();\n            let bca = brideCenterApis[callId];\n            if (bca === undefined) {\n                brideCenterApis[callId] = {\n                    id: callId,\n                    resolve: resolve,\n                    reject: reject,\n                }\n                break;\n            }\n        }\n        console.log('bridgeCenterApi: url=%s, callId=%s, body=%s', url, callId, body);\n        let o = window.opener || window.parent || window;\n        console.log('bridgeCenterApi: window=%s', o);\n        o?.postMessage({\n            type: 'center-api',\n            callId: callId,\n            url: url,\n            method: method,\n            body: body\n        }, '*');\n    });\n}\n\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\n    let {callId, url, method, body} = message;\n    let result = await callCenterapi.directCall(url, method, body);\n    from.postMessage({\n        type: 'center-api-return',\n        callId: callId,\n        result: result,\n    }, '*');\n}\n\nfunction bridgeCenterApiReturn(message:any) {\n    let {callId, result} = message;\n    let bca = brideCenterApis[callId];\n    if (bca === undefined) return;\n    brideCenterApis[callId] = undefined;\n    bca.resolve(result);\n}\n","import * as React from 'react';\nimport _ from 'lodash';\nimport {nav, Page, resOptions, PageHeaderProps, PageWebNav} from '../components';\nimport { User, env } from '../tool';\nimport { VPage } from './vpage';\nimport { View } from './view';\nimport { messageHub } from '../net';\n\nexport interface ConfirmOptions {\n    caption?: string;\n    message: string | JSX.Element;\n    classNames?: string;\n    ok?: string;\n    yes?: string;\n    no?: string;\n}\n\nexport interface WebNav<C extends Controller> {\n\tVNavHeader?: new (controller: C) => View<C>;\n\tVNavRawHeader?: new (controller: C) => View<C>;\n\tVNavFooter?: new (controller: C) => View<C>;\n\tVNavRawFooter?: new (controller: C) => View<C>;\n\trenderPageHeader?: (props: PageHeaderProps) => JSX.Element;\n}\n\nexport abstract class Controller {\n    readonly res: any;\n\treadonly x: any;\n\tprivate _t: any = {};\n\treadonly t: (str:string)=>any;\n    icon: string|JSX.Element;\n    label:string;\n\treadonly isDev:boolean = env.isDevelopment;\n\treadonly pageWebNav: PageWebNav;\n    get user():User {return nav.user}\n    get isLogined():boolean {\n        let {user} = nav;\n        if (user === undefined) return false;\n        return user.id > 0;\n    }\n    constructor(res:any) {\n        this.res = res || {};\n\t\tthis.x = this.res.x || {};\n\t\tthis.t = (str:string):any => this.internalT(str) || str;\n\t\tthis.pageWebNav = this.getPageWebNav();\n\t}\n\n\tinit(...param: any[]) {}\n\n\tinternalT(str:string):any {\n\t\treturn this._t[str];\n\t}\n\n\tget webNav(): WebNav<any> {return undefined;}\n\n\tgetWebNav(): WebNav<any> {return this.webNav;}\n\n\tprivate getPageWebNav(): PageWebNav {\n\t\tlet webNav =  this.getWebNav();\n\t\tif (webNav === undefined) return;\n\t\tlet {VNavHeader, VNavRawHeader, VNavFooter, VNavRawFooter, renderPageHeader} = webNav;\n\t\tlet navHeader:JSX.Element;\n\t\tif (VNavHeader) navHeader = this.renderView(VNavHeader);\n\t\tlet navRawHeader:JSX.Element;\n\t\tif (VNavRawHeader) navRawHeader = this.renderView(VNavRawHeader);\n\t\tlet navFooter:JSX.Element; \n\t\tif (VNavFooter) navFooter = this.renderView(VNavFooter);\n\t\tlet navRawFooter:JSX.Element;\n\t\tif (VNavRawFooter) navRawFooter = this.renderView(VNavRawFooter);\n\t\tlet ret:PageWebNav = {\n\t\t\tnavHeader,\n\t\t\tnavRawHeader,\n\t\t\tnavFooter,\n\t\t\tnavRawFooter,\n\t\t\trenderPageHeader,\n\t\t};\n\t\treturn ret;\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tif (res === undefined) return;\n\t\tlet {$lang, $district} = resOptions;\n\t\t_.merge(this._t, res);\n\t\tif ($lang !== undefined) {\n\t\t\tlet l = res[$lang];\n\t\t\tif (l !== undefined) {\n\t\t\t\t_.merge(this._t, l);\n\t\t\t\tlet d = l[$district];\n\t\t\t\tif (d !== undefined) {\n\t\t\t\t\t_.merge(this._t, d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t}\n\n    private receiveHandlerId:number;\n    //private disposer:()=>void;\n\n    protected dispose = () => {\n        // message listener的清理\n\t\t//nav.unregisterReceiveHandler(this.receiveHandlerId);\n\t\tmessageHub.unregisterReceiveHandler(this.receiveHandlerId);\n        this.onDispose();\n    }\n\n    protected onDispose() {\n\t}\n\t\n\tget isRouting() {return nav.isRouting;}\n\n\tisMe(id:any):boolean {\n\t\tif (id === null) return false;\n\t\tlet {user} = this;\n\t\tlet userId = user.id;\n\t\tswitch (typeof id) {\n\t\t\tdefault: return false;\n\t\t\tcase 'string': return Number(id) === userId;\n\t\t\tcase 'number': return id === userId;\n\t\t\tcase 'object': return id.id === userId;\n\t\t}\n\t}\n\n    protected async openVPage<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:(ret:any)=>void):Promise<void> {\n        await (new vp((this as any) as C)).open(param, afterBack);\n    }\n\n    protected async replaceVPage<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:(ret:any)=>void):Promise<void> {\n        await (new vp((this as any) as C)).replaceOpen(param, afterBack);\n    }\n\n    protected renderView<C extends Controller>(view: new (controller: C)=>View<C>, param?:any) {\n        return (new view((this as any) as C)).render(param);\n    }\n\n    async event(type:string, value:any) {\n        await this.onEvent(type, value);\n    }\n\n    protected async onEvent(type:string, value:any) {\n    }\n\n    protected msg(text:string) {\n        alert(text);\n    }\n    protected errorPage(header:string, err:any) {\n        this.openPage(<Page header=\"App error!\">\n            <pre>\n                {typeof err === 'string'? err : err.message}\n            </pre>\n        </Page>);\n    }\n\n    protected onMessage(message:any):Promise<void> {\n        return;\n    }\n\n    private onMessageReceive = async (message:any):Promise<void> => {\n        await this.onMessage(message);\n    }\n\n    protected async beforeStart():Promise<boolean> {\n        /*\n        console.log('this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);');\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n        console.log('return true');\n        */\n        return true;\n\t}\n\tprotected async afterStart():Promise<void> {\n\t}\n    protected registerReceiveHandler() {\n        this.receiveHandlerId = messageHub.registerReceiveHandler(this.onMessageReceive);\n    }\n\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\n    async start(param?:any, ...params:any[]):Promise<void> {\n        //this.disposer = this.dispose;\n\t\tthis.registerReceiveHandler();\n        let ret = await this.beforeStart();\n        if (ret === false) return;\n\t\tawait this.internalStart(param, ...params);\n\t\tawait this.afterStart();\n    }\n\n    get isCalling():boolean {return this._resolve_$ !== undefined}\n\n    private _resolve_$:((value:any) => void)[];\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<T> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await this.start(param, ...params);\n        });\n    }\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<any> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await (new vp(this as any)).open(param);\n        });\n    }\n\n    returnCall(value:any) {\n        if (this._resolve_$ === undefined) return;\n        let resolve = this._resolve_$.pop();\n        if (resolve === undefined) {\n            alert('the Controller call already returned, or not called');\n            return;\n        }\n        resolve(value);\n    }\n\n    openPage(page:JSX.Element, onClosePage?: (ret:any)=>void) {\n\t\tlet disposer: ()=>void;\n\t\tif (onClosePage !== undefined) {\n\t\t\tdisposer = () => {\n\t\t\t\t//if (this.disposer) this.disposer();\n\t\t\t\tonClosePage(undefined);\n\t\t\t}\n\t\t}\n\n        nav.push(page, disposer);\n        //this.disposer = undefined;\n    }\n\n    replacePage(page:JSX.Element, onClosePage?: ()=>void) {\n        nav.replace(page, onClosePage);\n        //this.disposer = undefined;\n    }\n\n    backPage() {\n        nav.back();\n    }\n\n    closePage(level?:number) {\n        nav.pop(level);\n    }\n\n    ceasePage(level?:number) {\n        nav.ceaseTop(level);\n\t}\n\t\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tnav.go(showPage, url, absolute);\n\t}\n\n    removeCeased() {\n        nav.removeCeased();\n    }\n\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        nav.regConfirmClose(confirmClose);\n\t}\n\n\tprivate topPageKey:any;\n\tprotected startAction() {\n\t\tthis.topPageKey = nav.topKey();\n    }\n    get TopKey() {\n        return this.topPageKey;\n    }\n    SetTopKey(key:any) {\n        this.topPageKey = key;\n    }\n\tpublic popToTopPage() {\n\t\tnav.popTo(this.topPageKey);\n\t}\n\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\n            let {caption, message, ok, yes, no, classNames} = options;\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\n                this.closePage();\n                resolve(res);\n            }\n            let buttons:any[] = [];\n            if (ok !== undefined) {\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\n            }\n            if (yes !== undefined) {\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\n            }\n            if (no !== undefined) {\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\n            }\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\n                    <div className=\"d-flex align-items-center justify-content-center\">\n                        {message}\n                    </div>\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\n                        {buttons}\n                    </div>\n                </div>\n            </Page>);\n            nav.regConfirmClose(async ():Promise<boolean> => {\n                resolve(undefined);\n                return true;\n            });\n        });\n    }\n}\n","import * as React from 'react';\nimport { Page, Image, UserView } from '../components';\nimport { env, User } from '../tool';\nimport { Controller } from './controller';\nimport { VPage } from './vpage';\n\nexport abstract class View<C extends Controller> {\n    protected controller: C;\n    protected readonly res: any;\n\tprotected readonly x: any;\n\tprotected readonly t: (str:string)=>any;\n\n    constructor(controller: C) {\n        this.controller = controller;\n        this.res = controller.res;\n\t\tthis.x = controller.x;\n\t\tthis.t = controller.t;\n    }\n\n\tprotected get isDev() {return  env.isDevelopment}\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\n    abstract render(param?:any): JSX.Element;\n\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\n        return (new vm(this.controller)).render(param);\n    }\n\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\n        await (new vp(this.controller)).open(param, afterBack);\n    }\n\n    protected async event(type:string, value?:any) {\n        await this.controller.event(type, value);\n\t}\n\t\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tthis.controller.go(showPage, url, absolute);\n\t}\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        return await this.controller.vCall(vp, param);\n    }\n\n    protected returnCall(value:any) {\n        this.controller.returnCall(value);\n    }\n\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderUserText(user:any) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <>{nick || name}</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\n\t\tlet {user} = this.controller;\n\t\tif (!user) return;\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\n\t}\n\n    protected openPage(view: React.StatelessComponent<any>, param?:any, onClosePage?:(ret:any)=>void) {\n        let type = typeof param;\n        if (type === 'object' || type === 'undefined') {\n            this.controller.openPage(React.createElement(view, param), onClosePage);\n        }\n        else {\n            this.controller.openPage(<Page header=\"param type error\">\n                View.openPage param must be object, but here is {type}\n            </Page>, onClosePage);\n        }\n    }\n\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\n        this.controller.replacePage(React.createElement(view, param));\n    }\n\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\n        this.controller.openPage(page, onClosePage);\n    }\n\n    protected replacePageElement(page: JSX.Element, onClosePage?: ()=>void) {\n        this.controller.replacePage(page, onClosePage);\n    }\n\n    protected backPage() {\n        this.controller.backPage();\n    }\n\n    protected closePage(level?:number) {\n        this.controller.closePage(level);\n    }\n\n    protected ceasePage(level?:number) {\n        this.controller.ceasePage(level);\n    }\n\n    protected removeCeased() {\n        this.controller.removeCeased();\n    }\n\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.controller.regConfirmClose(confirmClose);\n\t}\n\n\tprotected popToTopPage() {\n\t\tthis.controller.popToTopPage();\n\t}\n}\n","import * as React from 'react';\nimport { Page, Scroller, TabsProps } from \"../components\";\nimport { View } from \"./view\";\nimport { Controller } from \"./controller\";\n\nexport abstract class VPage<C extends Controller> extends View<C> {\n\tprotected retOnClosePage: any;\n\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\n\t\tthis.init(param);\n\t\tlet _onClosePage: ()=>void;\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\n\t\treturn;\n\t}\n\n    replaceOpen(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\n\t\tthis.init(param);\n\t\tlet _onClosePage: ()=>void;\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\n\t\tthis.replacePageElement(this.renderPage(), _onClosePage);\n\t\treturn;\n\t}\n\n\trender(param?:any):JSX.Element {\n\t\tthis.init(param);\n\t\treturn this.renderPage();\n\t}\n\n\tinit(param?:any):void {return;}\n\n\theader():string|boolean|JSX.Element {return null;}\n\tright():JSX.Element {return null;}\n\tcontent():JSX.Element {return null;}\n\tfooter():JSX.Element {return null;}\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\n\tprotected renderPage():JSX.Element {\n\t\tlet header = this.header();\n\t\tif (!header) header = false;\n\t\treturn <Page\n\t\t\theader={header} right={this.right()} footer={this.footer()}\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\n\t\t\tback={this.back}\n\t\t\theaderClassName={this.headerClassName}\n\t\t\tclassName={this.className}\n\t\t\tafterBack={()=>this.afterBack()}\n\t\t\ttabsProps={this.tabsProps}\n\t\t\tlogout={this.logout()}\n\t\t\twebNav={this.controller.pageWebNav}\n\t\t>\n\t\t\t{this.content()}\n\t\t</Page>;\n\t}\n\n\tprotected onPageScroll(e:any) {}\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\n\tprotected afterBack():void {}\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\n\tprotected get headerClassName(): string {return null;}\n\tprotected get className(): string {return null;}\n\tprotected get tabsProps(): TabsProps {return null;}\n}\n","import React from 'react';\nimport _ from 'lodash';\nimport { FA, Page } from '../../components';\nimport { Controller } from \"../controller\";\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport interface CStringEditProps {\n\tlabel?: string;\n\tplaceholder?: string;\n\tmaxLength?: number;\n\tonValueChange?: (value: string) => Promise<void>;\n}\n\nexport class CStringEdit extends Controller {\n\tprivate props: CStringEditProps = {\n\t\tlabel: '编辑'\n\t}\n\t@observable value: string;\n\t@observable private newValue: string;\n\t@observable private isChanged: boolean;\n\t@observable private error: string;\n\n\tprotected async internalStart() {}\n\trender(value:string, props?:CStringEditProps) {\n\t\tthis.value = value;\n\t\tif (props) _.merge(this.props, props);\n\t\treturn React.createElement(observer(()=><>{this.renderValue()}{this.renderPencil()}</>))\n\t}\n\n\tprotected renderValue() {return <>{this.value}</>}\n\tprotected renderPencil() {\n\t\treturn <span onClick={this.onEdit} className=\"cursor-pointer\">\n\t\t\t&nbsp; <FA className=\"text-info\" name=\"pencil-square-o\" /> &nbsp;\n\t\t</span>;\n\t}\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.verifyValue();\n\t}\n\t\n\tprotected verifyValue() {}\n\n    private onFocus = () => {\n        this.error = undefined;\n\t}\n\t\n\tprivate onEdit = () => {\n\t\tlet {label, maxLength, placeholder, onValueChange} = this.props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tthis.value = this.newValue;\n\t\t\t\tthis.closePage();\n\t\t\t\tif (onValueChange) onValueChange(this.value);\n\t\t\t}\n\t\t}\n        let right = React.createElement(observer(() => <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>));\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (evt.keyCode === 13) onSave();\n\t\t}\n\t\tthis.openPage(<Page header={label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<input type=\"text\"\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n\t\t\t\t\tclassName=\"form-control\"\n\t\t\t\t\tdefaultValue={this.value}\n\t\t\t\t\tmaxLength={maxLength} />\n                {\n\t\t\t\t\tReact.createElement(observer(()=> placeholder && <div className=\"small muted m-2\">{placeholder}</div>))                    \n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n\t\t</Page>);\n\t}\n}\n","import * as React from 'react';\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\nimport { nav } from '../nav';\nimport { observable } from 'mobx';\nimport { FieldRule } from '../form/rules';\nimport { Image } from '../image';\nimport { Edit } from './edit';\n\nexport abstract class ItemEdit {\n\tprotected edit: Edit;\n\tprotected name: string;\n\tprotected _itemSchema: ItemSchema;\n    get itemSchema(): ItemSchema {return this._itemSchema}\n    protected _uiItem:UiItem;\n    get uiItem():UiItem {return this._uiItem}\n    value: any;\n\tlabel: string;\n\tget editInRow(): boolean {return false;}\n\n    @observable protected error: string;\n    @observable protected isChanged: boolean = false;\n    protected newValue: any;\n\n    constructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) {\n\t\tthis.edit = edit;\n        this._itemSchema = itemSchema;\n        this._uiItem = uiItem\n        this.value = value;\n        let {name} = itemSchema;\n        this.name = name;\n        this.label = label;\n\t}\n\t\n\tinit() {\t\t\n\t}\n\n    async start():Promise<any> {\n        return await this.internalStart();\n    }\n\n    protected abstract internalStart():Promise<any>;\n\n    async end():Promise<any> {\n        await this.internalEnd()\n    }\n\n\trenderContent() {\n        let {name, type} = this._itemSchema;\n        let divValue:any;\n        let uiItem = this._uiItem;\n        let label:string, labelHide:boolean;\n        if (uiItem === undefined) {\n            label = name;\n        }\n        else {\n\t\t\tlabel = uiItem.label;\n\t\t\tlabelHide = uiItem.labelHide;\n            let templet = uiItem.Templet;\n            if (templet !== undefined) {\n                if (typeof templet === 'function') {\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\n\t\t\t\t}\n                else {\n\t\t\t\t\tdivValue = {templet};\n\t\t\t\t}\n            }\n            else if (this.value !== undefined) {\n                switch (uiItem.widget) {\n                    case 'radio':\n                    case 'select':\n                        let {list} = uiItem as UiSelectBase;\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\n                        break;\n                    case 'id':\n                        divValue = <b>no templet for {name}={this.value}</b>\n                        break;\n                }\n            }\n        }\n        if (divValue === undefined) {\n            switch (type) {\n                default:\n                    divValue = this.value? \n\t\t\t\t\t\t<b>{this.value}</b> \n\t\t\t\t\t\t:\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\n                    break;\n                case 'image':\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\n                    break;\n            }\n\t\t}\n\t\treturn divValue;\n\t}\n\n    protected async internalEnd():Promise<void> {nav.pop()}\n\n    protected verifyValue() {\n        if (this.uiItem === undefined) return;\n        let {rules} = this.uiItem;\n        if (rules === undefined) return;\n        let nv = this.newValue;\n        function verifyRule(rule:FieldRule, value: any):string {\n            let error = rule(nv);\n            if (error !== undefined) {\n                if (typeof error !== 'object')\n                    return error;\n                else\n                    return JSON.stringify(error);\n            }\n        }\n        if (Array.isArray(rules)) {\n            for (let rule of rules) {\n                let error = verifyRule(rule as FieldRule, nv);\n                if (error !== undefined) {\n                    this.error = error;\n                    break;\n                }\n            }\n        }\n        else {\n            this.error = verifyRule(rules as FieldRule, nv);\n        }\n    }\n}\n","//import _ from 'lodash';\nimport { Caller } from '../net';\nimport { Entity } from './entity';\nimport { Action } from './action';\nimport { Query } from './query';\n\ninterface UqResponseSchema {\n    uq: any;\n    entity: any;\n}\n\nexport abstract class EntityCaller<T> extends Caller<T> {\n    private tries: number;\n    protected _entity: Entity;\n\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\n        super(params, waiting);\n        this.tries = 0;\n        this._entity = entity;\n    }\n\n    protected get entity(): Entity {return this._entity;}\n\n    //大多的entityCaller都不需要这个\n    //buildParams() {return this.entity.buildParams(this.params);}\n    \n    async request(): Promise<any> {\n        await this.entity.loadSchema();\n        let ret = await this.innerRequest();\n        return ret;\n    }\n\n    protected async innerCall(): Promise<any> {\n        return await this.entity.uqApi.xcall(this);\n    }\n\n    async innerRequest(): Promise<any> {\n        let jsonResult = await this.innerCall();\n        let {$uq, $modify, res} = jsonResult;\n        this.entity.uq.pullModify($modify);\n        if ($uq === undefined) {\n            //if (res === undefined) debugger;\n            let ret = this.xresult(res);\n            //if (ret === undefined) debugger;\n            return ret;\n        }\n        return await this.retry($uq);\n    }\n\n    xresult(res:any):any {return res}\n\n    get headers(): {[header:string]: string} {\n        let {ver, uq} = this.entity;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }\n\n    private async retry(schema: UqResponseSchema) {\n        ++this.tries;\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\n        this.rebuildSchema(schema);\n        return await this.innerRequest();\n    }\n\n    private rebuildSchema(schema: UqResponseSchema) {\n        let {uq, entity} = schema;\n        if (uq !== undefined) {\n\t\t\tthis.entity.uq.buildEntities(uq);\n\t\t}\n        if (entity !== undefined) {\n\t\t\tthis.entity.setSchema(entity);\n\t\t}\n    }\n}\n\nexport abstract class ActionCaller extends EntityCaller<any> {\n    protected get entity(): Action {return this._entity as Action;}\n}\n\nexport class QueryQueryCaller extends EntityCaller<any> {\n    protected get entity(): Query {return this._entity as Query};\n    get path():string {return `query/${this.entity.name}`;}\n    xresult(res:any) {\n        let data = this.entity.unpackReturns(res);\n        return data;\n    }\n    buildParams() {return this.entity.buildParams(this.params);}\n}\n\nexport class QueryPageCaller extends EntityCaller<any> {\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\n\tprotected get entity(): Query {return this._entity as Query};\n\t//results: {[name:string]:any[]};\n\tget path():string {return `query-page/${this.entity.name}`;}\t\n    buildParams() {\n        let {pageStart, pageSize, params} = this.params;\n        let p:any;\n        if (params === undefined) {\n            p = {key: ''};\n        }\n        else {\n            p = this.entity.buildParams(params);\n        }\n        /*\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        */\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return p;\n    };\n    xresult(res:any): {[name:string]:any[]} {\n        let ret = this.entity.unpackReturns(res);\n\t\t//return this.results.$page;// as any[];\n\t\treturn ret;\n    }\n}\n","import { UqApi } from '../net';\nimport { LocalCache } from '../tool';\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\nimport { Tuid } from './tuid';\nimport { getObjPropIgnoreCase } from '../tool';\n\nconst tab = '\\t';\nconst ln = '\\n';\nconst chars = '\\\\ntbfvr';\nconst codeBackSlash = chars.charCodeAt(0);\nconst codeN = chars.charCodeAt(1);\nconst codeT = chars.charCodeAt(2);\nconst codeB = chars.charCodeAt(3);\nconst codeF = chars.charCodeAt(4);\nconst codeV = chars.charCodeAt(5);\nconst codeR = chars.charCodeAt(6);\n\nconst codes = '\\n\\t\\b\\f\\v\\r';\nconst codeBN = codes.charCodeAt(0);\nconst codeBT = codes.charCodeAt(1);\nconst codeBB = codes.charCodeAt(2);\nconst codeBF = codes.charCodeAt(3);\nconst codeBV = codes.charCodeAt(4);\nconst codeBR = codes.charCodeAt(5);\n\nexport abstract class Entity {\n    private jName: string;\n    schema: any;\n    ver: number = 0;\n    sys?: boolean;\n    readonly uq: UqMan;\n    readonly name: string;\n    readonly typeId: number;\n    readonly cache: LocalCache;\n    readonly uqApi: UqApi;\n    abstract get typeName(): string;\n    get sName():string {return this.jName || this.name}\n    fields: Field[];\n    arrFields: ArrFields[];\n    returns: ArrFields[];\n\n    constructor(uq:UqMan, name:string, typeId:number) {\n        this.uq = uq;\n        this.name = name;\n        this.typeId = typeId;\n        this.sys = this.name.indexOf('$') >= 0;\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\n        this.uqApi = this.uq.uqApi;\n    }\n\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\n\n    //getApiFrom() {return this.entities.uqApi;}\n\n    private fieldMaps: {[arr:string]: FieldMap} = {};\n    fieldMap(arr?:string): FieldMap {\n        if (arr === undefined) arr = '$';\n        let ret = this.fieldMaps[arr];\n        if (ret === undefined) {\n            let fields:Field[];\n            if (arr === '$') fields = this.fields;\n            else if (this.arrFields !== undefined) {\n                let arrFields = this.arrFields.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            else if (this.returns !== undefined) {\n                let arrFields = this.returns.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            if (fields === undefined) return {};\n            ret = {};\n            for (let f of fields) ret[f.name] = f;\n            this.fieldMaps[arr] = ret;\n        }\n        return ret;\n    }\n\n    public async loadSchema():Promise<void> {\n        if (this.schema !== undefined) return;\n        let schema = this.cache.get();\n        if (!schema) {\n            schema = await this.uq.loadEntitySchema(this.name);\n        }\n        this.setSchema(schema);\n\t\tthis.buildFieldsTuid();\n\t\tawait this.loadValues();\n\t}\n\t\n\tprotected async loadValues():Promise<any> {}\n\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\n    public clearSchema() {\n        this.schema = undefined;\n    }\n\n    public setSchema(schema:any) {\n        if (schema === undefined) return;\n        let {name, version} = schema;\n        this.ver = version || 0;\n\t\tthis.setJName(name);\n        this.cache.set(schema);\n\t\tthis.schema = schema;\n\t\tthis.buildFieldsTuid();\n\t}\n\t\n\tprotected setJName(name:string) {\n        if (name !== this.name) this.jName = name;\n\t}\n\n    public buildFieldsTuid() {\n        let {fields, arrs, returns} = this.schema;\n        this.uq.buildFieldTuid(this.fields = fields);\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\n    }\n\n    schemaStringify():string {\n        return JSON.stringify(this.schema, (key:string, value:any) => {\n            if (key === '_tuid') return undefined;\n            return value;\n        }, 4);\n    }\n\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\n        if (this.schema === undefined) return;\n        let {fields, arrs} = this.schema;\n        let entities = this.uq;\n        function getTuid(fn:string, fieldArr:Field[]) {\n            if (fieldArr === undefined) return;\n            let f = fieldArr.find(v => v.name === fn);\n            if (f === undefined) return;\n            return entities.getTuid(f.tuid);\n        }\n        let fn = fieldName.toLowerCase();\n        if (arrName === undefined) return getTuid(fn, fields);\n        if (arrs === undefined) return;\n        let an = arrName.toLowerCase();\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\n        if (arr === undefined) return;\n        return getTuid(fn, arr.fields);\n    }\n\n    buildParams(params:any):any {\n        let result:any = {};\n        let fields = this.fields;\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\n        let arrs = this.arrFields;\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let {name, fields} = arr;\n                let paramsArr:any[] = params[name];\n                if (paramsArr === undefined) continue;\n                let arrResult:any[] = [];\n                result[name] = arrResult;\n                for (let pa of params) {\n                    let rowResult = {};\n                    this.buildFieldsParams(rowResult, fields, pa);\n                    arrResult.push(rowResult);\n                }\n            }\n        }\n        return result;\n    }\n\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\n        for (let field of fields) {\n            let {name, type} = field;            \n            let d = params[name];\n            let val:any;\n            switch (type) {\n\t\t\t\tcase 'datetime':\n                \tval = this.buildDateTimeParam(d);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'date':\n\t\t\t\t\tif (d instanceof Date) {\n\t\t\t\t\t\tval = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tval = d;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tswitch (typeof d) {\n\t\t\t\t\t\tdefault: val = d; break;\n\t\t\t\t\t\tcase 'object':\n\t\t\t\t\t\t\tif (d instanceof Date) {\n\t\t\t\t\t\t\t\tval = d;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlet tuid = field._tuid;\n\t\t\t\t\t\t\tif (tuid === undefined) val = d.id;\n\t\t\t\t\t\t\telse val = tuid.getIdFromObj(d);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n            }\n            result[name] = val;\n        }\n    }\n\n    buildDateTimeParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'object': dt = (val as Date); break;\n            case 'string':\n            case 'number': dt = new Date(val); break;\n        }\n        return Math.floor(dt.getTime()/1000);\n    }\n\n    buildDateParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'string': return val;\n            case 'object': dt = (val as Date); break;\n            case 'number': dt = new Date(val); break;\n        }\n        let ret = dt.toISOString();\n        let p = ret.indexOf('T');\n        return p>0? ret.substr(0, p) : ret;\n    }\n\n    pack(data:any):string {\n        let ret:string[] = [];\n        let fields = this.fields;\n        if (fields !== undefined) this.packRow(ret, fields, data);\n        let arrs = this.arrFields; \n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n\t\t\t\tlet {name, fields} = arr;\n\t\t\t\tlet arrData = getObjPropIgnoreCase(data, name);\n\t\t\t\t//if (!arrData) arrData = data[name.toLowerCase()];\n                this.packArr(ret, fields, arrData);\n            }\n        }\n        return ret.join('');\n    }\n\n    private escape(row:any, field:Field):any {\n        let d = row[field.name];\n        switch (field.type) {\n            case 'datetime':\n                return this.buildDateTimeParam(d);\n            default:\n                switch (typeof d) {\n                    default: return d;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) return d.id;\n                        return tuid.getIdFromObj(d);\n                    case 'string':\n                        let len = d.length;\n                        let r = '', p = 0;\n                        for (let i=0;i<len;i++) {\n                            let c:number = d.charCodeAt(i), ch:string;\n                            switch(c) {\n\t\t\t\t\t\t\t\tdefault: continue;\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\n                                case codeBT: ch = '\\\\t'; break;\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\n\t\t\t\t\t\t\tp = i+1;\n                        }\n                        return r + d.substring(p);\n                    case 'undefined': return '';\n                }\n        }\n    }\n\n    private packRow(result:string[], fields:Field[], data:any) {\n        let len = fields.length;\n        if (len === 0) return;\n        let ret = '';\n        ret += this.escape(data, fields[0]);\n        for (let i=1;i<len;i++) {\n            let f = fields[i];\n            ret += tab + this.escape(data, f);\n        }\n        result.push(ret + ln);\n    }\n\n    private packArr(result:string[], fields:Field[], data:any[]) {\n        if (data !== undefined) {\n\t\t\tif (data.length === 0) {\n\t\t\t\tresult.push(ln);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (let row of data) {\n\t\t\t\t\tthis.packRow(result, fields, row);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tresult.push(ln);\n\t\t}\n        result.push(ln);\n    }\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\n        for (let f of fields as Field[]) {\n            let {name, _tuid} = f;\n            if (_tuid === undefined) continue;\n            let id = values[name];\n            //_tuid.useId(id);\n            values[name] = _tuid.boxId(id);\n        }\n    }\n\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\n        if (fields === undefined) return values as any[];\n        //if (this.fields === undefined) return values as any[];\n        let ret:any[] = []\n        for (let ln of values) {\n            if (!ln) continue;\n            let len = ln.length;\n            let p = 0;\n            while (p<len) {\n                let ch = ln.charCodeAt(p);\n                if (ch === 10) {\n                    ++p;\n                    break;\n                }\n                let row = {};\n                p = this.unpackRow(row, fields, ln, p);\n                ret.push(row);\n            }\n        }\n        return ret;\n    }\n\n    unpackSheet(data:string):any {\n        let ret = {} as any; //new this.newMain();\n        //if (schema === undefined || data === undefined) return;\n        let fields = this.fields;\n        let p = 0;\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\n        let arrs = this.arrFields; //schema['arrs'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    unpackReturns(data:string):{[name:string]:any[]} {\n        if (data === undefined) debugger;\n        let ret = {} as any;\n        //if (schema === undefined || data === undefined) return;\n        //let fields = schema.fields;\n        let p = 0;\n        //if (fields !== undefined) p = unpackRow(ret, schema.fields, data, p);\n        let arrs = this.returns; //schema['returns'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                //let creater = this.newRet[arr.name];\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\n        for (;p<len;p++) {\n            ch0 = ch;\n            ch = data.charCodeAt(p);\n            if (ch === 9) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                c = p+1;\n                ++i;\n                if (i>=fLen) {\n                    p = data.indexOf('\\n', c);\n                    if (p >= 0) ++p;\n                    else p = len;\n                    return p;\n                }\n            }\n            else if (ch === 10) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                ++p;\n                ++i;\n                return p;\n            }\n        }\n        let f = fields[i];\n        let {name} = f;\n        if (ch0 !== 8) {\n            let v = data.substring(c);\n            ret[name] = this.to(ret, v, f);\n        }\n        return len;\n    }\n\n    private to(ret:any, v:string, f:Field):any {\n        switch (f.type) {\n\t\t\tdefault: return v;\n\t\t\tcase 'text':\n\t\t\tcase 'char':\n\t\t\t\treturn this.reverseNT(v);\n            case 'datetime':\n            case 'time':\n\t\t\tcase 'timestamp':\n                let n = Number(v);\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\n                return date;\n            case 'date':\n                let parts = v.split('-');\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\n            case 'tinyint':\n            case 'smallint':\n            case 'int':\n            case 'bigint':\n            case 'dec':\n                return Number(v);\n            case 'id':\n                let id = Number(v);\n                let {_tuid} = f;\n                if (_tuid === undefined) return id;\n                return _tuid.boxId(id);\n        }\n\t}\n\t\n\tprivate reverseNT(text:string):string {\n\t\tif (text === undefined) return;\n\t\tif (text === null) return;\n\t\tlet len = text.length;\n\t\tlet r = '';\n\t\tlet p = 0;\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet c = text.charCodeAt(i);\n\t\t\tif (c === codeBackSlash) {\n\t\t\t\tif (i===len-1) break;\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\n\t\t\t\tlet ch:string;\n\t\t\t\tswitch (c1) {\n\t\t\t\t\tdefault: continue;\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\n\t\t\t\t}\n\t\t\t\tr += text.substring(p, i) + ch;\n\t\t\t\tp = i+2;\n\t\t\t\t++i;\n\t\t\t}\n\t\t}\n\t\tr += text.substring(p, len);\n\t\treturn r;\n\t}\n\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\n\t\tlet p0 = p;\n        let vals:any[] = [], len = data.length;\n        let {name, fields} = arr;\n        while (p<len) {\n            let ch = data.charCodeAt(p);\n            if (ch === 10) {\n\t\t\t\tif (p === p0) {\n\t\t\t\t\tch = data.charCodeAt(p);\n\t\t\t\t\tif (ch !== 10) {\n\t\t\t\t\t\tthrow new Error('upackArr: arr第一个字符是10，则必须紧跟一个10，表示整个arr的结束')\n\t\t\t\t\t}\n\t\t\t\t\t++p;\n\t\t\t\t}\n                ++p;\n                break;\n            }\n            let val = {} as any; //new creater();\n            vals.push(val);\n            p = this.unpackRow(val, fields, data, p);\n        }\n        ret[name] = vals;\n        return p;\n    }\n}\n","import { bridgeCenterApi, isBridged } from './appBridge';\nimport { FetchError } from './fetchError';\nimport { HttpChannelUI } from './httpChannelUI';\nimport { nav } from '../components/nav';\nimport { Caller } from './caller';\nimport { env } from '../tool';\nimport wxfetch from 'wxapp-fetch';\n\n/*\nexport async function httpGet(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.get('', params);\n    return ret;\n}\n\nexport async function httpPost(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.post('', params);\n    return ret;\n}\n*/\n\nconst methodsWithBody = ['POST', 'PUT'];\n\nexport abstract class HttpChannel {\n    private timeout: number;\n    protected ui?: HttpChannelUI;\n    protected hostUrl: string;\n    protected apiToken: string;\n\n    constructor(hostUrl: string, apiToken: string, ui?: HttpChannelUI) {\n        this.hostUrl = hostUrl;\n        this.apiToken = apiToken;\n        this.ui = ui;\n        this.timeout = env.isDevelopment === true ? 500000 : 50000;\n    }\n\n    private startWait = (waiting: boolean) => {\n        if (waiting === true) {\n            if (this.ui !== undefined) this.ui.startWait();\n        }\n    }\n\n    private endWait = (url?: string, reject?: (reason?: any) => void) => {\n        if (this.ui !== undefined) this.ui.endWait();\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\n    }\n\n    private showError = async (error: FetchError) => {\n        if (this.ui !== undefined) await this.ui.showError(error);\n    }\n\n    used() {\n        this.post('', {});\n    }\n\n    async xcall(urlPrefix: string, caller: Caller<any>): Promise<void> {\n        let options = this.buildOptions();\n        let { headers, path, method } = caller;\n        if (headers !== undefined) {\n            let h = options.headers;\n            for (let i in headers) {\n                //h.append(i, encodeURI(headers[i]));\n                h[i] = encodeURI(headers[i]);\n            }\n        }\n        options.method = method;\n        let p = caller.buildParams();\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\n            options.body = JSON.stringify(p)\n        }\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\n    }\n\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\n        let ret = await this.innerFetch(url, options, waiting);\n        return ret.res;\n    }\n\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\n        if (params) {\n            let keys = Object.keys(params);\n            if (keys.length > 0) {\n                let c = '?';\n                for (let k of keys) {\n                    let v = params[k];\n                    if (v === undefined) continue;\n                    url += c + k + '=' + params[k];\n                    c = '&';\n                }\n            }\n        }\n        let options = this.buildOptions();\n        options.method = 'GET';\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'POST';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'PUT';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'DELETE';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n    async fetch(url: string, options: any, waiting: boolean, resolve: (value?: any) => any, reject: (reason?: any) => void): Promise<void> {\n        let that = this;\n        this.startWait(waiting);\n        let path = url;\n        function buildError(err: any, ex?: string) {\n            switch (typeof err) {\n                case 'string':\n                    if (ex !== undefined) err += ' ' + ex;\n                    break;\n                case 'object':\n                    let keys = Object.keys(err);\n                    let retErr: any = {\n                        ex: ex,\n                    };\n                    for (let key of keys) {\n                        retErr[key] = err[key];\n                    }\n                    err = retErr;\n                    break;\n            }\n            return {\n                channel: that,\n                url: path,\n                options: options,\n                resolve: resolve,\n                reject: reject,\n                error: err,\n            }\n        }\n        try {\n            console.log('%s-%s %s : %s', options.method, path, options.body || '', options.params);\n            let now = Date.now();\n            let timeOutHandler = env.setTimeout(\n                undefined, //'httpChannel.fetch',\n                () => {\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\n                },\n                this.timeout);\n            let res;\n            let url = encodeURI(path);\n            if (process.env.isMiniprogram) {\n                res = await wxfetch(url, options) as Response;\n                console.log(res);\n            }\n            else {\n                res = await fetch(url, options);\n            }\n            if (res.ok === false) {\n                env.clearTimeout(timeOutHandler);\n                console.log('ok false endWait');\n                that.endWait();\n                console.log('call error %s', res.statusText);\n                throw res.statusText;\n            }\n            let jres:boolean = false;\n            if (process.env.isMiniprogram) {\n                jres = true;\n            }\n            else {\n                let ct = res.headers.get('content-type');\n                if (ct && ct.indexOf('json') >= 0) {\n                    jres = true;\n                }\n            }\n            if (jres) {\n                return res.json().then(async retJson => {\n                    env.clearTimeout(timeOutHandler);\n                    that.endWait();\n                    if (retJson.ok === true) {\n                        if (typeof retJson !== 'object') {\n                            debugger;\n                        }\n                        else if (Array.isArray(retJson) === true) {\n                            debugger;\n                        }\n                        return resolve(retJson);\n                    }\n                    let retError = retJson.error;\n                    if (retError === undefined) {\n                        await that.showError(buildError('not valid tonva json'));\n                    }\n                    else {\n                        await that.showError(buildError(retError, 'retJson.error'));\n                        reject(retError);\n                    }\n                }).catch(async error => {\n                    await that.showError(buildError(error, 'catch res.json()'));\n                });\n            }\n            else {\n                let text = await res.text();\n                env.clearTimeout(timeOutHandler);\n                console.log('text endWait');\n                that.endWait();\n                resolve(text);\n            }\n        }\n        catch (error) {\n            this.endWait(url, reject);\n            if (typeof error === 'string') {\n                let err = error.toLowerCase();\n                if (err.startsWith('unauthorized') === true) {\n                    nav.logout();\n                    return;\n                }\n            }\n            console.error('fecth error (no nav.showError): ' + url);\n            console.error(error);\n            // await this.showError(buildError(error, 'catch outmost'));\n        };\n    }\n\n    protected abstract async innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\n\n    async callFetch(url: string, method: string, body: any): Promise<any> {\n        let options = this.buildOptions();\n        options.method = method;\n        options.body = body;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(url, options, true, resolve, reject);\n        });\n    }\n\n    //private buildOptions(): {method:string; headers:Headers; body:any} {\n    private buildOptions(): { method: string; headers: { [name: string]: string }; body: any } {\n        let headers = this.buildHeaders();\n        let options = {\n            headers: headers,\n            method: undefined as any,\n            body: undefined as any,\n            // cache: 'no-cache',\n        };\n        return options;\n    }\n\n    /*\n    protected buildHeaders():Headers {\n        let {language, culture} = nav;\n        let headers = new Headers();\n        //headers.append('Access-Control-Allow-Origin', '*');\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\n        let lang = language;\n        if (culture) lang += '-' + culture;\n        headers.append('Accept-Language', lang);\n        if (this.apiToken) { \n            headers.append('Authorization', this.apiToken); \n        }\n        return headers;\n    }\n    */\n    protected buildHeaders(): { [name: string]: string } {\n        let { language, culture } = nav;\n        let headers: { [name: string]: string } = {}; //new Headers();\n        //headers.append('Access-Control-Allow-Origin', '*');\n        //headers.append('Content-Type', 'application/json;charset=UTF-8');\n        headers['Content-Type'] = 'application/json;charset=UTF-8';\n        let lang = language;\n        if (culture) lang += '-' + culture;\n        //headers.append('Accept-Language', lang);\n        headers['Accept-Language'] = lang;\n        if (this.apiToken) {\n            //headers.append('Authorization', this.apiToken); \n            headers['Authorization'] = this.apiToken;\n        }\n        return headers;\n    }\n}\n\nexport class CenterHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        if (this.apiToken === undefined && isBridged())\n            return await bridgeCenterApi(u, options.method, options.body);\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n\nexport class UqHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n","import {nav} from '../components/nav';\nimport {FetchError} from './fetchError';\n\nexport interface HttpChannelUI {\n    startWait():void;\n    endWait():void;\n    showError(error:FetchError):Promise<void>;\n    showUpgradeUq(uq:string, version:number):Promise<void>;\n}\n\nexport class HttpChannelNavUI implements HttpChannelUI {\n    startWait() {\n        nav.startWait();\n    }\n    endWait() {\n        nav.endWait();\n    }\n    async showError(error:FetchError):Promise<void> {\n        nav.endWait();\n        /*\n        if (error.name === 'SyntaxError') {\n            error = {\n                name: error.name,\n                message: error.message,\n            }\n        }*/\n        await nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await nav.showUpgradeUq(uq, version);\n    }\n}\n\n","import _ from 'lodash';\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\nimport {HttpChannelNavUI} from './httpChannelUI';\nimport {appUq, logoutUqTokens, buildAppUq} from './appBridge';\nimport {ApiBase} from './apiBase';\nimport { host } from './host';\nimport { LocalMap, env } from '../tool';\nimport {decodeUserToken} from '../tool/user';\n\nlet channelUIs:{[name:string]: HttpChannel} = {};\nlet channelNoUIs:{[name:string]: HttpChannel} = {};\n\nexport function logoutApis() {\n    channelUIs = {};\n    channelNoUIs = {};\n    logoutUnitxApis();\n    logoutUqTokens();\n}\n\ninterface UqLocal {\n    user: number;\n    unit: number;\n    value: any;\n    tick?: number;\n    isNet?: boolean;\n}\ninterface UqLocals {\n    user: number;\n    unit: number;\n    uqs: {[uq:string]: UqLocal};\n}\n/*\nconst uqLocalEntities = 'uqLocalEntities';\nclass CacheUqLocals {\n    private local:UqLocals;\n\n    async loadAccess(uqApi: UqApi):Promise<any> {\n        try {\n            let {uqOwner, uqName} = uqApi;\n            if (this.local === undefined) {\n                let ls = null; // localStorage.getItem(uqLocalEntities);\n                if (ls !== null) {\n                    this.local = JSON.parse(ls);\n                }\n            }\n            if (this.local !== undefined) {\n                let {user, uqs} = this.local;\n                if (user !== loginedUserId || uqs === undefined) {\n                    this.local = undefined;\n                }\n                else {\n                    for (let i in uqs) {\n                        let ul = uqs[i];\n                        ul.isNet = undefined;\n                    }\n                }\n            }\n            if (this.local === undefined) {\n                this.local = {\n                    user: loginedUserId,\n                    unit: undefined,\n                    uqs: {}\n                };\n            }\n\n            let ret: any;\n            let un = uqOwner+'/'+uqName;\n            let uq = this.local.uqs[un];\n            if (uq !== undefined) {\n                let {value} = uq;\n                ret = value;\n            }\n            if (ret === undefined) {\n                ret = await uqApi.__loadAccess();\n                //this.saveLocal(un, ret);\n            }\n            return _.cloneDeep(ret);\n        }\n        catch (err) {\n            this.local = undefined;\n            localStorage.removeItem(uqLocalEntities);\n            throw err;\n        }\n    }\n\n    private saveLocal(uqName:string, accessValue: any) {\n        this.local.uqs[uqName] = {\n            value: accessValue,\n            isNet: true,\n        }\n        let str = JSON.stringify(this.local);\n        localStorage.setItem(uqLocalEntities, str);\n    }\n\n    async checkAccess(uqApi: UqApi):Promise<boolean> {\n        if (this.local === undefined) return false;\n        let {uqOwner, uqName} = uqApi;\n        let un = uqOwner+'/'+uqName;\n        let uq = this.local.uqs[un];\n        if (uq === undefined) return false;\n        let {isNet, value} = uq;\n        if (isNet === true) return true;\n        let ret = await uqApi.__loadAccess();\n        let isMatch = _.isMatch(value, ret);\n        if (isMatch === false) {\n            this.saveLocal(un, ret);\n            return false;\n        }\n        uq.isNet = true;\n        return true;\n    }\n}\n\nconst localUqs = new CacheUqLocals;\n*/\nexport class UqApi extends ApiBase {\n    private access:string[];\n    appOwner:string;\n    appName:string;\n    uqOwner: string;\n    uqName: string;\n    uq: string;\n\n    constructor(basePath:string, appOwner:string, appName:string, uqOwner:string, uqName:string, access:string[], showWaiting?: boolean) {\n        super(basePath, showWaiting);\n        this.appOwner = appOwner;\n        this.appName = appName;\n        if (uqName) {\n            this.uqOwner = uqOwner;\n            this.uqName = uqName;\n            this.uq = uqOwner + '/' + uqName;\n        }\n        this.access = access;\n        this.showWaiting = showWaiting;\n    }\n\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\n\n    async init() {\n        await buildAppUq(this.uq, this.uqOwner, this.uqName, this.appOwner, this.appName);\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channels: {[name:string]: HttpChannel};\n        let channelUI: HttpChannelNavUI;\n        if (this.showWaiting === true || this.showWaiting === undefined) {\n            channels = channelUIs;\n            channelUI = new HttpChannelNavUI();\n        }\n        else {\n            channels = channelNoUIs;\n        }\n        let channel = channels[this.uq];\n        if (channel !== undefined) return channel;\n        let uqToken = appUq(this.uq); //, this.uqOwner, this.uqName);\n        if (!uqToken) {\n            //debugger;\n            await this.init();\n            uqToken = appUq(this.uq);\n        }\n        let {url, token} = uqToken;\n        this.token = token;\n        channel = new UqHttpChannel(url, token, channelUI);\n        return channels[this.uq] = channel;\n    }\n\n    /*async update():Promise<string> {\n        return await this.get('update');\n    }*/\n\n    /*\n    async __loadAccess():Promise<any> {\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n    */\n    async loadAccess():Promise<any> {\n        //return await localUqs.loadAccess(this);\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n\n    /*async loadEntities():Promise<any> {\n        return await this.get('entities');\n    }*/\n\n    /*\n    async checkAccess():Promise<boolean> {\n        return await localUqs.checkAccess(this);\n    }\n    */\n\n    async schema(name:string):Promise<any> {\n        return await this.get('schema/' + name);\n    }\n\n    async queueModify(start:number, page:number, entities:string) {\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\n    }\n\n    /*async schemas(names:string[]):Promise<any[]> {\n        return await this.post('schema', names);\n    }*/\n\n    /*\n    async tuidGet(name:string, id:number):Promise<any> {\n        return await this.get('tuid/' + name + '/' + id);\n    }\n\n    async tuidGetAll(name:string):Promise<any[]> {\n        return await this.get('tuid-all/' + name + '/');\n    }\n\n    async tuidSave(name:string, params:any):Promise<any> {\n        return await this.post('tuid/' + name, params);\n    }\n\n    async tuidSearch(name:string, arr:string, owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        let ret = await this.post('tuids/' + name, {\n            arr: arr,\n            owner: owner,\n            key: key,\n            pageStart: pageStart,\n            pageSize: pageSize\n        });\n        return ret;\n    }\n    async tuidArrGet(name:string, arr:string, owner:number, id:number):Promise<any> {\n        return await this.get('tuid-arr/' + name + '/' + owner + '/' + arr + '/' + id);\n    }\n    async tuidArrGetAll(name:string, arr:string, owner:number):Promise<any[]> {\n        return await this.get('tuid-arr-all/' + name + '/' + owner + '/' + arr + '/');\n    }\n    async tuidArrSave(name:string, arr:string, owner:number, params:any):Promise<any> {\n        return await this.post('tuid-arr/' + name + '/' + owner + '/' + arr + '/', params);\n    }\n    async tuidArrPos(name:string, arr:string, owner:number, id:number, order:number):Promise<any> {\n        return await this.post('tuid-arr-pos/' + name + '/' + owner + '/' + arr + '/', {\n            id: id,\n            $order: order\n        });\n    }\n\n    async tuidIds(name:string, arr:string, ids:number[]):Promise<any[]> {\n        try {\n            let url = 'tuidids/' + name + '/';\n            if (arr !== undefined) url += arr;\n            else url += '$';\n            let ret = await this.post(url, ids);\n            return ret;\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    */\n    /*async sheetSave(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name, data);\n    }*/\n\n    /*async sheetAction(name:string, data:object) {\n        return await this.put('sheet/' + name, data);\n    }*/\n\n    /*async stateSheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/states', data);\n    }*/\n\n    /*async stateSheetCount(name:string):Promise<any> {\n        return await this.get('sheet/' + name + '/statecount');\n    }*/\n\n    /*async mySheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/my-sheets', data);\n    }*/\n\n    /*async getSheet(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/get/' + id);\n    }*/\n\n    /*async sheetArchives(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name + '/archives', data);\n    }\n\n    async sheetArchive(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/archive/' + id);\n    }*/\n\n    /*async action(name:string, data:object):Promise<any> {\n        return await this.post('action/' + name, data);\n    }\n\n    async actionReturns(name:string, data:object):Promise<any[][]> {\n        return await this.post('action/' + name + '/returns', data);\n    }\n\n    async page(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p:any;\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return await this.post('query-page/' + name, p);\n    }\n\n    async query(name:string, params:any):Promise<any> {\n        let ret = await this.post('query/' + name, params);\n        return ret;\n    }\n    */\n/*\n    async history(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n\n    async book(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n*/\n    /*async user():Promise<any> {\n        return await this.get('user');\n    }*/\n}\n\nlet channels:{[unitId:number]: HttpChannel} = {};\n\nexport function logoutUnitxApis() {\n    channels = {};\n}\n\nexport class UnitxApi extends UqApi {\n    private unitId:number;\n    constructor(unitId:number) {\n        super('tv/', undefined, undefined, undefined, undefined, undefined, true);\n        this.unitId = unitId;\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channel = channels[this.unitId];\n        if (channel !== undefined) return channel;\n        return channels[this.unitId] = await this.buildChannel();\n    }\n\n    private async buildChannel():Promise<HttpChannel> {\n        let channelUI = new HttpChannelNavUI();\n        let centerAppApi = new CenterAppApi('tv/', undefined);\n        let ret = await centerAppApi.unitxUq(this.unitId);\n        let {token, db, url, urlTest} = ret;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        this.token = token;\n        return new UqHttpChannel(realUrl, token, channelUI);\n    }\n}\n\nlet centerHost:string;\n\nexport function setCenterUrl(url:string) {\n    console.log('setCenterUrl %s', url);\n    centerHost = url;\n    //centerToken = undefined;\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nexport let centerToken:string|undefined = undefined;\n\nlet loginedUserId:number = 0;\nexport function setCenterToken(userId:number, t?:string) {\n    loginedUserId = userId;\n    centerToken = t;\n    console.log('setCenterToken %s', t);\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nlet centerChannelUI:HttpChannel;\nlet centerChannel:HttpChannel;\nfunction getCenterChannelUI():HttpChannel {\n    if (centerChannelUI !== undefined) return centerChannelUI;\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\n}\nfunction getCenterChannel():HttpChannel {\n    if (centerChannel !== undefined) return centerChannel;\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\n}\n\nexport abstract class CenterApiBase extends ApiBase {\n    /*\n    constructor(path: string, showWaiting?: boolean) {\n        super(path, showWaiting);\n    }*/\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        return (this.showWaiting === true || this.showWaiting === undefined)?\n            getCenterChannelUI():\n            getCenterChannel();\n    }\n}\n\nconst uqTokensName = 'uqTokens';\nexport class UqTokenApi extends CenterApiBase {\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\n\n    async uq(params: {unit:number, uqOwner:string, uqName:string, appOwner:string, appName:string}):Promise<any> {\n        let {uqOwner, uqName} = params;\n        let un = uqOwner+'/'+uqName;\n        let localCache = this.localMap.child(un);\n        try {\n            let uqToken:UqLocal = localCache.get();\n            if (uqToken !== undefined) {\n                let {unit, user} = uqToken;\n                if (unit !== params.unit || user !== loginedUserId) {\n                    localCache.remove();\n                    uqToken = undefined;\n                }\n            }\n            let nowTick = Math.floor(Date.now() / 1000);\n            if (uqToken !== undefined) {\n                let {tick, value} = uqToken;\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\n                    return _.clone(value);\n                }\n            }\n            let appUqParams:any = _.clone(params);\n            appUqParams.testing = host.testing;\n            let ret = await this.get('app-uq', appUqParams);\n            if (ret === undefined) {\n                let {unit, uqOwner, uqName} = params;\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\n                throw err;\n            }\n\n            uqToken = {\n                unit: params.unit,\n                user: loginedUserId,\n                tick: nowTick,\n                value: ret,\n            }\n            localCache.set(uqToken);\n            return _.clone(ret);\n        }\n        catch (err) {\n            localCache.remove();\n            throw err;\n        }\n    }\n}\n\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\n\nexport class CallCenterApi extends CenterApiBase {\n    directCall(url:string, method:string, body:any):Promise<any> {\n        return this.call(url, method, body);\n    }\n}\nexport const callCenterapi = new CallCenterApi('', undefined);\n\nexport interface UqAppData {\n    appName: string;\n    appOwner: string;\n    id: number;\n    version: string;        // AppUI version\n    uqs: UqData[];\n}\n\nexport interface UqData {\n    id: number;\n    uqOwner: string;\n    uqName: string;\n    access: string;\n    newVersion: boolean;\n}\n\nexport interface UqServiceData {\n    id: number;\n    db: string;\n    url: string;\n    urlTest: string;\n    token: string;\n}\n\n//const appUqsName = 'appUqs';\n\nexport class CenterAppApi extends CenterApiBase {\n    //private local: LocalCache = env.localDb.item(appUqsName);\n    //private cachedUqs: UqAppData;\n    async uqs(appOwner:string, appName:string):Promise<UqAppData> {\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n        return ret;\n        /*\n        let ret:UqAppData;\n        let appUqs = this.local.get();\n        if (appUqs) {\n            let {appOwner:rAppOwner, appName:rAppName} = appUqs;\n            if (appOwner === rAppOwner && appName === rAppName) ret = appUqs;\n        }\n        if (ret === undefined) {\n            ret = await this.uqsPure(appOwner, appName);\n            ret.appName = appName;\n            ret.appOwner = appOwner;\n            //localStorage.setItem(JSON.stringify(obj));\n            this.local.set(ret);\n        }\n        //return this.cachedUqs = _.cloneDeep(ret);\n        return ret;\n        */\n    }\n    private async uqsPure(appOwner:string, appName:string):Promise<UqAppData> {\n        return await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n    }\n    /*\n    private async isOkCheckUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.uqsPure(appOwner, appName);\n        let {id:cachedId, uqs:cachedUqs} = this.local.get(); //.cachedUqs;\n        let {id:retId, uqs:retUqs} = ret;\n        if (cachedId !== retId) return false;\n        if (cachedUqs.length !== retUqs.length) return false;\n        let len = cachedUqs.length;\n        for (let i=0; i<len; i++) {\n            if (_.isMatch(cachedUqs[i], retUqs[i]) === false) return false;\n        }\n        return true;\n    }\n    async checkUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.isOkCheckUqs(appOwner, appName);\n        if (ret === false) {\n            this.local.remove();\n            nav.start();\n        }\n        return ret;\n    }\n    */\n    async unitxUq(unit:number):Promise<UqServiceData> {\n        return await this.get('tie/unitx-uq', {unit:unit});\n    }\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\n        return await this.post('tie/change-password', param);\n    }\n}\n\nexport async function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\n    let centerAppApi = new CenterAppApi('tv/', undefined);\n    //let unit = meInFrame.unit;\n    let ret = await centerAppApi.uqs(appOwner, appName);\n    //await centerAppApi.checkUqs(appOwner, appName);\n    /*\n    .then(v => {\n        if (v === false) {\n            localStorage.removeItem(appUqs);\n            nav.start();\n        }\n    });\n    */\n    return ret;\n}\n\n//import { nav } from '../ui';\n\nexport interface RegisterParameter {\n    nick:string, \n    user:string, \n    pwd:string,\n    country:number, \n    mobile:number, \n    mobileCountry:number,\n    email:string,\n    verify:string,\n};\n\nexport class UserApi extends CenterApiBase {\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\n        //(params as any).device = nav.local.device.get();\n        let ret = await this.get('user/login', params);\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeUserToken(ret);\n            case 'object':\n                let token = ret.token;\n                let user = decodeUserToken(token);\n                let {nick, icon} = ret;\n                if (nick) user.nick = nick;\n                if (icon) user.icon = icon;\n                return user;\n        }\n        // !== undefined) return decodeToken(token);\n    }\n    async register(params: RegisterParameter): Promise<any>\n    {\n        return await this.post('user/register', params);\n    }\n\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\n    }\n\n    async checkVerify(account:string, verify:string) {\n        return await this.post('user/check-verify', {account:account, verify:verify});\n    }\n\n    async isExists(account:string) {\n        return await this.get('user/is-exists', {account:account});\n    }\n\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\n        return await this.post('user/reset-password', {account:account, password, verify, type});\n    }\n    \n    async userSetProp(prop:string, value:any) {\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\n    }\n\n    async me():Promise<any> {\n        return await this.get('tie/me');\n    }\n\n    async user(id:number): Promise<any> {\n        return await this.get('tie/user', {id:id});\n\t}\n\t\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\n\t\treturn await this.get('tie/user-from-key', {key});\n\t}\n}\n\nexport const userApi = new UserApi('tv/', undefined);\n","import _ from 'lodash';\n\nexport interface KeyValueRes {\n    [key:string]: any;\n}\n\nexport interface Res<T extends KeyValueRes> {\n    [lang:string]: T | {[district:string]: T};\n}\n\nexport const resOptions:{\n\tlang: string;\n\t$lang: string;\n\tdistrict: string;\n\t$district: string;\n} = {\n\tlang: undefined,\n\t$lang: undefined,\n\tdistrict: undefined,\n\t$district: undefined,\n}\n\nexport function setResOptions(lang:string, district:string) {\n\tresOptions.lang = lang;\n\tresOptions.$lang = '$' + lang;\n    resOptions.district = district;\n    resOptions.$district = '$' + district;\n}\n\n(function() {\n    let lang: string, district: string;\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\n        || navigator.language; // ||   // All browsers\n    //navigator.userLanguage; // IE <= 10\n    if (!language) {\n        lang = 'zh';\n        district = 'CN';\n    }\n    else {\n        let parts = language.split('-');\n        lang = parts[0];\n        if (parts.length > 1) district = parts[1].toUpperCase();\n    }\n    setResOptions(lang, district);\n}());\n\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\n    let {lang, district} = resOptions;\n    let ret:T = {} as T;\n    if (res === undefined) return ret;\n    _.merge(ret, res._);\n    let l = res[lang];\n    if (l === undefined) return ret;\n    _.merge(ret, l._);\n    let d = l[district];\n    if (d === undefined) return ret;\n    _.merge(ret, d);\n    let {entity} = ret;\n    if (entity !== undefined) {\n        for (let i in entity) {\n            entity[i.toLowerCase()] = entity[i];\n        }\n    }\n    return ret;\n}\n\nconst resGlobal:any = {};\nexport function setRes(target: any, res: any):(str:string)=>any {\n\tif (res === undefined) return;\n\tlet {$lang, $district} = resOptions;\n\t_.merge(target, res);\n\tif ($lang !== undefined) {\n\t\tlet l = res[$lang];\n\t\tif (l !== undefined) {\n\t\t\t_.merge(target, l);\n\t\t\tlet d = l[$district];\n\t\t\tif (d !== undefined) {\n\t\t\t\t_.merge(target, d);\n\t\t\t}\n\t\t}\n\t}\n\treturn function(str:string) {\n\t\treturn target[str] || str;\n\t}\n}\nexport function setGlobalRes(res: any) {\n\tsetRes(resGlobal, res);\n}\nexport function t(str:string):any {\n\treturn resGlobal[str] || str;\n}\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst ID_LENGTH = 8;\n\nexport function uid():string {\n    let len = ALPHABET.length;\n    let rtn = '';\n    for (let i = 0; i < ID_LENGTH; i++) {\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\n    }\n    return rtn;\n}\n","export * from './uqMan';\nexport * from './entity';\nexport * from './action';\nexport * from './query';\nexport * from './sheet';\nexport * from './tuid';\nexport * from './book';\nexport * from './map';\nexport * from './history';\nexport * from './pending';\nexport * from './uqsMan';\nexport * from './tag/tag';\n","import _ from 'lodash';\nimport {observable, IObservableArray} from 'mobx';\nimport { PageItems } from '../tool';\nimport {Field, ArrFields} from './uqMan';\nimport {Entity} from './entity';\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\n\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\n\nexport class QueryPager<T extends any> extends PageItems<T> {\n\tprivate query: Query;\n\tprivate $page: any;\n\tprotected idFieldName: any;\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\n        super(itemObservable);\n        this.query = query;\n        if (pageSize !== undefined) this.pageSize = pageSize;\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\n\t}\n\n\tsetReverse() {\n\t\tthis.appendPosition = 'head';\n\t}\n\n    protected async onLoad() {\n\t\tif (this.$page) return;\n        let {schema} = this.query;\n        if (schema === undefined) {\n\t\t\tawait this.query.loadSchema();\n\t\t\tschema = this.query.schema;\n\t\t}\n\t\tif (schema === undefined) return;\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\n\t\tif ($page === undefined) return;\n\t\tthis.sortOrder = $page.order;\n\t\tlet fields = $page.fields;\n\t\tif (fields !== undefined) {\n\t\t\tlet field = fields[0];\n\t\t\tif (field) this.idFieldName = field.name;\n\t\t}\n    }\n\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\n\t\treturn ret;\n\t}\n\tprotected getPageId(item:T) {\n\t\tif (item === undefined) return;\n\t\tif (typeof item === 'number') return item;\n\t\tlet start = (item as any)[this.idFieldName];\n\t\tif (start === null) return;\n\t\tif (start === undefined) return;\n\t\tif (typeof start === 'object') {\n\t\t\tlet id = start.id;\n\t\t\tif (id !== undefined) return id;\n\t\t}\n\t\treturn start;\n\t}\n\tasync refreshItems(item:T) {\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index < 0) return;\n\t\tlet startIndex:number;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\tstartIndex = index - 1;\n\t\t}\n\t\telse {\n\t\t\tstartIndex = index + 1;\n\t\t}\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\n\t\tlet pageSize = 1;\n        let ret = await this.load(\n\t\t\tthis.param, \n\t\t\tpageStart,\n\t\t\tpageSize);\n\t\tlet len = ret.length;\n\t\tif (len === 0) {\n\t\t\tthis._items.splice(index, 1);\n\t\t\treturn;\n\t\t}\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet newItem = ret[i];\n\t\t\tif (!newItem) continue;\n\t\t\tlet newId = newItem[this.idFieldName];\n\t\t\tif (newId === undefined || newId === null) continue;\n\t\t\tif (typeof newId === 'object') newId = newId.id;\n\t\t\tlet oldItem = this._items.find(v => {\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\n\t\t\t\treturn oldId = newId;\n\t\t\t});\n\t\t\tif (oldItem) {\n\t\t\t\t_.merge(oldItem, newItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Query extends Entity {\n    get typeName(): string { return 'query';}\n    private pageStart: any;\n    private pageSize:number;\n    private params:any;\n    private more: boolean;\n    private startField: Field;\n    @observable list:IObservableArray; // = observable.array([], {deep: false});\n    returns: ArrFields[];\n    isPaged: boolean;\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        let {returns} = schema;\n        //this.returns = returns;\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\n    }\n\n    resetPage(size:number, params:any) {\n        this.pageStart = undefined;\n        this.pageSize = size;\n        this.params = params;\n        this.more = false;\n        this.list = undefined;\n    }\n    get hasMore() {return this.more;}\n    async loadPage():Promise<void> {\n        if (this.pageSize === undefined) {\n            throw new Error('call resetPage(size:number, params:any) first');\n        }\n        let pageStart:any;\n        if (this.pageStart !== undefined) {\n            switch (this.startField.type) {\n                default: pageStart = this.pageStart; break;\n                case 'date':\n                case 'time':\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\n            }\n        }\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\n\t\tlet page = ret.$page;\n        /*\n        await this.loadSchema();\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\n        let data = await this.unpackReturns(res);\n        let page = data['$page'] as any[];\n        */\n        this.list = observable.array([], {deep: false});\n        if (page !== undefined) {\n            if (page.length > this.pageSize) {\n                this.more = true;\n                page.pop();\n                let ret = this.returns.find(r => r.name === '$page');\n                this.startField = ret.fields[0];\n                this.pageStart = page[page.length-1][this.startField.name];\n            }\n            else {\n                this.more = false;\n            }\n            this.list.push(...page);\n        }\n        //this.loaded = true;\n    }\n\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\n        return new QueryPageCaller(this, params, showWaiting);\n    }\n\n    async page(params:any, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<{[name:string]:any[]}> {\n        let p = {pageStart, pageSize, params};\n        let res = await this.pageCaller(p, showWaiting).request();\n        return res;\n    }\n    protected queryCaller(params: any, showWaiting: boolean = true): QueryQueryCaller {\n        return new QueryQueryCaller(this, params, showWaiting);\n    }\n    async query(params:any, showWaiting:boolean = true):Promise<any> {\n        let res = await this.queryCaller(params, showWaiting).request();\n        return res;\n    }\n    async table(params:any, showWaiting:boolean = true): Promise<any[]> {\n        let ret = await this.query(params, showWaiting);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.table(params, showWaiting);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.obj(params, showWaiting);\n        for (let i in ret) return ret[i];\n    }\n}\n","import { messageHub } from \"./messageHub\";\n\nlet subAppWindow:Window;\nfunction postWsToSubApp(msg:any) {\n    if (subAppWindow === undefined) return;\n    subAppWindow.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport function setSubAppWindow(win:Window) {\n    subAppWindow = win;\n}\n\nexport function postWsToTop(msg:any) {\n    window.top.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport abstract class WsBase {\n\tprivate messageHub = messageHub;\n\t/*\n    wsBaseId:string;\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n\t*/\n\t/*\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.anyHandlers[seed] = handler;\n        return seed;\n    }\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.msgHandlers[seed] = {type:type, handler: handler};\n        return seed;\n    }\n    endWsReceive(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n\t}\n\t*/\n    async receive(msg:any) {\n\t\tthis.messageHub.dispatch(msg);\n\t\t/*\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n\t\t}\n\t\t*/\n    }\n}\n\nlet wsBaseSeed = 1;\nexport class WsBridge extends WsBase {\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\n}\n\nexport const wsBridge = new WsBridge();\n\nexport class WSChannel extends WsBase {\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\n    static centerToken:string;\n    private wsHost: string;\n    private token: string;\n    private ws: WebSocket;\n\n    constructor(wsHost: string, token: string) {\n        super();\n        this.wsHost = wsHost;\n        this.token = token;\n    }\n\n    static setCenterToken(token?: string) {\n        WSChannel.centerToken = token;\n    }\n    \n    connect():Promise<void> {\n        //this.wsHost = wsHost;\n        //this.token = token || WSChannel.centerToken;\n        if (this.ws !== undefined) return;\n        let that = this;\n        return new Promise((resolve, reject) => {\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\n            console.log('connect webSocket %s', this.wsHost);\n            ws.onopen = (ev) => {\n                console.log('webSocket connected %s', this.wsHost);\n                that.ws = ws;\n                resolve();\n            };\n            ws.onerror = (ev) => {\n                reject('webSocket can\\'t open!');\n            };\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\n            ws.onclose = (ev) => {\n                that.ws = undefined;\n                console.log('webSocket closed!');\n            }\n        });\n    }\n    close() {\n        if (this.ws !== undefined) {\n            this.ws.close();\n            this.ws = undefined;\n        }\n    }\n    private async wsMessage(event:any):Promise<void> {\n        try {\n            console.log('websocket message: %s', event.data);\n            let msg = JSON.parse(event.data);\n            postWsToSubApp(msg);\n            await this.receive(msg);\n        }\n        catch (err) {\n            console.log('ws msg error: ', err);\n        }\n    }\n    sendWs(msg:any) {\n        let netThis = this;\n        this.connect().then(() => {\n            netThis.ws.send(msg);\n        });\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\nimport _ from 'lodash';\n\nexport interface ImageProps {\n    src: string;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n}\n\n// src = .src, 表示fontawesome Icon\nexport function Image(props: ImageProps) {\n\tlet {className, style, src, altImage} = props;\n\tlet icon:string;\n    if (src) {\n\t\tif (src.indexOf('.') !== 0) {\n\t\t\tif (_.startsWith(src, ':') === true) {\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\n\t\t\t}\n\t\t\treturn <img src={src} className={className} alt=\"img\"\n\t\t\t\tstyle={style}\n\t\t\t\tonError={evt=>{\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n\t\t\t\t}} />;\n\t\t}\n\t\ticon = src.substr(1);\n\t}\n\telse {\n\t\ticon = 'file-o'\n\t}\n\treturn <span className={classNames(className, 'image-none')} style={style}>\n\t\t<i className={'fa fa-' + icon} />\n\t</span>;\n}\n","import jwtDecode from 'jwt-decode';\n\nexport interface Unit {\n    id: number;\n    name: string;\n}\n\nexport interface Guest {\n    id: number;             // id = 0\n    guest: number;\n    token: string;\n}\n\nexport interface User extends Guest {\n    id: number;\n    name: string;\n    nick?: string;\n    icon?: string;\n}\n\nexport function decodeUserToken(token: string): User {\n    let ret:any = jwtDecode(token);\n    let user: User = {\n        id: ret.id,\n        name: ret.name,\n        guest: ret.guest,\n        token: token,\n    };\n    return user;\n}\n\nexport function decodeGuestToken(token: string): Guest {\n    let ret:any = jwtDecode(token);\n    let guest: Guest = {\n        id: 0,\n        guest: ret.guest,\n        token: token,\n    };\n    return guest;\n}\n","import { env } from '../tool';\nimport _ from 'lodash';\n\nconst centerHost = process.env.isMiniprogram ? 'https://tv.jkchemical.com' : process.env['REACT_APP_CENTER_HOST'];\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\nconst resHost = process.env.isMiniprogram ? 'https://tv.jkchemical.com' :process.env['REACT_APP_RES_HOST'] || centerHost;\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugBuilderHost = 'localhost:3009';\ninterface HostValue {\n    value: string;\n    local: boolean;\n}\nconst hosts:{[name:string]:HostValue} = {\n    centerhost: {\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \n        local: false\n    },\n    reshost: {\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\n        local: false\n    },\n    uqhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    unitxhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    \"uq-build\": {\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \n        local: false\n    }\n}\n\nconst httpArr = ['https://', 'http://'];\nfunction isAbsoluteUrl(url:string):boolean {\n    for (let str of httpArr) {\n        if (_.startsWith(url, str) === true) return true;\n    }\n    return false;\n}\n\nfunction urlFromHost(host:string):string {\n    if (isAbsoluteUrl(host) === true) {\n        if (_.endsWith(host, '/')) return host;\n        return host + '/';\n    }\n    return `http://${host}/`;\n}\n\nfunction centerUrlFromHost(host:string):string {\n    return urlFromHost(host);\n}\nfunction centerWsFromHost(host:string) {\n    let https = 'https://';\n    if (_.startsWith(host, https) === true) {\n        host = host.substr(https.length);\n        if (_.endsWith(host, '/') === true) host = host.substr(0, host.length-1);\n        return 'wss://' + host + '/tv/';\n    }\n    return `ws://${host}/tv/`\n}\nexport function resUrlFromHost(host:string) {\n\tif (!host) return;\n    let url = urlFromHost(host);\n    return url + 'res/';\n}\n\nconst fetchOptions = {\n    method: \"GET\",\n    mode: \"no-cors\", // no-cors, cors, *same-origin\n    headers: {\n        \"Content-Type\": \"text/plain\"\n    },\n};\n\nclass Host {\n    testing: boolean;\n    url: string;\n    ws: string;\n    resHost: string;\n\n    async start(testing:boolean) {\n        this.testing = testing;\n        // if (env.isDevelopment === true) {\n        //     await this.tryLocal();\n        // }\n        let host = this.getCenterHost();\n        this.url = centerUrlFromHost(host);\n        this.ws = centerWsFromHost(host);\n        this.resHost = this.getResHost();\n    }\n\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\n    private async tryLocal() {\n        let promises:PromiseLike<any>[] = [];\n        let hostArr:string[] = [];\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            let {value} = hostValue;\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\n        }\n\n        for (let host of hostArr) {\n            let fetchUrl = this.debugHostUrl(host);\n            promises.push(localCheck(fetchUrl));\n        }\n        let results = await Promise.all(promises);\n        let len = hostArr.length;\n        for (let i=0; i<len; i++) {\n            let local = results[i];\n            let host = hostArr[i];\n            for (let j in hosts) {\n                let hostValue = hosts[j];\n                if (hostValue.value === host) {\n                    hostValue.local = local;\n                }\n            }\n        }\n        /*\n        let p = 0;\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            hostValue.local = results[p];\n            ++p;\n        }\n        */\n    }\n\n    private getCenterHost():string {\n        let {value, local} = hosts.centerhost;\n        //if (document.location) {\n            let hash = window.location.hash;\n            if (hash && hash.includes('sheet_debug') === true) {\n                return value;\n            }\n        //}\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return centerHost;\n    }\n\n    private getResHost():string {\n        let {value, local} = hosts.reshost;\n        //if (document.location) {\n            let hash = window.location.hash;\n            if (hash.includes('sheet_debug') === true) {\n                return value;\n            }\n        //}\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return resHost;\n    }\n\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\n        if (env.isDevelopment === false) return url;\n        let host = hosts[debugHost];\n        if (host === undefined) return url;\n        let {value, local} = host;\n        if (local === false) return url;\n        return `http://${value}/`;\n    }\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\n\t\tlet path:string;\n\t\tif (!urlTest) {\n\t\t\turlTest = url;\n\t\t\tif (!urlTest) {\n\t\t\t\tconsole.error('no server set for ' + db);\n\t\t\t\tdebugger;\t\t\t\t\n\t\t\t}\n\t\t}\n        if (this.testing === true) {\n            if (urlTest !== '-') url = urlTest;\n            path = 'uq/test/' + db + '/';\n        }\n        else {\n            path = 'uq/prod/' + db + '/';\n        }\n\t\turl = this.getUrlOrDebug(url);\n\t\tif (_.endsWith(url, '/') === false) {\n\t\t\turl += '/';\n\t\t}\n        return url + path;\n    }\n\n    async localCheck(urlDebug: string):Promise<boolean> {\n        return await localCheck(urlDebug);\n    }\n}\n\nexport const host:Host = new Host();\n\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\n// 网上找了上面的fetch timeout代码。\n// 尽管timeout了，fetch仍然继续，没有cancel\n\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\n//const timeout = 2000;\nconst timeout = 200;\n\nfunction fetchLocalCheck(url:string):Promise<any> {\n    return new Promise((resolve, reject) => {\n      fetch(url, fetchOptions as any)\n      .then(v => {\n          v.text().then(resolve).catch(reject);\n      })\n      .catch(reject);\n      const e = new Error(\"Connection timed out\");\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\n    });\n}\n\nasync function localCheck(url:string):Promise<boolean> {\n    try {\n        await fetchLocalCheck(url);\n        return true;\n    }\n    catch (err) {\n        return false;\n    }\n}\n\n/*\nexport interface IUqForChannel {\n    uq: string;\n    uqVersion: number;\n}\n*/","//import _ from 'lodash';\nimport { KeyValueRes, Res } from './res';\n\nexport interface FormRes extends KeyValueRes {\n    required: string;\n    number: string;\n    integer: string;\n    min: string;\n    max: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const formRes:Res<FormRes> = {\n    _: {\n        required: 'required',\n        number: 'not valid number',\n        integer: 'not valid integer',\n        min: 'min value is ${min}',\n        max: 'max value is ${max}',\n    },\n    zh: {\n        _: {\n            required: '必须填',\n            number: '需要数字',\n            integer: '需要整数',\n            min: '不能小于${min}',\n            max: '不能大于${max}',\n        }\n    },\n}\n","import { KeyValueRes, Res } from './res';\n\nexport interface ListRes extends KeyValueRes {\n    none: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const listRes:Res<ListRes> = {\n    _: {\n        none: '[none]',\n    },\n    zh: {\n        _: {\n            none: '[无]',\n        }\n    },\n}\n","import { Res } from '../res';\n\nexport interface LoginRes {\n    a: string;\n}\n\nexport const loginRes: Res<LoginRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import { Res } from '../res';\n\nexport interface RegisterRes {\n    a: string;\n}\n\nexport const registerRes: Res<RegisterRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import React, { CSSProperties } from 'react';\nimport { PageHeaderProps } from './pageHeader';\n\nconst scrollAfter = 20; // 20ms之后，scroll执行\nexport class Scroller {\n    private el: HTMLBaseElement;\n    constructor(el: HTMLBaseElement) {\n        this.el = el;\n    }\n\n    scrollToTop():void {\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\n    }\n    scrollToBottom():void {\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\n    }\n}\n\nexport interface ScrollProps {\n    onScroll?: (e:any) => void;\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\n\tclassName?: string;\n}\ninterface ScrollViewProps extends ScrollProps {\n\tclassName?: string;\n\tstyle?: React.CSSProperties;\n}\nconst scrollTimeGap = 100;\nabstract class ScrollViewBase<T extends ScrollViewProps> extends React.Component<T, null> {\n    private bottomTime:number = 0;\n\tprivate topTime:number = 0;\n\tprivate div: HTMLDivElement;\n\n\tprotected refDiv = (div:HTMLDivElement) => {\n\t\tif (!div) {\n\t\t\tif (this.div) {\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tthis.div = div;\n\t\tthis.div.addEventListener('resize', this.onResize);\n\t}\n\n\tprivate onResize = (ev:UIEvent) => {\n\t\tconsole.error('div resize');\n\t};\n\n    protected onScroll = async (e:any) => {\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\n        if (onScroll) this.props.onScroll(e);\n        let el = e.target as HTMLBaseElement;\n        let scroller = new Scroller(el);\n        if (el.scrollTop < 30) {\n            if (onScrollTop !== undefined) {\n                let topTime = new Date().getTime();\n                if (topTime-this.topTime > scrollTimeGap) {\n                    this.topTime = topTime;\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\n\t\t\t\t\t\t // has more\n\t\t\t\t\t\tif (ret === true) {\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\n\t\t\t\t\t\t\tlet top = 200;\n\t\t\t\t\t\t\tif (top > sh) top = sh;\n\t\t\t\t\t\t\tel.scrollTop = top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n                }\n            }\n        }\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\n            //this.eachChild(this, 'bottom');\n            if (onScrollBottom !== undefined) {\n                let bottomTime = new Date().getTime();\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\n                    this.bottomTime = bottomTime;\n                    onScrollBottom(scroller);\n                }\n            }\n        }\n    }\n    private eachChild(c:any, direct:'top'|'bottom') {\n        let { props } = c;\n        if (props === undefined)\n            return;\n        let { children } = props;\n        if (children === undefined)\n            return;\n        React.Children.forEach(children, (child, index) => {\n            let {_$scroll} = child as any;\n            if (_$scroll) _$scroll(direct);\n            console.log(child.toString());\n            this.eachChild(child, direct);\n        });\n\t}\n}\n\nexport class ScrollView extends ScrollViewBase<ScrollViewProps> {\n    render() {\n\t\tlet {className, style} = this.props;\n\t\treturn <div ref={this.refDiv} className=\"tv-page\"\n\t\t\tonScroll={this.onScroll} style={style}>\n\t\t\t<article className={className}>\n\t\t\t\t{this.props.children}\n\t\t\t</article>\n\t\t</div>;\n    }\n}\n\nexport interface PageWebNav {\n\tnavHeader?: JSX.Element; \n\tnavRawHeader?: JSX.Element; \n\tnavFooter?: JSX.Element; \n\tnavRawFooter?: JSX.Element; \n\trenderPageHeader?: (props:PageHeaderProps)=>JSX.Element;\n}\ninterface WebNavScrollViewProps extends ScrollViewProps {\n\twebNav: PageWebNav;\n}\n\nexport class WebNavScrollView extends ScrollViewBase<WebNavScrollViewProps> {\n    render() {\n\t\tlet {className, style, webNav} = this.props;\n\t\tlet {navHeader, navRawHeader, navFooter, navRawFooter} = webNav;\n\t\tlet vHeader:any, vFooter:any;\n\t\tif (navRawHeader) vHeader = navRawHeader;\n\t\telse if (navHeader) vHeader = <header><main>{navHeader}</main></header>\n\t\tif (navRawFooter) vFooter = navRawFooter;\n\t\telse if (navFooter) vFooter = <footer><main>{navFooter}</main></footer>\n\n\t\treturn <div ref={this.refDiv} className=\"tv-page-webnav\"\n\t\t\tonScroll={this.onScroll} style={style}>\n\t\t\t{vHeader}\n\t\t\t<article className={className}>\n\t\t\t\t{this.props.children}\n\t\t\t</article>\n\t\t\t{vFooter}\n\t\t</div>;\n    }\n}\n","import { Entity } from './entity';\nimport { ActionCaller } from './caller';\n\nexport class Action extends Entity {\n    get typeName(): string { return 'action';}\n    async submit(data:object, waiting: boolean = true) {\n\t\tlet caller = new ActionSubmitCaller(this, data)\n\t\tlet ret = await caller.request();\n\t\treturn ret;\n    }\n    async submitReturns(data:object):Promise<{[ret:string]:any[]}> {\n       return await new SubmitReturnsCaller(this, data).request();\n    }\n    async submitConvert(data:object) {\n        return await new SubmitConvertCaller(this, data).request();\n    }\n}\n\nexport class ActionSubmitCaller extends ActionCaller {\n    get path():string {return 'action/' + this.entity.name;}\n    buildParams():any {\n\t\treturn {data: this.entity.pack(this.params)}\n\t}\n}\n\nclass SubmitReturnsCaller extends ActionSubmitCaller {\n    get path():string {return 'action/' + this.entity.name + '/returns';}\n    xresult(res:any):any {\n        let {returns} = this.entity;\n        let len = returns.length;\n        let ret:{[r:string]:any[]} = {};\n        for (let i=0; i<len; i++) {\n            let retSchema = returns[i];\n            ret[retSchema.name] = res[i];\n        }\n        return ret;\n    }\n}\n\nclass SubmitConvertCaller extends ActionSubmitCaller {\n    get path():string {return 'action-convert/' + this.entity.name;}\n    buildParams():any {\n        return {\n            data: this.params\n        };\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-lmr.css';\n\nexport interface LMRProps {\n    className?: string | string[];\n    left?: string|JSX.Element;\n    right?: string|JSX.Element;\n    onClick?: ()=>void;\n}\n\n@observer\nexport class LMR extends React.Component<LMRProps> {\n    render() {\n        let {className, left, children, right, onClick} = this.props;\n        let l, r;\n        if (left !== undefined) l = <header>{left}</header>;\n        if (right !== undefined) r = <footer>{right}</footer>;\n        let cursor;\n        if (onClick !== undefined) cursor = 'cursor-pointer';\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\n            {l}\n            <div>{children}</div>\n            {r}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-badge.css';\n\nexport interface BadgeProps {\n    className?: string;\n    badge?: string|number;\n    size?: 'xs' | 'sm' | 'lg';\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\n    badgeAlign?: 'left'|'center'|'right';\n    badgeVertical?: 'top'|'middle'|'bottom';\n}\n\n@observer\nexport class Badge extends React.Component<BadgeProps> {\n    render() {\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\n        let cn = classNames(\n            className,\n            'va-badge',\n            size && 'va-badge-'+size,\n            'va-badge-' + (color||'secondary'),\n            badgeAlign && 'va-badg-'+badgeAlign,\n            badgeVertical && 'va-badg-'+badgeVertical,\n        );\n        let b;\n        if (badge) b = <b>{badge}</b>;\n        return <div className={cn}>\n            {children}\n            {b}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface FAProps {\n    name: string;\n    className?: string;\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\n    spin?: boolean;\n    fixWidth?: boolean;\n    border?: boolean;\n    pull?: 'left'|'right';\n    pulse?: boolean;\n    rotate?: 90|180|270;\n    flip?: 'horizontal'|'vertical';\n    inverse?: boolean;\n}\n\nexport class FA extends React.Component<FAProps> {\n    render() {\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\n        let cn = classNames(className, 'fa',\n            name && ('fa-' + name),\n            size && 'fa-'+size,\n            fixWidth && 'fa-fw',\n            border && 'fa-border',\n            pull && 'fa-pull-' + pull,\n            spin && 'fa-spin',\n            pulse && 'fa-pulse',\n            rotate && 'fa-rotate-' + rotate,\n            flip && 'fa-flip-' + flip,\n            inverse && 'fa-inverse',\n        );\n        return <i className={cn} />\n    }\n}\n\nexport interface StackedFAProps {\n    className?: string;\n    size?: 'lg',\n}\nexport class StackedFA extends React.Component<StackedFAProps> {\n    render() {\n        let {className, size, children} = this.props;\n        let cn = classNames(\n            'fa-stack',\n            className,\n            size && 'fa-' + size);\n        return <span className={cn}>\n            {children}\n        </span>;\n    }\n}\n","import * as React from 'react';\nimport {FA} from './FA';\n\nexport interface IconTextProps {\n    icon: string;\n    iconClass?: string;\n    text: string;\n    textClass?: string;\n}\n\nexport class IconText extends React.Component<IconTextProps> {\n    render() {\n        let {icon, iconClass, text, textClass} = this.props;\n        return <div className=\"py-2\">\n            <FA className={iconClass} name={icon} fixWidth={true} />\n            <span className={textClass}>{text}</span>\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport const Muted = (props:any) => \n<small className={classNames('text-muted', props.className)} style={props.style}>\n    {props.children}\n</small>;\n","import _ from 'lodash';\n\nclass _LocalStorage {\n    getItem(key:string) {\n        return localStorage.getItem(key)\n    }\n    setItem(key:string, value:string) {\n        localStorage.setItem(key, value);\n    }\n    removeItem(key:string) {\n        localStorage.removeItem(key);\n    }\n}\n\nconst __ls = new _LocalStorage(); // new Ls;\n\nexport class LocalCache {\n    private readonly local: Local;\n    //private value: T;\n    readonly key: string|number;\n\n    constructor(local:Local, key:string|number) {\n        this.local = local;\n        this.key = key;\n    }\n    get():any {\n        try {\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\n            //if (this.value !== undefined) return this.value;\n            let text = this.local.getItem(this.key);\n            if (text === null) return;\n            if (text === undefined) return undefined;\n            //return this.value = \n            return JSON.parse(text);\n        }\n        catch (err) {\n            this.local.removeItem(this.key);\n            return;\n        }\n    }\n    set(value:any) {\n\t\tlet t = JSON.stringify(value, (key, value) => {\n\t\t\tif (key !== '_tuid') return value;\n\t\t});\n\t\tthis.local.setItem(this.key, t);\n    }\n    remove(local?:Local) {\n        if (local === undefined) {\n            this.local.removeItem(this.key);\n        }\n        else {\n            this.local.removeLocal(local);\n        }\n    }\n    child(key:string|number):LocalCache {\n        return this.local.child(key);\n    }\n    arr(key:string|number):LocalArr {\n        return this.local.arr(key);\n    }\n    map(key:string|number):LocalMap {\n        return this.local.map(key);\n    }\n}\n\nabstract class Local {\n    private readonly caches: {[key:string]:LocalCache};\n    private readonly locals: {[key:string]:Local};\n    protected readonly name: string;\n    constructor(name: string) {\n        this.name = name;\n        this.caches = {};\n        this.locals = {};\n    }\n\n    protected abstract keyForGet(key:string|number):string;\n    protected abstract keyForSet(key:string|number):string;\n    protected abstract keyForRemove(key:string|number):string;\n    abstract removeAll():void;\n    getItem(key:string|number):string {\n        let k = this.keyForGet(key);\n        if (k === undefined) return;\n        return __ls.getItem(k);\n    }\n    setItem(key:string|number, value: string):void {\n        let k = this.keyForSet(key);\n        __ls.setItem(k, value);\n    }\n    removeItem(key:string|number):void {\n        let k = this.keyForSet(key);\n        if (k === undefined) return;\n        localStorage.removeItem(k);\n    }\n    arr(key:string|number):LocalArr {\n        let sk = String(key);\n        let arr = this.locals[sk] as LocalArr;\n        if (arr === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = arr = new LocalArr(k);\n        }\n        return arr;\n    }\n    map(key:string|number):LocalMap {\n        let sk = String(key);\n        let map = this.locals[sk] as LocalMap;\n        if (map === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = map = new LocalMap(k);\n        }\n        return map;\n    }\n    removeLocal(local:Local) {\n        let sk = local.name;\n        let k = this.keyForRemove(sk);\n        if (k === undefined) return;\n        let arr = this.locals[sk];\n        if (arr === undefined) arr = new LocalArr(k);\n        else this.locals[sk] = undefined;\n        arr.removeAll();\n    }\n    child(key:string|number):LocalCache {\n        let ks = String(key);\n        let ret = this.caches[ks];\n        if (ret !== undefined) return ret;\n        return this.caches[ks] =ret = new LocalCache(this, key);\n    }\n}\n\nconst maxArrSize = 500;\nexport class LocalArr extends Local {\n    private readonly index: number[];\n    constructor(name: string) {\n        super(name);\n        let index = __ls.getItem(this.name);\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\n    }\n    private saveIndex() {\n        __ls.setItem(this.name, this.index.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i < 0) return undefined;\n        return `${this.name}.${key}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) {\n            this.index.unshift(key);\n            if (this.index.length > maxArrSize) this.index.pop();\n        }\n        else {\n            this.index.splice(i, 1);\n            this.index.unshift(key)\n        }\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    protected keyForRemove(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) return;\n        this.index.splice(i, 1);\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    removeAll():void {\n        for (let i of this.index) {\n            __ls.removeItem(`${this.name}.${i}`);\n        }\n        __ls.removeItem(this.name);\n        this.index.splice(0);\n    }\n    item(index:number):LocalCache {\n        return this.child(index);\n    }\n}\n\nexport class LocalMap extends Local {\n    private readonly index: {[key:string]:number};\n    private max: number;\n    constructor(name: string) {\n        super(name);\n        this.max = 0;\n        this.index = {};\n        let index = __ls.getItem(this.name);\n        if (index !== null) {\n            let ls = index.split('\\n');\n            ls.forEach(l => {\n                let p = l.indexOf('\\t');\n                if (p<0) return;\n                let key = l.substr(0, p);\n                let i = Number(l.substr(p+1));\n                if (isNaN(i) === true) return;\n                this.index[key] = i;\n                if (i>this.max) this.max = i;\n            });\n        }\n    }\n    private saveIndex() {\n        let ls:string[] = [];\n        for (let k in this.index) {\n            let v = this.index[k];\n            if (v === undefined) continue;\n            ls.push(`${k}\\t${v}`);\n        }\n        __ls.setItem(this.name, ls.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) return undefined;\n        return `${this.name}.${i}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) {\n            ++this.max;\n            i = this.max;\n            this.index[key] = i;\n            this.saveIndex();\n        }\n        return `${this.name}.${i}`;\n    }\n    protected keyForRemove(key:string|number):string {\n        let i = this.index[key];\n        if (i===undefined) return;\n        this.index[key] = undefined;\n        this.saveIndex();\n        return `${this.name}.${i}`;\n    }\n    removeAll():void {\n        for (let i in this.index) {\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\n            this.index[i] = undefined;\n        }\n        __ls.removeItem(this.name);\n        this.max = 0;\n    }\n    item(key:string):LocalCache {\n        return this.child(key);\n    }\n}\n","import * as React from 'react';\nimport { BoxId } from './boxId';\nimport { Tuid } from './tuid';\nimport { observer } from 'mobx-react';\n\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\n    return <>{tuidName}: {uqStringify(values)}</>;\n};\n\nexport function uqStringify(values: any): string {\n    let s = '{';\n    if (values === undefined) return 'undefined';\n    for (let i in values) {\n        let v = values[i];\n        s += i + ': ';\n        if (v === undefined) {\n            s += 'undefined';\n        }\n        else if (v === null) {\n            s += 'null';\n        }\n        else {\n            switch (typeof v) {\n                default:\n                    s += v;\n                    break;\n                case 'function':\n                    s += 'function';\n                    break;\n                case 'object':\n                    s += '{obj}';\n                    break;\n            }\n        }\n        s += ', ';\n    }\n    return s + '}';\n}\n\nexport class ReactBoxId implements BoxId {\n    readonly id: number;\n    protected tuid: Tuid;\n    protected ui: (values:any) => JSX.Element;\n    readonly isUndefined:boolean;\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\n        this.id = Number(id);\n        this.tuid = tuid;\n        this.ui = ui;\n        this.isUndefined = (this.tuid === undefined);\n    }\n\n    get obj():any {\n        return this.tuid.valueFromId(this.id);\n    }\n\n    equ(id:BoxId|number): boolean {\n        if (id === undefined || id === null) return false;\n        if (typeof id === 'object') return this.id === id.id;\n        return this.id === id;\n    }\n\n    render(ui:TvTemplet, x:any):JSX.Element {\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\n        let boxName = this.boxName; // this.tuid.name;\n        let val = this.obj; // this.tuid.valueFromId(this.id);\n        if (this.isUndefined === true) {\n            if (ui !== undefined) return ui(val, x);\n            return TuidContent(boxName, val, x);\n        }\n        switch (typeof val) {\n            case 'undefined':\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\n            case 'number':\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\n        }\n        if (ui === undefined) {\n            ui = this.ui;\n        }\n        if (ui !== undefined) {\n            if (typeof ui !== 'function') {\n                ui = (ui as any).content;\n            }\n            if (ui !== undefined) {\n                let ret = ui(val/*, this.tuidUR.res*/);\n                if (ret !== undefined) return ret;\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\n            }\n        }\n\n        return TuidContent(boxName, val);\n    }\n\n    get boxName():string {return this.tuid.name}\n    // ui(): TvTemplet {return this.tuid.ui}\n    // res(): any {return this.tuid.res}\n\n    async assure(): Promise<BoxId> {\n        await this.tuid.assureBox(this.id);\n        return this;\n    }\n}\n\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\n    let logContent:any;\n    let boxId:ReactBoxId = bi as ReactBoxId;\n    switch(typeof bi) {\n        case 'undefined': logContent = <>boxId undefined</>; break;\n        case 'number': logContent = <>id:{bi}</>; break;\n        default:\n            if (typeof boxId.render !== 'function') {\n                if (ui === undefined) {\n                    logContent = TuidContent(boxId.boxName, bi, x);\n                }\n                else {\n                    return ui(bi, x);\n                }\n            }\n            break;\n    }\n    if (logContent !== undefined) {\n        return <del className=\"text-danger\">{logContent}</del>;\n    }\n    return boxId.render(ui, x);\n}\n\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\n\ninterface Props {\n    tuidValue: number|BoxId, \n    ui?: TvTemplet,\n    x?: any,\n    nullUI?: ()=>JSX.Element\n}\n\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\n    if (tuidValue === undefined) {\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\n        return nullUI();\n    }\n    if (tuidValue === null) {\n        if (nullUI === undefined) return <>[null]</>;\n        return nullUI();\n    }\n    let ttv = typeof tuidValue;\n    switch (ttv) {\n        default:\n            if (ui === undefined)\n                return <>{ttv}-{tuidValue}</>;\n            else {\n                let ret = ui(tuidValue, x);\n                if (ret !== undefined) return ret;\n                return <>{tuidValue}</>;\n            }\n        case 'object':\n            let divObj = boxIdContent(tuidValue, ui, x);\n            if (divObj !== undefined) return divObj;\n            return nullUI === undefined? <>id null</>: nullUI();\n        case 'number':\n            return <>id...{tuidValue}</>;\n    }\n});\n\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\n};\n","import * as React from 'react';\n\nexport function Loading() {\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\n    </div>;\n}\n","import { LocalMap } from './localDb';\nimport _ from 'lodash';\n\nconst testingTags:string[] = ['/test', '/test/', '-test', '-test/'];\nfunction isTesting():boolean {\n    if (\"undefined\" != typeof wx)\n        return false;\n    let {pathname} = window.location;\n    let pn = pathname.toLowerCase();\n    for (let item of testingTags) {\n        if (_.endsWith(pn, item) === true) return true;\n    }\n    return false;\n}\n\nexport const env = (function () {\n    let testing = isTesting();\n    let localDb = new LocalMap(testing===true? '$$':'$');\n    return {\n        testing: testing,\n        isDevelopment: process.env.NODE_ENV === 'development',\n        localDb: localDb,\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\n            //if (tag !== undefined) console.log('setTimeout ' + tag);\n            return global.setTimeout(callback, ms, ...args);\n        },\n        clearTimeout: (handle:NodeJS.Timer):void => {\n            global.clearTimeout(handle);\n        },\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\n            return global.setInterval(callback, ms, ...args);\n        },\n        clearInterval: (handle:NodeJS.Timer):void => {\n            global.clearInterval(handle);\n        }\n    }\n}());\n","\nexport * from './boxId';\nexport * from './tuid';\nexport { TuidsCache } from './tuidsCache';\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import {HttpChannel} from './httpChannel';\nimport { Caller } from './caller';\n\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \n    resolve:(values:any)=>any, reject:(reason:any)=>void)\n{\n    await channel.fetch(url, options, false, resolve, reject);\n}\n\nexport abstract class ApiBase {\n    protected token: string;\n    protected path: string;\n    protected showWaiting: boolean;\n\n    constructor(path: string, showWaiting: boolean) {\n        this.path = path || '';\n        this.showWaiting = showWaiting;\n    }\n\n    protected abstract async getHttpChannel(): Promise<HttpChannel>;\n\n    async xcall(caller:Caller<any>):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.xcall(this.path, caller);\n    }\n\n    public async call(url:string, method:string, body:any):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.callFetch(url, method, body);\n    }\n\n    public async get(path:string, params:any=undefined): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.get(this.path + path, params);\n    }\n\n    public async post(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.post(this.path + path, params);\n    }\n\n    public async put(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.put(this.path + path, params);\n    }\n\n    public async delete(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.delete(this.path + path, params);\n    }\n}\n","import * as React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { UiImageItem } from '../schema';\nimport { ImageUploader } from '../resUploader';\nimport { nav } from '../nav';\nimport { ItemEdit } from './itemEdit';\n\nexport class ImageItemEdit extends ItemEdit {\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\n    @observable private resId: string;\n\n    protected async internalStart():Promise<any> {\n        this.resId = this.value;\n        return new Promise<any>((resolve, reject) => {\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\n        });\n    }\n\n    /*\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let ret = await this.resUploader.upload();\n        if (ret === null) {\n            this.overSize = true;\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.value);\n    }\n    */\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let size:any = this.uiItem && this.uiItem.size;\n\n        /*\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>resolve(this.resId)}>保存</button>;\n        let overSize:any;\n        if (this.overSize === true) {\n            overSize = <div className=\"text-danger\">\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\n            </div>;\n        }\n        */\n        return <ImageUploader \n            label={'更改' + this.label}\n            id={this.resId}\n            size={size}\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\n        /*\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div>上传图片：</div>\n                    <div className=\"my-3\">\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\n                    </div>\n                    <div>\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\n                    </div>\n                </div>\n                {overSize}\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\n                <div className=\"d-flex\">\n                    <div className=\"w-12c h-12c mr-4\"\n                        style={{border: '1px dotted gray', padding: '8px'}}>\n                        <Image className=\"w-100 h-100\" src={this.resId} />\n                    </div>\n                    <div>\n                        <div className=\"small\">图片预览</div>\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\n                    </div>\n                </div>\n            </div>\n        </Page>;\n        */\n    })\n}\n","import _ from 'lodash';\nimport {observable, IObservableArray, computed} from 'mobx';\n\nexport abstract class PageItems<T> {\n    constructor(itemObservable:boolean = false) {\n        this._items = observable.array<T>([], {deep:itemObservable});\n    }\n\tprivate isFirst: boolean = true;\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\n    @observable loading: boolean = false;\n    @observable private beforeLoad: boolean = true;\n    @observable protected loaded: boolean = false;\n    protected _items:IObservableArray<T>;\n    @observable allLoaded: boolean = false;\n    @computed get items():IObservableArray<T> {\n        if (this.beforeLoad === true) return null;\n        if (this.loaded === false) return undefined;\n        return this._items;\n\t}\n\t\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\n\t\tthis.pageItemAction = pageItemAction;\n\t}\n\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\n\t\tthis.itemConverter = itemConverter;\n\t}\n\n    @observable topDiv:string = '$$top';\n    @observable bottomDiv:string = '$$bottom';\n    scrollToTop = () => {\n\t\tthis.scrollIntoView(this.topDiv);\n\t\t//let id = '$$top'+uid();\n\t\t//this.topDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.topDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n    }\n    scrollToBottom = () => {\n\t\tthis.scrollIntoView(this.bottomDiv);\n\t\t//let id = '$$bottom'+uid();\n\t\t//this.bottomDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.bottomDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n\t}\n\tprivate scrollIntoView(divId:string) {\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(divId);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t}\n\n    protected param: any;\n    protected firstSize = 100;\n    protected pageStart:any = undefined;\n    protected pageSize = 30;\n    protected appendPosition:'head'|'tail' = 'tail';\n\n\tprotected sortOrder:'asc'|'desc';\n\tprotected abstract async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\n\tprotected getPageId(item:T):any {return;}\n\tprotected setPageStart(item:T) {\n\t\tthis.pageStart = this.getPageId(item);\n\t}\n\t\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\n\t\tlet pageList = results.$page;\n\t\tif (this.itemConverter) {\n\t\t\tlet ret:T[] = [];\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\n\t\t\t\tret.push(item);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\tif (this.pageItemAction !== undefined) {\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tthis.pageItemAction(pageList[i], results);\n\t\t\t}\n\t\t}\n\t\treturn pageList;\n\t}\n\n    reset() {\n        this.isFirst = true;\n        this.beforeLoad = true;\n        this.loaded = false;\n        this.param = undefined;\n\t\tthis.allLoaded = false;\n\t\tthis.pageStart = undefined;\n        this._items.clear();\n        //this.setPageStart(undefined);\n    }\n\n    append(item:T) {\n        if (this.appendPosition === 'tail')\n            this._items.unshift(item);\n        else\n            this._items.push(item);\n    }\n\n    async first(param:any):Promise<void> {\n        this.reset();\n        this.beforeLoad = false;\n        this.param = param;\n        await this.more();\n\t}\n\n\tprivate changing = false;\n\tasync attach(): Promise<void> {\n\t\tif (this.sortOrder === undefined) {\n\t\t\tconsole.error('没有定义增减序，无法attach');\n\t\t\treturn;\n\t\t}\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet items = this._items;\n\t\tlet isAsc = this.sortOrder === 'asc';\n\t\t//let isTail:boolean, \n\t\tlet endItem:T;\n\t\tlet scrollToEnd:() => void;\n\t\tlet pushItem:(item:T) => void;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\t//isTail = true;\n\t\t\tendItem = items[0];\n\t\t\tscrollToEnd = this.scrollToTop;\n\t\t\tpushItem = (item:T) => items.unshift(item);\n\n\t\t}\n\t\telse {\n\t\t\t//isTail = false;\n\t\t\tlet endIndex = items.length;\n\t\t\tendItem = items[endIndex-1];\n\t\t\tscrollToEnd = this.scrollToBottom;\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\n\t\t}\n\t\tlet startId = this.getPageId(endItem);\n\t\tlet pid = undefined;\n\t\tlet sum = 0, max = 50;\n\t\tfor (;sum < max;) {\n\t\t\tlet ret = await this.load(this.param, pid, 3);\n\t\t\tlet len = ret.length;\n\t\t\tif (len === 0) break;\n\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = ret[i];\n\t\t\t\tpid = this.getPageId(item);\n\t\t\t\tif (isAsc === true) {\n\t\t\t\t\tif (pid >= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pid <= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpushItem(item);\n\t\t\t\t/*\n\t\t\t\tif (isTail === true) {\n\t\t\t\t\tthis._items.unshift(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t\tthis.changing = false;\n\t\tif (sum > 0) {\n\t\t\tscrollToEnd();\n\t\t\t/*\n\t\t\tif (isTail === true) this.scrollToTop();\n\t\t\telse this.scrollToBottom();\n\t\t\t*/\n\t\t}\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\n\t\tthis._items.clear();\n\t\tthis.setLoaded(ret);\n\t\t/*\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet item = ret[i];\n\t\t\tlet pid = this.getRefreshPageId(item);\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\n\t\t\t//let oldItem = this._items[index];\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\n\t\t\tif (index >= 0) {\n\t\t\t\t_.merge(this._items[index], item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.splice(0, 0, item);\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.changing = false;\n\t}\n\n\tprotected getRefreshPageId(item:T) {\n\t\treturn this.getPageId(item);\n\t}\n\n    protected async onLoad(): Promise<void> {}\n    protected async onLoaded(): Promise<void> {}\n\n    async more():Promise<boolean> {\n        if (this.allLoaded === true) return false;\n\t\tif (this.loading === true) return true;\n\t\tif (this.changing === true) return true;\n\t\tthis.loading = true;\n\t\tthis.changing = true;\n        await this.onLoad();\n        if (this.pageStart === undefined) this.setPageStart(undefined);\n        let pageSize = this.pageSize + 1;\n        if (this.isFirst === true) {\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\n        }\n        let ret = await this.load(\n                this.param, \n                this.pageStart,\n\t\t\t\tpageSize);\n        this.loaded = true;\n\t\tlet len = ret.length;\n        if ((this.isFirst===true && len>this.firstSize) ||\n            (this.isFirst===false && len>this.pageSize))\n        {\n            this.allLoaded = false;\n            --len;\n            ret.splice(len, 1);\n        }\n        else {\n            this.allLoaded = true;\n\t\t}\n\t\t/*\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(ret[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...ret);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...ret.reverse());\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.setLoaded(ret);\n\t\tthis.isFirst = false;\n\t\tthis.onLoaded();\n\t\tthis.changing = false;\n\t\tthis.loading = false;\n\t\treturn !this.allLoaded;\n\t}\n\t\n\tprivate setLoaded(data:any[]) {\n\t\tlet len = data.length;\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(data[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...data.reverse());\n\t\t\t}\n\t\t}\n\t}\n\n\tfindItem(item:any):T {\n\t\tlet pid = this.getPageId(item);\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\n\t\tif (index < 0) return;\n\t\treturn this._items[index];\n\t\t//let oldItem = this._items[index];\n\t\t//let oid = this.getPageId(oldItem);\n\t\t//if (pid === oid) return oldItem;\n\t}\n}\n","class MessageHub {\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\n    registerReceiveHandler(...args:any[]):number {\n\t\tlet seed = this.handlerSeed++;\n\t\tlet args0 = args[0];\n\t\tlet handler:(msg:any)=>Promise<void>;\n\t\tswitch (typeof args0) {\n\t\t\tcase 'string':\n\t\t\t\thandler = args[1];\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\n\t\t\t\tbreak;\n\t\t\tcase 'function':\n\t\t\t\tthis.anyHandlers[seed] = args0;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn seed;\n    }\n    unregisterReceiveHandler(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n    }\n    async dispatch(msg:any) {\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n        }\n    }\n}\n\nexport const messageHub = new MessageHub();\n","// typescript version of krasimir/navigo\n\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\n\nexport interface NamedRoute {\n\tas: string;\n\tuses: RouteFunc;\n\thooks?: Hooks;\n}\nexport interface Hooks {\n\tbefore: (done:()=>void, params:object) => void;\n\tafter: (params:object) => void;\n\tleave: (params:object) => void;\n\talready: (params:object) => void;\n}\ninterface Handler {\n\thandler: RouteFunc;\n\thooks: Hooks;\n}\ninterface LastResolved {\n\turl: string;\n\tquery: string;\n\thooks: Hooks;\n\tparams?: {[name:string]:string};\n\tname?: string;\n}\ninterface Route {\n\troute: string|RegExp;\n\thandler: RouteFunc,\n\tname: string,\n\thooks: Hooks\n}\n\nexport class Navigo {\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\n\tprivate static WILDCARD_REGEXP = /\\*/g;\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\n\tprivate static MATCH_REGEXP_FLAGS = '';\n\n\tprivate static isPushStateAvailable() {\n\t\treturn !!(\n\t\t  typeof window !== 'undefined' &&\n\t\t  window.history &&\n\t\t  window.history.pushState\n\t\t);\n\t}\n\t\n\tprivate static clean(s:string|RegExp) {\n\t\tif (s instanceof RegExp) return s;\n\t\treturn Navigo.cleanUrl(s);\n\t}\n\tprivate static cleanUrl(s:string) {\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\n\t}\n\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\n\t\tif (names.length === 0) return null;\n\t\tif (!match) return null;\n\t\treturn match\n\t\t  .slice(1, match.length)\n\t\t  .reduce((params, value, index) => {\n\t\t\t\tif (params === null) params = {};\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\n\t\t\t\treturn params;\n\t\t  }, null);\n\t}\n\t  \n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\n\t\tlet paramNames:string[] = [], regexp:RegExp;\n\t  \n\t\tif (route instanceof RegExp) {\n\t\t\tregexp = route;\n\t\t}\n\t\telse {\n\t\t\tregexp = new RegExp(\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\n\t\t\t\t\t\tparamNames.push(name);\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\n\t\t\t\t\t})\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\n\t\t}\n\t\treturn { regexp, paramNames };\n\t}\n\t  \n\tprivate static getUrlDepth(url:string):number {\n\t\treturn url.replace(/\\/$/, '').split('/').length;\n\t}\n\t  \n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\n\t}\n\t  \n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\n\t\treturn routes.map(route => {\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\n\t\t\treturn match ? { match, route, params } : false;\n\t\t}).filter(m => m);\n\t}\n\t  \n\tprivate static match(url:string, routes:Route[]) {\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\n\t}\n\t  \n\tprivate static root(url:string, routes:Route[]) {\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\n\t\tlet matched = routes.map(\n\t\t\troute => {\n\t\t\t\tlet r = route.route;\n\t\t\t\tif (r === '' || r === '*') return url;\n\t\t\t\tif (typeof r === 'string') {\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/\\\\w+');\n\t\t\t\t}\n\t\t\t\tlet routeExp = r + exp;\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t);\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\n\t\tlet len = matched.length;\n\t\tif (len === 0) return fallbackURL;\n\t\tlet matched0 = matched[0];\n\t\tif (len === 1) return matched0;\n\t\treturn matched.reduce((result, url) => {\n\t\t\tif (result.length > url.length) result = url;\n\t\t\treturn result;\n\t\t}, matched0);\n\t}\n\t  \n\tprivate static isHashChangeAPIAvailable() {\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\n\t}\n\t  \n\tprivate static extractGETParameters(url:string):string {\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\n\t}\n\t  \n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\n\t\tlet onlyURL = url, split:string[];\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\n\t  \n\t\tif (typeof hash === 'undefined') {\n\t\t\t// To preserve BC\n\t\t\thash = '#';\n\t\t}\n\t  \n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\n\t\t}\n\t\telse {\n\t\t\tsplit = url.split(hash);\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\n\t\t}\n\t\treturn onlyURL;\n\t}\n\t  \n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\n\t\tif (hooks && typeof hooks === 'object') {\n\t\t\tif (hooks.before) {\n\t\t\t\thooks.before((shouldRoute = true) => {\n\t\t\t\tif (!shouldRoute) return;\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\t}, params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (hooks.after) {\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\thandler();\n\t}\n\t  \n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tif (!url.match(hash)) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tlet split = url.split(hash);\n\t  \n\t\treturn split.length < 2 || split[1] === '';\n\t}\n\t\n\tprivate root:string;\n\tprivate _routes:Route[] = [];\n\tprivate _useHash:boolean;\n\tprivate _hash:string;\n\tprivate _paused:boolean;\n\tprivate _destroyed:boolean;\n\tprivate _lastRouteResolved:LastResolved;\n\tprivate _notFoundHandler:Handler;\n\tprivate _defaultHandler:Handler;\n\tprivate _usePushState:boolean;\n\tprivate _genericHooks:Hooks;\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\n\tprivate timout: any; //NodeJS.Timeout;\n\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\n\t\tthis.root = null;\n\t\tthis._useHash = useHash;\n\t\tthis._hash = (!hash)? '#' : hash;\n\t\tthis._paused = false;\n\t\tthis._destroyed = false;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._notFoundHandler = null;\n\t\tthis._defaultHandler = null;\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\n\t\tthis._genericHooks = null;\n\t\tthis._historyUpdateMethod = 'pushState';\n\t\n\t\tif (r) {\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\n\t\t} else if (useHash) {\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\n\t\t}\n\t\n\t\tthis._listen();\n\t\tthis.updatePageLinks();\n\t}\n  \n\tnavigate(path:string, absolute:boolean = false):Navigo {\n\t\tlet to:string;\n\t\tpath = path || '';\n\t\tif (this._usePushState) {\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\n\t\t\tthis._historyUpdate({}, '', to);\n\t\t\tthis.resolve();\n\t\t}\n\t\telse if (typeof window !== 'undefined') {\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\n\t\t\tlet {location} = window;\n\t\t\tlocation.href = location.href\n\t\t\t\t.replace(/#$/, '')\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\n\t\t}\n\t\treturn this;\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\tlet arg0 = args[0];\n\t\tlet arg1 = args[1];\n\t\tswitch (typeof arg0) {\n\t\t\tcase 'function':\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\n\t\t\t\tif (!this._notFoundHandler) {\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (args.length < 2) break;\n\t\t\t\tif (arg0 === '/') {\n\t\t\t\t\tthis._defaultHandler = { \n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \n\t\t\t\t\t\thooks: args[2],\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis._add(arg0, arg1, args[2]);\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this;\n\t}\n\n\toff(handler:RouteFunc):Navigo {\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\n\t\t\tthis._defaultHandler = null;\n\t\t}\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\n\t\t\tthis._notFoundHandler = null;\n\t\t}\n\t\tthis._routes = this._routes.reduce((result, r) => {\n\t\t\tif (r.handler !== handler) result.push(r);\n\t\t\treturn result;\n\t\t}, []);\n\t\treturn this;\n\t}\n\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\n\t\tthis._notFoundHandler = { handler, hooks };\n\t\treturn this;\n\t}\n\n\tresolve(current?:string) {\n\t\tlet c = current || this._cLoc();\n\t\tlet root = this._getRoot();\n\t\tlet url = c.replace(root, '');\n\t\n\t\tif (this._useHash) {\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\n\t\t}\n\t\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\n\t\n\t\tif (this._paused) return false;\n\t\n\t\tif (\n\t\t\tthis._lastRouteResolved &&\n\t\t\tonlyURL === this._lastRouteResolved.url &&\n\t\t\tGETParameters === this._lastRouteResolved.query\n\t\t) {\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\n\t\n\t\tlet manageHooks = (handler:Handler) => {\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tthis._callLeave();\n\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\thooks: handler.hooks\n\t\t\t\t\t};\n\t\t\t\t\thandler.handler(GETParameters);\n\t\t\t\t}, handler.hooks);\n\t\t\t}, this._genericHooks);\n\t\t}\n\n\t\tif (matched === false) {\n\t\t\tif (this._defaultHandler && (\n\t\t\t\tonlyURL === '' ||\n\t\t\t\tonlyURL === '/' ||\n\t\t\t\tonlyURL === this._hash ||\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\n\t\t\t)) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\n\t\t\t\t\t}, this._defaultHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._defaultHandler);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (this._notFoundHandler) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters,\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\n\t\t\t\t\t}, this._notFoundHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._notFoundHandler);\n\t\t\t}\n\t\t\treturn false;\t\n\t\t}\n\t\tlet m = matched;\n\t\tif (m) {\n\t\t\tthis._callLeave();\n\t\t\tthis._lastRouteResolved = {\n\t\t\t\turl: onlyURL,\n\t\t\t\tquery: GETParameters,\n\t\t\t\thooks: m.route.hooks,\n\t\t\t\tparams: m.params,\n\t\t\t\tname: m.route.name\n\t\t\t};\n\t\t\tlet handler = m.route.handler;\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tm.route.route instanceof RegExp ?\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\n\t\t\t\t\thandler(m.params, GETParameters);\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\n\t\t\t}, this._genericHooks, m.params);\n\t\t\treturn m;\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis._routes = [];\n\t\tthis._destroyed = true;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._genericHooks = null;\n\t\tclearTimeout(this.timout);\n\t\tif (typeof window !== 'undefined') {\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t}\n\n\tupdatePageLinks() {\n\t\t//var self = this;\n\t\tif (typeof document === 'undefined') return;\n\t\t\tthis._findLinks().forEach(link => {\n\t\t\tif (!link.hasListenerAttached) {\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\n\t\t\t\t\tvar location = this.getLinkPath(link);\n\t\t\n\t\t\t\t\tif (!this._destroyed) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlink.hasListenerAttached = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tgenerate(name:string, data:any = {}) {\n\t\tlet result = this._routes.reduce((result, route) => {\n\t\t\tif (route.name === name) {\n\t\t\t\tresult = route.route.toString();\n\t\t\t\tfor (let key in data) {\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}, '');\n\t\n\t\treturn this._useHash ? this._hash + result : result;\n\t}\n\n\tlink(path:string) {\n\t\treturn this._getRoot() + path;\n\t}\n\n\tpause(status:boolean = true) {\n\t\tthis._paused = status;\n\t\tif (status) {\n\t\t\tthis._historyUpdateMethod = 'replaceState';\n\t\t}\n\t\telse {\n\t\t\tthis._historyUpdateMethod = 'pushState';\n\t\t}\n\t}\n\n\tresume() {\n\t\tthis.pause(false);\n\t}\n\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\n\t\tthis._historyUpdateMethod = value;\n\t\treturn value;\n\t}\n\n\tdisableIfAPINotAvailable() {\n\t\tif (!Navigo.isPushStateAvailable()) {\n\t\t\tthis.destroy();\n\t\t}\n\t}\n\n\tlastRouteResolved() {\n\t\treturn this._lastRouteResolved;\n\t}\n\n\tgetLinkPath(link:any) {\n\t\treturn link.getAttribute('href');\n\t}\n\n\thooks(hooks:Hooks) {\n\t\tthis._genericHooks = hooks;\n\t}\n\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\n\t\tif (typeof route === 'string') {\n\t\t\troute = encodeURI(route);\n\t\t}\n\t\tthis._routes.push(\n\t\t\ttypeof handler === 'object' ?\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler: handler.uses,\n\t\t\t\tname: handler.as,\n\t\t\t\thooks: hooks || handler.hooks\n\t\t\t} \n\t\t\t:\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler, \n\t\t\t\tname: undefined,\n\t\t\t\thooks,\n\t\t\t}\n\t\t);\n\t\treturn this._add;\n\t}\n\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\n\t\tswitch (this._historyUpdateMethod) {\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\n\t\t}\n\t}\n\n\tprivate _getRoot() {\n\t\tif (this.root !== null) return this.root;\n\t\tlet cLoc = this._cLoc();\n\t\tlet cLocRoot = cLoc.split('?')[0];\n\t\tthis.root = Navigo.root(cLocRoot, this._routes);\n\t\treturn this.root;\n\t}\n\n\tprivate _listen() {\n\t\tif (this._usePushState) {\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\n\t\t}\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t\telse {\n\t\t\tlet cached = this._cLoc();\n\t\n\t\t\tlet check = () => {\n\t\t\t\tlet current = this._cLoc();\n\t\t\t\tif (cached !== current) {\n\t\t\t\t\tcached = current;\n\t\t\t\t\tthis.resolve();\n\t\t\t\t}\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\n\t\t\t\tthis.timout = setTimeout(check, 200);\n\t\t\t};\n\t\t\tcheck();\n\t\t}\n\t}\n\n\tprivate _cLoc() {\n\t\tif (typeof window !== 'undefined') {\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\n\t\t\t//}\n\t\t\treturn Navigo.cleanUrl(window.location.href);\n\t\t}\n\t\treturn '';\n\t}\n\n\tprivate _findLinks() {\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\n\t}\n\n\tprivate _onLocationChange = () => {\n\t\tconsole.log('_onLocationChange');\n\t\tthis.resolve();\n\t}\n\n\tprivate _callLeave() {\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\n\t\tif (lastRouteResolved) {\n\t\t\tlet {params, hooks} = lastRouteResolved;\n\t\t\tif (hooks) {\n\t\t\t\tif (hooks.leave) {\n\t\t\t\t\thooks.leave(params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//export default Navigo;\nexport const navigo = new Navigo();\n","import * as React from 'react';\nimport {nav} from '../nav';\n\nexport interface PageHeaderProps {\n    back?: 'back' | 'close' | 'none';\n    center: string | JSX.Element;\n    right?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n    className?: string;\n\tafterBack?: () => void;\n\tex?: JSX.Element;\n}\n\nexport function renderPageHeader(props: PageHeaderProps, inWebNav?: boolean) {\n    let onBack = async () => {\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\n\t\tlet {afterBack} = props;\n\t\tif (afterBack) afterBack();\n    }\n    let onLogoutClick = () => {\n\t\tlet logout = async () => {\n\t\t\tlet {logout} = props;\n\t\t\tif (typeof logout === 'function') {\n\t\t\t\tawait logout(); \n\t\t\t}\n\t\t\tawait nav.logout(undefined);\n\t\t}\n\t\tnav.showLogout(logout);\n    }\n\n\tlet b = nav.level > 1 || window.self !== window.top;\n\tlet {back, right, center, logout, className, ex} = props;\n\tif (inWebNav === true &&  !back && !right && !center) return;\n\tlet vBack:any, debugLogout:any;\n\tif (logout !== undefined && window.self === window.top) {\n\t\tif ((typeof logout === 'boolean' && logout === true)\n\t\t\t|| typeof logout === 'function')\n\t\t{\n\t\t\tlet {user} = nav;\n\t\t\tif (user !== undefined) {\n\t\t\t\tlet {nick, name} = user;\n\t\t\t\tdebugLogout = <div className=\"d-flex align-items-center\">\n\t\t\t\t\t<small className=\"text-light\">{nick || name}</small>\n\t\t\t\t\t{\n\t\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\t\t<div className=\"ml-2 py-2 px-3 cursor-pointer\"\n\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\tonClick={onLogoutClick}>\n\t\t\t\t\t\t\t<i className=\"fa fa-sign-out fa-lg\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</div>;\n\t\t\t}\n\t\t}\n\t}\n\tif (b) {\n\t\tswitch (props.back) {\n\t\t\tcase 'none':\n\t\t\t\tvBack = undefined;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\tcase 'back':\n\t\t\t\tvBack = <nav onClick={onBack}><i className=\"fa fa-angle-left\" /></nav>;\n\t\t\t\tbreak;\n\t\t\tcase 'close':\n\t\t\t\tvBack = <nav onClick={onBack}><i className=\"fa fa-close\" /></nav>;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tif (window.self !== window.top) {\n\t\tconsole.log(document.location.href);\n\t\t// pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\n\t}\n\tif (vBack === undefined && typeof center === 'string') {\n\t\tcenter = <div className=\"px-3\">{center}</div>;\n\t}\n\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\n\tlet header = <header className={className}>\n\t\t<nav>\n\t\t\t{vBack}\n\t\t\t{/*pop 弹出window暂时停止作用 */}\n\t\t\t<div>{center}</div>\n\t\t\t{rightView}\n\t\t</nav>\n\t\t{ex}\n\t</header>;\n\tif (inWebNav === true) return header;\n\treturn <>\n\t\t<section className=\"tv-page-header\">{header}</section>\n\t\t{header}\n\t</>;\n}\n\nexport class PageHeader extends React.Component<PageHeaderProps> {\n\trender() {return renderPageHeader(this.props)}\n\t/*\n    private back = async () => {\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\n\t\tlet {afterBack} = this.props;\n\t\tif (afterBack) afterBack();\n    }\n    openWindow() {\n        window.open(document.location.href);\n    }\n    private logoutClick = () => {\n        nav.showLogout(this.logout);\n    }\n    private logout = async () => {\n        let {logout} = this.props;\n        if (typeof logout === 'function') {\n            await logout(); \n        }\n        await nav.logout(undefined);\n    }\n    render() {\n        let b = nav.level > 1 || window.self !== window.top;\n        let {right, center, logout, className, ex} = this.props;\n        let back:any, debugLogout:any;\n        if (logout !== undefined && window.self === window.top) {\n            if ((typeof logout === 'boolean' && logout === true)\n                || typeof logout === 'function')\n            {\n                let {user} = nav;\n                if (user !== undefined) {\n                    let {nick, name} = user;\n                    debugLogout = <div className=\"d-flex align-items-center\">\n                        <small className=\"text-light\">{nick || name}</small>\n                        {\n                            // eslint-disable-next-line\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\n                                role=\"button\"\n                                onClick={this.logoutClick}>\n                                <i className=\"fa fa-sign-out fa-lg\" />\n                            </div>\n                        }\n                    </div>;\n                }\n            }\n        }\n        if (b) {\n            switch (this.props.back) {\n                case 'none':\n                    back = undefined;\n                    break;\n                default:\n                case 'back':\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\n                    break;\n                case 'close':\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\n                    break;\n            }\n        }\n        if (window.self !== window.top) {\n            console.log(document.location.href);\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\n        }\n        if (back === undefined && typeof center === 'string') {\n            center = <div className=\"px-3\">{center}</div>;\n        }\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\n\t\tlet header = <header className={className}>\n\t\t\t<nav>\n\t\t\t\t{back}\n\t\t\t\t<div>{center}</div>\n\t\t\t\t{rightView}\n\t\t\t</nav>\n\t\t\t{ex}\n\t\t</header>;\n        return <>\n\t\t\t<section className=\"tv-page-header\">{header}</section>\n\t\t\t{header}\n\t\t</>;\n\t}\n\t*/\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport classNames from 'classnames';\nimport { IVPage } from './page';\nimport { IObservableValue } from 'mobx/lib/internal';\nimport '../../css/va-tab.css';\nimport { ScrollView } from './scrollView';\n\nexport type TabCaption = (selected:boolean) => JSX.Element;\n\nexport interface TabProp {\n    name: string;\n    caption: TabCaption;\n\tcontent?: () => JSX.Element;\n\tpage?: IVPage;\n    notify?: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tisSelected?: boolean;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n}\n\nexport interface TabsProps {\n    tabs: TabProp[];\n    tabPosition?: 'top' | 'bottom';\n    size?: 'sm' | 'lg' | 'md';\n    tabBg?: string;\n    contentBg?: string;\n    sep?: string;\n    selected?: string;\n    borderColor?: string;\n    borderWidth?: string;\n}\n\nclass Tab {\n\t@observable private loaded: boolean = false;\n    name: string;\n    @observable selected: boolean;\n    caption: TabCaption;\n\tcontentBuilder: ()=>JSX.Element;\n\tpage: IVPage;\n    notify: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n\n    private _content: JSX.Element;\n    \n    get content(): JSX.Element {\n\t\tif (this.load && this.loaded === false) return null;\n\t\tif (this.selected === false) return this._content;\n\t\tif (!this._content) {\n\t\t\tif (this.contentBuilder !== undefined) {\n\t\t\t\tthis._content = this.contentBuilder();\n\t\t\t}\n\t\t\telse if (this.page !== undefined) {\n\t\t\t\tthis._content = this.page.content();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\n\t\t\t}\n\t\t}\n\t\treturn this._content;\n    }\n\n    async shown() {\n        if (this.onShown !== undefined) {\n            await this.onShown();\n        }\n        if (this.load !== undefined) {\n\t\t\tif (this.loaded === false) {\n\t\t\t\tawait this.load();\n\t\t\t\tthis.loaded = true;\n\t\t\t}\n        }\n    }\n}\n\nexport const TabCaptionComponent = (label:string, icon:string, color:string) => <div \n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\n    <small>{label}</small>\n</div>;\n\nexport const TabCaption = TabCaptionComponent;\n\nexport class TabsView {\n\tprivate props: TabsProps;\n    private size: string;\n    private tabBg: string;\n    //private contentBg: string;\n    private sep: string;\n    @observable private selectedTab: Tab;\n    @observable private tabArr: Tab[];\n\n    constructor(props: TabsProps) {\n\t\tthis.props = props;\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\n\t\tthis.size = size || 'md';\n        this.tabArr = tabs.map(v => {\n            let tab = new Tab();\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\ttab.name = name;\n\t\t\tif (isSelected === true || name === selected) {\n\t\t\t\tthis.selectedTab = tab;\n\t\t\t}\n\t\t\ttab.selected = false;\n\t\t\ttab.caption = caption;\n\t\t\tif (content !== undefined) {\n\t\t\t\ttab.contentBuilder = content;\n\t\t\t}\n\t\t\telse if (page !== undefined) {\n\t\t\t\ttab.page = page;\n\t\t\t\t//contentBuilder = () => {return page.content()};\n\t\t\t}\n            tab.notify = notify;\n            tab.load = load;\n\t\t\ttab.onShown = onShown;\n\t\t\ttab.onScroll = onScroll;\n\t\t\ttab.onScrollTop = onScrollTop;\n\t\t\ttab.onScrollBottom = onScrollBottom;\n\t\t\ttab.className = className;\n            return tab;\n        });\n        this.tabBg = tabBack;\n        //this.contentBg = contentBack;\n        this.sep = sep;\n        if (this.selectedTab === undefined) {\n\t\t\tthis.selectedTab = this.tabArr[0];\n\t\t}\n        this.selectedTab.selected = true;\n    }\n\n    tabClick = async (tab:Tab) => {\n\t\tif (!tab) {\n\t\t\ttab = this.selectedTab;\n\t\t\tif (tab === undefined) {\n\t\t\t\tif (this.tabArr === undefined) return;\n\t\t\t\tif (this.tabArr.length === 0) return;\n\t\t\t\ttab = this.tabArr[0];\n\t\t\t}\n\t\t}\n\n        this.selectedTab.selected = false;\n        tab.selected = true;\n\t\tthis.selectedTab = tab;\n\t\t\n\t\tawait tab.shown();\n    }\n\n\t/*\n    showTab(tabName: string) {\n        let tab = this.tabs.find(v => v.name === tabName);\n        if (tab === undefined) return;\n        if (this.selectedTab !== undefined) this.selectedTab.selected = false;\n        tab.selected = true;\n        this.selectedTab = tab;\n\t}\n\t*/\n\n\tprivate tabs = observer(() => {\n        let {tabPosition, borderColor} = this.props;\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\n        if (borderColor) {\n            bsCur = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderLeftWidth: 1,\n                borderRightWidth: 1,\n                borderBottomWidth: 1,\n            }\n            bsTab = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderBottomWidth: 1,\n                borderLeftWidth: 0,\n                borderRightWidth: 0,\n            }\n            if (tabPosition === 'top') {\n                bsCur.borderBottomWidth = 0;\n                bsCur.borderTopLeftRadius = 10;\n                bsCur.borderTopRightRadius = 10;\n                bsTab.borderTopWidth = 0;\n            }\n            else {\n                bsCur.borderTopWidth = 0;\n                bsCur.borderBottomLeftRadius = 10;\n                bsCur.borderBottomRightRadius = 10;\n                bsTab.borderBottomWidth = 0;\n            }\n        }\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\n\t\tlet tabs = <div className={cn}>\n            {this.tabArr.map((v,index) => {\n                let {selected, caption, notify} = v;\n                let notifyCircle:any;\n                if (notify !== undefined) {\n                    let num = notify.get();\n                    if (num !== undefined) {\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\n                    }\n                }\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\n\t\t\t\t\t<div>\n\t\t\t\t\t{notifyCircle}\n\t\t\t\t\t{caption(selected)}\n\t\t\t\t\t</div>\n                </div>\n            })}\n\t\t</div>;\n\t\treturn tabs;\n\t});\n\n\tcontent = observer(() => {\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\n\t\treturn <>\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet {tabPosition} = this.props;\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\t\tlet tabs = React.createElement(this.tabs);\n\t\t\t\tlet pageHeader:any, pageFooter:any;\n\t\t\t\tif (page !== undefined) {\n\t\t\t\t\tpageHeader = page.header();\n\t\t\t\t\tpageFooter = page.footer();\n\t\t\t\t}\n\t\t\t\tlet header:any, footer:any;\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\n\t\t\t\tif (tabPosition === 'top') {\n\t\t\t\t\theader = <>\n\t\t\t\t\t\t<section className=\"tv-page-header\">\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\n\t\t\t\t\t</>;\n\t\t\t\t\tif (pageFooter !== undefined) {\n\t\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pageHeader !== undefined) {\n\t\t\t\t\t\theader = <>\n\t\t\t\t\t\t\t<section className='tv-page-header'>\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t<section className='tv-page-footer'>\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</>;\n\t\t\t\t}\n\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = displayNone;\n\t\t\t\treturn <ScrollView key={index} className={className}\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\n\t\t\t\t\t{header}\n\t\t\t\t\t{content}\n\t\t\t\t\t{footer}\n\t\t\t\t</ScrollView>;\n\t\t\t})}\n\t\t</>;\n\t});\n\n    render() {\n\t\tlet {tabPosition} = this.props;\n\t\tlet tabs = React.createElement(this.tabs);\n\t\tlet header:any, footer:any;\n\t\tlet visibility:React.CSSProperties = {display:'none'};\n\t\tif (tabPosition === 'top') {\n\t\t\theader = <header>{tabs}</header>;\n\t\t}\n\t\telse {\n\t\t\tfooter = <footer>{tabs}</footer>;\n\t\t}\n\t\treturn <>\n\t\t\t{header}\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = visibility;\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\n\t\t\t\t\t{v.content}\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t\t{footer}\n\t\t</>;\n    }\n};\n\n@observer export class Tabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn this.tabsView.render();\n    }\n};\n\n@observer export class RootTabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn React.createElement(this.tabsView.content);\n    }\n};\n","import * as React from 'react';\nimport { nav } from './nav';\nimport { Loading } from './loading';\nimport { Image as ImageControl } from './image';\nimport { Page } from './page/page';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { LMR } from './simple';\n\nexport interface ResUploaderProps {\n    className?: string;\n    label?: string;\n    multiple?: boolean;\n    maxSize?: number;\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\n@observer\nexport class ResUploader extends React.Component<ResUploaderProps> {\n    private fileInput: HTMLInputElement;\n    @observable private fileName: string;\n\n    buildFormData():FormData {\n        let {maxSize} = this.props;\n        if (maxSize === undefined || maxSize <= 0) \n            maxSize = 100000000000;\n        else\n            maxSize = maxSize * 1024;\n        var files:FileList = this.fileInput.files;\n        var data = new FormData();\n        let len = files.length;\n        for (let i=0; i<len; i++) {\n            let file = files[i];\n            if (file.size > maxSize) return null;\n            data.append('files[]', file, file.name);\n        }\n    }\n\n    getFile0(): File {\n        return this.fileInput.files[0];\n    }\n\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\n        let resUrl = nav.resUrl + 'upload';\n        if (!formData) formData = this.buildFormData();\n        try {\n            nav.startWait();\n            //let headers = new Headers();\n            //headers.append('Access-Control-Allow-Origin', '*');\n            let headers:{[name:string]: string} = {}; //new Headers();\n            headers['Access-Control-Allow-Origin'] = '*';\n                //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \n            //let abortController = new AbortController();\n            let res = await fetch(resUrl, {\n                method: \"POST\",\n                body: formData,\n                headers: headers,\n                //signal: abortController.signal,\n            });\n            let json = await res.json();\n            return ':' + json.res.id;\n        }\n        catch (err) {\n            console.error('%s %s', resUrl, err);\n            return {error:err};\n        }\n        finally {\n            nav.endWait();\n        }\n    }\n\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let {onFilesChange} = this.props;\n        if (onFilesChange) onFilesChange(evt);\n        let files = evt.target.files;\n        let len = files.length;\n        let names:string[] = [];\n        for (let i=0; i<len; i++) {\n            names.push(files.item(i).name);\n        }\n        this.fileName = names.join(', ');\n    }\n\n    render() {\n        let {className, multiple, label} = this.props;\n        return <div>\n                <label className=\"btn btn-outline-success\">\n                    {label || '选择文件'} \n                    <input \n                        className={className}\n                        ref={t=>this.fileInput=t} \n                        onChange={this.onFilesChange}\n                        type='file' name='file' \n                        multiple={multiple} style={{display:'none'}} />\n                </label>\n                &nbsp;\n                {this.fileName}\n            </div>\n    }\n}\n\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\n    var unit;\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    while ( (unit = units.shift()) && size > 1024 ) {\n        size = size / 1024;\n    }\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\n}\n\ninterface ImageUploaderProps {\n    id?: string;\n    label?: string;\n    size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw';\n\tonSaved?: (imageId:string) => Promise<void>;\n\timageTypes?: string[];\n}\n\nconst xlargeSize = 1600;\nconst largeSize = 800;\nconst mediumSize = 400;\nconst smallSize = 180;\n\n@observer\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\n\tprivate imgBaseSize: number;\n\tprivate imageTypes: string[];\n    private suffix: string;\n    private resUploader: ResUploader;\n    @observable private file: File;    \n    @observable private desImgWidth: number;\n    @observable private desImgHeight: number;\n    @observable private desImgSize: number;\n    @observable private srcImgWidth: number;\n    @observable private srcImgHeight: number;\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private srcImage: string;\n    @observable private desImage: string;\n    @observable private fileError: string;\n    @observable private uploaded: boolean = false;\n\n    constructor(props: ImageUploaderProps) {\n        super(props);\n\t\tthis.resId = props.id;\n\t\tthis.imageTypes = props.imageTypes || ImageUploader.imageTypes;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(this.imageTypes.indexOf(this.suffix) < 0){\n                this.fileError = `图片类型必须是 ${this.imageTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.srcImage = reader.result as string;\n\t\t\t\tswitch (this.suffix ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tawait this.setSize(this.props.size);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'svg':\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\n\t\t\t\t\t\tthis.desImage = this.srcImage;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n            };\n        }\n    }\n\n    private async setSize(size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw') {\n        switch (size) {\n            default:\n            case 'sm':\n                this.imgBaseSize = smallSize; break;\n            case 'md':\n                this.imgBaseSize = mediumSize; break;\n            case 'lg':\n\t\t\t\tthis.imgBaseSize = largeSize; break;\n\t\t\tcase 'xl':\n\t\t\t\tthis.imgBaseSize = xlargeSize; break;\n\t\t\tcase 'raw':\n\t\t\t\tthis.imgBaseSize = -1; break;\n\t\t}\n\t\tthis.desImage = await this.compress();\n    }\n\n    private compress = ():Promise<string> => {\n        return new Promise<string>((resolve, reject) => {\n            var img = new Image();\n            img.src = this.srcImage;\n            img.onload = () => {\n                //var that = this;\n                // 默认按比例压缩\n                let {width, height} = img;\n                this.srcImgWidth = width;\n                this.srcImgHeight = height;\n                let scale = width / height;\n\t\t\t\tlet w:number, h:number;\n\t\t\t\tif (this.imgBaseSize < 0) {\n\t\t\t\t\tw = width;\n\t\t\t\t\th = height;\n\t\t\t\t}\n                else if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\n                    w = width;\n                    h = height;\n                }\n                else if (scale < 0) {\n                    w = this.imgBaseSize;\n                    h = w / scale;\n                }\n                else {\n                    h = this.imgBaseSize;\n                    w = h * scale;\n                }\n                this.desImgWidth = Math.round(w);\n                this.desImgHeight = Math.round(h);\n                var quality = 0.7;  // 默认图片质量为0.7\n                //生成canvas\n                var canvas = document.createElement('canvas');\n                var ctx = canvas.getContext('2d');\n                // 创建属性节点\n                var anw = document.createAttribute(\"width\");\n                anw.nodeValue = String(w);\n                var anh = document.createAttribute(\"height\");\n                anh.nodeValue = String(h);\n                canvas.setAttributeNode(anw);\n                canvas.setAttributeNode(anh);\n                ctx.drawImage(img, 0, 0, w, h);\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\n                let blob = this.convertBase64UrlToBlob(base64);\n                this.desImgSize = blob.size;\n                if (this.desImgSize > 3*1024*1024) {\n                    this.fileError = \"图片大于3M，无法上传\";\n                    this.enableUploadButton = false;\n                }\n                resolve(base64);\n            }\n        });\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.desImage);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    private showOrgImage = () => {\n        nav.push(<Page header=\"原图\">\n            <div className=\"p-3 text-center\">\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\n            </div>\n        </Page>);\n    }\n\n    private levelDiv() {\n        if (this.props.size) return;\n        let arr = [{caption:'小图', size:'sm'}];\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\n            arr.push({caption:'中图', size:'md'});\n        }\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\n            arr.push({caption:'大图', size:'lg'});\n        }\n        if (this.srcImgHeight > xlargeSize || this.srcImgWidth > xlargeSize) {\n\t\t\tarr.push({caption:'超大图', size:'xl'});\n\t\t\tarr.push({caption:'原图', size:'raw'});\n        }\n        if (arr.length < 2) return;\n        return <div>{arr.map((v, index) => {\n            let {caption, size} = v;\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \n                onChange={()=>this.setSize(size as any)}\n                defaultChecked={index===0} /> {caption}</label>;\n        })}</div>\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改图片'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择图片文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {this.imageTypes.join(', ')} 格式图片。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                    <LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n                            :\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\n                                <div className=\"mr-5\">\n                                    {this.levelDiv()}\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\n                                    &nbsp; &nbsp;\n                                    文件大小：{formatSize(this.desImgSize)}\n                                    </div>\n                                </div>\n                                <button className=\"btn btn-primary\" \n                                    disabled={!this.enableUploadButton}\n                                    onClick={this.upload}>上传</button>\n                            </div>\n                    }\n                    right={this.desImage && \n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\n                            原图大小: {formatSize(this.file.size)}<br/>\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\n                        </button>\n                    }\n                    ></LMR>\n                </div>\n                <div className=\"text-center\" \n                    style={{\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\n                        padding: '8px'\n                    }}>\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\ninterface AudioUploaderProps {\n    id?: string;\n    label?: string;\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\n@observer\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\n\tprivate static audioTypes = ['mp3', 'wav'];\n\n    private suffix: string;\n\tprivate resUploader: ResUploader;\n\t@observable private content: string;\n\t@observable private file: File;    \n\t@observable private fileSize: number;\n\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private fileError: string;\n\t@observable private uploaded: boolean = false;\n\t@observable private uploading: boolean = false;\n\n    constructor(props: AudioUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.content = reader.result as string;\n\t\t\t\tthis.fileSize = this.content.length;\n            };\n        }\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n\t\tif (!this.resUploader) return;\n\t\tthis.uploading = true;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.content);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改文件'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择音频文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                </div>\n            </div>\n\t\t\t<LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\tthis.uploading === true?\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t/>\n        </Page>;\n    }\n}\n","import _ from 'lodash';\nimport { UqApi, UqData, UnitxApi, appInFrame } from '../net';\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\nimport { Action } from './action';\nimport { Sheet } from './sheet';\nimport { Query } from './query';\nimport { Book } from './book';\nimport { History } from './history';\nimport { Map } from './map';\nimport { Pending } from './pending';\nimport { CreateBoxId, BoxId } from './tuid';\nimport { LocalMap, LocalCache } from '../tool';\nimport { UQsMan } from './uqsMan';\nimport { ReactBoxId } from './tuid/reactBoxId';\nimport { Tag } from './tag/tag';\n\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\n    | 'datetime' | 'date' | 'time' | 'timestamp';\n\nexport function fieldDefaultValue(type:FieldType) {\n    switch (type) {\n        case 'tinyint':\n        case 'smallint':\n        case 'int':\n        case 'bigint':\n        case 'dec':\n            return 0;\n        case 'char':\n        case 'text':\n            return '';\n        case 'datetime':\n        case 'date':\n            return '2000-1-1';\n        case 'time':\n            return '0:00';\n    }\n}\n\nexport interface Field {\n    name: string;\n    type: FieldType;\n    tuid?: string;\n    arr?: string;\n    null?: boolean;\n    size?: number;\n    owner?: string;\n    _tuid: TuidBox;\n}\nexport interface ArrFields {\n    name: string;\n    fields: Field[];\n    id?: string;\n    order?: string;\n}\nexport interface FieldMap {\n    [name:string]: Field;\n}\nexport interface SchemaFrom {\n    owner:string;\n    uq:string;\n}\nexport interface TuidModify {\n    max: number;\n    seconds: number;\n}\n\nexport class UqMan {\n    private readonly actions: {[name:string]: Action} = {};\n    private readonly sheets: {[name:string]: Sheet} = {};\n    private readonly queries: {[name:string]: Query} = {};\n    private readonly books: {[name:string]: Book} = {};\n    private readonly maps: {[name:string]: Map} = {};\n    private readonly histories: {[name:string]: History} = {};\n\tprivate readonly pendings: {[name:string]: Pending} = {};\n\tprivate readonly tags: {[name:string]: Tag} = {};\n    private readonly tuidsCache: TuidsCache;\n    private readonly localAccess: LocalCache;\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\n    readonly localMap: LocalMap;\n    readonly localModifyMax: LocalCache;\n    readonly tuids: {[name:string]: Tuid} = {};\n    readonly createBoxId: CreateBoxId;\n    readonly newVersion: boolean;\n    readonly uqOwner: string;\n    readonly uqName: string;\n    readonly name: string;\n    readonly uqApi: UqApi;\n    readonly id: number;\n\n    uqVersion: number;\n\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\n        this.createBoxId = createBoxId;\n        if (createBoxId === undefined) {\n            this.createBoxId = this.createBoxIdFromTVs;\n            this.tvs = tvs || {};\n        }\n        let {id, uqOwner, uqName, access, newVersion: clearTuids} = uqData;\n        this.newVersion = clearTuids;\n        this.uqOwner = uqOwner;\n        this.uqName = uqName;\n        this.id = id;\n        this.name = uqOwner + '/' + uqName;\n        this.uqVersion = 0;\n        this.localMap = uqs.localMap.map(this.name);\n        this.localModifyMax = this.localMap.child('$modifyMax');\n        this.localAccess = this.localMap.child('$access');\n        //let hash = document.location.hash;\n        let baseUrl = 'tv/';\n\n        let acc: string[];\n        if (access === null || access === undefined || access === '*') {\n            acc = [];\n        }\n        else {\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\n        }\n        if (this.name === '$$$/$unitx') {\n            // 这里假定，点击home link之后，已经设置unit了\n            // 调用 UnitxApi会自动搜索绑定 unitx service\n            this.uqApi = new UnitxApi(appInFrame.unit);\n        }\n        else {\n            let {appOwner, appName} = uqs;\n            this.uqApi = new UqApi(baseUrl, appOwner, appName, uqOwner, uqName, acc, true);\n        }\n        this.tuidsCache = new TuidsCache(this);\n    }\n\n    get entities() {\n        return _.merge({}, \n            this.actions, this.sheets, this.queries, this.books,\n\t\t\tthis.maps, this.histories, this.pendings, this.tuids,\n\t\t\tthis.tags,\n        );\n    }\n\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\n        let {name} = tuid;\n        /*\n        let tuidUR = this.tuidURs[name];\n        if (tuidUR === undefined) {\n            let {ui, res} = this.getUI(tuid);\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\n        }\n        */\n        return new ReactBoxId(id, tuid, this.tvs[name]);\n    }\n\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\n    tuidDiv(name:string, div:string):TuidDiv {\n        let tuid = this.tuids[name.toLowerCase()]\n        return tuid && tuid.div(div.toLowerCase());\n    }\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\n    book(name:string):Book {return this.books[name.toLowerCase()]}\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\n    history(name:string):History {return this.histories[name.toLowerCase()]}\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\n\n    sheetFromTypeId(typeId:number):Sheet {\n        for (let i in this.sheets) {\n            let sheet = this.sheets[i];\n            if (sheet.typeId === typeId) return sheet;\n        }\n    }\n\n    readonly tuidArr: Tuid[] = [];\n    readonly actionArr: Action[] = [];\n    readonly sheetArr: Sheet[] = [];\n    readonly queryArr: Query[] = [];\n    readonly bookArr: Book[] = [];\n    readonly mapArr: Map[] = [];\n    readonly historyArr: History[] = [];\n    readonly pendingArr: Pending[] = [];\n    readonly tagArr: Tag[] = [];\n\n    async init() {\n        await this.uqApi.init();\n    }\n\n    async loadEntities(): Promise<string> {\n        try {\n            let accesses = this.localAccess.get();\n            if (!accesses) {\n                accesses = await this.uqApi.loadAccess();\n            }\n            if (!accesses) return;\n            this.buildEntities(accesses);\n        }\n        catch (err) {\n            return err;\n        }\n    }\n\n\tbuildEntities(entities:any) {\n        if (entities === undefined) {\n            debugger;\n        }\n        this.localAccess.set(entities);\n        let {access, tuids, version} = entities;\n        this.uqVersion = version;\n        this.buildTuids(tuids);\n        this.buildAccess(access);\n\t}\n\t\n    private buildTuids(tuids:any) {\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let {typeId, from} = schema;\n            let tuid = this.newTuid(i, typeId, from);\n            tuid.sys = true;\n        }\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let tuid = this.getTuid(i);\n            tuid.setSchema(schema);\n        }\n        for (let i in this.tuids) {\n            let tuid = this.tuids[i];\n            tuid.buildFieldsTuid();\n        }\n\t}\n\n    async loadEntitySchema(entityName: string): Promise<any> {\n        return await this.uqApi.schema(entityName);\n    }\n\n    getTuid(name:string): Tuid {\n        return this.tuids[name];\n    }\n\n    private buildAccess(access:any) {\n        for (let a in access) {\n            let v = access[a];\n            switch (typeof v) {\n                case 'string': this.fromType(a, v); break;\n                case 'object': this.fromObj(a, v); break;\n            }\n        }\n    }\n\n    cacheTuids(defer:number) {\n        this.tuidsCache.cacheTuids(defer);\n    }\n\n    newAction(name:string, id:number):Action {\n        let action = this.actions[name];\n        if (action !== undefined) return action;\n        action = this.actions[name] = new Action(this, name, id)\n        this.actionArr.push(action);\n        return action;\n    }\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\n        let tuid = this.tuids[name];\n        if (tuid !== undefined) return tuid;\n        if (from !== undefined)\n            tuid = new TuidImport(this, name, id, from);\n        else\n            tuid = new TuidInner(this, name, id);\n        this.tuids[name] = tuid;\n        this.tuidArr.push(tuid);\n        return tuid;\n    }\n    newQuery(name:string, id:number):Query {\n        let query = this.queries[name];\n        if (query !== undefined) return query;\n        query = this.queries[name] = new Query(this, name, id)\n        this.queryArr.push(query);\n        return query;\n    }\n    private newBook(name:string, id:number):Book {\n        let book = this.books[name];\n        if (book !== undefined) return book;\n        book = this.books[name] = new Book(this, name, id);\n        this.bookArr.push(book);\n        return book;\n    }\n    private newMap(name:string, id:number):Map {\n        let map = this.maps[name];\n        if (map !== undefined) return map;\n        map = this.maps[name] = new Map(this, name, id)\n        this.mapArr.push(map);\n        return map;\n    }\n    private newTag(name:string, id:number):Tag {\n        let tag = this.tags[name];\n        if (tag !== undefined) return tag;\n        tag = this.tags[name] = new Tag(this, name, id)\n        this.tagArr.push(tag);\n        return tag;\n    }\n    private newHistory(name:string, id:number):History {\n        let history = this.histories[name];\n        if (history !== undefined) return;\n        history = this.histories[name] = new History(this, name, id)\n        this.historyArr.push(history);\n        return history;\n    }\n    private newPending(name:string, id:number):Pending {\n        let pending = this.pendings[name];\n        if (pending !== undefined) return;\n        pending = this.pendings[name] = new Pending(this, name, id)\n        this.pendingArr.push(pending);\n        return pending;\n    }\n    newSheet(name:string, id:number):Sheet {\n        let sheet = this.sheets[name];\n        if (sheet !== undefined) return sheet;\n        sheet = this.sheets[name] = new Sheet(this, name, id);\n        this.sheetArr.push(sheet);\n        return sheet;\n    }\n    private fromType(name:string, type:string) {\n        let parts = type.split('|');\n        type = parts[0];\n        let id = Number(parts[1]);\n        switch (type) {\n            //case 'uq': this.id = id; break;\n            case 'tuid':\n                // Tuid should not be created here!;\n                //let tuid = this.newTuid(name, id);\n                //tuid.sys = false;\n                break;\n            case 'action': this.newAction(name, id); break;\n            case 'query': this.newQuery(name, id); break;\n            case 'book': this.newBook(name, id); break;\n            case 'map': this.newMap(name, id); break;\n            case 'history': this.newHistory(name, id); break;\n            case 'sheet':this.newSheet(name, id); break;\n\t\t\tcase 'pending': this.newPending(name, id); break;\n\t\t\tcase 'tag': this.newTag(name, id); break;\n        }\n    }\n    private fromObj(name:string, obj:any) {\n        switch (obj['$']) {\n            case 'sheet': this.buildSheet(name, obj); break;\n        }\n    }\n    private buildSheet(name:string, obj:any) {\n        let sheet = this.sheets[name];\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\n        sheet.build(obj);\n    }\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\n        if (fields === undefined) return;\n        for (let f of fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.getTuid(tuid);\n            if (t === undefined) continue;\n            f._tuid = t.buildTuidBox();\n        }\n        for (let f of fields) {\n            let {owner} = f;\n            if (owner === undefined) continue;\n            let ownerField = fields.find(v => v.name === owner);\n            if (ownerField === undefined) {\n                if (mainFields !== undefined) {\n                    ownerField = mainFields.find(v => v.name === owner);\n                }\n                if (ownerField === undefined) {\n                    debugger;\n                    throw new Error(`owner field ${owner} is undefined`);\n                }\n            }\n            let {arr, tuid} = f;\n            let t = this.getTuid(ownerField._tuid.tuid.name);\n            if (t === undefined) continue;\n            let div = t.div(arr || tuid);\n            f._tuid = div && div.buildTuidDivBox(ownerField);\n            if (f._tuid === undefined) {\n                debugger;\n                throw new Error(`owner field ${owner} is not tuid`);\n            }\n        }\n    }\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\n        if (arrFields === undefined) return;\n        for (let af of arrFields) {\n            let {fields} = af;\n            if (fields === undefined) continue;\n            this.buildFieldTuid(fields, mainFields);\n        }\n    }\n\n    pullModify(modifyMax:number) {\n        this.tuidsCache.pullModify(modifyMax);\n    }\n}\n","import { Entity } from './entity';\nimport { PageItems } from '../tool/pageItems';\nimport { EntityCaller } from './caller';\n\nexport interface SheetState {\n    name: string;\n    actions: SheetAction[];\n}\n\nexport interface SheetAction {\n    name: string;\n}\n\nexport interface StateCount {\n    state: string;\n    count: number;\n}\n\nexport class Sheet extends Entity {\n    get typeName(): string { return 'sheet';}\n    states: SheetState[];\n\n    /*\n    setStates(states: SheetState[]) {\n        for (let state of states) {\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\n        }\n    }*/\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.states = schema.states;\n    }\n    build(obj:any) {\n        this.states = [];\n        for (let op of obj.ops) {\n            this.states.push({name: op, actions:undefined});\n        }\n        /*\n        for (let p in obj) {\n            switch(p) {\n                case '#':\n                case '$': continue;\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\n            }\n        }*/\n    }\n    private createSheetState(name:string, obj:object):SheetState {\n        let ret:SheetState = {name:name, actions:[]};\n        let actions = ret.actions;\n        for (let p in obj) {\n            let action:SheetAction = {name: p};\n            actions.push(action);\n        }\n        return ret;\n    }\n    /*\n    private setStateAccess(s:SheetState, s1:SheetState) {\n        if (s === undefined) return;\n        for (let action of s1.actions) {\n            let acn = action.name;\n            let ac = s.actions.find(a=>a.name === acn);\n            if (ac === undefined) continue;\n            s.actions.push(action);\n        }\n    }*/\n    async save(discription:string, data:any):Promise<any> {\n        /*\n        await this.loadSchema();\n        let {id} = this.uq;\n        let text = this.pack(data);\n\n        let ret = await this.uqApi.sheetSave(this.name, );\n        return ret;\n        */\n        let {id} = this.uq;\n        //let text = this.pack(data);\n        let params = {app: id, discription: discription, data:data};\n        return await new SaveCaller(this, params).request();\n        /*\n        let {id, state} = ret;\n        if (id > 0) this.changeStateCount(state, 1);\n        return ret;\n        */\n    }\n    async action(id:number, flow:number, state:string, action:string) {\n        /*\n        await this.loadSchema();\n        return await this.uqApi.sheetAction(this.name, {id:id, flow:flow, state:state, action:action});\n        */\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\n    }\n    private unpack(data:any):any {\n        //if (this.schema === undefined) await this.loadSchema();\n        let ret = data[0];\n        let brief = ret[0];\n        let sheetData = this.unpackSheet(brief.data);\n        let flows = data[1];\n        return {\n            brief: brief,\n            data: sheetData,\n            flows: flows,\n        }\n    }\n    async getSheet(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.getSheet(this.name, id);\n        */\n        let ret = await new GetSheetCaller(this, id).request();\n        if (ret[0].length === 0) return await this.getArchive(id);\n        return this.unpack(ret);\n    }\n    async getArchive(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchive(this.name, id)\n        return this.unpack(ret);\n        */\n        let ret = await new SheetArchiveCaller(this, id).request();\n        return this.unpack(ret);\n    }\n\n    async getArchives(pageStart:number, pageSize:number) {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {pageStart:pageStart, pageSize:pageSize};\n        return await new SheetArchivesCaller(this, params).request();\n    }\n\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new StateSheetsCaller(this, params).request();\n    }\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\n\n    async stateSheetCount():Promise<StateCount[]> {\n        /*\n        await this.loadSchema();\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\n        return this.states.map(s => {\n            let n = s.name, count = 0;\n            let r = ret.find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n        */\n        return await new StateSheetCountCaller(this, undefined).request();\n    }\n\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\n        return await new UserSheetsCaller(this, params).request();\n    }\n\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new MySheetsCaller(this, params).request();\n    }\n}\n\n\nabstract class SheetCaller<T> extends EntityCaller<T> {\n    protected get entity(): Sheet {return this._entity as Sheet;}\n    protected readonly suffix:string;\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\n}\n\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\n    get path():string {return `sheet/${this.entity.name}`;}\n    buildParams() {\n        let {app, discription, data} = this.params;\n        return {\n            app: app,\n            discription: discription,\n            data: this.entity.pack(data)\n        };\n    }\n}\n\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\n    method = 'PUT';\n    get path():string {return `sheet/${this.entity.name}`;}\n    //buildParams() {return this.entity.buildParams(this.params);}\n}\n\nclass GetSheetCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //private id:number;\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\n}\n\nclass SheetArchiveCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\n}\n\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'archives';\n}\n\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'states';\n}\n\nclass StateSheetCountCaller extends SheetCaller<undefined> {\n    method = 'GET';\n    protected readonly suffix = 'statecount';\n    xresult(res:any):any {\n        let {states} = this.entity;\n        return states.map(s => {\n            let n = s.name, count = 0;\n            let r = (res as any[]).find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n    }\n}\n\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'user-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'my-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nexport class PageStateItems<T> extends PageItems<T> {\n    private sheet: Sheet;\n    constructor(sheet: Sheet) {\n        super(true);\n        this.sheet = sheet;\n        this.pageSize = 10;\n\t}\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n\t\treturn {$page: ret};\n\t}\n\t/*\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n        return ret;\n\t}\n\t*/\n\tprotected getPageId(item:T) {\n\t\treturn item === undefined? 0 : (item as any).id;\n\t}\n\t/*\n    protected setPageStart(item:any) {\n        this.pageStart = item === undefined? 0 : item.id;\n\t}\n\t*/\n}\n","import {Query} from './query';\nimport { QueryQueryCaller } from './caller';\n\nexport class Book extends Query {\n    get typeName(): string { return 'book';}\n    protected queryApiName = 'book';\n\n    protected queryCaller(params: any): QueryQueryCaller {\n        return new BookQueryCaller(this, params);\n    }\n}\n\nexport class BookQueryCaller extends QueryQueryCaller {\n    get path():string {return `book/${this.entity.name}`;}\n}\n","import {Query} from './query';\n\nexport class History extends Query {\n    get typeName(): string { return 'history';}\n    protected queryApiName = 'history';\n}\n","import { Entity } from './entity';\nimport { Action, ActionSubmitCaller } from './action';\nimport { Query } from './query';\nimport { Field } from './uqMan';\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\n\ninterface MapActions {\n    add: Action;\n    del: Action;\n}\ninterface MapQueries {\n    all: Query;\n    page: Query;\n    query: Query;\n}\n\nexport class Map extends Entity {\n    get typeName(): string { return 'map';}\n    keys: Field[];\n    actions: MapActions = {} as any;\n    queries: MapQueries = {} as any;\n    schemaFrom: {owner:string; uq:string};\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.schemaFrom = this.schema.from;\n        let {actions, queries, keys} = schema;\n        this.uq.buildFieldTuid(this.keys = keys);\n        for (let i in actions) {\n            let actionSchema = actions[i];\n            let {name} = actionSchema;\n            let action = this.uq.newAction(name, undefined);\n            action.setSchema(actionSchema);\n            action.buildFieldsTuid();\n            (this.actions as any)[i] = action;\n        }\n        for (let i in queries) {\n            let querySchema = queries[i];\n            let {name} = querySchema;\n            let query = this.uq.newQuery(name, undefined);\n            query.setSchema(querySchema);\n            query.buildFieldsTuid();\n            (this.queries as any)[i] = query;\n        }\n    }\n\n    async add(param:any) {\n        let ret = await new AddCaller(this, param).request();\n        return ret;\n    }\n\n    async del(param:any) {\n        let ret = await new DelCaller(this, param).request();\n        return ret;\n    }\n\n    async all() {\n        let ret = await new AllCaller(this, undefined).request();\n        return ret;\n    }\n\n    async page(param:any, pageStart:any, pageSize: number) {\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\n        return ret;\n    }\n\n    async query(param:any) {\n       let qc = new QueryCaller(this, param);\n       let ret = await qc.request();\n       return ret;\n   }\n    async table(params:any): Promise<any[]> {\n        let ret = await this.query(params);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any):Promise<any> {\n        let ret = await this.table(params);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any):Promise<any> {\n        let ret = await this.obj(params);\n        for (let i in ret) return ret[i];\n    }\n}\n\nabstract class MapCaller extends EntityCaller<any> {\n    protected get entity(): Map {return this._entity as Map;}\n    get path():string {return undefined;}\n\n    protected abstract getCaller(param: any):EntityCaller<any>;\n\n    protected async innerCall(): Promise<any> {\n        let caller = this.getCaller(this.params);\n        let res = await this.entity.uqApi.xcall(caller);\n        let ret = caller.xresult(res.res);\n        return {res: ret};\n    }\n\n    buildParams() {\n        let p = super.buildParams();\n        return p;\n    }\n}\n\nclass AddCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass DelCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass AllCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\n    }\n}\n\nclass PageCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\n    }\n}\n\nclass QueryCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\n    }\n}\n\nclass MapAddCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/add`}\n    get headers(): {[header:string]: string} {return undefined;}\n}\n\nclass MapDelCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/del`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapAllCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/all`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapPageCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/page`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapQueryCaller extends QueryQueryCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/query`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n","import {Query} from './query';\n\nexport class Pending extends Query {\n    get typeName(): string { return 'pending';}\n    protected queryApiName = 'pending';\n}\n","import * as React from 'react';\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\nimport { Tag, TagValue } from './tag';\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class TagView implements IValuesView {\n\tprivate tag: Tag;\n\tconstructor(tag: Tag) {\n\t\tthis.tag = tag;\n\t}\n\trender(values: number|string):JSX.Element {\n\t\tlet names:string[];\n\t\tif (typeof values === 'number') {\n\t\t\tnames = [this.tag.nameFromId(values)];\n\t\t}\n\t\telse {\n\t\t\tnames = this.tag.namesFromIds(values);\n\t\t}\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\n\t\t})}</div>;\n\t}\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\n        let content = this.tag.values.map((item,index) => {\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\n        });\n\t\treturn this.renderView(options, content);\n\t}\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\n\t\tlet content = this.tag.values.map((item,index) => {\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\n\t\t});\n\t\treturn this.renderView(options, content);\n\t}\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\n\t\tlet {className, wrapClassName} = options;\n\t\twrapClassName = wrapClassName?\n\t\t\t'row ' + wrapClassName\n\t\t\t:\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\n\t\treturn <div className={className} style={radioStyle}>\n\t\t\t<div className={wrapClassName}>\n                {content}\n\t\t\t</div>\n        </div>;\n\t}\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, inputName, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\n\t\t\t\tvalue={id} defaultChecked={value===id}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"checkbox\"\n\t\t\t\tvalue={id} defaultChecked={checked}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n}\n","import { Entity } from \"../entity\";\nimport { TagView } from \"./tagView\";\n\nexport interface TagValue {\n\tid: number;\n\tname: string;\n\text: string;\n}\n\nexport class Tag extends Entity {\n    get typeName(): string { return 'tag';}\n\tvalues: TagValue[];\n\tprivate coll: {[id:number]: TagValue} = {};\n\n\tprivate _view: TagView;\n\tget view(): TagView { \n\t\tif (this._view !== undefined) return this._view; \n\t\treturn this._view = new TagView(this);\n\t}\n\n\tnameFromId(id:number) {\n\t\tlet c = this.coll[id]; \n\t\treturn c===undefined? undefined : c.name;\n\t}\n\n\tnamesFromIds(ids:string):string[] {\n\t\tlet ret:string[] = [];\n\t\tfor (let id of ids.split('|')) {\n\t\t\tlet c = this.coll[Number(id)];\n\t\t\tlet name = c===undefined? undefined : c.name;\n\t\t\tif (name !== undefined) ret.push(name);\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync loadValues():Promise<TagValue[]> {\n\t\tif (this.values !== undefined) return this.values;\n\t\tthis.values = [];\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\n\t\tif (ret === undefined) return;\n\t\tlet lines = (ret as string).split('\\n');\n\t\tfor (let line of lines) {\n\t\t\tif (line.length === 0) continue;\n\t\t\tlet parts = line.split('\\t');\n\t\t\tlet id = Number(parts[0]);\n\t\t\tlet val = {\n\t\t\t\tid: id,\n\t\t\t\tname: parts[1],\n\t\t\t\text: parts[2],\n\t\t\t};\n\t\t\tthis.values.push(val);\n\t\t\tthis.coll[id] = val;\n\t\t}\n\t\treturn this.values;\n\t}\n}\n","export * from './page';\nexport * from './tabs';\nexport * from './scrollView';\nexport * from './pageHeader';","export * from './schema';\nexport * from './uiSchema';\nexport * from './toUiSelectItems';\nexport * from './IValuesView';","\nexport const mobileRegex = /^[0-9]*$/;\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\n\nexport const EmailFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\n}\n\nexport const MobileFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface DropdownAction {\n    icon?: string;\n    caption?: string;\n\taction?: () => void;\n\ticonClass?: string;\n\tcaptionClass?: string;\n}\n\nexport interface DropdownActionsProps {\n    icon?: string;\n    actions: DropdownAction[];\n    isRight?: boolean;\n\tclassName?: string;\n\titemIconClass?: string;\n\titemCaptionClass?: string;\n}\n\nexport interface DropdownActionsState {\n    dropdownOpen: boolean;\n}\n\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\n    private menu: HTMLDivElement;\n    private button: HTMLElement;\n    constructor(props:DropdownActionsProps) {\n        super(props);\n        this.state = {\n            dropdownOpen: false\n        };\n    }\n\n    componentDidMount() {\n        document.addEventListener('click', this.handleDocumentClick);\n        document.addEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.handleDocumentClick);\n        document.removeEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    private handleDocumentClick = (evt:any) => {\n        if (this.state.dropdownOpen === false) return;\n        if (this.button && this.button.contains(evt.target)) return;\n        if (!this.menu) return;\n        //if (!this.menu.contains(evt.target)) \n        this.toggle();\n    }\n\n    private toggle = () => {\n        this.setState({\n            dropdownOpen: !this.state.dropdownOpen\n        });\n    }\n\n    render() {\n        let {icon, actions, isRight, className, itemIconClass, itemCaptionClass} = this.props;\n        if (isRight === undefined) isRight = true;\n        let hasIcon = actions.some(v => v.icon!==undefined);\n        let {dropdownOpen} = this.state;\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\n\t\tlet cn = className || 'cursor-pointer dropdown-toggle btn btn-sm';\n\t\t//if (className) cn += className;\n        return <div className={'dropdown'}>\n\t\t\t<button ref={v=>this.button=v} \n\t\t\t\tclassName={cn}\n                data-toggle=\"dropdown\"\n                aria-expanded={dropdownOpen}\n                onClick={this.toggle}>\n                <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} />\n            </button>\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\n                {\n                    actions.map((v,index) => {\n\t\t\t\t\t\tif (!v) {\n                            return <div className=\"dropdown-divider\" key={index}/>;\n\t\t\t\t\t\t}\n                        let {icon, caption, action, iconClass, captionClass} = v;\n                        if (icon === undefined && caption === undefined) \n                            return <div className=\"dropdown-divider\" />;\n                        let i:any;\n                        if (hasIcon === true) {\n                            if (icon !== undefined) icon = 'fa-' + icon;\n\t\t\t\t\t\t\ti = <i className={classNames('mr-2', 'fa', icon, 'fa-fw', iconClass || itemIconClass)}\n\t\t\t\t\t\t\t\taria-hidden={true}></i>;\n                        }\n                        if (action === undefined) \n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\n                            evt.preventDefault();\n                            action();\n                        }\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\n                            action();\n                        }\n                            // eslint-disable-next-line\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\n                            >{i} <span className={captionClass || itemCaptionClass}>{caption}</span></a>\n                    })\n                }\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport { setRes } from '../../components';\n\nexport interface EasyDateProps {\n    date: Date | number;\n}\n\n//type YMD = (year:number, month:number, date:number) => string;\n//type MD = (month:number, date:number) => string;\n\nconst timeRes:{[prop:string]:any} = {\n\tmd: (month:number, date:number) => `${month}-${date}`,\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\tyesterday: 'Yday',\n\ttoday: 'Today',\n\ttomorrow: 'Tmw',\n\t$zh: {\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\n\t\tyesterday: '昨天',\n\t\ttoday: '今天',\n\t\ttomorrow: '明天',\n\t},\n\t$en: {\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\t\tyesterday: 'Yday',\n\t\ttoday: 'Today',\n\t\ttomorrow: 'Tmw',\n\t}\n}\n\nsetRes(timeRes, timeRes);\n\nfunction tt(str:string):any {\n\treturn timeRes[str];\n}\n\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\n    if (!vDate) return null;\n    let date: Date;\n    switch (typeof vDate) {\n        default: date = vDate as Date; break;\n        case 'string': date = new Date(vDate); break;\n        case 'number': date = new Date((vDate as number)*1000); break;\n    }\n\n    let now = new Date();\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\n    let d = date;\n    tick = now.getTime() - d.getTime();\n    let hour=d.getHours(), minute=d.getMinutes();\n    nDate=now.getDate();\n    _date=d.getDate();\n    month=d.getMonth()+1;\n    year=d.getFullYear();\n\tnowYear = now.getFullYear();\n\n\tlet appendTime:boolean = false;\n\tlet dPart:string = (function() {\n\t\tif (tick < -24*3600*1000) {\n\t\t\tif (year === nowYear) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('md')(month, _date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('ymd')(year, month, _date);\n\t\t\t}\n\t\t}\n\t\tif (tick < 24*3600*1000) {\n\t\t\tif (_date!==nDate) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\n\t\t\t}\n\t\t\tif (withTime===true) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn tt('today');\n\t\t}\n\t\tif (year === nowYear) {\n\t\t\treturn tt('md')(month, _date);\n\t\t}\n\t\treturn tt('ymd')(year, month, _date);\n\t})();\n\n\tlet hm = hour + ((minute<10?':0':':') + minute);\n\n\t/*\n    if (tick < -24*3600*1000) {\n        if (year === nowYear)\n            return tt('md')(month, _date) + ' ' + hm;\n        else\n            return tt('ymd')(year, month, _date) + ' ' + hm;\n    }\n    if (always === true || tick < 24*3600*1000) {\n        return _date!==nDate? \n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \n            : withTime===true? hm : tt('today');\n    }\n    if (year === nowYear) {\n        return tt('md')(month, _date);\n    }\n\treturn tt('ymd')(year, month, _date);\n\t*/\n\tif (appendTime === true || always === true) {\n\t\treturn dPart + ' ' + hm;\n\t}\n\treturn dPart;\n}\n\n\nexport class EasyDate extends React.Component<EasyDateProps> {\n    render() {\n        return renderDate(this.props.date, false);\n    }\n}\n\ninterface EasyTimeProps extends EasyDateProps {\n\talways?: boolean;\n}\nexport class EasyTime extends React.Component<EasyTimeProps> {\n    render() {\n\t\tlet {date, always} = this.props;\n        return renderDate(date, true, always);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Image } from '.';\n\nexport interface MediaProps {\n    icon: string;\n    main: string|JSX.Element;\n    discription?: string | JSX.Element;\n    px?: number;\n    py?: number;\n}\n\nexport class Media extends React.Component<MediaProps> {\n    render() {\n        let {icon, main, discription, px, py} = this.props;\n        let disp:any;\n        if (typeof discription === 'string')\n            disp = <div>{discription}</div>;\n        else\n            disp = discription;\n        let cn = classNames(\n            'media', \n            px===undefined? 'px-0':'px-'+px, \n            py===undefined? 'py-2':'py-'+py);\n        return <div className={cn}>\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\n            <div className=\"media-body\">\n                <h5 className=\"mt-0\">{main}</h5>\n                {disp}\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\n\nexport interface SearchBoxProps {\n    className?: string;\n    label?: string;\n    initKey?: string;\n    placeholder?: string;\n    buttonText?: string;\n    maxLength?: number;\n    size?: 'sm' | 'md' | 'lg';\n    inputClassName?: string;\n    onSearch: (key:string)=>Promise<void>;\n    onFocus?: ()=>void;\n    allowEmptySearch?: boolean;\n}\n\n/*\nexport interface SearchBoxState {\n    disabled: boolean;\n}*/\n\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\n    private input: HTMLInputElement;\n    private key: string = null;\n    @observable private disabled: boolean;\n\n    private onChange = (evt: React.ChangeEvent<any>) => {\n        this.key = evt.target.value;\n        if (this.key !== undefined) {\n            this.key = this.key.trim();\n            if (this.key === '') this.key = undefined;\n        }\n        if (this.props.allowEmptySearch !== true) {\n            this.disabled = !this.key;\n        }\n    }\n    private onSubmit = async (evt: React.FormEvent<any>) => {\n        evt.preventDefault();\n        if (this.key === null) this.key = this.props.initKey || '';\n        if (this.props.allowEmptySearch !== true) {\n            if (!this.key) return;\n            if (this.input) this.input.disabled = true;\n        }\n        await this.props.onSearch(this.key);\n        if (this.input) this.input.disabled = false;\n    }\n    clear() {\n        if (this.input) this.input.value = '';\n    }\n    render() {\n        let {className, inputClassName, onFocus,\n            label, placeholder, buttonText, maxLength, size} = this.props;\n        let inputSize:string;\n        switch (size) {\n            default:\n            case 'sm': inputSize = 'input-group-sm'; break;\n            case 'md': inputSize = 'input-group-md'; break;\n            case 'lg': inputSize = 'input-group-lg'; break;\n        }\n        return <form className={className} onSubmit={this.onSubmit} >\n            <div className={classNames(\"input-group\", inputSize)}>\n                {label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\n                <input ref={v=>this.input=v} onChange={this.onChange}\n                    type=\"text\"\n                    name=\"key\"\n                    onFocus={onFocus}\n                    className={classNames('form-control', inputClassName || 'border-primary')}\n                    placeholder={placeholder}\n                    defaultValue={this.props.initKey}\n                    maxLength={maxLength} />\n                <div className=\"input-group-append\">\n                    <button className=\"btn btn-primary\"\n                        type=\"submit\"\n                        disabled={this.disabled}>\n                        <i className='fa fa-search' />\n                        <i className=\"fa\"/>\n                        {buttonText}\n                    </button>\n                </div>\n            </div>\n        </form>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { userApi } from '../net';\nimport { User } from '../tool';\nimport _ from 'lodash';\n\nexport type UserLoader = (userId:number)=>Promise<any>;\n\nexport class UserCache<T> {\n\tprivate loader: UserLoader;\n\tprivate onLoaded: (user:User) => void;\n\tprivate map = observable(new Map<number, T|number>());\n\n\tconstructor(loader: UserLoader) {\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\n\t\tthis.loader = loader;\n\t}\n\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tif (!id) return;\n\t\tthis.onLoaded = onLoaded;\n\t\tid = Number(id);\n\t\tlet ret = this.map.get(id);\n\t\tif (ret === undefined) {\n\t\t\tthis.map.set(id, id);\n\t\t}\n\t}\n\n\tgetValue(id:number|any):any {\n\t\tif (!id) return;\n\t\tswitch (typeof(id)) {\n\t\t\tcase 'object': \n\t\t\t\tid = id.id; \n\t\t\t\tif (!id) return;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet ret = this.map.get(id);\n\t\tif (!ret) return;\n\t\tswitch (typeof(ret)) {\n\t\tdefault:\n\t\t\treturn ret;\n\t\tcase 'number':\n\t\t\tif (ret < 0) return id;\n\t\t\tthis.map.set(id, -id);\n\t\t\tthis.loader(id).then(v => {\n\t\t\t\tif (!v) v = null;\n\t\t\t\tthis.map.set(id, v);\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\n\t\t\t}).catch(reason => {\n\t\t\t\tconsole.error(reason);\n\t\t\t});\n\t\t\treturn id;\n\t\t}\n\t}\n}\n\nconst userCache = new UserCache(undefined);\n\nexport interface UserIconProps {\n    id: number;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n    noneImage?: any;\n}\n\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\n    let {className, style, id, altImage, noneImage} = props;\n    let user = userCache.getValue(id);\n    switch (typeof user) {\n\tcase 'undefined':\n\tcase 'number':\n        return <div className={classNames(className, 'image-none')} style={style}>\n            {noneImage || <i className=\"fa fa-file-o\" />}\n        </div>;\n    }\n    let {icon} = user;\n    if (!icon) {\n        return <div className={classNames(className, 'image-none')} style={style}>\n            <i className=\"fa fa-file-o\" />\n        </div>;\n    }\n    if (_.startsWith(icon, ':') === true) {\n        icon = nav.resUrl + icon.substr(1);\n    }\n    return <img src={icon} className={className} alt=\"img\"\n        style={style}\n        onError={evt=>{\n            if (altImage) evt.currentTarget.src=altImage;\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n        }} />;\n});\n\nexport interface UserViewProps {\n\tid?: number;\n\tuser?: number|User;\n\trender: (user:User) => JSX.Element;\n\tonLoaded?: (user:User) => void\n}\n\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\n\tlet {id:idProp, user, render, onLoaded} = props;\n\tif (user === null) return <>null</>;\n\tswitch (typeof user) {\n\t\tcase 'undefined': \n\t\t\tuser = userCache.getValue(idProp);\n\t\t\tbreak;\n\t\tcase 'object': \n\t\t\tlet {/*obj, */id} = user as any;\n\t\t\t//if (typeof obj !== 'object') {\n\t\t\t\tuseUser(id, onLoaded);\n\t\t\t\tuser = userCache.getValue(id);\n\t\t\t//}\n\t\t\tbreak;\n\t\tcase 'number':\n\t\t\tuseUser(user as number, onLoaded);\n\t\t\tuser = userCache.getValue(user as number);\n\t\t\tbreak;\n\t\tcase 'string':\n\t\t\tuseUser(Number(user), onLoaded);\n\t\t\tuser = userCache.getValue(Number(user));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tuser = undefined;\n\t\t\tbreak;\n\t}\n    switch (typeof user) {\n\t\tcase 'undefined':\n\t\tcase 'number':\n        \treturn <>{user}</>;\n    }\n    return render(user);\n});\n\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\n\tif (!id) return;\n\tif (typeof(id) === 'object') {\n\t\tid = (id as any).id;\n\t}\n\tuserCache.use(id, onLoaded);\n}\n","import { UqMan, TuidModify } from '../uqMan';\nimport { Tuid } from \"./tuid\";\nimport { env } from '../../tool';\n\ninterface Modify {\n    id: number;\n    entity: string;\n    key: string;\n}\n\nexport class TuidsCache {\n    private readonly uq: UqMan;\n    private modifyMax: TuidModify;\n    private cacheTimer: any;\n    constructor(uq: UqMan) {\n        this.uq = uq;\n    }\n\n    cacheTuids(defer:number) {\n        this.clearCacheTimer();\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\n    }\n    private clearCacheTimer() {\n        if (this.cacheTimer === undefined) return;\n        env.clearTimeout(this.cacheTimer);\n        this.cacheTimer = undefined;\n    }\n    private loadIds = () => {\n        this.clearCacheTimer();\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            let tuid = tuids[i];\n            tuid.cacheIds();\n        }\n    }\n    \n    pullModify(modifyMax:number) {\n        if (modifyMax === undefined) return;\n        let now = Math.floor(Date.now() / 1000);\n        if (this.modifyMax === undefined) {\n            this.modifyMax = this.uq.localModifyMax.get();\n            if (this.modifyMax === undefined) {\n                this.modifyMax = {\n                    max: modifyMax,\n                    seconds: now,\n                };\n                this.uq.localModifyMax.set(this.modifyMax);\n            }\n        }\n        let {max, seconds} = this.modifyMax;\n        let lockGap = 3600;\n        if (now - seconds < lockGap) return;\n        if (modifyMax <= max) return;\n        let tuidCached:string[] = [];\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            //if (tuids[i].cached === true) \n            tuidCached.push(i);\n        }\n        if (tuidCached.length === 0) return;\n        this.modifyMax.seconds = now;\n        this.innerPullModify(tuidCached.join('\\t'));\n    }\n\n    private async innerPullModify(tuidLists:string):Promise<void> {\n        let {uqApi, tuids} = this.uq;\n        let {max} = this.modifyMax;\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\n        let modifyMax:number = 0;\n        for (let modify of ret.queue) {\n\t\t\tlet {id, entity, key} = modify;\n\t\t\tif (!key) continue;\n            let tuid = tuids[entity];\n            if (tuid === undefined) continue;\n            let item = group[entity];\n            if (item === undefined) {\n                item = group[entity] = {tuid: tuid, ids:[]};\n            }\n            item.ids.push(key);\n            if (id > modifyMax) modifyMax = id;\n        }\n        for (let i in group) {\n            let {tuid, ids} = group[i];\n            await tuid.modifyIds(ids);\n        }\n        let now = Math.floor(Date.now() / 1000);\n        this.modifyMax = {\n            max: modifyMax,\n            seconds: now,\n        }\n        this.uq.localModifyMax.set(this.modifyMax);\n    }\n}\n","import { LocalMap, LocalCache, env } from '../tool';\nimport { UqData, UqAppData, loadAppUqs } from '../net';\nimport { UqMan } from './uqMan';\nimport { TuidImport, TuidInner } from './tuid';\nimport { nav } from '../components';\n\nexport interface TVs {\n    [uqName:string]: {\n        [tuidName: string]: (values: any) => JSX.Element;\n    }\n}\n\nexport class UQsMan {\n\tstatic _uqs: any;\n\tstatic value: UQsMan;\n\tstatic errors: string[];\n\n\tstatic async load(tonvaAppName:string, version:string, tvs:TVs) {\n\t\tlet uqsMan = UQsMan.value = new UQsMan(tonvaAppName, tvs);\n        let {appOwner, appName} = uqsMan;\n        let {localData} = uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        uqsMan.id = id;\n        await uqsMan.init(uqs);\n        let retErrors = await uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                UQsMan._uqs = uqsMan.buildUQs();\n                return;\n            }\n        }\n        UQsMan.errors = retErrors;\n\t}\n\n    private collection: {[uqName: string]: UqMan};\n    private readonly tvs: TVs;\n\n    readonly name: string;\n    readonly appOwner: string;\n    readonly appName: string;\n    readonly localMap: LocalMap;\n    readonly localData: LocalCache;\n    id: number;\n\n    private constructor(tonvaAppName:string, tvs:TVs) {\n        this.tvs = tvs || {};\n        this.buildTVs();\n        this.collection = {};\n        let parts = tonvaAppName.split('/');\n        if (parts.length !== 2) {\n            throw new Error('tonvaApp name must be / separated, owner/app');\n        }\n        this.appOwner = parts[0];\n        this.appName = parts[1];\n        this.localMap = env.localDb.map(tonvaAppName);\n        this.localData = this.localMap.child('uqData');\n    }\n\n    // to be removed in the future\n    addUq(uq: UqMan) {\n        this.collection[uq.name] = uq;\n    }\n\n    private buildTVs() {\n        for (let i in this.tvs) {\n            let uqTVs = this.tvs[i];\n            if (uqTVs === undefined) continue;\n            let l = i.toLowerCase();\n            if (l === i) continue;\n            this.tvs[l] = uqTVs;\n            for (let j in uqTVs) {\n                let en = uqTVs[j];\n                if (en === undefined) continue;\n                let lj = j.toLowerCase();\n                if (lj === j) continue;\n                uqTVs[lj] = en;\n            }\n        }\n    }\n\n    async init(uqsData:UqData[]):Promise<void> {\n        let promiseInits: PromiseLike<void>[] = [];\n        for (let uqData of uqsData) {\n            let {uqOwner, uqName} = uqData;\n            let uqFullName = uqOwner + '/' + uqName;\n            //let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\n            //let cUq = this.newCUq(uqData, uqUI);\n            //this.cUqCollection[uqFullName] = cUq;\n            //this.uqs.addUq(cUq.uq);\n            let uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\n            this.collection[uqFullName] = uq;\n            let lower = uqFullName.toLowerCase();\n            if (lower !== uqFullName) {\n                this.collection[lower] = uq;\n            }\n            promiseInits.push(uq.init());\n        }\n        await Promise.all(promiseInits);\n    }\n\n    async load(): Promise<string[]> {\n        let retErrors:string[] = [];\n        let promises: PromiseLike<string>[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            promises.push(uq.loadEntities());\n\t\t}\t\t\n        let results = await Promise.all(promises);\n        for (let result of results)\n        {\n            let retError = result; // await cUq.loadSchema();\n            if (retError !== undefined) {\n                retErrors.push(retError);\n                continue;\n            }\n\t\t}\n        return retErrors;\n    }\n\n    buildUQs(): any {\n        let that = this;\n        let uqs:any = {};\n        for (let i in this.collection) {\n            let uqMan = this.collection[i];\n            //let n = uqMan.name;\n            let uqName = uqMan.uqName;\n            let l = uqName.toLowerCase();\n            let entities = uqMan.entities;\n            let keys = Object.keys(entities);\n            for (let key of keys) {\n                let entity = entities[key];\n                let {name} = entity;\n                //if (name !== sName) \n                //entities[sName] = entity;\n                entities[name.toLowerCase()] = entity;\n            }\n            //uqs[i] = entities;\n            //uqs[uqName] = entities;\n            //if (l !== uqName) \n            uqs[l] = new Proxy(entities, {\n                get: function(target, key, receiver) {\n                    let lk = (key as string).toLowerCase();\n                    let ret = target[lk];\n                    if (ret !== undefined) return ret;\n\t\t\t\t\tdebugger;\n\t\t\t\t\tlet err = `entity ${uqName}.${String(key)} not defined`;\n                    console.error(err);\n                    that.showReload('UQ错误：' + err);\n                    return undefined;\n                }\n            });\n        }\n        //let uqs = this.collection;\n        return new Proxy(uqs, {\n            get: function (target, key, receiver) {\n                let lk = (key as string).toLowerCase();\n                let ret = target[lk];\n                if (ret !== undefined) return ret;\n                /*\n                for (let i in uqs) {\n                    if (i.toLowerCase() === lk) {\n                        return uqs[i];\n                    }\n                }*/\n                debugger;\n                console.error('error in uqs');\n                that.showReload(`代码错误：新增 uq ${String(key)}`);\n                return undefined;\n            },\n        });\n    }\n\n    private showReload(msg: string) {\n        this.localMap.removeAll();\n        nav.showReloadPage(msg);\n    }\n\n    setTuidImportsLocal():string[] {\n        let ret:string[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            for (let tuid of uq.tuidArr) {\n                if (tuid.isImport === true) {\n                    let error = this.setInner(tuid as TuidImport);\n                    if (error) ret.push(error);\n                }\n            }\n        }\n        return ret;\n    }\n\n    private setInner(tuidImport: TuidImport):string {\n        let {from} = tuidImport;\n        let fromName = from.owner + '/' + from.uq;\n        let uq = this.collection[fromName];\n        if (uq === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\n        }\n        let iName = tuidImport.name\n        let tuid = uq.tuid(iName);\n        if (tuid === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\n        }\n        if (tuid.isImport === true) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\n        }\n        tuidImport.setFrom(tuid as TuidInner);\n    }\n}\n","import _ from 'lodash';\nimport { Context } from '../context';\nimport { FormRes } from '../../../res/formRes';\n\nexport abstract class Rule {\n    abstract check(defy:string[], value:any):void;\n}\n\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\nexport type FieldRule = (value:any) => string[] | string;\n\nexport class RuleCustom extends Rule {\n    private func: FieldRule;\n    constructor(func: FieldRule) {\n        super();\n        this.func = func;\n    }\n    check(defy:string[], value:any) {\n        let ret = this.func(value);\n        if (ret === undefined) return;\n        switch (typeof ret) {\n            case 'undefined': return;\n            case 'string': defy.push(ret as string); return;\n            default: defy.push(...ret); return;\n        }        \n    }\n}\n\nexport abstract class RulePredefined extends Rule {\n    protected res: FormRes;\n    constructor(res: FormRes) {\n        super();\n        this.res = res;\n    }\n}\n\nexport class RuleRequired extends RulePredefined {\n    check(defy:string[], value:any) {\n        switch (typeof value) {\n            default:\n            case 'boolean': return;\n            case 'object':\n                if (value !== null) return;\n                break;\n            case 'string':\n                if ((value as string).trim().length > 0) return;\n                break;\n            case 'number':\n                if (isNaN(value as number) === false) return;\n                break;\n            case 'undefined':\n                break;\n        }\n        defy.push(this.res.required);\n    }\n}\n\nexport class RuleNum extends RulePredefined {\n    private minMsg: _.TemplateExecutor;\n    private maxMsg: _.TemplateExecutor;\n    protected min: number;\n    protected max: number\n    constructor(res: FormRes, min?: number, max?: number) {\n        super(res);\n        this.minMsg = _.template(res.min);\n        this.maxMsg = _.template(res.max);\n        this.min = min;\n        this.max = max;\n    }\n    check(defy:string[], value:any) {\n        if (value === undefined || value === null) return;\n        let n = Number(value);\n        if (isNaN(n) === true) {\n            defy.push(this.res.number);\n        }\n        else {\n            this.checkMore(defy, n);\n        }\n    }\n\n    protected checkMore(defy:string[], value: number) {\n        if (this.min !== undefined && Number(value) < this.min) {\n            defy.push(this.minMsg({min:this.min}));\n        }\n        if (this.max !== undefined && Number(value) > this.max) {\n            defy.push(this.maxMsg({max:this.max}));\n        }\n    }\n}\n\nexport class RuleInt extends RuleNum {\n    protected checkMore(defy:string[], n: number) {\n        super.checkMore(defy, n);\n        if (Number.isInteger(n) === false) {\n            defy.push(this.res.integer);\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { ItemSchema } from '../../schema';\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport abstract class Widget {\n    name: string;\n    protected context: Context;\n    protected fieldProps:FieldProps;\n    protected children: React.ReactNode;\n    protected _itemSchema: ItemSchema;\n    protected _ui: UiItem;\n    protected defaultValue: any;\n    protected value: any;\n    protected rules: Rule[];\n    @observable errors: string[] = [];\n    @observable protected contextErrors: string[] = [];\n    @computed protected get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\n    protected readOnly:boolean;\n    protected disabled:boolean;\n    @observable visible:boolean;\n\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\n        this.context = context;\n        let {name} = itemSchema;\n        this.name = name;\n        this._itemSchema = itemSchema;\n        this.fieldProps = fieldProps;\n        this.children = children;\n        this._ui = context.getUiItem(name);\n        if (this.ui === undefined) {\n            this.readOnly = false;\n            this.disabled = false;\n            this.visible = true;\n        }\n        else {\n            let {readOnly, disabled, visible} = this.ui;\n            this.readOnly = (readOnly === true);\n            this.disabled = (disabled === true);\n            this.visible = !(visible === false);            \n        }\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\n        // this.init();\n    }\n\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\n    protected get ui(): UiItem {return this._ui};\n\n    init() {\n        this.rules = [];\n        if (this.itemSchema.required === true) {\n            this.rules.push(new RuleRequired(this.context.form.res));\n        }\n        this.buildRules();\n        if (this.ui === undefined) return;\n        let {rules} = this.ui;\n        if (rules === undefined) return;\n        if (Array.isArray(rules) === false) {\n            this.rules.push(new RuleCustom(rules as FieldRule));\n            return;\n        }\n        for (let rule of rules as FieldRule[]) {\n            this.rules.push(new RuleCustom(rule));\n        }\n    }\n\n    protected buildRules() {\n    }\n\n    checkRules() {\n        let defy:string[] = [];\n        for (let r of this.rules) r.check(defy, this.value);\n        if (defy.length === 0) {\n            this.context.removeErrorWidget(this);\n        }\n        else {\n            this.context.addErrorWidget(this);\n            this.errors.push(...defy);\n        }\n    }\n\n    @computed get isOk() {\n        return this.errors.length ===0;\n    }\n\n    setError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.errors.push(err);\n        else this.errors.push(...err);\n    }\n\n    setContextError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.contextErrors.push(err);\n        else this.contextErrors.push(...err);\n    }\n\n    clearError() {\n        this.errors.splice(0);\n    }\n\n    clearContextError() {\n        this.contextErrors.splice(0);\n    }\n\n    protected parse(value:any):any {return value}\n\n    protected setElementValue(value:any) {}\n    protected setDataValue(value:any) {\n        if (this.isChanging === true) return;\n        this.context.initData[this.name] = this.value = this.parse(value);\n    }\n\n    setValue(value:any) {\n        if (this.isChanging === true) return;\n        //this.setDataValue(value);\n        //this.setElementValue(value);\n        this.changeValue(value, false);\n    }\n\n    getValue() {\n        return this.context.getValue(this.name);\n    }\n\n    getReadOnly():boolean {return this.readOnly}\n    getDisabled():boolean {return this.disabled}\n    getVisible():boolean {return this.visible}\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}\n    setVisible(value:boolean) {this.visible = value}\n\n    private isChanging: boolean;\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n\n    protected changeValue(newValue: any, fromElement: boolean) {\n        let prev = this.value;\n        let onChanging: ChangingHandler;\n        let onChanged: ChangedHandler;\n        if (this.ui !== undefined) {\n            onChanging = this.ui.onChanging;\n            onChanged = this.ui.onChanged;\n        }\n        let allowChange = true;\n        if (onChanging !== undefined) {\n            this.isChanging = true;\n            allowChange = onChanging(this.context, this.value, prev);\n            this.isChanging = false;\n        }\n        if (allowChange === true) {\n            this.setDataValue(newValue);\n            if (fromElement !== true) this.setElementValue(newValue);\n            if (onChanged !== undefined) {\n                this.isChanging = true;\n                onChanged(this.context, this.value, prev);\n                this.isChanging = false;\n            }\n        }\n    }\n\n    protected get className():string {\n        let fieldClass:string;\n        if (this.context.inNode === false) fieldClass = 'form-control';\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\n    }\n\n    protected abstract render():JSX.Element;\n\n    protected renderBody():JSX.Element {\n        let elDiscription;\n        if (this.hasError === false && this.ui) {\n            let {discription, discriptionClassName} = this.ui;\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\n            elDiscription = <span className={discriptionClassName}>\n                {discription}\n            </span>;\n        }\n        return <>\n            {this.render()}\n            {elDiscription}\n        </>;\n    }\n\n    container = observer(():JSX.Element => {\n        if (this.visible === false) return null;\n        let {form, inNode} = this.context;\n        if (inNode === true) return this.render();\n        let label:any = this.label;\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\n        }\n        return form.FieldContainer(label, this.renderBody());\n    })\n\n    protected get label():string {\n        let label:any;\n        if (this.ui === undefined) {\n            label = this.name;\n        }\n        else {\n            let uiLabel = this.ui.label;\n            if (uiLabel === null) label = null;\n            else label = uiLabel || this.name;\n        }\n        return label;\n    }\n\n    protected renderTemplet():JSX.Element | undefined {\n        if (this.children !== undefined) {\n            return <>{this.children}</>;\n        }\n        if (this.ui === undefined) return undefined;\n        let {Templet} = this.ui;\n        if (typeof Templet === 'function') return Templet(this.value);\n        return Templet;\n    }\n\n    protected renderErrors() {\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\n        if (errorList.length === 0) return null;\n        let {inNode} = this.context;\n        let tag = inNode === true? 'span' : 'div';\n        return errorList.map(err => React.createElement(tag, \n            {\n                key: err, \n                className: 'text-danger d-inline-block my-2 ml-3'\n            },\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\n        ));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextItem, StringSchema } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class TextWidget extends Widget {\n    protected inputType = 'text';\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\n    protected input: HTMLInputElement;\n    @observable protected hasFocus: boolean;\n\n    protected setElementValue(value:any) {\n        if (this.input === null) return;\n        this.input.value = value;\n    }\n    protected get placeholder() {return (this.ui && this.ui.placeholder) || this.name}\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        this.internalOnKeyDown(evt);\n        if (evt.keyCode !== 13) return;\n        let {onEnter} = this.context.form.props;\n        if (onEnter === undefined) return;\n\n        this.changeValue(evt.currentTarget.value, true);\n\n        //this.checkRules();\n        //this.context.checkContextRules();\n        this.input.blur();\n\n        let ret = await onEnter(this.name, this.context);\n        if (ret !== undefined) {\n            this.context.setError(this.name, ret);\n        }\n    }\n\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n    }\n\n    protected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n\t\tthis.context.checkContextRules();\n\t\tthis.hasFocus = false;\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n\t\tthis.hasFocus = true;\n    }\n    protected onChange(evt: React.ChangeEvent<any>) {\n    }\n\n    setReadOnly(value:boolean) {\n        if (this.input === null) return;\n        this.input.readOnly = this.readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        if (this.input === null) return;\n        this.input.disabled = this.disabled = value;\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {\n            //'form-control': true,\n        };\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, cn)}\n            type={this.inputType}\n            defaultValue={this.value}\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\n            placeholder={this.placeholder}\n            readOnly={this.readOnly}\n            disabled={this.disabled}\n            onKeyDown = {this.onKeyDown}\n            onFocus = {this.onFocus}\n            onBlur={this.onBlur}\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextAreaItem } from '../../schema';\nimport { StringSchema } from '../../schema';\n\nexport class TextAreaWidget extends Widget {\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\n    protected input: HTMLTextAreaElement;\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\n\n    protected setElementValue(value:any) {this.input.value = value}\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.setValue(evt.currentTarget.value);\n    }\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n        this.context.checkContextRules();\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {};\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <>\n\t\t\t<textarea ref={(input) => this.input=input}\n\t\t\t\tonBlur={this.onBlur} \n\t\t\t\tonFocus={this.onFocus}\n                className={classNames(this.className, cn)}\n                rows={this.ui && this.ui.rows}\n                maxLength={this.itemSchema.maxLength}\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class PasswordWidget extends TextWidget {\n    protected inputType = 'password';\n}\n\nexport class UrlWidget extends TextWidget {\n    protected inputType = 'url';\n}\n\nexport class EmailWidget extends TextWidget {\n    protected inputType = 'email';\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\nimport { RuleNum, RuleInt } from '../rules';\nimport { NumBaseSchema } from '../../schema';\n\nexport class NumberWidget extends TextWidget {\n    protected inputType = 'number';\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\n\n    protected buildRules() {\n        super.buildRules();\n        let res = this.context.form.res;\n        let {min, max} = this.itemSchema;\n        this.rules.push(\n            this.itemSchema.type === 'integer'?\n                new RuleNum(res, min, max) :\n                new RuleInt(res, min, max)\n        );\n        /*\n        if (this.itemSchema.type === 'integer') {\n            this.rules.push(new RuleInt);\n        }\n        let {min, max} = this.itemSchema;\n        if (min !== undefined) this.rules.push(new RuleMin(min));\n        if (max !== undefined) this.rules.push(new RuleMax(max));\n        */\n    }\n\n    protected parse(value:any):any {\n        if (value === undefined || value === null) return;\n        return Number(value);\n    }\n}\n","import * as React from 'react';\nimport { NumberWidget } from './numberWidget';\n\nexport class UpdownWidget extends NumberWidget {\n    protected inputType = 'number';\n\n    protected isValidKey(key:number):boolean {\n        return key===46 || key===8 || key===37 || key===39\n            || (key>=48 && key<=57)\n            || (key>=96 && key<=105)\n            || key===109 || key===189;\n    }\n    \n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n        let key = evt.keyCode;\n        window.event.returnValue = this.isValidKey(key);\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class DateWidget extends TextWidget {\n    protected inputType = 'date';\n}\n\nexport class DateTimeWidget extends TextWidget {\n    protected inputType = 'datetime';\n}\n\nexport class TimeWidget extends TextWidget {\n    protected inputType = 'time';\n}\n\nexport class MonthWidget extends TextWidget {\n    protected inputType = 'month';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiCheckItem } from '../../schema';\n\nexport class CheckBoxWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\n    protected trueValue: any;\n    protected falseValue: any;\n\n    init() {\n        super.init();\n        if (this.ui !== undefined) {\n            let {trueValue, falseValue} = this.ui;\n            if (trueValue === undefined) this.trueValue = true;\n            else this.trueValue = trueValue;\n            if (falseValue === undefined) this.falseValue = false;\n            else this.falseValue = falseValue;\n        }\n        else {\n            this.trueValue = true;\n            this.falseValue = false;\n        }\n    }\n    protected setElementValue(value:any) {\n        this.input.checked = value === this.trueValue;\n    }\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\n        this.setDataValue(v);\n    }\n\n    protected onClick = () => {\n        this.context.clearErrors();\n    }\n\n    render() {\n        let cn = classNames(this.className, 'form-check-inline p-0');\n        let input = <input\n            ref={(input)=>this.input = input}\n            className={'align-self-center'}\n            type=\"checkbox\"\n            defaultChecked={this.defaultValue} \n            onChange={this.onInputChange}\n            onClick={this.onClick} />;\n        if (this.context.inNode === true) {\n            return <label className={cn}>\n                {input} {(this.ui&&this.ui.label) || this.name}\n            </label>\n        }\n        else {\n            return <div className={cn}>\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\n            </div>;\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\nimport { Widget } from './widget';\nimport { UiSelect } from '../../schema';\n\nexport class SelectWidget extends Widget {\n    protected select: HTMLSelectElement;\n    protected get ui(): UiSelect {return this._ui as UiSelect};\n    @observable protected readOnly: boolean;\n\n    protected setElementValue(value:any) {this.select.value = value}\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\n        this.setDataValue(evt.target.value);\n    }\n\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\n\n    render() {\n        if (this.readOnly === true) {\n            let option = this.ui.list.find(v => v.value === this.value);\n            let title = (option === undefined)? '(???)' : option.title;\n            return <span className=\"form-control w-min-6c\">{title}</span>;\n        }\n        return <select\n            ref={(select)=>this.select = select}\n            className={classNames(this.className, 'form-control')}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}>\n            {this.ui.list.map((v,index) => {\n                let {title, value} = v;\n                let cn:string;\n                //if (value === undefined || value === null) cn = 'text-light small';\n                //else cn = 'text-danger';\n                return <option className={cn} key={index} value={value}>{title || value}</option>\n            })}\n        </select>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n//import { TextWidget } from './textWidget';\nimport { Widget } from './widget';\nimport { UiRadio } from '../../schema';\nimport { RowContext } from '../context';\n\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class RadioWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiRadio {return this._ui as UiRadio};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n    }\n\n    /*\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n    */\n\n    render() {\n        let {defaultValue, list} = this.ui;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n        return <span className={cn} style={radioStyle}>\n                {list.map((v,index) => {\n                    let {value, title} = v;\n                    let name = this.name;\n                    if (rowKey !== undefined) name += '-' + rowKey;\n                    return <label key={index} className=\"form-radio-inline\">\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\n                            onChange={this.onInputChange} />\n                        {title || value}\n                    </label>;\n                    //</span>\n                })}\n            </span>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiRange } from '../../schema';\nimport { Widget } from './widget';\n\nexport class RangeWidget extends Widget {\n    protected inputType = 'range';\n    protected input: HTMLInputElement;\n    protected get ui(): UiRange {return this._ui as UiRange};\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    render() {\n        let {min, max, step} = this.ui;\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\n            type={this.inputType}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}\n            max={max}\n            min={min}\n            step={step}\n            />\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiIdItem, TempletType } from '../../schema';\nimport { observable } from 'mobx';\n\nconst none = <small className=\"text-muted\">[无]</small>;\n\nexport class IdWidget extends Widget {\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\n    @observable protected value:number;\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}    \n\n    protected onClick = async () => {\n        let pickId = this.ui && this.ui.pickId;\n        if (pickId === undefined) {\n            alert('no pickId defined!');\n            return;\n        }\n        let id = await pickId(this.context, this.name, this.value);        \n        this.setDataValue(id);\n        this.clearError();\n        this.clearContextError();\n        this.checkRules();\n    }\n\n    render() {\n        let placeholder:string|JSX.Element, Templet: TempletType;\n        if (this.ui !== undefined) {\n            placeholder = this.ui.placeholder;\n            Templet = this.ui.Templet;\n        }\n        let cn:any = {\n            'form-control': true,\n            'required-item': this.itemSchema.required === true,\n            'cursor-pointer': true,\n            'is-invalid': this.hasError,\n        };\n        let content;\n        if (this.value === undefined || this.value === null) {\n            content = placeholder || none;\n            cn['text-muted'] = true;\n        }\n        else if (Templet === undefined) {\n            let c: any;\n            if (this.value === null) {\n                c = 'null';\n            }\n            else {\n                switch (typeof this.value) {\n                    case 'undefined': c = none; break;\n                    case 'object': c = (this.value as any).id; break;\n                    default: c = this.value; break;\n                }\n            }\n            content = <>{c}</>;\n        }\n        else if (typeof Templet === 'function') {\n            content = Templet(this.value);\n        }\n        else {\n            content = Templet;\n        }\n        return <>\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport { DataType } from '../../schema';\nimport { UiType } from '../../schema';\n\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\n};\n","import * as React from 'react';\nimport { UiButton, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { Widget } from './widget';\nimport { observer } from 'mobx-react';\n\nexport class ButtonWidget extends Widget {\n    protected get ui(): UiButton {return this._ui as UiButton};\n\n    protected onClick = async () => {\n        this.clearError();\n        this.clearContextError();\n        let {name, type} = this.itemSchema;\n        if (type === 'submit') {\n            await this.context.submit(name);\n        }\n        /*\n        let {onButtonClick} = this.context.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${name} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(name, this.context);\n        if (ret === undefined) return;\n        this.context.setError(name, ret);\n        */\n    }\n\n    private observerRender = observer(() => {\n        let {name, type} = this.itemSchema;\n        let Templet:TempletType, cn:string, caption:string;\n        if (this.ui !== undefined) {\n            let {widget:widgetType} = this.ui;\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\n            Templet = this.ui.Templet;\n            cn = this.ui.className;\n            caption = this.ui.label;\n        }\n        let {form, hasError} = this.context;\n        let context = this.context;\n        let disabled = type==='submit' && hasError;\n        let content:any;\n        if (this.children !== undefined) content = this.children;\n        else if (typeof Templet === 'function') content = Templet();\n        else if (Templet !== undefined) content = Templet;\n        else content = caption; \n        let button = <button \n            className={cn} \n            type=\"button\"\n            disabled={disabled}\n            onClick={this.onClick}>\n            {content || name}\n        </button>;\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\n        return <div className={form.ButtonClass}>\n            <div>{this.renderErrors()}</div>\n            {button}\n        </div>;\n    });\n    \n    protected get label():string {return null}\n\n    render() {\n        return React.createElement(this.observerRender);\n    }\n}\n","import * as React from 'react';\nimport { Form } from './form';\nimport { UiSchema, UiArr, UiItem } from '../schema';\nimport { ArrSchema, ItemSchema } from '../schema';\nimport { Widget } from './widgets/widget';\n//import { ArrRow } from './arrRow';\nimport { observable, computed } from 'mobx';\nimport { ContextRule } from './rules';\nimport { observer } from 'mobx-react';\n\nexport abstract class Context {\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\n    readonly form: Form;\n    readonly uiSchema: UiSchema;\n    readonly initData: any;\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\n    readonly widgets: {[name:string]: Widget} = {};\n    readonly rules: ContextRule[];\n    readonly isRow: boolean;\n    @observable errors: string[] = [];\n    @observable errorWidgets:Widget[] = [];\n\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\n        this.form = form;\n        this.uiSchema = uiSchema;\n        this.initData = data;\n        this.inNode = inNode;\n        this.isRow = isRow;\n        if (uiSchema !== undefined) {\n            let {rules} = uiSchema;\n            if (rules !== undefined) {\n                this.rules = [];\n                if (Array.isArray(rules) === false)\n                    this.rules.push(rules as ContextRule);\n                else\n                    this.rules.push(...rules as ContextRule[]);\n            }\n        }\n    }\n\n    getArrRowContexts(arrName: string) {\n        if (this.subContexts === undefined) this.subContexts = {};\n        let arrRowContexts = this.subContexts[arrName];\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\n        return arrRowContexts;\n    }\n\n    abstract get data():any;\n    abstract getItemSchema(itemName:string):ItemSchema;\n    abstract getUiItem(itemName:string):UiItem;\n    get arrName():string {return undefined}\n    getValue(itemName:string):any {return this.initData[itemName]}\n    setValue(itemName:string, value:any) {\n        this.initData[itemName] = value;\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setValue(value);\n    }\n    getDisabled(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) return widget.getDisabled();\n        return undefined;\n    }\n    setDisabled(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setDisabled(value);\n    }\n    getReadOnly(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getReadOnly();\n        return undefined;\n    }\n    setReadOnly(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setReadOnly(value);\n    }\n    getVisible(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getVisible();\n        return undefined;\n    }\n    setVisible(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setVisible(value);\n    }\n\n    async submit(buttonName: string) {\n        this.checkRules()\n        if (this.hasError === true) {\n            let err = '';\n            for (let ew of this.errorWidgets) {\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\n            }\n            console.error(err);\n            return;\n        }\n        let {onButtonClick} = this.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this);\n        if (ret === undefined) return;\n        this.setError(buttonName, ret);\n\n    }\n\n    checkFieldRules() {\n        for (let i in this.widgets) {\n            this.widgets[i].checkRules();\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                arrRowContexts[j].checkFieldRules();\n            }\n        }\n    }\n\n    checkContextRules() {\n        this.clearErrors();\n        if (this.rules === undefined) return;\n        for (let rule of this.rules) {\n            let ret = rule(this);\n            if (ret === undefined) continue;\n            if (Array.isArray(ret) === true) {\n                this.errors.push(...ret as string[]);\n            }\n            else if (typeof ret === 'string') {\n                this.errors.push(ret as string);\n            }\n            else {\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\n            }\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                let rowContext = arrRowContexts[j];\n                rowContext.clearErrors();\n                rowContext.checkContextRules();\n            }\n        }\n    }\n\n    setError(itemName:string, error:string) {\n        let widget = this.widgets[itemName];\n        if (widget === undefined) return;\n        widget.setContextError(error);\n        this.addErrorWidget(widget);\n    }\n\n    clearContextErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearContextError();\n        }\n    }\n\n    clearWidgetsErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearError();\n        }\n    }\n\n    checkRules() {\n        this.clearErrors();\n        this.clearWidgetsErrors();\n        this.checkFieldRules();\n        if (this.hasError === true) return;\n        this.checkContextRules();\n    }\n\n    addErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos < 0) this.errorWidgets.push(widget);\n    }\n    removeErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\n    }\n\n    protected checkHasError():boolean {\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\n        if (ret === true) return true;\n        if (this.subContexts === undefined) return false;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                if (arrRowContexts[j].hasError === true) return true;\n            }\n        }\n        return false;\n    }\n\n    @computed get hasError():boolean {\n        return this.checkHasError();\n    };\n\n    clearErrors() {\n        this.errors.splice(0);\n        this.errorWidgets.splice(0);\n        this.clearContextErrors();\n    }\n\n    renderErrors = observer((): JSX.Element => {\n        let {errors} = this;\n        if (errors.length === 0) return null;\n        return <>\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\n            </span>)}\n        </>\n    });\n}\n\nlet rowKeySeed:number = 1;\nexport class RowContext extends Context {\n    readonly parentContext: Context;\n    readonly arrSchema: ArrSchema;\n    readonly rowKey: number;\n\treadonly data: any;\n    //readonly uiSchema: UiArr;\n\t\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\n        let uiArr:UiArr;\n        let {uiSchema} = parentContext;\n        if (uiSchema !== undefined) {\n            let {items} = uiSchema;\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\n        }\n        super(parentContext.form, uiArr, data, inNode, true);\n        this.parentContext = parentContext;\n        this.arrSchema = arrSchema;\n        this.rowKey = rowKeySeed++;\n        this.data = data;\n    }\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        if (this.uiSchema === undefined) return undefined;\n        let {items} = this.uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName]\n    }\n    get arrName():string {return this.arrSchema.name}\n    clearErrors() {\n        super.clearErrors();\n        this.parentContext.clearErrors();\n    }\n\n    get parentData():any {return this.parentContext.data;}\n}\n\nexport class FormContext extends Context {\n    constructor(form:Form, inNode:boolean) {\n        super(form, form.uiSchema, form.data, inNode, false);\n    }\n    get data():any {return this.form.data}\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        let {uiSchema} = this.form;\n        if (uiSchema === undefined) return undefined;\n        let {items} = uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName];\n    }\n}\n\nexport const ContextContainer = React.createContext<Context>({} as any);\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\n//import { ArrRow } from '../arrRow';\nimport { Context, RowContext, ContextContainer } from '../context';\nimport { ArrSchema } from '../../schema';\nimport { UiArr, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { factory } from './factory';\n\nexport const ArrComponent = observer((\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \n{\n    let {name, arr} = arrSchema;\n    let data = parentContext.initData[name] as any[];\n    let {form} = parentContext;\n    let arrRowContexts = parentContext.getArrRowContexts(name);\n    let ui = parentContext.getUiItem(name) as UiArr;\n    let arrLabel = name;\n    let Templet:TempletType;\n    let selectable:boolean, deletable:boolean, restorable:boolean;\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\n    if (uiSchema !== undefined) {\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\n        if (selectable !== true) selectable = formSelectable;\n        if (deletable !== true) deletable = formDeletable;\n        if (restorable !== true) restorable = formRestorable;\n    }\n    if (ui !== undefined) {\n        let {widget:widgetType, label, \n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\n        } = ui;\n        if (arrSelectable !== undefined) selectable = arrSelectable;\n        if (arrDeletable !== undefined) deletable = arrDeletable;\n        if (arrRestorable !== undefined) restorable = arrRestorable;\n        if (ac !== undefined) ArrContainer = ac;\n        if (rc !== undefined) RowContainer = rc;\n        if (rs !== undefined) RowSeperator = rs;\n        Templet = ui.Templet;\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\n        arrLabel = label || arrLabel;\n    }\n    let first = true;\n    return ArrContainer(arrLabel, <>\n        {data.map((row:any, index) => {\n            let rowContext: RowContext;\n            let rowContent: JSX.Element;\n            let sep = undefined;\n            if (first === false) sep = RowSeperator;\n            else first = false;\n            if (children !== undefined) {\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\n                rowContent = <>{children}</>;\n            }\n            else {\n                let typeofTemplet = typeof Templet;\n                if (typeofTemplet === 'function') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\n                }\n                else if (typeofTemplet === 'object') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = Templet as JSX.Element;\n                }\n                else {\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\n                    rowContent = <>{\n                        arr.map((v, index) => {\n                            return <React.Fragment key={v.name}>\n                                {factory(rowContext, v, undefined)}\n                            </React.Fragment>\n                        })}\n                    </>;\n                }\n            }\n            let {rowKey} = rowContext;\n            arrRowContexts[rowKey] = rowContext;\n\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\n            if (selectable === true) {\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\n                    let {checked} = (evt.target as HTMLInputElement);\n                    row.$isSelected = checked;\n                    let {$source} = row;\n                    if ($source !== undefined) $source.$isSelected = checked;\n                    rowContext.clearErrors();\n                }\n                selectCheck = <div className=\"form-row-checkbox\">\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\n                </div>;\n            }\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\n            if (deletable === true) {\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\n                let onDelClick = () => {\n                    if (restorable === true) {\n                        row.$isDeleted = !isDeleted;\n                        let {$source} = row;\n                        if ($source !== undefined) $source.$isDeleted = !isDeleted;\n                    }\n                    else {\n                        let p = data.indexOf(row);\n                        if (p>=0) data.splice(p, 1);\n                    }\n                    rowContext.clearErrors();\n                }\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\n                    <i className={classNames('fa', icon, 'fa-fw')} />\n                </div>;\n            }\n            let editContainer = selectable===true || deletable===true?\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\n                    {selectCheck}\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\n                    {deleteIcon}\n                </div></fieldset>\n                :\n                (content:any) => content;\n\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\n                {sep}\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\n            </ContextContainer.Provider>;\n        })}\n    </>);\n});\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiImageItem } from '../../schema';\nimport { Image } from '../../image';\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\n\nexport class ImageWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\n    @observable private imageSrc: string;\n\n    init() {\n        super.init();\n        this.imageSrc = this.value;\n    }\n\n    protected onClick = async () => {\n        let edit = new ImageItemEdit(undefined, this.itemSchema, this.ui, this.ui.label, this.value);\n        let ret = await edit.start();\n        if (ret !== null) {\n            this.setValue(ret);\n            this.imageSrc = ret;\n        }\n        await edit.end();\n    }\n\n    render() {\n        return React.createElement(this.observerRender);\n    }\n\n    private observerRender = observer(() => {\n        let cn = [\n            'bg-white p-1 d-flex justify-content-center',\n        ];\n        let onClick: any;\n        if (!this.readOnly && !this.disabled) {\n            cn.push('cursor-pointer');\n            onClick = this.onClick;\n        }\n        return <div className={classNames(cn)} onClick={onClick}>\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\n        </div>;\n    });\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\nimport { RowContext } from '../context';\n\nabstract class TagWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiTag {return this._ui as UiTag};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n\t}\n\t\n\tabstract render():JSX.Element;\n}\n\nexport class TagSingleWidget extends TagWidget {\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n\t\tlet name = this.name;\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputName: name,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\n    }\n}\n\nexport class TagMultiWidget extends TagWidget {\n\tprivate defaultArr:number[];\n\tinit() {\n\t\tsuper.init();\n\t\tlet def = this.defaultValue;\n\t\tswitch (typeof def) {\n\t\t\tdefault:\n\t\t\t\tthis.defaultArr = [];\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\n\t\t\t\tbreak;\n\t\t}\n\t}\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.changeValue(values.join('|'), true);\n\t}\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let cn = classNames(this.className, 'py-0');\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputs: this.inputs,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\n    }\n}\n","import * as React from 'react';\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\nimport { TypeWidget, UiCustom } from '../../schema';\nimport { TextWidget } from './textWidget';\nimport { TextAreaWidget } from './textareaWidget';\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\nimport { UpdownWidget } from './updownWidget';\nimport { NumberWidget } from './numberWidget';\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\nimport { CheckBoxWidget } from './checkBoxWidget';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { SelectWidget } from './selectWidget';\nimport { RadioWidget } from './radioWidget';\nimport { RangeWidget } from './rangeWidget';\nimport { IdWidget } from './idWidget';\nimport { ButtonWidget } from './buttonWidget';\nimport { ArrComponent } from './arrComponent';\nimport { ImageWidget } from './imageWidget';\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\n\nconst widgetsFactory: {[type: string]: {widget?: TypeWidget, dataTypes?: DataType[]}} = {\n    id: {\n        dataTypes: ['id'],\n        widget: IdWidget,\n    },\n    text: {\n        dataTypes: ['integer', 'number', 'string'],\n        widget: TextWidget\n    },\n    textarea: {\n        dataTypes: ['string'],\n        widget: TextAreaWidget\n    },\n    password: {\n        dataTypes: ['string'],\n        widget: PasswordWidget\n    },\n    date: {\n        dataTypes: ['date'],\n        widget: DateWidget\n    },\n    datetime: {\n        dataTypes: ['date'],\n        widget: DateTimeWidget\n    },\n    time: {\n        dataTypes: ['date'],\n        widget: TimeWidget\n    },\n    month: {\n        dataTypes: ['date'],\n        widget: MonthWidget\n    },\n    select: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: SelectWidget\n    },\n    url: {\n        dataTypes: ['string'],\n        widget: UrlWidget\n    },\n    email: {\n        dataTypes: ['string'],\n        widget: EmailWidget\n    },\n    number: {\n        dataTypes: ['integer', 'number'],\n        widget: NumberWidget\n    },\n    updown: {\n        dataTypes: ['integer', 'number'],\n        widget: UpdownWidget\n    },\n    color: {\n\n    },\n    checkbox: {\n        dataTypes: ['boolean', 'integer', 'number'],\n        widget: CheckBoxWidget\n    },\n    image: {\n        dataTypes: ['string'],\n        widget: ImageWidget,\n    },\n    checkboxes: {\n\n    },\n    radio: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: RadioWidget\n\t},\n\ttagSingle: {\n\t\tdataTypes: ['integer'],\n\t\twidget: TagSingleWidget\n\t},\n\ttagMulti: {\n\t\tdataTypes: ['string'],\n\t\twidget: TagMultiWidget\n\t},\n    range: {\n        dataTypes: ['integer'],\n        widget: RangeWidget,\n    },\n    button: {\n        dataTypes: ['button', 'submit'],\n        widget: ButtonWidget,\n    }\n}\n\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\n    if (context === undefined) {\n        debugger;\n        return null;\n    }\n    if (itemSchema === undefined) return undefined;\n    let {name, type} = itemSchema;\n    switch (type) {\n    case 'arr':\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\n    default:\n        break;\n    }\n\n    let typeWidget: TypeWidget;\n    let ui = context.getUiItem(name);\n    function getTypeWidget(t:DataType): TypeWidget {\n        switch(t) {\n        default: return TextWidget; \n        case 'id': return IdWidget;\n        case 'integer': return UpdownWidget;\n        case 'number': return NumberWidget; \n        case 'string': return TextWidget; \n        case 'date': return DateWidget; \n        case 'boolean': return CheckBoxWidget; \n        case 'button':\n        case 'submit': return ButtonWidget;\n        }\n    }\n    if (ui === undefined) { \n        typeWidget = getTypeWidget(type);\n    }\n    else {\n        let {widget:widgetType} = ui;\n        switch (widgetType) {\n        default:\n            if (widgetType !== undefined) {\n                let widgetFactory = widgetsFactory[widgetType];\n                typeWidget = widgetFactory.widget;\n            }\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\n            break;\n        case 'custom':\n            typeWidget = (ui as UiCustom).WidgetClass;\n            break;\n        case 'group':\n            return <span>impletment group</span>;\n        }\n        //label = uiLabel || name;\n    }\n    \n    let {widgets} = context;\n    let widget = new typeWidget(context, itemSchema, fieldProps, children);\n    widget.init();\n    widgets[name] = widget;\n\n    return <widget.container />;\n    /*\n    if (isRow === false) {\n        let WidgetElement = observer(() => widget.container());\n        return <WidgetElement />;\n    }\n    else {\n        let widgetElement = widget.container();\n        return widgetElement;\n    }\n    */\n}\n\n","import * as React from 'react';\nimport {observable, IReactionDisposer, autorun} from 'mobx';\nimport classNames from 'classnames';\nimport { Schema, ItemSchema, ArrSchema } from '../schema';\nimport { UiSchema, TempletType } from '../schema';\nimport { factory } from './widgets';\nimport 'font-awesome/css/font-awesome.min.css';\nimport { ContextContainer, FormContext, Context } from './context';\nimport { FormRes, formRes } from '../../res';\nimport { resLang } from '../../res/res';\n\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\n\nexport interface FormProps {\n    className?: string;\n    schema: Schema;\n    uiSchema?: UiSchema;\n    formData?: any;\n    onButtonClick?: FormButtonClick;\n    onEnter?: InputEnter;\n    fieldLabelSize?: number;            // col-sm-2 for label\n    requiredFlag?: boolean;             // default=true\n    beforeShow?: (formContext:FormContext) => void;\n    res?: FormRes;\n\n    Container?: (content:JSX.Element) => JSX.Element;\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\n    FieldClass?: string;\n    ButtonClass?: string;\n}\n\nexport class Form extends React.Component<FormProps> {\n    readonly schema: Schema;\n    readonly itemSchemas: {[name:string]: ItemSchema};\n    readonly uiSchema: UiSchema;\n    readonly res?: FormRes;\n    protected formContext: FormContext;\n    private disposer: IReactionDisposer;\n    readonly data:any;\n\n    readonly Container: (content:JSX.Element) => JSX.Element;\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\n    readonly FieldClass: string;\n    readonly ButtonClass: string;\n    \n    constructor(props:FormProps) {\n        super(props);\n        let {schema, uiSchema, \n            Container, FieldContainer, FieldClass, \n            ButtonClass, res,\n        } = props;\n        this.Container = Container || this.DefaultContainer;\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\n        this.res = res || this.DefaultRes;\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\n\n        this.schema = schema;\n        this.itemSchemas = {};\n        for (let itemSchema of this.schema) {\n            this.itemSchemas[itemSchema.name] = itemSchema;\n        }\n        this.uiSchema = uiSchema;\n\n        this.disposer = autorun(this.watch);\n        this.data = {};\n    }\n\n    private renderContent():any {\n        this.initData(this.props.formData);\n        let {children} = this.props;\n        if (children !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return <>{children}</>;\n        }\n\n        let Templet: TempletType;\n        if (this.uiSchema !== undefined) {\n            Templet = this.uiSchema.Templet;\n        }\n        if (Templet !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\n        }\n\n        this.formContext = new FormContext(this, false);\n        return <>{this.schema.map((v, index) => {\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\n        })}</>;\n    }\n\n    private initData(formData: any) {\n        if (formData === undefined) formData = {};\n        if (this.uiSchema !== undefined) {\n            let {items} = this.uiSchema;\n            if (items !== undefined) {\n                for (let i in items) {\n                    let ui = items[i];\n                    let dv = ui.defaultValue;\n                    if (dv !== undefined) {\n                        if (formData[i] === undefined) {\n                            formData[i] = dv;\n                        }\n                    }\n                }\n            }\n        }\n        for (let itemSchema of this.schema) {\n            this.initDataItem(itemSchema, this.data, formData);\n        }\n    }\n\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\n        let {name, type} = itemSchema;\n        if (type === 'button') return;\n        if (type !== 'arr') {\n            data[name] = formData[name];\n            return;\n        }\n\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\n        let {arr:arrItems} = arrItem;\n        if (arrItems === undefined) return;\n        let arrDict:any = arrItem.itemSchemas = {};\n        for (let item of arrItems) {\n            arrDict[item.name] = item;\n        }\n        let val:any[] = formData[name];\n        if (val === undefined) val = [];\n        else if (Array.isArray(val) === false) val = [val];\n        let arr:any[] = [];\n        for (let row of val) {\n            let {$isSelected, $isDeleted} = row;\n            let r = {\n                $source: row,\n                $isSelected: $isSelected,\n                $isDeleted: $isDeleted,\n            };\n            for (let item of arrItems) {\n                this.initDataItem(item, r, row);\n            }\n            arr.push(r);\n        }\n        // 如果没有observable，行删除标志点击不管用\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\n        data[name] = observable(arr);\n        //data[name] = arr;\n        return;\n    }\n\n    private watch = () => {\n        let {formData} = this.props;\n        if (formData === undefined) return;\n        //this.initData(formData);\n        this.calcSelectOrDelete();\n    }\n    private calcSelectOrDelete() {\n        for (let itemSchema of this.schema) {\n            this.arrItemOperated(itemSchema);\n        }\n    }\n\n    private arrItemOperated(itemSchema: ItemSchema) {\n        let {name, type} = itemSchema;\n        if (type !== 'arr') return;\n        if (this.data === undefined) return;\n        let formArrVal = this.data[name];\n        if (formArrVal === undefined) return;\n        let {arr: arrItems} = itemSchema as ArrSchema;\n        for (let row of formArrVal) {\n            let {$source} = row;\n            if ($source === undefined) continue;\n            let {$isSelected, $isDeleted} = $source;\n            row.$isSelected = $isSelected;\n            row.$isDeleted = $isDeleted;\n            //console.log($isSelected, $isDeleted);\n            for (let item of arrItems) {\n                this.arrItemOperated(item);\n            }\n        }\n    }\n\n    componentDidMount() {\n        let {beforeShow} = this.props;\n        if (beforeShow !== undefined) beforeShow(this.formContext);\n    }\n\n    componentWillUnmount() {\n        if (this.disposer !== undefined) this.disposer();\n    }\n\n    render() {\n        let content = this.renderContent();\n        return <ContextContainer.Provider value={this.formContext}>\n            {React.createElement(this.formContext.renderErrors)}\n            {this.Container(content)}\n        </ContextContainer.Provider>;\n    }\n\n    async buttonClick(buttonName:string) {\n        this.formContext.checkRules()\n        if (this.formContext.hasError === true) return;\n\n        let {onButtonClick} = this.formContext.form.props;\n        if (onButtonClick === undefined) {\n            alert(`you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this.formContext);\n        if (ret === undefined) return;\n        this.formContext.setError(buttonName, ret);\n    }\n\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\n            {content}\n        </form>;\n    }\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\n        let {fieldLabelSize} = this.props;\n\n        if (fieldLabelSize > 0) {\n            let labelView:any;\n            if (label === null) {\n                fieldLabelSize = 0;\n            }\n            else {\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label')}>{label}</label>\n            }\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\n            return <div className=\"form-group row\">\n                {labelView}\n                <div className={fieldCol}>{content}</div>\n            </div>;\n        }\n        return <div className=\"form-group\">\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\n            {content}\n        </div>;\n    }\n    protected DefaultFieldClass:string = undefined;\n    protected DefaultButtonClass = 'text-center py-2';\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\n\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\n        return <div>\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\n            {content}\n        </div>;\n    }\n    RowContainer = (content:JSX.Element): JSX.Element => {\n        let cn = classNames({\n            'py-3': true\n        });\n        return <div className={cn}>{content}</div>\n    }\n    RowSeperator = <div className=\"border border-gray border-top\" />;\n}\n","import * as React from 'react';\nimport { factory } from './widgets';\nimport { ContextContainer, Context } from './context';\n\nexport interface FieldProps {\n    name: string;\n}\n\nexport class FormField extends React.Component<FieldProps> {\n    static contextType = ContextContainer;\n    render() {\n        let {name, children } = this.props;\n        let context:Context = this.context;\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\n        let itemSchema = context.getItemSchema(name);\n        let content = factory(context, itemSchema, children, this.props);\n        if (content === undefined) {\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\n        }\n        return content;\n    }\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport interface InputOptions {\n\ttype: string;\n\tmin?: number;\n\tmax?: number;\n\tstep?: number;\n}\n\nexport class StringItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n\t}\n\t\n\tprotected inputOptions():InputOptions {\n\t\treturn {\n\t\t\ttype: 'text',\n\t\t}\n\t}\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (evt.keyCode === 13) onSave();\n\t\t}\n\t\tlet {type, max, min, step} = this.inputOptions();\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<input type={type}\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n                    defaultValue={this.value} min={min} max={max} step={step} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiRadio } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class RadioItemEdit extends ItemEdit {\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value: any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {name} = this.itemSchema;\n        let {list} = this.uiItem;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n            }}>保存</button>;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input name={name} type=\"radio\" value={value} \n                        onClick={()=>this.onChange(value)} \n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\n                </label></div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\n\t\t\t</div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiSelect } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class SelectItemEdit extends ItemEdit {\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiIdItem } from '../schema';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class IdItemEdit extends ItemEdit {\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>(async (resolve, reject) => {\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            //nav.push(element,reject);\n\n            let {pickId} = this.uiItem;\n            if (pickId === undefined) {\n                alert('IdItemEdit.pickId = undefined');\n                return;\n            }\n            let boxId = await pickId(undefined, undefined, this.value);\n            //if (typeof id === 'object') {\n            //    id = (id as any).id;\n            //}\n            this.onChange(boxId.id);\n            resolve(boxId);\n            //this.newValue = id;\n        });\n    }\n\n    protected async internalEnd():Promise<void> {}\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        /*\n        let {resolve, reject} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n        */\n        return <Page header={'更改' + this.label}>\n            ddd\n        </Page>\n    })\n}\n","import * as React from 'react';\nimport { UiTag } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nabstract class TagItemEdit extends ItemEdit {\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\n\tprotected inputType: 'checkbox' | 'radio';\n    get uiItem(): UiTag {return this._uiItem as UiTag};\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n\t}\n\t\n\trenderContent() {\n\t\tlet valuesView = this.uiItem.valuesView;\n\t\tif (valuesView === undefined) return super.renderContent();\n\t\treturn valuesView.render(this.value);\n\t}\n\n\tprotected abstract renderInputs():JSX.Element;\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n\t\t\t}}>保存</button>;\n\t\t/*\n        let content = list?\n            list.map((v, index:number) => {\n                let {name:itemName, id} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\n                </label></div>;\n            })\n            :\n\t\t\t<>no list defined</>;\n\t\t*/\n        return <Page header={'更改' + this.label} right={right}>\n\t\t\t<div className=\"p-3\">\n\t\t\t\t{this.renderInputs()}\n\t\t\t</div>\n        </Page>;\n    })\n}\n\nexport class TagSingleItemEdit extends TagItemEdit {\n\tprotected inputType:'radio'|'checkbox' = 'radio';\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {currentTarget} = evt;\n\t\tif (currentTarget.checked === false) return;\n        this.newValue = Number(currentTarget.value);\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\t\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange,\n\t\t};\n\t\treturn valuesView.renderRadios(this.value, options);\n\t}\n}\n\nexport class TagMultiItemEdit extends TagItemEdit {\n\t//private arr:number[];\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\n\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.newValue = values.join('|');\n        //this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange\n\t\t};\n\t\treturn valuesView.renderChecks(this.value, options);\n\t}\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class TextAreaItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\n\t\t\t// if (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <textarea\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n\t\t\t\t\tdefaultValue={this.value}\n\t\t\t\t\trows={6} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import React from 'react';\nimport { UiCheckItem } from '../schema';\nimport { ItemEdit } from './itemEdit';\n\nexport class CheckBoxItemEdit extends ItemEdit {\n\tprivate input: HTMLInputElement;\n    get uiItem(): UiCheckItem {return this._uiItem as UiCheckItem}\n\tget editInRow(): boolean {return true;}\n    protected async internalStart():Promise<any> {\n\t\tif (!this.input) return;\n\t\tlet uiItem = this.uiItem;\n\t\tif (uiItem === undefined) return this.input.checked;\n\t\tlet {checked} = this.input;\n\t\treturn this.getValue(checked);\n    }\n\tasync end():Promise<any> {}\n\trenderContent() {\n\t\tlet {readOnly} = this.uiItem;\n\t\tlet disabled = readOnly === true;\n\t\tlet onChange:any;\n\t\tif (readOnly !== true) onChange = this.onChange;\n\t\treturn <input ref={r => this.input=r} type=\"checkbox\" \n\t\t\tdefaultChecked={this.value} disabled={disabled}\n\t\t\tonChange={onChange} />\n\t}\n\n\tprivate getValue(checked: boolean) {\n\t\tlet {trueValue, falseValue} = this.uiItem;\n        return checked === true? (trueValue??true) : (falseValue??false);\n\t}\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = this.getValue(evt.target.checked);\n        let preValue = this.value;\n\t\tthis.isChanged = (this.newValue !== preValue);\n\t\tthis.edit.onItemChanged(this, this.newValue);\n    }\n}\n","import { UiRange } from \"../schema\";\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\n\nexport class RangeItemEdit extends StringItemEdit {\n\tprotected inputOptions():InputOptions {\n\t\tlet min:number, max:number, step:number;\n\t\tif (this._uiItem) {\n\t\t\tmin = (this._uiItem as UiRange).min\n\t\t\tmax = (this._uiItem as UiRange).max\n\t\t\tstep = (this._uiItem as UiRange).step\n\t\t}\n\t\treturn {\n\t\t\ttype: 'range',\n\t\t\tmin, max, step\n\t\t}\n\t}\n}\n","import { UiNumberItem } from \"../schema\";\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\n\nexport class NumberItemEdit extends StringItemEdit {\n\tprotected inputOptions():InputOptions {\n\t\tlet min:number, max:number, step:number;\n\t\tif (this._uiItem) {\n\t\t\tmin = (this._uiItem as UiNumberItem).min\n\t\t\tmax = (this._uiItem as UiNumberItem).max\n\t\t\tstep = (this._uiItem as UiNumberItem).step\n\t\t}\n\t\treturn {\n\t\t\ttype: 'number',\n\t\t\tmin, max, step\n\t\t}\n\t}\n}\n","import * as React from 'react';\n//import _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\nimport { ItemEdit } from './itemEdit';\nimport { StringItemEdit } from './stringItemEdit';\nimport { ImageItemEdit } from './imageItemEdit';\nimport { RadioItemEdit } from './radioItemEdit';\nimport { SelectItemEdit } from './selectItemEdit';\nimport { IdItemEdit } from './idItemEdit';\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\nimport { TextAreaItemEdit } from './textAreaItemEdit';\nimport { CheckBoxItemEdit } from './checkBoxItemEdit';\nimport { RangeItemEdit } from './rangeItemEdit';\nimport { NumberItemEdit } from './numberItemEdit';\n\nexport interface EditProps {\n    className?: string;\n    schema: Schema;\n    data: any;\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\n    stopEdit?: boolean;\n    uiSchema?: UiSchema;\n    sepClassName?: string;\n    topBorderClassName?: string;\n    bottomBorderClassName?: string;\n    rowContainerClassName?: string;\n}\n\n@observer\nexport class Edit extends React.Component<EditProps> {\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\n    private topBorder:JSX.Element;\n    private bottomBorder:JSX.Element;\n    private rowContainerClassName?: string;\n    private sep:JSX.Element;\n\tprivate uiSchema: {[name:string]: UiItem};\n\n    constructor(props: EditProps) {\n        super(props);\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema} = props;\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\n        //if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\n    }\n\n    render() {\n        let {schema} = this.props;\n\t\tlet sep:any;\n        return <div>\n\t\t\t{this.topBorder}\n            {schema.map((itemSchema, index) => {\n\t\t\t\tlet {stopEdit} = this.props;\n\t\t\t\tlet {name} = itemSchema;\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\n\t\t\t\tlet label:string, labelHide:any;\n\t\t\t\tif (uiItem !== undefined) {\n\t\t\t\t\tlabel = uiItem.label || name;\n\t\t\t\t\tlabelHide = uiItem.labelHide;\n\t\t\t\t};\n\t\t\t\tlet value = this.props.data[name];\n\t\t\t\tlet itemEdit = createItemEdit(this, itemSchema, uiItem, label, value);\n\t\t\t\tlet rowContainerClassName = this.rowContainerClassName;\n\t\t\t\tlet {editInRow} = itemEdit;\n\t\t\t\tif (editInRow === false) {\n\t\t\t\t\tif (stopEdit !== true) editInRow = false;\n\t\t\t\t}\n\t\t\t\tif (editInRow === false) rowContainerClassName += ' cursor-pointer';\n\n\t\t\t\tlet {required} = itemSchema;\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\n\t\t\t\tif (labelHide === true) {\n\t\t\t\t\tdivLabel = undefined;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\n\t\t\t\t\tcn += 'justify-content-end';\n\t\t\t\t}\n\t\t\t\tlet ret = <React.Fragment key={index}>\n\t\t\t\t\t{sep}\n\t\t\t\t\t<div className={'d-flex align-items-center' + rowContainerClassName} \n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\n\t\t\t\t\t\t{divLabel}\n\t\t\t\t\t\t<div className={cn}>{\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\n\t\t\t\t\t\t}</div>\n\t\t\t\t\t\t{editInRow === false && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\n\t\t\t\t\t</div>\n\t\t\t\t</React.Fragment>;\n\t\t\t\tsep = this.sep;\n\t\t\t\treturn ret;\n\t\t\t})}\n\t\t\t{this.bottomBorder}\n\t\t</div>;\n    }\n\n\tasync onItemChanged(itemEdit:ItemEdit, newValue:any) {\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\n\t\tthis.props.data[itemSchema.name] = newValue;\n        let {onItemChanged, stopEdit} = this.props;\n\t\tif (stopEdit === true) return;\n\t\tif (uiItem?.readOnly === true) return;\n\t\tif (onItemChanged === undefined) {\n\t\t\talert(`${itemSchema.name} value changed, new: ${newValue}, pre: ${value}`);\n\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\n\t\t\t//this.props.data[itemSchema.name] = changeValue;\n\t\t}\n\t\telse {\n\t\t\tawait onItemChanged(itemSchema, newValue, value);\n\t\t}\n\t}\n\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\n\t\tif (itemEdit === undefined) {\n\t\t\talert('item has no edit');\n\t\t\treturn;\n\t\t}\n\t\tlet {itemSchema, uiItem, value, editInRow} = itemEdit;\n\t\tif (editInRow === true) return;\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\n\t\tif (stopEdit === true) return;\n\t\tif (uiItem?.readOnly === true) return;\n        let changeValue:any;\n        if (onItemClick !== undefined) {\n            await onItemClick(itemSchema, uiItem, value);\n            return;\n        }\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\n        if (itemEdit === undefined) {\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\n            return;\n        }\n        try {\n            changeValue = await itemEdit.start();\n            if (changeValue !== value) {\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\n                if (onItemChanged === undefined) {\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\n                    //this.props.data[itemSchema.name] = changeValue;\n                }\n                else {\n                    await onItemChanged(itemSchema, changeValue, value);\n                }\n            }\n            await itemEdit.end();\n        }\n        catch (err) {\n            // 如果直接back，会触发reject，就到这里了\n\t\t\tconsole.log('no value changed');\n\t\t\tconsole.error(err);\n        }\n    }\n}\n\ntype NewItemEdit = new (edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) => ItemEdit;\n\nfunction createItemEdit(edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any):ItemEdit {\n\tlet ie: ItemEdit;\n    let itemEdit: NewItemEdit;\n    if (uiItem !== undefined) {\n        switch (uiItem.widget) {\n            default: break;\n            case 'id': itemEdit = IdItemEdit; break;\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\n            case 'image': itemEdit = ImageItemEdit; break;\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\n\t\t\tcase 'range': itemEdit = RangeItemEdit; break;\n\t\t\tcase 'number':\n\t\t\tcase 'updown': itemEdit = NumberItemEdit; break;\n\t\t\tcase 'checkbox': itemEdit = CheckBoxItemEdit; break;\n            case 'radio': \n\t\t\t\tie = new RadioItemEdit(edit, itemSchema, uiItem as UiRadio, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagSingle':\n\t\t\t\tie = new TagSingleItemEdit(edit, itemSchema, uiItem as UiTagSingle, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagMulti':\n\t\t\t\tie = new TagMultiItemEdit(edit, itemSchema, uiItem as UiTagMulti, label, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\tif (ie === undefined) {\n\t\tif (itemEdit === undefined) {\n\t\t\tswitch (itemSchema.type) {\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\n\t\t\t\tcase 'boolean': itemEdit = CheckBoxItemEdit; break;\n\t\t\t\tcase 'number':\n\t\t\t\tcase 'integer': itemEdit = RangeItemEdit; break;\n\t\t\t}\n\t\t}\n\t\tif (itemEdit === undefined) return;\n\t\tie = new itemEdit(edit, itemSchema, uiItem, label, value);\n\t}\n\tie.init();\n\treturn ie;\n}\n","import {CenterApiBase} from '../net';\n\nexport class CenterApi extends CenterApiBase {\n    async userAppUnits(app:number):Promise<any[]> {\n        return await this.get('tie/user-app-units', {app:app});\n    }\n    async userFromId(userId:number):Promise<any> {\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\n\t}\n\tasync userFromKey(userName:string):Promise<any> {\n\t\treturn await this.get('tie/user-from-key', {key:userName});\n\t}\n}\n\nexport const centerApi = new CenterApi('tv/', undefined);\n","import * as React from 'react';\nimport { Page, FA, nav, LMR, List } from \"../components\";\nimport { VPage } from '../vm';\nimport { appInFrame } from '../net';\nimport { CAppBase } from \"./CAppBase\";\nimport { UQsMan } from '../uq';\n\n/*\nexport class VAppMain extends VPage<CMainBase> {\n    async open(param?:any) {\n        this.openPage(this.appPage);\n    }\n\n    render(param?:any) {\n        return this.appContent();\n    }\n\n    protected appPage = () => {\n        let {caption} = this.controller;\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\n            {this.appContent()}\n        </Page>;\n    }\n\n    protected appContent = () => {\n        let {cUqArr} = this.controller;\n        let content:any;\n        if (cUqArr.length === 0) {\n            content = <div className=\"text-danger\">\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\n            </div>;\n        }\n        else {\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\n        }\n        return <>{content}</>;\n    };\n}\n*/\nexport class VUnsupportedUnit extends VPage<CAppBase> {\n    async open(predefinedUnit: number) {\n        this.openPage(this.page, {predefinedUnit:predefinedUnit});\n    }\n\n    private page = ({predefinedUnit}:{predefinedUnit: number}) => {\n        let {user} = nav;\n        let userName:string = user? user.name : '[未登录]';\n        let {appOwner, appName} = UQsMan.value;\n        return <Page header=\"APP无法运行\" logout={true}>\n            <div className=\"m-3 text-danger container\">\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\n                    <div className=\"col-sm text-body\">{userName}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">App</div>\n                    <div className=\"col-sm text-body\">{`${appOwner}/${appName}`}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">\n                        可能原因<FA name=\"exclamation-triangle\" />\n                    </div>\n                    <div className=\"col-sm text-body\">\n                        <ul className=\"p-0\">\n                            <li>没有小号运行 {appName}</li>\n                            <li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\n                            {\n                                predefinedUnit && \n                                <li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\n                            }\n                        </ul>\n                    </div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\n                    <div className=\"col-sm text-body\">\n                        预设小号定义在 public/unit.json 文件中。\n                        定义了这个文件的程序，只能由url直接启动。\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\n                        如果要删去缓存的预定义Unit，logout然后再login。\n                    </div>\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\nexport class VUnitSelect extends VPage<CAppBase> {\n    async open() {\n        this.openPage(this.page);\n    }\n\n    private renderRow = (item: any, index: number):JSX.Element => {\n        let {id, nick, name} = item;\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\n            <div>{nick || name}</div>\n        </LMR>;\n    }\n    private onRowClick = async (appUnit: any) => {\n\t\tappInFrame.unit = appUnit.id; // 25;\n\t\tthis.controller.setAppUnit(appUnit);\n        await this.controller.start();\n    }\n\n    private page = () => {\n        return <Page header=\"选择小号\" logout={true}>\n            <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\n        </Page>\n    }\n}\n\nexport class VErrorsPage extends VPage<CAppBase> {\n    async open(errors:string[]) {\n        this.openPage(this.page, {errors:errors});\n    }\n\n    private page = (errors:{errors:string[]}) => {\n        return <Page header=\"ERROR\">\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\n\t\t\t\t</div>\n\n                <div>Load Uqs 发生错误：</div>\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\n            </div>\n        </Page>;\n    }\n}\n\nexport class VStartError extends VPage<CAppBase> {\n    async open(error:any) {\n        this.openPage(this.page, {error:error});\n    }\n\n    private page = ({error}:{error:any}) => {\n        return <Page header=\"App start error!\">\n            <pre>\n                {typeof error === 'string'? error : error.message}\n            </pre>\n        </Page>;\n    }\n}","import { nav, t, setGlobalRes, RouteFunc, Hooks, Navigo, NamedRoute } from \"../components\";\nimport { Controller } from '../vm';\nimport { UQsMan, TVs } from \"../uq\";\nimport { appInFrame } from \"../net\";\nimport { centerApi } from \"./centerApi\";\nimport { VUnitSelect, VErrorsPage, VStartError, VUnsupportedUnit } from \"./vMain\";\n\nexport interface IConstructor<T> {\n    new (...args: any[]): T;\n}\n\nexport interface AppConfig {\n    appName: string;        // 格式: owner/appName\n    version: string;        // 版本变化，缓存的uqs才会重载\n    tvs: TVs;\n    uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\n    loginTop?: JSX.Element;\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\n\tprivacy?: string;\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\n\thtmlTitle?: string;\n}\n\nexport interface Elements {\n\t[id:string]: (element: HTMLElement)=>void,\n}\n\nexport abstract class CAppBase extends Controller {\n\tprivate appConfig: AppConfig;\n    protected _uqs: any;\n\n    protected readonly name: string;\n\tprotected readonly noUnit: boolean;\n\n    appUnits:any[];\n\n    constructor(config?: AppConfig) {\n\t\tsuper(undefined);\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\n        let {appName, noUnit} = this.appConfig;\n        this.name = appName;\n        if (appName === undefined) {\n            throw new Error('appName like \"owner/app\" must be defined in MainConfig');\n        }\n\t\tthis.noUnit = noUnit;\n    }\n\n    get uqs(): any {return this._uqs;}\n\n\tinternalT(str:string):any {\n\t\treturn t(str);\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tsetGlobalRes(res);\n\t}\n\t\n\tprotected hookElements(elements: Elements) {\n\t\tif (elements === undefined) return;\n\t\tfor (let i in elements) {\n\t\t\tlet el = document.getElementById(i);\n\t\t\tif (el) {\n\t\t\t\telements[i](el);\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate appUnit:any;\n\tprivate roleDefines: string[];\n\thasRole(role: string|number):boolean {\n\t\tlet nRole:number;\n\t\tif (typeof role === 'string') {\n\t\t\tif (role.length === 0) return false;\n\t\t\tlet index = this.roleDefines.findIndex(v => v === role);\n\t\t\tif (index < 0) return false;\n\t\t\tnRole = 1<<index;\n\t\t}\n\t\telse {\n\t\t\tnRole = role;\n\t\t}\n\t\treturn (this.appUnit.roles & nRole) !== 0;\n\t}\n\n\tsetAppUnit(appUnit:any) {\n\t\tthis.appUnit = appUnit;\n\t}\n\t\n    protected async beforeStart():Promise<boolean> {\n        try {\n\t\t\tthis.onRoute();\n\t\t\tif (nav.isRouting === false) {\n\t\t\t\t//await nav.init();\n\t\t\t\tlet {appName, version, tvs} = this.appConfig;\n\t\t\t\tawait UQsMan.load(appName, version, tvs);\n\t\t\t}\n\t\t\tthis._uqs = UQsMan._uqs;\n\t\t\n            //let retErrors = await this.load();\n            //let app = await loadAppUqs(this.appOwner, this.appName);\n            // if (isDevelopment === true) {\n\t\t\t// 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\n\t\t\tlet retErrors = UQsMan.errors;\n            let {predefinedUnit} = appInFrame;\n            let {user} = nav;\n            if (user !== undefined && user.id > 0) {\n\t\t\t\tlet result = await centerApi.userAppUnits(UQsMan.value.id);\n\t\t\t\t// 老版本，只返回一个数组。新版本，返回两个数组。下面做两个数组的判断\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\tthis.appUnits = result;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (Array.isArray(result[0]) === true) {\n\t\t\t\t\t\tthis.appUnits = result[0];\n\t\t\t\t\t\tlet result1 = result[1];\n\t\t\t\t\t\tif (Array.isArray(result1) === true) {\n\t\t\t\t\t\t\tthis.roleDefines = result1[0]?.roles?.split('\\t');\n\t\t\t\t\t\t\tif (this.roleDefines === undefined) this.roleDefines = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.appUnits = result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.noUnit === true) return true;\n                switch (this.appUnits.length) {\n                    case 0:\n                        this.showUnsupport(predefinedUnit);\n\t\t\t\t\t\treturn false;\n                    case 1:\n\t\t\t\t\t\tthis.appUnit = this.appUnits[0];\n                        let appUnitId = this.appUnit.id;\n                        if (appUnitId === undefined || appUnitId < 0 || \n                            (predefinedUnit !== undefined && appUnitId !== predefinedUnit))\n                        {\n                            this.showUnsupport(predefinedUnit);\n                            return false;\n                        }\n                        appInFrame.unit = appUnitId;\n                        break;\n                    default:\n                        if (predefinedUnit>0 && this.appUnits.find(v => v.id===predefinedUnit) !== undefined) {\n                            appInFrame.unit = predefinedUnit;\n                            break;\n                        }\n                        this.openVPage(VUnitSelect);\n                        return false;\n                }\n            }\n            if (retErrors !== undefined) {\n                this.openVPage(VErrorsPage, retErrors);\n                return false;\n            }\n            return true;\n        }\n        catch (err) {\n            this.openVPage(VStartError, err);\n            return false;\n        }\n    }\n\tprotected async afterStart():Promise<void> {\n\t\tnav.resolveRoute();\n\t}\n\n    async userFromId(userId:number):Promise<any> {\n        return await centerApi.userFromId(userId);\n    }\n\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\tprotected on(...args:any[]):Navigo {\n\t\treturn nav.on(args[0], args[1], args[2]);\n\t}\n\n\tprotected onRoute() {\n\t}\n\n    private showUnsupport(predefinedUnit: number) {\n        nav.clear();\n        this.openVPage(VUnsupportedUnit, predefinedUnit);\n    }\n}\n","import { AppConfig, CAppBase } from './CAppBase';\n\nexport async function start(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig, isUserLogin?:boolean) {\t\n\tlet {htmlTitle} = appConfig;\n\tif (htmlTitle) {\n\t\tdocument.title = htmlTitle;\n\t}\n\tlet html = document.getElementsByTagName('html');\n\tlet html0 = html[0];\n\tif (html0) {\n\t\tlet version = html0?.getAttribute('data-version');\n\t\tif (version) appConfig.version = version;\n\t}\n\n\tlet cApp = new CApp(appConfig);\n    await cApp.start(isUserLogin);\n}\n","import _ from 'lodash';\nimport { Controller, WebNav } from \"../vm\";\nimport { IConstructor } from \"./CAppBase\";\n\nexport abstract class CBase extends Controller {\n    protected readonly _uqs: any;\n    protected readonly _cApp: any;\n\n    constructor(cApp: any) {\n        super(cApp.res);\n        this._cApp = cApp;\n        this._uqs = cApp && cApp.uqs;\n\t}\n\n    protected get uqs(): any {return this._uqs}\n\tget cApp(): any {return this._cApp}\n\thasRole(role:string|number):boolean {\n\t\treturn this._cApp?.hasRole(role);\n\t}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._cApp.internalT(str);\n\t}\n\n    protected newC<T extends CBase>(type: IConstructor<T>, param?:any):T {\n\t\tlet c = new type(this.cApp);\n\t\tc.init(param);\n\t\treturn c;\n    }\n\n    protected newSub<O extends CBase, T extends CSub<O>>(type: IConstructor<T>, param?:any):T {\n\t\tlet s = new type(this);\n\t\ts.init(param);\n\t\treturn s;\n\t}\n\t\n\tgetWebNav(): WebNav<any> {\n\t\tlet wn = this._cApp?.getWebNav();\n\t\tif (wn === undefined) return;\n\t\tlet ret = _.clone(wn);\n\t\t_.merge(ret, this.webNav);\n\t\treturn ret;\n\t}\n}\n\nexport abstract class CSub<T extends CBase> extends CBase {\n    protected _owner: T;\n\n    constructor(owner: T) {\n        super(owner.cApp);\n        this._owner = owner;\n\t}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._owner.internalT(str);\n\t}\n\n    protected get owner(): CBase {return this._owner}\n\t\n\tgetWebNav(): WebNav<any> {\n\t\tlet wn = this._cApp?.getWebNave();\n\t\tif (wn === undefined) return;\n\t\tlet ownerWNs:WebNav<any>[] = [];\n\t\tfor (let p = this.owner; p!==undefined; p = (p as any)?.owner) {\n\t\t\townerWNs.push(p.webNav);\n\t\t}\n\t\tlet ret = _.clone(wn);\n\t\tfor (;;) {\n\t\t\tlet own = ownerWNs.pop();\n\t\t\tif (own === undefined) break;\n\t\t\t_.merge(ret, own);\n\t\t}\n\t\t_.merge(ret, this.webNav);\n\t\treturn ret;\n\t}\n}\n","import * as React from 'react';\nimport { IObservableArray, computed } from 'mobx';\nimport { PageItems } from '../../tool/pageItems';\nimport {List} from './index';\n\nexport abstract class ListBase {\n    protected list: List;\n    constructor(list: List) {\n        this.list = list;\n    }\n    get isPaged():boolean {\n        let items = this.list.props.items;\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\n    }\n    get items():any[]|IObservableArray<any> {\n        let items = this.list.props.items;\n        if (items === null) return null;\n        if (items === undefined) return undefined;\n        if (Array.isArray(items) === true)\n            return items as IObservableArray<any>;\n        else\n            return (items as PageItems<any>).items;\n    }\n    @computed get loading():boolean {\n        let items = this.list.props.items;\n        if (items === null) return false;\n        if (items === undefined) return true;\n        let pageItems = items as PageItems<any>;\n        if (pageItems.items === undefined) return false;\n        return pageItems.loading;\n    }\n    get selectedItems():any[] { return undefined; }\n    //updateProps(nextProps:any) {}\n    dispose() {};\n    abstract render: (item:any, index:number) => JSX.Element;\n    protected renderContent(item:any, index:number) {\n        let {render} = this.list.props.item;\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\n        return render(item, index);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\n\nexport class Clickable extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key, onClick} = this.list.props.item;\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { ListBase } from './base';\nimport { uid } from '../../tool/uid';\n\nexport class Static extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key} = this.list.props.item;\n        if (typeof item === 'string') {\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\n            return <li key={uid()} className={cn}>{item}</li>;\n        }\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport {observable, IObservableArray, isObservableArray, observe} from 'mobx';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\nimport {uid} from '../../tool/uid';\nimport { PageItems } from '../../tool/pageItems';\nimport { List } from './index';\nimport { observer } from 'mobx-react';\n\nexport interface SelectableItem {\n    selected: boolean;\n    item: any;\n    labelId: string;\n}\n\nexport class Selectable extends ListBase {\n    @observable private _items: SelectableItem[];\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\n\n    constructor(list: List) {\n        super(list);\n        this.buildItems();\n        this.listenArraySplice();\n    }    \n\n    private listenArraySplice() {\n        let {items} = this.list.props;\n        if (items === undefined) return;\n        if (items === null) return;\n        let itemsArray:any;\n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        if (isObservableArray(items) === true) {\n            observe(itemsArray as IObservableArray<any>, (change) => {                \n                if (change.type === 'splice') {\n                    let {index, removedCount, added} = change;\n                    let _added = added && added.map(v => {\n                        return {\n                            selected: false, \n                            item: v, \n                            labelId:uid()\n                        }\n                    });\n                    this._items.splice(index, removedCount, ..._added);\n                    this.buildItems();\n                }\n            }, true);\n        }\n    }\n\n    private buildItems = () => {\n        let {items, isItemSelected, selectedItems, compare} = this.list.props;\n        let itemsArray:any[] | IObservableArray<any>;\n        if (items === undefined) {\n            this._items = undefined;\n            return;\n        }\n        if (items === null) {\n            this._items = null;\n            return;\n        }\n        \n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n\n\t\tif (isItemSelected) {\n\t\t\tlet retItems = itemsArray.map(v => {\n\t\t\t\treturn {\n\t\t\t\t\tselected: isItemSelected(v),\n\t\t\t\t\titem: v, \n\t\t\t\t\tlabelId:uid()\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis._items = retItems;\n\t\t}\n\t\telse {\n\t\t\tlet comp: ((item:any, selectItem:any)=>boolean);\n\t\t\tif (compare === undefined) {\n\t\t\t\tcomp = (item:any, selectItem:any) => item === selectItem;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcomp = compare;\n\t\t\t}\n\t\t\tlet retItems = itemsArray.map(v => {\n\t\t\t\t//let isObserved = isObservable(v);\n\t\t\t\t//let obj = isObserved === true? toJS(v) : v;\n\t\t\t\t//let obj = v;\n\t\t\t\tlet selected = selectedItems === undefined?\n\t\t\t\t\tfalse\n\t\t\t\t\t: selectedItems.find(si => comp(v, si)) !== undefined;\n\t\t\t\treturn {\n\t\t\t\t\tselected: selected, \n\t\t\t\t\titem: v, \n\t\t\t\t\tlabelId:uid()\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis._items = retItems;\n\t\t}\n    }\n\n    get items() {\n        //if (this._items === undefined) \n        //this.buildItems();\n        return this._items;\n    }\n    private checkAll(on: boolean) {\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\n        for (let item of this._items) item.selected = on;\n    }\n    selectAll() {\n        //if (this._items) this._items.forEach(v => v.selected = true);\n        this.checkAll(true);\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\n    }\n    unselectAll() {\n        // if (this._items) this._items.forEach(v => v.selected = false);\n        this.checkAll(false);\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\n    }\n    /*\n    updateProps(nextProps:any) {\n        if (nextProps.selectedItems === this._selectedItems) return;\n        this.buildItems();\n    }\n    */\n    private get anySelected():boolean {return this._items.some(v => v.selected)}\n    private onSelect(item:SelectableItem, selected:boolean) {\n        item.selected = selected;\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\n    }\n    \n    get selectedItems():any[] {\n        return this._items.filter(v => v.selected === true).map(v => v.item);\n    }\n    /*\n    set selectedItems(value: any[]) {\n        if (value === undefined) return;\n        if (this._items === undefined) return;\n        let sLen = this._items.length;\n        let list = value.slice();\n        for (let n=0; n<sLen; n++) {\n            let sItem = this._items[n];\n            let len = list.length;\n            if (len === 0) break;\n            let item = sItem.item;\n            for (let i=0; i<len; i++) {\n                let v = list[i];\n                if (item === v) {\n                    sItem.selected = true;\n                    value.splice(i, 1);\n                    break;\n                }\n            }\n        };\n    }\n    */\n    //w-100 mb-0 pl-3\n    //m-0 w-100\n    render = (item:SelectableItem, index:number):JSX.Element => {\n        let {key} = this.list.props.item;\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\n    }\n\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\n        let {item, index} = props;\n        let {className} = this.list.props.item;\n        let {labelId, selected, item:obItem} = item;\n        return <li className={classNames(className)}>\n            <div className=\"d-flex align-items-center px-3\">\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\n                    defaultChecked={selected}\n                    onChange={(e)=>{\n                        this.onSelect(item, e.target.checked)} \n                    }/>\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\n                    {this.renderContent(obItem, index)}\n                </label>\n            </div>\n        </li>\n    })\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport _ from 'lodash';\nimport {PageItems} from '../../tool/pageItems';\nimport {ListBase} from './base';\nimport {Clickable} from './clickable';\nimport {Static} from './static';\nimport {Selectable} from './selectable';\nimport '../../css/va-list.css';\nimport { IObservableArray } from 'mobx';\nimport { resLang } from '../../res/res';\nimport { ListRes, listRes } from '../../res';\n\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\ninterface ItemProps {\n\tclassName?: string|string[];\n\trender?: (item:any, index:number) => JSX.Element;\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\n\tonClick?: (item:any)=>void;\n\tkey?: (item:any)=>string|number;\n}\n\nexport interface ListProps {\n    className?: string|string[];\n    items: any[] | IObservableArray<any> | PageItems<any>;\n    item: ItemProps;\n\tisItemSelected?: (item:any) => boolean;\n    compare?: (item:any, selectItem:any) => boolean;\n\tselectedItems?:any[];\n    header?: StaticRow;\n    footer?: StaticRow;\n    before?: StaticRow;\n    loading?: StaticRow;\n\tnone?: StaticRow;\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\n}\n\n@observer\nexport class List extends React.Component<ListProps> {\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\n\n\tprivate listBase: ListBase;\n\tprivate selectable: Selectable;\n    constructor(props:ListProps) {\n\t\tsuper(props);\n        this.buildBase();\n    }\n    _$scroll = (direct: 'top'|'bottom') => {\n        console.log('############### items scroll to ' + direct);\n    }\n    private buildBase() {\n        let {item} = this.props;\n        let {onClick, onSelect} = item;\n        if (onSelect !== undefined)\n            this.selectable = this.listBase = new Selectable(this);\n        else if (onClick !== undefined)\n            this.listBase = new Clickable(this);\n        else\n            this.listBase = new Static(this);\n\t}\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\n\t\t\tthis.buildBase();\n\t\t\tthis.forceUpdate();\n\t\t}\n\t}\n    componentWillUnmount() {\n        this.listBase.dispose();\n    }\n    selectAll() {\n        if (this.selectable) this.selectable.selectAll();\n    }\n    unselectAll() {\n        if (this.selectable) this.selectable.unselectAll();\n    }\n    get selectedItems():any[] {\n        return this.listBase.selectedItems;\n    }\n    render() {\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\n        if (before === undefined) before = '-';\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\n        if (none === undefined) none = List.res.none;\n        //this.listBase.selectedItems = selectedItems;\n        let {items, loading:isLoading} = this.listBase;\n        function staticRow(row:StaticRow, type:string) {\n            if (!row) return;\n            switch (typeof row) {\n                default:\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\n                case 'object': return <li>{row}</li>\n            } \n        }\n        let content:any, waitingMore:any;\n        if (items === null)\n            content = staticRow(before, 'before');\n        else if (items === undefined)\n            content = staticRow(loading, 'loading');\n        else if (items.length === 0)\n            content = staticRow(none, 'none');\n        else {\n            content = items.map((item, index) => {\n                return this.listBase.render(item, index);\n            });\n        }\n        if (isLoading === true && items) {\n            waitingMore = staticRow(loading, 'loading');\n\t\t}\n\t\tlet tabIndex:number;\n\t\tif (onFocus !== undefined) tabIndex = -1;\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\n            {staticRow(header, 'header')}\n            {content}\n            {waitingMore}\n            {staticRow(footer, 'footer')}\n        </ul>;\n    }\n}\n","import * as React from 'react';\nimport className from 'classnames';\nimport {PropGridProps} from './PropGrid';\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\n\nexport abstract class PropRow {\n    setValues(values: any) {}\n    abstract render(key:string): any;\n}\n\nexport class PropBorder extends PropRow {\n    render(key:string): JSX.Element {\n        return <div key={'_b_' + key} className=\"\">\n            <div className=\"w-100\">\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\n            </div>\n        </div>;\n    }\n}\n\nexport class PropGap extends PropRow {\n    private param: string;\n    constructor(param?: string) {\n        super();\n        this.param = param;\n    }\n    render(key:string): JSX.Element {\n        let w: string;\n        switch (this.param) {\n            default: w = 'py-2'; break;\n            case '=': w = 'py-1'; break;\n            case '-': w = 'pb-1'; break;\n        }\n        let cn = className(w);\n        return <div key={'_g_' + key} className={cn} />;\n    }\n}\n\nconst valueAlignStart = 'justify-content-start';\nconst valueAlignCenter = 'justify-content-center';\nconst valueAlignEnd = 'justify-content-end';\nexport abstract class LabeledPropRow extends PropRow {\n    protected gridProps: PropGridProps;\n    protected _prop: LabeledProp;\n    protected get prop():LabeledProp {return this._prop}\n    protected content: any;\n    protected col: string;\n    //protected values: any;\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\n        super();\n        this.gridProps = gridProps;\n        this._prop = prop;\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\n        //this.values = values;\n    }\n    render(key:string):any {\n        let {onClick, bk} = this.prop;\n        let cn = className({\n            \"cursor-pointer\": onClick !== undefined,\n            \"bg-white\": bk === undefined, \n            \"row\": true\n        });\n        return <div key={key} className={cn} onClick={onClick}>\n            {this.renderLabel()}\n            {this.renderProp()}\n        </div>;\n    }\n    protected renderLabel():any {\n        let {label} = this.prop;\n        if (label === undefined) return null;\n        return <label className={this.col + '-3 col-form-label'}>\n            {label}\n        </label>;\n    }\n    protected renderProp():any {\n        let {label} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string = this.col + (label===undefined? '-12':'-9');\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n    protected renderPropBody():any {\n        return <div className=\"form-control-plaintext\">\n            {this.renderPropContent()}\n        </div>;\n    }\n    protected renderPropContent():any {\n        return this.content;\n    }\n}\n\nexport class StringPropRow extends LabeledPropRow {\n    protected get prop(): StringProp {return this._prop as StringProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class NumberPropRow extends LabeledPropRow {\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class ListPropRow extends LabeledPropRow {\n    protected get prop(): ListProp {return this._prop as ListProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else {\n            let list = this.prop.list;\n            if (typeof list === 'string') this.content = values[list];\n            else this.content = undefined;\n        }\n    }\n    protected renderPropBody() {\n        let {list, row} = this.prop;\n        let items:any[] = typeof list === 'string'? this.content : list;\n        if (items === undefined) return <div/>;\n        // new row(item)\n        return <div className=\"w-100\">\n            {\n                items.map((item, index) => <React.Fragment key={index}>\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\n                    {React.createElement(row, item)}\n                </React.Fragment>)\n            }\n        </div>;\n    }\n}\n\nexport class ComponentPropRow extends LabeledPropRow {\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\n    protected renderPropBody() {\n        let {component} = this.prop;\n        return component;\n    }\n    protected renderProp():any {\n        let {label, full} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string;\n        if (full !== true)\n            col = this.col + (label===undefined? '-12':'-9');\n        else\n            col = 'w-100';\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n}\n","import { PropGridProps } from './PropGrid';\nimport {\n    PropRow, PropBorder, PropGap, \n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\n} from './row';\n\nexport interface Format {\n\n}\n\nexport interface PropBase {\n    onClick?: () => void;\n}\n\nexport interface LabeledProp extends PropBase {\n    label?: string;\n    bk?: string;\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\n}\n\nexport interface StringProp extends LabeledProp {\n    type: 'string';\n    name: string;\n}\n\nexport interface NumberProp extends LabeledProp {\n    type: 'number';\n    name: string;\n}\n\nexport interface FormatProp extends LabeledProp {\n    type: 'format';\n    format: Format;\n}\n\nexport interface ListProp extends LabeledProp {\n    type: 'list';\n    list: string | any[];  // string 表示名字，否则就是值\n    row: new (props: any) => React.Component;\n}\n\nexport interface ComponentProp extends LabeledProp {\n    type: 'component';\n    full?: boolean;\n    component: any; //JSX.Element;\n}\n\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\n\nexport class PropView {\n    private gridProps: PropGridProps\n    private props: Prop[];\n    //private values:any;\n    private rows: PropRow[];\n\n    constructor(gridProps: PropGridProps, props: Prop[]) {\n        this.gridProps = gridProps;\n        this.props = props;\n        //this.values = values;\n        this.buildRows();\n    }\n\n    private buildRows() {\n        this.rows = [];\n        let isGap: boolean = true;\n        for (let prop of this.props) {\n            if (typeof prop === 'string') {\n                this.rows.push(new PropGap(prop));\n                isGap = true;\n            }\n            else {\n                if (!isGap) this.rows.push(new PropBorder());\n                let row;\n                switch (prop.type) {\n                    default: continue;\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\n                }\n                this.rows.push(row);\n                isGap = false;\n            }\n        }\n    }\n\n    setValues(values: any) {\n        for (let r of this.rows) r.setValues(values);\n    }\n\n    render() {\n        return this.rows.map((row, index) => row.render(String(index)));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport {Prop, PropView} from './propView';\n\nexport interface PropGridProps {\n    className?: string;\n    rows: Prop[];\n    values: any;\n    alignValue?: 'left'|'center'|'right';\n    labelFixLeft?: boolean;\n}\n\n@observer\nexport class PropGrid extends React.Component<PropGridProps> {\n    render() {\n        let {className, rows, values} = this.props;\n        let propView = new PropView(this.props, rows);\n        propView.setValues(values);\n        let cn = classNames('container-fluid', className);\n        return <div className={cn}>\n            {propView.render()}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\nimport { userApi } from '../net';\n\nexport class EditMeInfo extends React.Component {\n    private schema:ItemSchema[] = [\n        {name:'nick', type:'string'} as StringSchema,\n        {name:'icon', type:'image'} as ImageSchema\n    ];\n    private uiSchema:UiSchema = {\n        items: {\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\n            icon: {widget:'image', label:'头像'} as UiImageItem,\n        }\n    }\n    @observable private data:any;\n\n    constructor(props:any) {\n        super(props);\n        let {nick, icon} = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        }\n    }\n\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\n        let {name} = itemSchema;        \n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        let user:any = nav.user;\n        user[name] = newValue;\n        nav.saveLocalUser();\n    }\n\n    render() {\n        return <Page header=\"个人信息\">\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\n                data={this.data}\n                onItemChanged={this.onItemChanged} />\n        </Page>;\n    }\n}\n","import { observable } from 'mobx';\nimport { isNumber } from 'util';\nimport _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { BoxId } from './boxId';\nimport { TuidInner, TuidDiv } from './tuid';\n\nconst maxCacheSize = 1000;\n\nexport class IdCache {\n    private queue: number[] = [];               // 每次使用，都排到队头\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\n\tprivate loading:boolean = false;\n\n    protected localArr:LocalArr;\n    protected waitingIds: number[] = [];          // 等待loading的\n    protected tuidInner: TuidInner;\n\n    constructor(tuidLocal: TuidInner) {\n        this.tuidInner = tuidLocal;\n        this.initLocalArr();\n    }\n\n    protected initLocalArr() {\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    useId(id:number, defer?:boolean) {\n        if (!id) return;\n        if (isNumber(id) === false) return;\n        if (this.cache.has(id) === true) {\n            this.moveToHead(id);\n            return;\n        }\n        this.tuidInner.cacheTuids(defer===true?70:20);\n        this.cache.set(id, id);\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\n            this.moveToHead(id);\n            return;\n        }\n\n        if (this.queue.length >= maxCacheSize) {\n            // 缓冲已满，先去掉最不常用的\n            let r = this.queue.shift();\n            if (r === id) {\n                // 如果移除的，正好是现在用的，则插入\n                this.queue.push(r);\n                return;\n            }\n\n            //let rKey = String(r);\n            if (this.cache.has(r) === true) {\n                // 如果移除r已经缓存\n                this.cache.delete(r);\n            }\n            else {\n                // 如果移除r还没有缓存\n                let index = this.waitingIds.findIndex(v => v === r);\n                this.waitingIds.splice(index, 1);\n            }\n        }\n        this.waitingIds.push(id);\n        this.queue.push(id);\n        return;\n    }\n\n    private moveToHead(id:number) {\n        let index = this.queue.findIndex(v => v === id);\n        this.queue.splice(index, 1);\n        this.queue.push(id);\n    }\n\n    getValue(id:number) {\n        return this.cache.get(id);\n    }\n\n    remove(id:number) {\n        this.cache.delete(id);\n        let index = this.queue.findIndex(v => v === id);\n\t\tthis.queue.splice(index, 1);\n\t\tthis.localArr.removeItem(id);\n    }\n\n    valueFromId(id:number|BoxId):any {\n        let _id:number;\n        switch (typeof id) {\n            case 'object': _id = (id as BoxId).id; break;\n            case 'number': _id = id as number; break;\n            default: return;\n        }\n        return this.getValue(_id);\n    }\n\n    resetCache(id:number) {\n        this.remove(id);\n        this.useId(id);\n    }\n\n    cacheValue(val:any):boolean {\n        if (val === undefined) return false;\n        let id = this.getIdFromObj(val);\n        if (id === undefined) return false;\n        let index = this.waitingIds.findIndex(v => v === id);\n        if (index>=0) this.waitingIds.splice(index, 1);\n        this.cache.set(id, val);\n        return true;\n    }\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\n\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n\t\tlet tuidValues = await this.loadIds();\n\t\tif (tuidValues === undefined || tuidValues.length === 0) {\n\t\t\tthis.waitingIds.splice(0, this.waitingIds.length);\n\t\t\treturn;\n\t\t}\n        this.cacheIdValues(tuidValues);\n    }\n\n    private cacheIdValues(tuidValues: any[]) {\n        if (tuidValues === undefined) return;\n        let tuids = this.unpackTuidIds(tuidValues);\n        for (let tuidValue of tuids) {\n            if (this.cacheValue(tuidValue) === false) continue;\n            this.cacheTuidFieldValues(tuidValue);\n        }\n    }\n    async modifyIds(ids:any[]):Promise<void> {\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\n        let localedValues = tuidValues.filter(v => {\n            let p = v.indexOf('\\t');\n            if (p<0) p = v.length;\n            let id = Number(v.substr(0, p));\n            let val = this.localArr.getItem(id);\n            return (val !== undefined);\n        });\n        if (localedValues.length === 0) return;\n        this.cacheIdValues(localedValues);\n    }\n    protected divName:string = undefined;\n    protected async loadIds(): Promise<any[]> {\n\t\tif (this.loading === true) return;\n\t\tthis.loading = true;\n\t\tlet ret = await this.loadTuidIdsOrLocal(this.waitingIds);\n\t\tthis.loading = false;\n        return ret;\n    }\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.tuidInner.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\n    }\n\n    async assureObj(id:number):Promise<void> {\n        let val = this.cache.get(id);\n        switch (typeof val) {\n            case 'object': return val;\n            case 'number': this.cache.set(id, id); break;\n        }\n        let ret = await this.loadTuidIdsOrLocal([id]);\n        this.cacheIdValues(ret);\n    }\n\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\n        let ret:string[] = [];        \n        let netIds:number[] = [];\n        for (let id of ids) {\n            let value = this.localArr.getItem(id);\n            //if (value === undefined)\n            // 值不存在或者是空字符串，重新获取\n            if (!value)\n                netIds.push(id);\n            else\n                ret.push(value);\n        }\n        let len = netIds.length;\n        if (len > 0) {\n            let netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\n            for (let i=0; i<len; i++) {\n                //有些id可能没有内容，不会返回\n                //let id = netIds[i]; \n                let row:string = netRet[i];\n                if (!row) continue;\n                let p = row.indexOf('\\t');\n                if (p < 0) p = row.length;\n                let id = Number(row.substr(0, p));\n\t\t\t\t_.remove(netIds, v => v === id);\n                ret.push(row);\n                this.localArr.setItem(id, row);\n            }\n            len = netIds.length;\n            for (let i=0; i<len; i++) {\n                this.localArr.setItem(netIds[i], '');\n            }\n        }\n        return ret;\n    }\n}\n\nexport class IdDivCache extends IdCache {\n    private div: TuidDiv;\n    protected divName:string;\n\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\n        super(tuidLocal);\n        this.div = div;\n        this.divName = div.name;\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\n    }\n\n    protected initLocalArr() {\n        // 这个不需要，必须去掉\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.div.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.div.cacheTuidFieldValues(tuidValue);\n    }\n\n    /*\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n        let tuidValues = await this.loadIds();\n        if (tuidValues !== undefined) {\n            let tuids = this.tuidLocal.unpackTuidIds(tuidValues);\n            for (let tuidValue of tuids) {\n                if (this.cacheValue(tuidValue) === false) continue;\n                this.tuidLocal.cacheTuidFieldValues(tuidValue);\n                this.afterCacheValue(tuidValue);\n            }\n        }\n    }\n    */\n}\n","import _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { Entity } from '../entity';\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\nimport { EntityCaller } from '../caller';\nimport { BoxId } from './boxId';\nimport { IdCache, IdDivCache } from './idCache';\n\nexport interface TuidSaveResult {\n    id: number;\n    inId: number;\n}\n\nexport interface TuidNOResult {\n\tdate: string;\n\tno: number;\n}\n\nexport abstract class Tuid extends Entity {\n    protected noCache: boolean;\n    readonly typeName:string = 'tuid';\n    protected idName: string;\n    cached: boolean;\n    unique: string[];\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {id} = schema;\n        this.idName = id;\n    }\n\n    buildTuidBox(): TuidBox {\n        return new TuidBox(this);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    stopCache():void {this.noCache = true}\n    abstract useId(id:number):void;\n    abstract boxId(id:number):BoxId;\n    abstract valueFromId(id:number):any;\n\tabstract resetCache(id:number|BoxId):void;\n    abstract async assureBox<T> (id:number|BoxId): Promise<T>;\n    static equ(id1:BoxId|number, id2:BoxId|number): boolean {\n        if (id1 === undefined) return false;\n        if (id2 === undefined) return false;\n        if (typeof id1 === 'object') {\n            return id1.equ(id2);\n        }\n        if (typeof id2 === 'object') {\n            return id2.equ(id1);\n        }\n        return id1 === id2;\n    }\n    cacheIds() {}\n    async modifyIds(ids:any[]) {}\n    isImport = false;\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\n    abstract div(name:string):TuidDiv;\n    abstract async loadMain(id:number|BoxId):Promise<any>;\n\tabstract async load(id:number|BoxId):Promise<any>;\n    abstract async all():Promise<any[]>;\n\tabstract async save(id:number, props:any):Promise<TuidSaveResult>;\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\n    abstract async search(key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async loadArr(arr:string, owner:number, id:number):Promise<any>;\n    abstract async saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\n\tabstract async posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\n\tabstract async no():Promise<TuidNOResult>;\n}\n\nexport class TuidInner extends Tuid {\n    private divs: {[div:string]: TuidDiv};\n    protected cacheFields: Field[];\n    protected idCache: IdCache;\n    protected localArr:LocalArr;\n    constructor(uq:UqMan, name:string, typeId:number) {\n        super(uq, name, typeId);\n        this.idCache = new IdCache(this);\n        this.localArr = this.cache.arr(this.name + '.whole');\n        if (uq.newVersion === true) this.localArr.removeAll();\n    }\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {arrs} = schema;\n        if (arrs !== undefined) {\n            this.divs = {};\n            for (let arr of arrs) {\n                let {name} = arr;\n                let tuidDiv = new TuidDiv(this.uq, this, name);\n                this.divs[name] = tuidDiv;\n                tuidDiv.setSchema(arr);\n                tuidDiv.buildFieldsTuid();\n            }\n        }\n    }\n    \n    useId(id:number, defer?:boolean) {\n        if (this.noCache === true) return;\n        if (!id) return;\n        this.idCache.useId(id, defer);\n    }\n    boxId(id:number):BoxId {\n        if (!id) return;\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        let {createBoxId} = this.uq;\n        if (!createBoxId) return {id: id} as BoxId;\n        return createBoxId(this, id);\n    }\n    valueFromId(id:number) {return this.idCache.getValue(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tif (typeof id === 'object') id = id.id;\n\t\tthis.idCache.resetCache(id);\n\t}\n    async assureBox<T> (id:number|BoxId):Promise<T> {\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    cacheIds() {\n        this.idCache.cacheIds();\n        if (this.divs === undefined) return;\n        for (let i in this.divs) this.divs[i].cacheIds();\n    }\n    async modifyIds(ids:any[]) {\n        await this.idCache.modifyIds(ids);\n    }\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\n    get hasDiv():boolean {return this.divs!==undefined}\n    div(name:string):TuidDiv {\n        return this.divs && this.divs[name];\n    }\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\n        if (ret.length > 0) this.cached = true;\n        return ret;\n    }\n    async loadMain(id:number|BoxId):Promise<any> {\n        if (typeof id === 'object') id = id.id;\n        await this.idCache.assureObj(id);\n        return this.idCache.valueFromId(id);\n    }\n    async load(id:number|BoxId):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let cacheValue = this.idCache.valueFromId(id); \n        //if (typeof cacheValue === 'object') return cacheValue;\n        if (typeof id === 'object') id = id.id;\n        let valuesText = undefined; //this.localArr.getItem(id);\n        let values: any;\n        if (valuesText) {\n            values = JSON.parse(valuesText);\n        }\n        else {\n            values = await new GetCaller(this, id).request();\n            if (values !== undefined) {\n                // this.localArr.setItem(id, JSON.stringify(values));\n            }\n        }\n        if (values === undefined) return;\n        for (let f of this.schema.fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.uq.getTuid(tuid);\n            if (t === undefined) continue;\n            let n = f.name;\n            values[n] = t.boxId(values[n]);\n        }\n        this.idCache.cacheValue(values);\n        this.cacheTuidFieldValues(values);\n        return values;\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let {fields, arrs} = this.schema;\n        this.cacheFieldsInValue(values, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs as ArrFields[]) {\n                let {name, fields} = arr;\n                let arrValues = values[name];\n                if (arrValues === undefined) continue;\n                let tuidDiv = this.div(name);\n                for (let row of arrValues) {\n                    //row._$tuid = tuidDiv;\n                    //row.$owner = this.boxId(row.owner);\n                    tuidDiv.cacheValue(row);\n                    this.cacheFieldsInValue(row, fields);\n                }\n            }\n        }\n    }\n\n    public buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\n\t\tif (mainFields === undefined) debugger;\n\t\tthis.cacheFields = mainFields || this.fields;\n\t\tif (stampOnMain === true) {\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\n\t\t}\n        this.uq.buildFieldTuid(this.cacheFields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\n        if (id !== undefined) {\n            this.idCache.remove(id);\n            this.localArr.removeItem(id);\n        }\n        return ret;\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\n\t\tthis.idCache.remove(id);\n\t\tawait this.idCache.assureObj(id);\n\t}\n    async all():Promise<any[]> {\n        let ret: any[] = await new AllCaller(this, {}).request();\n        return ret;\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\n        return ret;\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        //let api = this.uqApi;\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\n        let ret = await new SearchCaller(this, params).request();\n        let {fields} = this.schema;\n        for (let row of ret) {\n            this.cacheFieldsInValue(row, fields);\n        }\n        return ret;\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let api = this.uqApi;\n        //return await api.tuidArrGet(this.name, arr, owner, id);\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any) {\n        //let params = _.clone(props);\n        //params[\"$id\"] = id;\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\n    }\n\n    async posArr(arr:string, owner:number, id:number, order:number) {\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\n\t}\n\tasync no():Promise<TuidNOResult> {\n\t\treturn await new TuidNoCaller(this, undefined).request();\n\t}\n}\n\nabstract class TuidCaller<T> extends EntityCaller<T> {\n    protected get entity(): Tuid {return this._entity as Tuid};\n}\n\n// 包含main字段的load id\n// 当前为了兼容，先调用的包含所有字段的内容\nclass GetCaller extends TuidCaller<number> {\n    method = 'GET';\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\n}\n\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\n    get path():string {\n        let {divName} = this.params;\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\n    }\n    buildParams():any {return this.params.ids}\n    xresult(res:any):any {\n        return (res as string).split('\\n');\n    }\n}\n\n\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\n    get path():string {return `tuid/${this.entity.name}`}\n    buildParams():any {\n        let {fields, arrs} = this.entity.schema;\n        let {id, props} = this.params;\n        let params:any = {$id: id};\n        this.transParams(params, props, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let arrName = arr.name;\n                let arrParams = [];\n                let arrFields = arr.fields;\n                let arrValues = props[arrName];\n                if (arrValues !== undefined) {\n                    for (let arrValue of arrValues) {\n                        let row = {};\n                        this.transParams(row, arrValue, arrFields);\n                        arrParams.push(row);\n                    }\n                }\n                params[arrName] = arrParams;\n            }\n        }\n        return params;\n    }\n    private transParams(values:any, params:any, fields:Field[]) {\n        if (params === undefined) return;\n        for (let field of fields) {\n            let {name, tuid, type} = field;\n            let val = params[name];\n            if (tuid !== undefined) {\n                if (typeof val === 'object') {\n                    if (val !== null) val = val.id;\n                }\n            }\n            else {\n                switch (type) {\n                    case 'date':\n                        val = this.entity.buildDateParam(val); \n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                    case 'datetime':\n                        val = this.entity.buildDateTimeParam(val);\n                        //val = new Date(val).toISOString();\n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                }\n            }\n            values[name] = val;\n        }\n    }\n}\n\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\n    get path():string {return `tuids/${this.entity.name}`}\n}\n\nclass AllCaller extends TuidCaller<{}> {\n    method = 'GET';\n    get path():string {return `tuid-all/${this.entity.name}`}\n}\n\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\n    method = 'GET';\n    get path():string {\n        let {arr, owner, id} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\n    }\n}\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\n}\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, props} = this.params;\n        let params = _.clone(props);\n        params['$id'] = id;\n        return params;\n    }\n}\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, order} = this.params;\n        return { bid: id, $order: order}\n    }\n}\nclass TuidNoCaller extends TuidCaller<{}> {\n    get path():string {\n        return `tuid-no/${this.entity.name}/`;\n    }\n    buildParams():any {\n\t\tlet d = new Date();\n\t\tlet year = d.getFullYear();\n\t\tlet month = d.getMonth() + 1;\n\t\tlet date = d.getDate();\n        return {year, month, date};\n    }\n}\n\nexport class TuidImport extends Tuid {\n    private tuidLocal: TuidInner;\n\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\n        super(uq, name, typeId);\n        this.from = from;\n    }\n\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\n    \n    readonly from: SchemaFrom;\n    isImport = true;\n\n    useId(id:number) {this.tuidLocal.useId(id);}\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tthis.tuidLocal.resetCache(id);\n\t}\n    async assureBox<T>(id:number):Promise<T> {\n        await this.tuidLocal.assureBox(id);\n\t\treturn this.tuidLocal.valueFromId(id);\n    }\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\n    async loadMain(id:number|BoxId):Promise<any> {\n        let ret = await this.tuidLocal.loadMain(id);\n        return ret;\n    }\n    async load(id:number|BoxId):Promise<any> {\n        return await this.tuidLocal.load(id);\n    }\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        return await this.tuidLocal.save(id, props);\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\n\t}\n    async all():Promise<any[]> {\n        return await this.tuidLocal.all();\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.search(key, pageStart, pageSize);\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        return await this.tuidLocal.loadArr(arr, owner, id);\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\n        await this.tuidLocal.saveArr(arr, owner, id, props);\n    }\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\n        await this.tuidLocal.posArr(arr, owner, id, order);\n    }\n\tasync no():Promise<TuidNOResult> {\n\t\treturn await this.tuidLocal.no();\n\t}\n}\n\n// field._tuid 用这个接口\n// Tuid, TuidDiv 实现这个接口\nexport class TuidBox {\n    tuid: Tuid;\n    ownerField:Field = undefined;\n    constructor(tuid: Tuid) {\n        this.tuid = tuid;\n    }\n\n    boxId(id:number):BoxId {\n        return this.tuid.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.tuid.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.tuid.useId(id);\n    }\n    async showInfo() {\n        alert('showInfo not implemented');\n    }\n}\n\n\nexport class TuidDiv extends TuidInner /* Entity*/ {\n    readonly typeName:string = 'div';\n    protected cacheFields: Field[];\n    protected tuid: TuidInner;\n    protected idName: string;\n    protected idCache: IdDivCache;\n\n    //ui: React.StatelessComponent<any>;\n    //res: any;\n\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\n        super(uq, name, 0);\n        this.tuid = tuid;\n        this.idName = 'id';\n        this.idCache = new IdDivCache(tuid, this);\n    }\n\n    get owner() {return this.tuid}\n\n    /*\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.buildFieldsTuid();\n    }*/\n\n    /*\n    setUIRes(ui:any, res:any) {\n        this.ui = ui && ui.content;\n        this.res = res;\n    }\n    */\n\n    buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields} = this.schema;\n        if (mainFields === undefined) debugger;\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\n    }\n\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\n        return new TuidBoxDiv(this.tuid, this, ownerField);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    cacheValue(value:any):void {\n        this.idCache.cacheValue(value);\n    }\n\n    useId(id:number, defer?:boolean):void {\n        if (this.noCache === true) return;\n        this.idCache.useId(id, defer);\n    }\n\n    /*\n    boxId(id:number):BoxId {\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        //return new BoxDivId(this.tuid, this, id);\n        return this.tuid.boxDivId(this, id);\n    }\n    */\n    valueFromId(id:number):any {\n        return this.idCache.getValue(id)\n    }\n\n    async assureBox<T>(id:number):Promise<T> {\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    async cacheIds() {\n        await this.idCache.cacheIds();\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let fields = this.schema.fields;\n        this.cacheFieldsInValue(values, fields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n}\n\nexport class TuidBoxDiv extends TuidBox {\n    ownerField: Field;\n    private div: TuidDiv;\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\n        super(tuid);\n        this.div = div;\n        this.ownerField = ownerField;\n    }\n\n    boxId(id:number):BoxId {\n        return this.div.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.div.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.div.useId(id);\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { AppConfig } from \"tonva\";\nimport { appName } from \"./appName\";\n\nexport const appConfig: AppConfig = {\n    appName: appName,\n\tversion: '1.0.0',\n\tnoUnit: true,\n    tvs: {},\n\toem: undefined,\n\thtmlTitle: '小单',\n};\n","export const appName = 'Bruce/notes';\n","import { CSub, CBase, CAppBase, IConstructor } from '../tonva';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n}\n\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n    get owner(): T { return this._owner as T }\n}\n\nexport abstract class CUqApp extends CAppBase {\n    get uqs(): UQs { return this._uqs };\n\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\n\t\tlet c = new type(this);\n\t\tc.init();\n\t\treturn c;\n    }\n}\n","import * as React from 'react';\nimport { VPage, TabCaptionComponent, Page, TabProp, t } from '../tonva';\nimport { CApp } from './CApp';\n\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\nfunction caption(label:string, icon:string) {\n\treturn (selected: boolean) => TabCaptionComponent(label, icon, color(selected));\n}\nexport class VMain extends VPage<CApp> {\n    async open(param?: any, onClosePage?: (ret:any)=>void) {\n        this.openPage(this.render, param, onClosePage);\n    }\n\n    render = (param?: any): JSX.Element => {\n\t\tlet { cHome, cRelation, cDiscover, cMe } = this.controller;\n\t\tlet tabs: TabProp[] = [\n\t\t\t{name: 'home', caption: caption(t('home'), 'home'), content: cHome.tab},\n\t\t\t{name: 'relation', caption: caption(t('relation'), 'user-plus'), content: cRelation.tab, onShown: cRelation.load},\n\t\t\t{name: 'discover', caption: caption(t('discover'), 'arrows-alt'), content: cDiscover.tab, load: cDiscover.loadBookProjects},\n\t\t\t{name: 'me', caption: caption(t('me'), 'user-o'), content: cMe.tab},\n\t\t];\n\t\treturn <Page tabsProps={{tabs}} webNav={{navHeader: <div>webNav header</div>, navFooter: <div>webNav footer</div>}} />;\n    }\n}\n","import { BoxId } from \"tonva\";\nimport { EnumTaskState } from \"./note/task/TaskState\";\n\nexport enum EnumNoteType {\n\ttext=0, task=1, comment=2, folder=3, group=4, groupFolder=5, unit=6, assign=7,\n\ttextList=8, textCheckable=9, unitNote=10,\n}\n\nexport interface NoteItem {\n\tseconds: number;\n\towner: number | BoxId;\n\tnote: number;\n\ttype: EnumNoteType;\n\tcaption: string;\n\tcontent: string;\n\tx: number;\n\tassigned: string;\n\tfrom: number | BoxId;\n\tfromAssigned: string;\n\tstate: EnumTaskState;\n\tflowContent?: string;\n\tgroupFolder?:number;\n\tunread: number;\n\tobj: any;\n\ttoCount?: number;\n\tspawnCount?: number;\n\tcommentCount?: number;\n\tcommentUnread?: number;\n\t$create: Date;\n\t$update: Date;\n}\n\nexport interface NoteFlow {\t\n}\n\nexport interface Access {\n\tuser: number;\n\taccess: number;\n\tassigned: string;\n}\n\nexport interface CommentItem {\n\tid: number;\n\tcontent: string;\n\towner: number;\n\tassigned: string;\n\t$create: Date;\n\t$update: Date;\n}\n\nexport interface NoteModel {\n\tid: number;\n\tcaption: string;\n\tcontent: string;\n\ttype: EnumNoteType,\n\tflowContent?: string;\n\t$create: Date;\n\t$update: Date;\n\tto: Access[];\n\tflow: NoteFlow[];\n\tspawn: NoteItem[];\n\tcontain: NoteItem[];\n\tcomments: CommentItem[];\n}\n\nexport function replaceAll(str:string, findStr:string, repStr:string):string {\n\tif (!str) return str;\n\treturn str.split(findStr).join(repStr);\n}\n\nexport function numberFromId(id:number|BoxId):number {\n\tlet _id:number;\n\tswitch (typeof id) {\n\t\t\tcase 'object': _id = (id as BoxId).id; break;\n\t\t\tcase 'number': _id = id as number; break;\n\t\t\tdefault: return;\n\t}\n\treturn _id;\n}\n\nexport function compareID(id1:number|BoxId, id2:number|BoxId):boolean {\n\treturn numberFromId(id1) === numberFromId(id2);\n}\n\nexport function checkHourMinutes(v:string): number {\n\tlet reTime = /^(?:(?:[0-9])|(?:[0-2][0-3])|(?:[0-1][0-9])):[0-5][0-9]$/;\n\tif (reTime.test(v)) {\n\t\tlet r = v.split(':');\n\t\treturn Number(r[0]) * 60 + Number(r[1]);\n\t}\n\tlet h = Number(v);\n\tif (isNaN(h) || h > 20 || h < 0) {\n\t\treturn -1;\n\t}\n\treturn h * 60;\n}\n\nexport function taskTimeToString(t:number):string {\n\tif (isNaN(t) || t <= 0)\n\t\treturn '';\n\tlet h = Math.floor(t / 60);\n\tlet m = Math.floor(t % 60);\n\tlet ms = m.toString();\n\tif (m < 10) {\n\t\tms = '0' + ms;\n\t}\n\treturn h.toString() + ':' + ms;\n}\n\n\nexport function initNoteItemObj(item:NoteItem):void {\n\tlet {type, content, flowContent} = item;\n\tif (flowContent) {\n\t\tlet obj = JSON.parse(flowContent);\n\t\titem.obj = obj;\n\t}\n\telse if (content) {\n\t\tif (content[0] === '{') {\n\t\t\tlet obj = JSON.parse(content);\n\t\t\tif (type === EnumNoteType.text) {\n\t\t\t\tswitch (obj.check) {\n\t\t\t\t\tcase 1: item.type = EnumNoteType.textList; break;\n\t\t\t\t\tcase 2: item.type = EnumNoteType.textCheckable; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.obj = obj;\n\t\t}\n\t\telse {\n\t\t\titem.obj = content;\n\t\t}\n\t}\n}\n\n","import React from 'react';\nimport { VPage, User, Image, UserView, CBase } from \"../../tonva\";\nimport { Contact } from 'model';\n\nexport abstract class VBasePage<T extends CBase> extends VPage<T> {\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected renderContactItem = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\treturn <div className=\"px-3 py-2\">\n\t\t\t{this.renderContact(contact, assigned)}\n\t\t</div>;\n\t}\n\n\tprotected renderSelectedContact(contacts:Contact[]) {\n\t\treturn contacts.map((c, index) => {\n\t\t\tlet {contact, assigned} = c;\n\t\t\treturn <span key={index} className=\"mr-3\">{this.renderContact(contact, assigned)}</span>;\n\t\t});\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VBasePage } from './VBasePage';\nimport { List, FA } from '../../tonva';\nimport { Contact } from '../../model';\nimport { CNotes } from '../CNotes';\n\nexport interface SelectContactOptions {\n\ttitle?: string;\n\taction?: string;\n\tsingle?: boolean;\n}\n\nexport class VSelectContact extends VBasePage<CNotes> {\n\t@observable private anySelected:boolean = false;\n\t@observable private contacts: Contact[];\n\t@observable private multiple:boolean = false;\n\tprivate list: List;\n\tprivate options: SelectContactOptions;\n\n\tinit(options: SelectContactOptions):void {\n\t\tthis.options = options;\n\t}\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return this.options?.title ?? '选择'}\n\tright() {\n\t\treturn React.createElement(observer(this.buildRight));\n\t}\n\n\tprivate buildRight = () => {\n\t\tif (this.options?.single === true) return;\n\t\tlet cn = 'btn btn-sm btn-success mr-1';\n\t\tif (this.multiple === false) {\n\t\t\treturn <button className={cn} onClick={this.onToggleSelect}>多选</button>;\n\t\t}\n\t\tif (this.contacts && this.contacts.length > 0) {\n\t\t\treturn <button className={cn} onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t\t{this.options?.action ?? '选中'}({this.contacts.length}) <FA name=\"angle-right\" />\n\t\t\t</button>;\n\t\t}\n\t\treturn <button className={cn} onClick={this.onToggleSelect}>单选</button>;\n\t}\n\n\tprivate onToggleSelect = () => {\n\t\tthis.multiple = !this.multiple;\n\t}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\tlet list:any;\n\t\t\tlet items = this.controller.cApp.contacts;\n\t\t\tif (this.multiple === true) {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onClick:this.onContactClick}} />\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{list}\n\t\t\t</div>;\n\t\t}\n\t\treturn React.createElement(observer(render));\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t\tthis.contacts = this.list.selectedItems;\n\t}\n\n\tprivate onContactClick = (item:Contact) => {\n\t\tthis.returnCall([item]);\n\t}\n\n\tprivate onNext = () => {\n\t\tthis.returnCall(this.list.selectedItems);\n\t}\n}\n","import React from 'react';\nimport { View, DropdownActions, DropdownAction } from \"../../tonva\";\nimport { CNotes } from \"../CNotes\";\n\nexport abstract class VNotesDropDown extends View<CNotes> {\n\tprotected text = {\n\t\ticon:'file-o', \n\t\tcaption:this.t('noteText'), \n\t\taction: this.controller.showAddNoteTextPage, \n\t\tcaptionClass: 'text-primary'\n\t};\n\tprotected list = {\n\t\ticon:'list', \n\t\tcaption:this.t('noteList'),\n\t\taction: this.controller.showAddNoteListPage,\n\t};\n\tprotected checkable = {\n\t\ticon:'check-square-o', \n\t\tcaption:this.t('noteCheckable'), \n\t\taction: this.controller.showAddNoteCheckablePage,\n\t};\n\tprotected task = {\n\t\ticon:'hand-pointer-o', \n\t\tcaption:this.t('noteTask'), \n\t\taction: this.controller.showAddAssignPage,\n\t\ticonClass: 'text-primary'\n\t};\n\tprotected folder = {\n\t\ticon:'folder', \n\t\tcaption:this.t('noteFolder'), \n\t\taction: this.controller.showAddMyFolderPage,\n\t\ticonClass: 'text-warning'\n\t};\n\tprotected space = {\n\t\ticon:'users', \n\t\tcaption:this.t('noteCreateSpace'), \n\t\taction: this.controller.showAddGroupPage,\n\t\ticonClass: 'text-danger'\n\t};\n\n\tprotected abstract get dropdownActions(): DropdownAction[];\n\n\trender() {\n\t\treturn <DropdownActions actions={this.dropdownActions}\n\t\t\ticon=\"plus\"\n\t\t\titemIconClass=\"text-info\"\n\t\t\tclassName=\"cursor-pointer btn btn-lg text-white p-1 mr-1\"/>\n\t}\n}\n\nexport class VHomeDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.folder, undefined, this.space];\n\t}\n}\n\nexport class VFolderDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.folder];\n\t}\n}\n\nexport class  VSpaceDropdown extends VNotesDropDown {\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\treturn [this.text, this.list, this.checkable, this.task, this.folder];\n\t}\n}\n","import { observable, computed } from \"mobx\";\nimport { CUqSub } from '../../tapp';\nimport { NoteItem, NoteModel, EnumNoteType, initNoteItemObj } from '../model';\nimport { CNotes } from '../CNotes';\n\nexport abstract class CNoteBase extends CUqSub<CNotes> {\n\tdisableFrom: boolean = false;\n\t@observable noteModel: NoteModel;\n\t@observable noteItem: NoteItem;\n\n\t@observable activeRelativeTab: string;\n\tget isContentChanged():boolean {return false;}; // {return this.cContent.changed}\n\n\tget groupFolder(): number {\n\t\tif (!this.noteItem)\n\t\t\treturn undefined;\n\t\tlet ret = this.noteItem.groupFolder;\n\t\tif (!ret && this.noteItem.type === EnumNoteType.groupFolder) {\n\t\t\tret = this.noteItem.note;\n\t\t}\n\t\treturn ret;\n\t}\n\n\tinit(param: NoteItem): void {\n\t\tthis.noteItem = param;\n\t}\n\n\tasync lodeModel() {\n\t\tlet folderId = this.owner.currentFold?.folderId;\n\t\tlet ret = await this.uqs.notes.GetNote.query({folder: folderId, note: this.noteItem.note});\n\t\tlet noteModel:NoteModel = ret.ret[0];\n\t\tnoteModel.to = ret.to;\n\t\tnoteModel.flow = ret.flow;\n\t\tnoteModel.spawn = ret.spawn;\n\t\tnoteModel.contain = ret.contain;\n\t\tnoteModel.comments = ret.comments;\n\t\tfor (var sItem of noteModel.spawn) {\n\t\t\tinitNoteItemObj(sItem);\n\t\t}\n\t\tthis.noteModel = noteModel;\n\t}\n\n\tabstract get type():EnumNoteType;\n\n\tprotected async internalStart() { }\n\n\t@observable caption: string;\n\tget isCaptionChanged() {return this.caption !== this.noteItem?.caption;}\n\t@computed get isNoteChanged(): boolean {\n\t\treturn this.isContentChanged || this.isCaptionChanged;\n\t}\n\n\tabstract renderIcon(): JSX.Element;\n\tabstract renderDirItem(index: number): JSX.Element;\n\tabstract showViewPage():void;\n\tabstract showEditPage():void;\n\tabstract showAddPage():void;\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\treturn obj;\n\t}\n\n\tasync showShareTo() {\n\t\tawait this.owner.showShareTo();\n\t}\n\n\tasync SetNote(showWaiting: boolean = true) {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tawait this.owner.editNote(showWaiting,\n\t\t\tthis.noteItem,\n\t\t\tthis.caption,\n\t\t\tnoteContent,\n\t\t\tobj);\n\t\tthis.updateChange();\n\t}\n\n\tprotected updateChange() {\n\t\tif (!this.noteItem) {\n\t\t\tdebugger;\n\t\t\tthrow new Error('this.noteItem can not be undefined');\n\t\t}\n\t\tthis.noteItem.$update = new Date();\n\t\tif (this.caption && this.caption !== this.noteItem.caption) {\n\t\t\tthis.noteItem.caption = this.caption;\n\t\t}\n\t\tthis.owner.itemChanged(this.noteItem);\n\t}\n\n\t// return the folder noteItem\n\titemChanged(noteItem: NoteItem):NoteItem {\n\t\t//if (this.noteItem) {\n\t\tthis.noteItem.$update = noteItem.$update;\n\t\treturn this.noteItem;\n\t\t//}\n\t}\n\n\tasync AddNote() {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tlet {folderId} = this.owner.currentFold;\n\t\tlet ret = await this.owner.addNote(folderId, this.caption, noteContent, obj, this.type);\n\t\tif (this.noteItem) {\n\t\t\tthis.updateChange();\n\t\t}\n\t\treturn ret;\n\t}\n}\n","import { VBasePage } from \"../../notes/views/VBasePage\";\nimport React from \"react\";\nimport { User, Image, UserView, Page, EasyTime, FA } from \"../../tonva\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport function renderIcon(name:string, cn:string) {\n\treturn <span className=\"fa-stack fa-lg\">\n\t\t<i className={'fa fa-square-o fa-stack-2x ' + cn}></i>\n\t\t<i className={'fa fa-stack-1x fa-' + name + ' ' + cn}></i>\n\t</span>\n\t//return <FA name={name} size=\"lg\" className={cn} fixWidth={true} />;\n}\n\nexport abstract class VNoteBase<T extends CNoteBase> extends VBasePage<T> {\n\t// VPage 里面的页面主体\n\tcontent() {\n\t\treturn this.renderBody();\n\t}\n\n\t// 页面主体\n\tprotected renderBody():JSX.Element {\n\t\treturn;\n\t}\n\n\t// 小单的主要部分，top, caption和content\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className=\"d-flex px-3 py-2 align-items-center border-top border-bottom bg-light\">\n\t\t\t{this.renderIcon()}\n\t\t\t{this.renderEditTime()}\n\t\t\t{this.renderFrom()}\n\t\t</div>;\n\t}\n\tprotected renderIcon():JSX.Element {return;}\n\t\n\tprotected renderFrom = () => {\n\t\tlet {noteItem, disableFrom: disableOwnerFrom} = this.controller;\n\t\tif (!noteItem) return <div>noteItem undefined in renderFrom</div>;\n\t\tlet {owner, assigned, from} = noteItem;\n\t\tlet contact:number = from? from as number : owner as number;\n\t\tif (disableOwnerFrom === false && this.isMe(contact) === false) {\n\t\t\tlet renderUser = (user:User) => {\n\t\t\t\tlet {name, nick, icon} = user;\n\t\t\t\tlet vImage:any, cnName:string = 'text-muted';\n\t\t\t\tif (icon) {\n\t\t\t\t\tcnName += ' small'\n\t\t\t\t\tvImage = <Image className=\"w-1c h-1c mr-1\" src={icon} />;\n\t\t\t\t}\n\t\t\t\treturn <>\n\t\t\t\t\t{vImage} <span className={cnName}>{assigned || nick || name}</span>\n\t\t\t\t</>\n\t\t\t}\n\t\t\treturn <span className=\"mr-3\"><UserView user={contact} render={renderUser} /></span>;\n\t\t}\n\t}\n\n\tprotected renderEditTime() {\n\t\tlet {$create, $update} = this.controller.noteItem;\n\t\tlet create:Date = $create;\n\t\tlet update:Date = $update;\n\t\tif (create && update) {\n\t\t\tlet time:Date, action:any;\n\t\t\tif (update.getTime() - create.getTime() > 60*1000) {\n\t\t\t\taction = <FA className=\"mr-1 text-info\" name=\"pencil\" />;\n\t\t\t\ttime = update;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttime = create;\n\t\t\t}\n\t\t\treturn <small className=\"text-muted\">\n\t\t\t\t{action}\n\t\t\t\t<span><EasyTime date={time} /></span>\n\t\t\t</small>\n\t\t}\n\t}\n\n\tprotected renderCaption() {\n\t\tlet {caption: title} = this.controller;\n\t\tif (title) {\n\t\t\treturn <div className=\"pr-3\">\n\t\t\t\t<div><b>{title}</b></div>\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderContent():JSX.Element {return;}\n\n\tprotected renderToCount() {\n\t\tlet {toCount} = this.controller.noteItem;\n\t\tif (toCount === undefined || toCount <= 0)\n\t\t\treturn;\n\t\treturn <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"share\"/><small className=\"\">{toCount}</small> \n\t\t</span>;\n\t}\n\n\tprotected renderSpawnCount() {\n\t\tlet {spawnCount} = this.controller.noteItem;\n\t\tif (spawnCount === undefined || spawnCount <= 0)\n\t\t\treturn;\n\t\treturn  <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"hand-pointer-o\"/><small className=\"\">{spawnCount}</small>\n\t\t</span>;\n\t}\n\n\tprotected renderCommentFlag = () => {\n\t\tlet {commentCount, commentUnread} = this.controller.noteItem;\n\t\tif (commentCount === undefined || commentCount <= 0)\n\t\t\treturn;\n\t\tlet vCU:any;\n\t\tif (commentUnread > 0) {\n\t\t\tlet cu:any = commentUnread>99? <>99<sup>+</sup></> : commentUnread;\n\t\t\tvCU = <div className=\"unread-num\">{cu}</div>;\n\t\t};\n\t\treturn  <span className=\"mr-5 text-muted position-relative\">\n\t\t\t<FA className=\"mr-2\" name=\"comment-o\"/><small className=\"\">{commentCount}</small>\n\t\t\t{vCU}\n\t\t</span>;\n\t}\n\n\tprotected showActionEndPage({content, onClick}:{content:any; onClick?:()=>void}) {\n\t\tthis.openPage(() => {\n\t\t\tonClick = onClick || (()=>this.closePage());\n\t\t\tlet {caption: title} = this.controller;\n\t\t\treturn <Page header={title} back=\"close\">\n\t\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t\t{content}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={onClick}>返回</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Page>;\n\t\t});\n\t}\n\n\tprotected renderShareButton() {\n\t\treturn <span onClick={this.onSendNote} className=\"cursor-pointer text-primary mr-5\">\n\t\t\t<FA name=\"share\" />\n\t\t</span>;\n\t}\n\n\tprotected onSendNote = async () => {\n\t\tawait this.controller.cApp.loadRelation();\n\t\tthis.controller.showShareTo();\n\t}\n\n\tprotected renderEditButton() : JSX.Element {\n\t\treturn <span onClick={()=>this.onEdit()} className=\"cursor-pointer text-primary\">\n\t\t\t<FA name=\"pencil-square-o\" />\n\t\t</span>;\n\t}\n\t\n\tprotected renderStateSpan(content: string, isEnd: boolean = false) {\n\t\tif (isEnd === true) {\n\t\t\treturn <span className=\"small text-danger\"><FA className=\"small mr-1\" name=\"stop\" />{content}</span>;\n\t\t}\n\t\treturn <span className=\"small text-success border border-success rounded px-2\">{content}</span>;\n\t}\n\n\tprotected onEdit() {this.controller.showEditPage()}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport class VNoteBaseDir<T extends CNoteBase> extends VNoteBase<T> {\n\trender() {\n\t\treturn this.renderBody();\n\t}\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderDirBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className=\"d-flex pl-2 pr-3 py-2 border-top\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<div className=\"ml-auto\">{this.renderEditTime()}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderDirBottom():JSX.Element {\n\t\tlet divToCount = this.renderToCount();\n\t\tlet divSpawnCount = this.renderSpawnCount();\n\t\tlet divComment = this.renderCommentFlag();\n\t\tif (divToCount || divSpawnCount || divComment) {\n\t\t\treturn <div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t{divToCount}\n\t\t\t\t{divSpawnCount}\n\t\t\t\t{divComment}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderIcon(): JSX.Element {\n\t\tlet {unread} = this.controller.noteItem;\n\t\tlet dot:any;\n\t\tif (unread>0) dot = <u/>;\n\t\treturn <div className=\"mr-3 unread-dot\">{this.controller.renderIcon()}{dot}</div>\n\t}\n}\n\nexport class VNoteBaseDirView extends VNoteBaseDir<CNoteBase> {\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { CNoteBase } from \"./CNoteBase\";\nimport { VNoteBaseForm } from './VNoteBaseForm';\n\nexport class VNoteBaseEdit<T extends CNoteBase> extends VNoteBaseForm<T> {\n\t/*\n\t@computed protected get btnSaveDisabled():boolean {\n\t\tif (this.controller.isContentChanged === true) return false;\n\t\tif (this.controller.isCaptionChanged === true) return false;\n\t\treturn true;\n\t}\n\t*/\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t\t{this.renderExButtons()}\n\t\t</div>;\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.SetNote();\n\t\tthis.closePage();\n\t}\n\n\tprotected renderExButtons():JSX.Element {return}\n}\n\nexport class VNoteBaseEditPage extends VNoteBaseEdit<CNoteBase> {\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n//import { computed } from 'mobx';\nimport { ConfirmOptions, FA } from '../../tonva';\n\nexport class VNoteBaseForm<T extends CNoteBase> extends VNoteBase<T> {\n\t//@computed protected get changed(): boolean {return this.controller.captionChanged};\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return this.t('notes')};\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderEditBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTopCaptionContent():JSX.Element {\n\t\treturn <div className=\"\">\n\t\t\t{this.renderCaptionInput()}\n\t\t\t<div className=\"mx-1 py-1 bg-white\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCaptionInput() {\n\t\treturn <div className=\"py-2 px-1\">\n\t\t\t<input type=\"text\" className=\"w-100 border-0 form-control font-weight-bold\" placeholder=\"标题\" maxLength={80}\n\t\t\t\tonChange={this.onCaptionChange}\n\t\t\t\tdefaultValue={this.controller.caption} />\n\t\t</div>;\n\t\t//autoFocus={true}\n\t}\n\n\tprotected onCaptionChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.controller.caption = evt.target.value.trim();\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn;\n\t}\n\n\tprotected async onDelete(): Promise<void> {\n\t\tlet options: ConfirmOptions = {\n\t\t\tcaption: '请确认',\n\t\t\tmessage: <div className=\"my-3\"><FA name=\"question-circle-o\" size=\"2x\" className=\"mr-3 text-danger\" />真的要删除这个小单吗？</div>,\n\t\t\tyes: '确认删除',\n\t\t\tno: '不删除'\n\t\t};\n\t\tif (await this.controller.confirm(options) === 'yes') {\n\t\t\tawait this.controller.owner.hideNote(this.controller.noteItem.note, 1);\n\t\t\tthis.closePage(2);\n\t\t}\n\t}\n\n\tprotected renderDeleteButton() {\n\t\treturn <button className=\"btn btn-outline-secondary mr-3\" onClick={() => this.onDelete()}>\n\t\t\t删除\n\t\t</button>;\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteBase } from \"./CNoteBase\";\n\nexport class VNoteBaseView<T extends CNoteBase> extends VNoteBase<T> {\n\theader() {return this.t('notes')}\n\n\tprotected renderBody() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderViewBottom()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\tlet vEditButton:any;\n\t\tlet isMe = this.isMe(this.controller.noteItem.owner);\n\t\tif (isMe === true) {\n\t\t\tvEditButton = <div className=\"ml-auto\">{this.renderEditButton()}</div>;\n\t\t}\n\t\treturn <div className=\"d-flex px-3 py-3 border-top border-bottom bg-light\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t<div className=\"d-flex align-items-center mt-1\">\n\t\t\t\t\t{this.renderFrom()}\n\t\t\t\t\t<span className=\"mr-3\">{this.renderEditTime()}</span>\n\t\t\t\t\t{vEditButton}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\t// 小单的主要部分，top, caption和content\n\tprotected renderTopCaptionContent() {\n\t\treturn <div className=\"bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"py-2\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn <div className=\"h-1c\"></div>;\n\t}\n\n\tprotected renderRelatives():JSX.Element {\n\t\treturn;\n\t}\n\n\tprotected renderIcon(): JSX.Element {\n\t\treturn <div className=\"mr-3\">{this.controller.renderIcon()}</div>;\n\t}\n}\n","import React from 'react';\n\nexport const none = <small className=\"text-muted\">[无]</small>;\n","import React from \"react\";\nimport { VPage, SearchBox, userApi, Image, FA, Muted, Controller } from \"../tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport abstract class VAddContact<T extends Controller> extends VPage<T> {\n\t@observable private hasError = false;\n\t@observable protected user:{id:number, name:string, nick:string, icon:string};\n\n\theader() {\n\t\treturn <div className=\"w-100 mr-1 d-flex\">\n\t\t\t<SearchBox className=\"flex-fill\" \n\t\t\t\tonSearch={this.onSearch} \n\t\t\t\tonFocus={this.onFocus}\n\t\t\t\tplaceholder=\"搜索联系人\" />\n\t\t\t<button className=\"btn btn-sm btn-outline-info ml-1\" onClick={()=>this.closePage()}>取消</button>\n\t\t</div>;\n\t}\n\n\tprivate onSearch = async (key:string) => {\n\t\tlet ret = await userApi.fromKey(key);\n\t\tif (!ret) {\n\t\t\tthis.hasError = true;\n\t\t\treturn;\n\t\t}\n\t\tif (this.controller.isMe(ret.id)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.user = ret;\n\t}\n\n\tprivate onFocus = () => {\n\t\tthis.hasError = false;\n\t}\n\n\tprivate onAddContact = async () => {\n\t\t//await this.controller.AddContact(this.user.id);\n\t\tawait this.addContact();\n\t\tthis.closePage();\n\t}\n\n\tprotected abstract addContact():Promise<void>;\n\tprotected renderFields():JSX.Element {return;}\n\n\tcontent() {\n\t\tlet c = observer(() => {\n\t\t\tif (this.hasError === true) {\n\t\t\t\treturn <div className=\"p-4\">\n\t\t\t\t\t<FA className=\"text-danger mr-2\" name=\"times-circle\" />\n\t\t\t\t\t<Muted>账号不存在或者不接受邀请</Muted>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tif (!this.user) return;\n\n\t\t\tlet {name, nick, icon} = this.user;\n\t\t\tlet div:any;\n\t\t\tif (nick) {\n\t\t\t\tdiv =  <div>\n\t\t\t\t\t<div><b>{nick}</b></div>\n\t\t\t\t\t<div>{name}</div>\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdiv = <div><b>{name}</b></div>\n\t\t\t}\n\t\t\treturn <div className=\"my-3 mx-3 border rounded\">\n\t\t\t\t<div className=\"p-4 d-flex bg-white rounded-top\">\n\t\t\t\t\t<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t\t{div}\n\t\t\t\t</div>\n\t\t\t\t{this.renderFields()}\n\t\t\t\t<div className=\"py-3 px-4\">\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={this.onAddContact}>增加</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t\treturn React.createElement(c);\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { User, Image, UserView, FA } from \"../../tonva\";\nimport { VNoteBase, CNoteBase } from '.';\nimport { none } from '../../tool';\n\nexport interface TabRelative {\n\tname: string;\n\tcaption: (isAction:boolean) => JSX.Element;\n\trender: () => JSX.Element;\n\tvisible: () => boolean;\n}\n\nexport class VRelativesBase<T extends CNoteBase> extends VNoteBase<T> {\n\n\tprotected tabShare:TabRelative = {\n\t\tname: 'share',\n\t\tvisible: () => this.controller.noteItem.toCount>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\tlet {toCount} = this.controller.noteItem;\n\t\t\tlet vCount:any;\n\t\t\tif (toCount > 0) vCount = <small>{toCount}</small>;\n\t\t\treturn <>\n\t\t\t\t<FA className=\"mr-2\" name=\"share\" /> \n\t\t\t\t{vCount}\n\t\t\t</>;\n\t\t},\n\t\trender: () => {\n\t\t\tlet {to} = this.controller.noteModel;\n\t\t\tif (!to || to.length === 0) return;\n\t\t\treturn <div className=\"px-3 py-2\">\n\t\t\t\t<small className=\"text-muted mr-3\">已分享给: </small>\n\t\t\t\t{to.map((t, index) => {\n\t\t\t\t\tlet {user, assigned} = t;\n\t\t\t\t\treturn <span key={index} className=\"mr-3\">{this.renderContact(user, assigned)}</span>;\n\t\t\t\t})}\n\t\t\t</div>\n\t\t}\n\t}\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected get tabs():TabRelative[] { return [this.tabShare] };\n\n\tprotected renderTabs():JSX.Element {\n\t\tlet render = observer(() => {\n\t\t\tlet {activeRelativeTab} = this.controller;\n\t\t\tlet tabs = this.tabs.filter(tab => tab.visible?.());\n\t\t\tif (tabs.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet tab = tabs.find(v => v.name === activeRelativeTab);\n\t\t\tif (!tab) tab = tabs[0];\n\t\t\treturn <div className=\"bg-white\">\n\t\t\t\t<div className=\"d-flex px-3 pt-3\">\n\t\t\t\t\t{tabs.map(v => {\n\t\t\t\t\t\tlet {name, caption} = v;\n\t\t\t\t\t\tlet isActive = v === tab;\n\t\t\t\t\t\treturn this.renderTab(isActive, name, caption(isActive));\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"border-top\" style={{marginTop: '-1px'}}>\n\t\t\t\t\t{tab.render() || <div className=\"p-3\">{none}</div>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t});\n\t\treturn React.createElement(render);\n\t}\n\n\trender():JSX.Element {\n\t\treturn this.renderTabs();\n\t}\n\n\tprivate renderTab(isAction:boolean, tabName:string, tabContent:any) {\n\t\tlet cn:string = isAction === true? ' bg-white' : ' bg-light text-muted border-bottom';\n\t\treturn <div key={tabName}\n\t\t\tclassName={'border-left border-top border-right rounded-top px-3 py-2 cursor-pointer' + cn}\n\t\t\tonClick={()=>this.controller.activeRelativeTab = tabName}>\n\t\t\t{tabContent}\n\t\t</div>;\n\t}\n}\n","import { Controller } from \"../../../tonva\";\nimport { observable } from \"mobx\";\n\nexport abstract class CContent extends Controller {\n\t@observable changed: boolean = false;\n\tprotected async internalStart() {}\n\tget isEmpty():boolean { return true; }\n\n\t//onContentChanged: () => Promise<void>;\n\ttoString(): string {return};\n\tprotected fromString(v:string):void {};\n\t\n\tstartInput(): void {\n\t\tthis.changed = false;\n\t}\n\tendInput(obj:any): void {this.buildObj(obj)}\n\tprotected abstract buildObj(obj:any): void;\n\n\tabstract renderInput(): JSX.Element;\n\tabstract renderViewContent(): JSX.Element;\n\trenderDirContent(): JSX.Element {return this.renderViewContent();}\n\n\treset(content:string) {\n\t\tthis.fromString(content);\n\t\tthis.startInput();\n\t\tthis.changed = true;\n\t}\n}\n","import React from 'react';\nimport { View } from \"../../../../tonva\";\nimport { CCheckable, ContentCheckItem } from './CCheckable';\nimport { observer } from 'mobx-react';\n\nexport abstract class VBase extends View<CCheckable> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {uncheckedItems, checkedItems} = this.controller.doneItems;\n\t\t\treturn <div className=\"mb-2\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t\t{this.renderCheckedItems(checkedItems)}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected abstract renderCheckItem(v:ContentCheckItem):JSX.Element;\n\tprotected abstract renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element;\n}\n","import React from 'react';\nimport { ContentCheckItem } from './CCheckable';\nimport { VBase } from './VBase';\n\nexport class VView extends VBase {\n\tprotected renderCheckItem(v:ContentCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"d-flex mx-3 align-items-center form-check mb-0\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdata-key={key}\n\t\t\t\tonChange={e => this.onCheckChange(v, e.currentTarget.checked)} />\n\t\t\t<div className={'form-control-plaintext ' + cn}>{content}</div>\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange(item:ContentCheckItem, checked:boolean) {\n\t\titem.checked = checked;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"border-top py-2\">\n\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedCount}项完成</div>\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { VBase } from \"./VBase\";\nimport { ContentCheckItem } from \"./CCheckable\";\nimport { FA } from '../../../../tonva';\n\nexport class VItem extends VBase {\n\tprotected renderCheckItem(v:ContentCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tlet icon: string;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t\ticon = 'check-square';\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t\ticon = 'square-o';\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center\">\n\t\t\t<FA name={icon} />\n\t\t\t<div className={'py-1 ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:ContentCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable, toJS } from 'mobx';\nimport { FA } from '../../../tonva';\n\ninterface Focusable<T> {\n\titem: T;\n\tfocused: boolean;\n}\n\nexport interface ListInputProps<T> {\n\titems: T[];\n\tuniqueKey: () => number;\n\tonChanged: () => void;\n}\n\nexport abstract class ListInputBase<T> {\n\tprotected props: ListInputProps<T>;\n\t@observable private focusables: Focusable<T>[];\n\tprivate currentFocusable: Focusable<T>;\n\tprivate inputingText: string;\n\tprivate focuseTimeout: any;\n\n\tconstructor(props: ListInputProps<T>) {\n\t\tthis.props = props;\n\t\tlet {items} = props;\n\t\tthis.focusables = items? items.map(item => ({\n\t\t\titem: toJS(item), \n\t\t\tfocused: false\n\t\t})) : [];\n\t}\n\n\tprotected abstract getItemKey(item:T): number;\n\tprotected abstract getItemText(item:T): string;\n\tprotected abstract setItemText(item:T, text:string): void;\n\tprotected abstract newItem(key:number, text:string): T;\n\n\tgetList():T[] { return this.focusables.map(v => toJS(v.item))}\n\n\trender(): JSX.Element {\n\t\treturn React.createElement(observer(() => <div>\n\t\t\t{this.focusables.map(this.renderItem)}\n\t\t\t{this.renderNewInput()}\n\t\t</div>));\n\t}\n\n\tprotected renderItem = (focusable: Focusable<T>):JSX.Element => {\n\t\tlet {focused} = focusable;\n\t\treturn focused === true? this.renderInputItem(focusable) : this.renderTextItem(focusable);\n\t}\n\n\tprotected renderTextItem(focusable:Focusable<T>):JSX.Element {\n\t\tlet {item} = focusable;\n\t\tlet key = this.getItemKey(item);\n\t\tlet text = this.getItemText(item);\n\t\treturn <div key={key} className=\"d-flex mr-3 align-items-stretch\">\n\t\t\t{this.renderItemHeader(item)}\n\t\t\t<div className=\"flex-fill py-2\" onMouseDown={() => this.onItemClick(focusable)}>{text}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderItemHeader(item:T):JSX.Element {\n\t\treturn <span>item</span>;\n\t}\n\n\tprotected onItemClick(focusable: Focusable<T>) {\n\t\tif (this.currentFocusable) {\n\t\t\tthis.currentFocusable.focused = false;\n\t\t}\n\t\tthis.currentFocusable = focusable;\n\t\tfocusable.focused = true;\n\t\tif (this.focuseTimeout) {\n\t\t\tclearTimeout(this.focuseTimeout);\n\t\t\tthis.focuseTimeout = undefined;\n\t\t}\n\t\tthis.focuseTimeout = setTimeout(() => {\n\t\t\tthis.input?.focus();\n\t\t\tconsole.log('this.input ' + (this.input? 'null' : 'focus') );\n\t\t}, 10);\n\t}\n\n\tprotected renderInputItem(focusable: Focusable<T>):JSX.Element {\n\t\tlet {item} = focusable;\n\t\tlet key = this.getItemKey(item);\n\t\treturn <div key={key} className=\"d-flex mr-3 align-items-stretch\">\n\t\t\t{this.renderItemHeader(item)}\n\t\t\t{this.renderInput(focusable)}\n\t\t</div>;\n\t}\n\n\tprotected renderInput(focusable?: Focusable<T>):JSX.Element {\n\t\treturn <input type=\"text\" className=\"flex-fill form-control\"\n\t\t\tdefaultValue={this.getItemText(focusable?.item)}\n\t\t\tref={this.inputRef}\n\t\t\tonBlur={this.onBlur}\n\t\t\tonKeyDown={this.onKeyDown}\n\t\t\tonChange={this.onChange} />;\n\t}\n\n\tprotected renderNewInput():JSX.Element {\n\t\treturn <div className=\"d-flex mr-3 my-2 align-items-center\">\n\t\t\t<div className=\"w-3c w-min-3c w-max-3c text-center\">\n\t\t\t\t<FA name=\"plus\" className=\"text-info mt-1\" fixWidth={true} /> \n\t\t\t</div>\n\t\t\t<input className=\"flex-fill form-control\" \n\t\t\t\ttype=\"text\" \n\t\t\t\tplaceholder=\"新增\" \n\t\t\t\tonBlur={this.onBlurAddNew}\n\t\t\t\tonChange={this.onChange}\n\t\t\t\tonKeyDown={this.onAddNewEnter} />\n\t\t</div>;\n\t}\n\n\tprivate onAddNewEnter = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode !== 13) return;\n\t\tevt.currentTarget.value = '';\n\t\tthis.addNewItem();\n\t}\n\n\tprivate addNewItem() {\n\t\tif (!this.inputingText) return;\n\t\tif (this.inputingText.trim().length === 0) return;\n\t\tthis.focusables.push(\n\t\t\t{\n\t\t\t\titem: this.newItem(this.props.uniqueKey(), this.inputingText.trimRight()),\n\t\t\t\tfocused: false\n\t\t\t}\n\t\t);\n\t\tthis.inputingText = undefined;\n\t}\n\n\tprotected input: HTMLInputElement;\n\tprivate onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode !== 13) return;\n\t\tthis.currentFocusable.focused = false;\n\t\tevt.currentTarget.value = '';\n\t\tthis.inputingText = undefined;\n\t\tthis.currentFocusable = undefined;\n\t}\n\n\tprivate onBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tthis.currentFocusable.focused = false;\n\t\tthis.currentFocusable = undefined;\n\t}\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {value} = evt.target;\n\t\tthis.inputingText = value;\n\t\tif (this.currentFocusable) this.setItemText(this.currentFocusable.item, value);\n\t\tthis.props.onChanged();\n\t}\n\tprivate inputRef = (input: any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t\t//this.input.focus();\n\t}\n\tprivate onBlurAddNew = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tevt.currentTarget.value = '';\n\t\tthis.addNewItem();\n\t}\n}\n","import React from 'react';\nimport { ListInputBase } from \"../ListInputBase\";\nimport { ContentCheckItem } from \"./CCheckable\";\n\nexport class CheckableListInput extends ListInputBase<ContentCheckItem> {\n\tprotected getItemKey(item:ContentCheckItem): number {return item.key}\n\tprotected getItemText(item:ContentCheckItem): string {return item?.text}\n\tprotected setItemText(item:ContentCheckItem, text:string): void {if (item) {item.text = text}}\n\tprotected newItem(key:number, text:string): ContentCheckItem {return {key, text, checked:false}};\n\n\tprotected renderItemHeader(item:ContentCheckItem):JSX.Element {\n\t\treturn <label className=\"w-3c w-min-3c w-max-3c text-center mb-0\">\n\t\t\t<input className=\"mt-3\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={item.checked}\n\t\t\t\tonChange={e => this.onCheckChange(item, e.currentTarget.checked)} />\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange = (item:ContentCheckItem, checked:boolean) => {\n\t\titem.checked = checked;\n\t\tthis.props.onChanged();\n\t}\n}\n","import { observable, computed } from \"mobx\";\nimport { CContent } from \"../CContent\";\nimport { VView } from \"./VView\";\nimport { VItem } from \"./VItem\";\nimport { CheckableListInput } from \"./CheckableListInput\";\n\nexport interface ContentCheckItem {\n\tkey: number;\n\ttext: string;\n\tchecked: boolean;\n}\n\nexport class CCheckable extends CContent {\n\tprivate listInput: CheckableListInput;\n\t@observable items: ContentCheckItem[] = [];\n\titemKey: number = 1;\n\t\n\tget isEmpty():boolean { return this.listInput.getList().length === 0; }\n\n\tinit(obj:any) {\n\t\tif (obj) {\n\t\t\tthis.itemKey = obj.itemKey;\n\t\t\tthis.items = obj.items;\n\t\t}\n\t}\n\n\tstartInput(): void {\n\t\tsuper.startInput();\n\t\tthis.listInput = new CheckableListInput({\n\t\t\titems: this.items,\n\t\t\tuniqueKey: () => this.itemKey++,\n\t\t\tonChanged: () => this.changed = true,\t\t\t\t\t\n\t\t});\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn this.listInput.render();\n\t\t/*\n\t\tlet v = new VInput(this, this.items);\n\t\treturn v.render();\n\t\t*/\n\t}\n\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\trenderDirContent():JSX.Element {return this.renderView(VItem)}\n\n\tendInput(obj:any): void {\n\t\tthis.items = this.listInput.getList();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t\tdelete obj.content;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t\tchecked: false\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\t/*\n\tasync onCheckChange(key: number, checked: boolean) {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) item.checked = checked;\n\t\tawait this.onContentChanged?.();\n\t\t//await this.SetNote(false);\n\t}\n\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = key && this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext,\n\t\t\tchecked: false,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n*/\n\t@computed get doneItems():{uncheckedItems:ContentCheckItem[], checkedItems: ContentCheckItem[]} {\n\t\tlet uncheckedItems:ContentCheckItem[] = [];\n\t\tlet checkedItems:ContentCheckItem[] = [];\n\t\tfor (let ci of this.items) {\n\t\t\tlet {checked} = ci;\n\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\telse uncheckedItems.push(ci);\n\t\t}\n\t\treturn {uncheckedItems, checkedItems};\n\t}\n}\n","import React from 'react';\nimport { View } from \"../../../../tonva\";\nimport { CList } from './CList';\nimport { observer } from 'mobx-react';\n\nexport class VView extends View<CList> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet items = this.controller.items;\n\t\t\treturn <ul className=\"note-content-list px-3 my-2\">\n\t\t\t\t{items.map((v, index) => {\n\t\t\t\t\tlet {key, text} = v;\n\t\t\t\t\treturn <li key={key} className=\"ml-3 pt-1 pb-2 align-items-center\">\n\t\t\t\t\t\t{text}\n\t\t\t\t\t</li>\n\t\t\t\t})}\n\t\t\t</ul>;\n\t\t}));\n\t}\n}\n","import React from 'react';\nimport { ListInputBase } from \"../ListInputBase\";\nimport { ListItem } from \"./CList\";\n\nexport class ListInput extends ListInputBase<ListItem> {\n\tprotected getItemKey(item:ListItem): number {return item.key}\n\tprotected getItemText(item:ListItem): string {return item?.text}\n\tprotected setItemText(item:ListItem, text:string): void {if (item) {item.text = text}}\n\tprotected newItem(key:number, text:string): ListItem {return {key, text}};\n\n\tprotected renderItemHeader(item:ListItem):JSX.Element {\n\t\treturn <div className=\"w-3c w-min-3c w-max-3c pt-2 text-center\">●</div>;\n\t}\n}\n","import { CContent } from \"../CContent\";\n//import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { observable } from \"mobx\";\nimport { ListInput } from \"./ListInput\";\n\nexport interface ListItem {\n\tkey: number;\n\ttext: string;\n}\n\nexport class CList extends CContent {\n\tprivate listInput: ListInput;\n\t@observable items: ListItem[] = [];\n\titemKey: number = 1;\n\n\tinit(obj:any) {\n\t\tthis.itemKey = obj.itemKey;\n\t\tthis.items = obj.items;\n\t}\n\n\tget isEmpty():boolean { return this.items.length === 0; }\n\n\tstartInput(): void {\n\t\tsuper.startInput();\n\t\tthis.listInput = new ListInput({\n\t\t\titems: this.items,\n\t\t\tuniqueKey: () => this.itemKey++,\n\t\t\tonChanged: () => this.changed = true,\t\t\t\t\t\n\t\t});\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn this.listInput.render();\n\t\t//let v = new VInput(this);\n\t\t//return v.render();\n\t}\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\n\tendInput(obj:any): void {\n\t\tthis.items = this.listInput.getList();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t\tdelete obj.content;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n/*\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext: text,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n*/\n}\n","import { CContent } from \"../CContent\";\nimport { observable } from \"mobx\";\n\nexport abstract class CTextBase extends CContent {\n\t@observable noteContent: string;\n\t@observable changedNoteContent: string;\n\n\tget isEmpty():boolean { return this.noteContent === undefined || this.noteContent.trim().length === 0; }\n\n\tinit(obj: any): void {\n\t\tswitch (typeof obj) {\n\t\t\tdefault: break;\t\t\t\t// Add状态，没有初始值\n\t\t\tcase 'undefined': break;\n\t\t\tcase \"string\":  this.noteContent = (obj as string).trim(); break;\n\t\t\tcase \"object\": this.noteContent = obj.content?.trim(); break;\n\t\t}\n\t}\n\n\tendInput(obj:any): void {\n\t\tif (this.changedNoteContent !== undefined) {\n\t\t\tthis.noteContent = this.changedNoteContent;\n\t\t\tthis.changedNoteContent = undefined;\n\t\t}\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any) {\n\t\tobj.content = this.changedNoteContent || this.noteContent;\n\t\tdelete obj.itemKey;\n\t\tdelete obj.items;\n\t}\n}\n","import { renderParagraphs } from '../../../components';\nimport React from 'react';\nimport { View } from \"../../../../tonva\";\nimport { CTextBase } from './CTextBase';\n\nexport class VTextBaseView<T extends CTextBase> extends View<T> {\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n\t\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\treturn renderParagraphs(content);\n\t}\n}\n","import React from 'react';\nimport { View } from \"../../../../tonva\";\nimport { CTextBase } from './CTextBase';\nimport { observer } from 'mobx-react';\n\nexport class VTextBaseInput<T extends CTextBase> extends View<T> {\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={this.t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n}\n","//import React from 'react';\nimport { CText } from './CText';\n//import { observer } from 'mobx-react';\n//import { View, t } from 'tonva';\nimport { VTextBaseInput } from '../textBase';\n\nexport class VInput<T extends CText> extends VTextBaseInput<T> {\n\t/*\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n\t*/\n}\n","import React from 'react';\nimport { VTextBaseView } from '../textBase';\nimport { CText } from './CText';\n\nexport class VView<T extends CText> extends VTextBaseView<T> {\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n}\n","import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { CTextBase } from \"../textBase\";\n\nexport class CText extends CTextBase {\n\trenderInput():JSX.Element {return this.renderView<this>(VInput)}\n\trenderViewContent():JSX.Element {return this.renderView<this>(VView)}\n\n\ttoString():string { return this.changedNoteContent || this.noteContent }\n\tfromString(v: string) {\n\t\tthis.noteContent = v.trim();\n\t}\n}\n\n","//import React from 'react';\n//import { View, t } from \"tonva\";\nimport { CFolder } from './CFolder';\n//import { observer } from 'mobx-react';\nimport { VTextBaseInput } from '../textBase';\n\nexport class VInput extends VTextBaseInput<CFolder> {\n\t/*\n\trender() {\n\t\treturn <div className=\"py-1 px-1\">\n\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={t('content')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t\tthis.controller.changed = true;\n\t}\n\t*/\n}\n","//import React from 'react';\n//import { View } from \"tonva\";\nimport { CFolder } from './CFolder';\nimport { VTextBaseView } from '../textBase';\n\nexport class VView extends VTextBaseView<CFolder> {\n\t/*\n\trender() {\n\t\treturn <div className=\"px-3 my-2\">\n\t\t\t{this.renderParagraphs(this.controller.noteContent)}\n\t\t</div>;\n\t}\n\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\tif (!content) return;\n\t\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\t\tlet c:any;\n\t\t\tif (!v) {\n\t\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc = '';\n\t\t\t\tlet len = v.length, i=0;\n\t\t\t\tfor (; i<len; i++) {\n\t\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tc += v.substr(i);\n\t\t\t}\n\t\t\treturn <div key={index} className=\"pt-1 pb-2\">{c}</div>;\n\t\t})}</>;\n\t}\n\t*/\n}\n","import { VInput } from \"./VInput\";\nimport { VView } from \"./VView\";\nimport { CTextBase } from \"../textBase\";\n\nexport class CFolder extends CTextBase {\n\trenderInput():JSX.Element {return this.renderView(VInput)}\n\trenderViewContent():JSX.Element {\n\t\treturn this.renderView(VView)\n\t}\n}\n\n","import React from 'react';\nimport { VBasePage } from '../../views/VBasePage';\nimport { CTo } from './CTo';\n\nexport class VSent extends VBasePage<CTo> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return '已发送'}\n\tcontent() {\n\t\treturn <div className=\"m-5 border rounded bg-white\">\n\t\t\t<div className=\"p-5 text-center border-bottom\">已发送</div>\n\t\t\t<div className=\"text-center py-3\">\n\t\t\t\t<button className=\"btn btn-outline-info\" onClick={()=>this.backPage()}>返回</button>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { List, FA } from '../../../tonva';\nimport { Contact } from '../../../model';\nimport { VBasePage } from '../../views/VBasePage';\n//import { VActions } from './VActions';\nimport { CTo } from './CTo';\n\nexport class VTo extends VBasePage<CTo> {\n\t//protected backPageCount = 2;\n\t/*\n\tinit(param?:any):void {\n\t\tif (param) {\n\t\t\tthis.backPageCount = Number(param);\n\t\t}\t\n\t}\n\t*/\n\n\t@observable private anyChanged:boolean = false;\n\tprivate list: List;\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return '收件人'}\n\tright():any {\n\t\tlet c = observer(() => <button className=\"btn btn-sm btn-primary mr-1\" onClick={this.onNext} disabled={!this.anyChanged}>\n\t\t\t下一步 <FA name=\"angle-right\" />\n\t\t</button>);\n\t\treturn React.createElement(c);\n\t}\n\tcontent() {\n\t\tlet items = this.controller.groupContacts; //.cApp.contacts;\n\t\treturn <div className=\"\">\n\t\t\t<List ref={v => this.list = v}\n\t\t\t\titems={items} \n\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}}\n\t\t\t\tisItemSelected={v => v.already} />\n\t\t</div>\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tlet {already} = item;\n\t\tif (\n\t\t\t\t(isSelected === true && already === 0)\n\t\t\t || (isSelected === false && already > 0)\n\t\t\t)\n\t\t{\n\t\t\tthis.anyChanged = true;\n\t\t}\n\t}\n\n\tprivate onNext = async () => {\n\t\tlet contacts = this.list.selectedItems;\n\t\tawait this.controller.onContactsSelected(contacts);\n\t\t//this.controller.contacts = contacts;\n\t\t//this.openVPage(VActions, this.backPageCount + 1); //, {contacts, noteId: this.currentNoteId});\n\t}\n}\n","import { observable } from \"mobx\";\nimport { CUqBase } from \"../../../tapp\";\nimport { Contact } from \"../../../model\";\nimport { VSent } from \"./VSent\";\nimport { VTo } from \"./VTo\";\nimport { Query } from \"tonva\";\nimport { NoteItem } from \"notes/model\";\n\nexport abstract class CTo extends CUqBase {\n\tprotected currentGroupFolder: number;\n\tcurrentNoteItem: NoteItem;\n\t@observable groupContacts: Contact[];\n\t@observable contacts: Contact[];\n\n\tconstructor(cApp:any, currentGroupFolder: number, currentNoteItem: NoteItem) {\n\t\tsuper(cApp);\n\t\tthis.currentGroupFolder = currentGroupFolder;\n\t\tthis.currentNoteItem = currentNoteItem;\n\t}\n\n\tprotected abstract get GetContacts(): Query; // this.uqs.notes.GetMyContacts\n\tprotected abstract sendOut(toList:number[]):Promise<void>;\n\tprotected abstract afterContactsSelected(): Promise<void>;\n\n\tprotected async internalStart():Promise<void> {\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: this.currentNoteItem.note,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.startAction();\n\t\tthis.openVPage(VTo);\n\t}\n\n\tonSendOut = async (): Promise<void> => {\n\t\t//let {contacts, noteItem, currentFold: currentFoldItem} = this.controller;\n\t\tlet toList = this.contacts.map (v => {\n\t\t\tlet {contact} = v;\n\t\t\tif (!contact) return undefined;\n\t\t\tif (typeof contact === 'object') return (contact as any).id;\n\t\t\treturn contact;\n\t\t});\n\t\t//await this.controller.sendNoteTo(currentFoldItem.folderId, noteItem.note, toList);\n\t\tawait this.sendOut(toList);\n\t\tthis.popToTopPage();\n\t\tthis.openVPage(VSent);\n\t}\n\n\tasync onContactsSelected(contacts: Contact[]) {\n\t\tthis.contacts = contacts;\n\t\tawait this.afterContactsSelected();\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { List, FA } from '../../../tonva';\nimport { Contact } from '../../../model';\nimport { CSelectContact } from './CSelectContact';\nimport { VBasePage } from '../../views/VBasePage';\n\nexport interface SelectContactOptions {\n\ttitle?: string;\n\taction?: string;\n\tsingle?: boolean;\n}\n\nexport class VSelectContact extends VBasePage<CSelectContact> {\n\t@observable private anySelected:boolean = false;\n\t@observable private contacts: Contact[];\n\t@observable private multiple:boolean = false;\n\tprivate list: List;\n\tprivate options: SelectContactOptions;\n\n\tinit(options: SelectContactOptions):void {\n\t\tthis.options = options;\n\t}\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return this.options?.title ?? '选择'}\n\tright() {\n\t\treturn React.createElement(observer(this.buildRight));\n\t}\n\n\tprivate buildRight = () => {\n\t\tif (this.options?.single === true) return;\n\t\tlet cn = 'btn btn-sm btn-success mr-1';\n\t\tif (this.multiple === false) {\n\t\t\treturn <button className={cn} onClick={this.onToggleSelect}>多选</button>;\n\t\t}\n\t\tif (this.contacts && this.contacts.length > 0) {\n\t\t\treturn <button className={cn} onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t\t{this.options?.action ?? '选中'}({this.contacts.length}) <FA name=\"angle-right\" />\n\t\t\t</button>;\n\t\t}\n\t\treturn <button className={cn} onClick={this.onToggleSelect}>单选</button>;\n\t}\n\n\tprivate onToggleSelect = () => {\n\t\tthis.multiple = !this.multiple;\n\t}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\tlet list:any;\n\t\t\tlet items = this.controller.contacts;\n\t\t\tif (this.multiple === true) {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onClick:this.onContactClick}} />\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{list}\n\t\t\t</div>;\n\t\t}\n\t\treturn React.createElement(observer(render));\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t\tthis.contacts = this.list.selectedItems;\n\t}\n\n\tprivate onContactClick = (item:Contact) => {\n\t\tthis.returnCall([item]);\n\t}\n\n\tprivate onNext = () => {\n\t\tthis.returnCall(this.list.selectedItems);\n\t}\n}\n","import { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { SelectContactOptions, VSelectContact } from \"./VSelectContact\";\nimport { CUqBase } from \"../../../tapp\";\n\nexport abstract class CSelectContact extends CUqBase {\n\t@observable contacts: Contact[];\n\n\t//protected abstract get GetContacts(): Query; // this.uqs.notes.GetMyContacts\n\tprotected abstract loadContacts(): Promise<void>;\n\n\tprotected async internalStart():Promise<void> {\n\t\tawait this.loadContacts();\n\t\t/*\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: this.currentNoteItem.note,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.startAction();\n\t\t*/\n\t\tthis.openVPage(VSelectContact);\n\t}\n\n\tSetContacts(contacts:Contact[]) {\n\t\tthis.contacts = [];\n\t\tfor (var ci of contacts) {\n\t\t\tlet n = {...ci};\n\t\t\tthis.contacts.push(n);\n\t\t}\n\t}\n\n\tasync callSelectContact(options: SelectContactOptions): Promise<Contact[]> {\n\t\treturn await this.vCall(VSelectContact, options);\n\t}\n}\n","import React from 'react';\nimport { CInputHours } from './CInputHours';\nimport { VBasePage } from '../../views/VBasePage';\nimport { checkHourMinutes, taskTimeToString } from '../../../notes/model';\n\nexport class VInputHours extends VBasePage<CInputHours> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\tprivate hourminutes: number;\n\theader() {return '输入工时'}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\treturn <div>\n\t\t\t\t<div className=\"flex-fill ml-2 mr-2 mt-2 \"><input className=\"flex-fill form-control border-0\"\n\t\t\t\t\ttype=\"text\" defaultValue={taskTimeToString(this.controller.hourminutes)}\n\t\t\t\t\tplaceholder=\"2.5或者2:30表示两个半小时\"\n\t\t\t\t\tautoFocus={true}\n\t\t\t\t\tonBlur={e=>this.onHoursBlur(e)}\n\t\t\t\t\tonChange={e=>this.onHoursChange(e)}/>\n\t\t\t\t</div>\n\t\t\t\t<button onClick={() => this.onNext()}\n\t\t\t\t\tclassName=\"btn btn-primary ml-2 mt-2\" >\n\t\t\t\t\t确认\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t}\n\t\treturn React.createElement(render);\n\t}\n\n\tprotected onHoursChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet m = checkHourMinutes(evt.target.value);\n\t\tif (m < 0) {\n\t\t\tm = undefined;\n\t\t}\n\t\tthis.hourminutes = m;\n\t}\n\n\tprotected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tif (checkHourMinutes(evt.target.value) < 0) {\n\t\t\tevt.target.value = '';\n\t\t\tthis.hourminutes = undefined;\n\t\t}\n\t}\n\n\tprivate onNext = () => {\n\t\tlet r = this.hourminutes !== undefined ? this.hourminutes : this.controller.hourminutes;\n\t\tthis.returnCall(r);\n\t}\n}\n","import { CUqBase } from \"../../../tapp\";\nimport { VInputHours } from \"./VInputHours\";\n\nexport class CInputHours extends CUqBase {\n\thourminutes: number;\n\n\tprotected async internalStart():Promise<void> {\n\t\tthis.openVPage(VInputHours);\n\t}\n\n\tasync inputHours(h?:number) {\n\t\tthis.hourminutes = h;\n\t\treturn await this.vCall(VInputHours);\n\t}\n}\n","import React from 'react';\n\nexport function renderParagraphs(content:string):JSX.Element {\n\tif (!content) return;\n\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\tlet c:any;\n\t\tif (!v) {\n\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t}\n\t\telse {\n\t\t\tc = '';\n\t\t\tlet len = v.length, i=0;\n\t\t\tfor (; i<len; i++) {\n\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tc += v.substr(i);\n\t\t}\n\t\treturn <div key={index} className=\"pt-1 pb-2\">{c}</div>;\n\t})}</>;\n}\n","import React from 'react';\nimport { List, FA, User, Image, UserView } from '../../../tonva';\nimport { CContainer } from '../CContainer';\nimport { CNoteBase, VNoteBase } from \"../../noteBase\";\nimport { observer } from 'mobx-react';\nimport { renderParagraphs } from '../../components';\n\nexport class VFolder<T extends CContainer> extends VNoteBase<T> {\n\tafterBack() {\n\t\tthis.controller.owner.popFolder();\n\t}\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (noteItem) {\n\t\t\t\treturn noteItem.caption;\n\t\t\t}\n\t\t\treturn this.t('notes');\n\t\t}));\n\t}\n\n\tright() {\n\t\t// 应该任何群成员都可以发小单吧\n\t\t//if (this.isMe(this.controller.noteItem.owner)) {\n\t\t\treturn this.controller.owner.renderFolderDropDown();\n\t\t//}\n\t}\n\n\tprotected top() {\n\t\tlet {noteItem} = this.controller;\n\t\tif (!noteItem) return;\n\n\t\tlet paragraphs: string;\n\t\tlet {content: contentString} = noteItem;\n\t\tlet json = JSON.parse(contentString);\n\t\tif (json) {\n\t\t\tlet {content} = json;\n\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t}\n\t\telse {\n\t\t\tparagraphs = \"整理小单\";\n\t\t}\n\t\tlet left: any;\n\t\tif (this.isMe(this.controller.noteItem.owner)) {\n\t\t\tleft = <>\n\t\t\t\t<FA className=\"mr-3 text-warning py-3\" name={noteItem.toCount > 0 ? \"folder-open\":\"folder\"} size=\"3x\" />\n\t\t\t\t<div className=\"small text-muted py-3\">{this.renderParagraphs(paragraphs)}</div>\n\t\t\t</>;\n\t\t}\n\t\telse {\n\t\t\tlet {owner, assigned} = noteItem;\n\t\t\tlet renderUser = (user:User) => {\n\t\t\t\tlet {name, nick, icon} = user;\n\t\t\t\treturn <>\n\t\t\t\t\t<Image className=\"w-3c h-3c mr-2 my-3\" src={icon || '.user-o'} />\n\t\t\t\t\t<div className=\"py-3\">\n\t\t\t\t\t\t<div className=\"small\">{assigned || nick || name}</div>\n\t\t\t\t\t\t<div className=\"small text-muted py-3\">{this.renderParagraphs(paragraphs)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</>;\n\t\t\t}\n\t\t\tleft = <UserView user={owner as number} render={renderUser} />;\n\t\t}\n\t\treturn <div className=\"d-flex ml-3\">\n\t\t\t{left}\n\t\t\t<div className=\"ml-auto align-self-stretch cursor-pointer px-3 d-flex align-items-center\" \n\t\t\t\tonClick={(e)=>{e.stopPropagation(); this.controller.showFolderView()}}>\n\t\t\t\t<FA name=\"ellipsis-h\" />\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tcontent() {\n\t\tlet {notesPager, showNoteItem} = this.controller;\n\t\treturn <div>\n\t\t\t{React.createElement(observer(() => this.top()))}\n\t\t\t<List className=\"\" \n\t\t\t\titems={notesPager} \n\t\t\t\titem={{\n\t\t\t\t\trender: this.renderItemInFolder,\n\t\t\t\t\tkey: this.noteKey, \n\t\t\t\t\tonClick: showNoteItem,\n\t\t\t\t\tclassName:'notes'}} />\n\t\t</div>\n\t}\n\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\treturn renderParagraphs(content);\n\t}\n\n\trenderListView() {\n\t\treturn this.content();\n\t}\n\n\tprivate noteKey = (item: CNoteBase) => {\n\t\tlet note = item.noteItem.note;\n\t\treturn note;\n\t}\n\n\tprivate renderItemInFolder = (cNoteBase: CNoteBase, index:number) => {\n\t\treturn <div className=\"d-block mb-2 bg-white\">{cNoteBase.renderDirItem(index)}</div>;\n\t}\n}\n","\nexport interface BookProject {\n\tid: number;\n\tname: string;\n\tcaption: string;\n\tmemo: string;\n\tratioX: number;\t\t\t\t\t// ratioX / ratioY 是显示内容值\n\tratioY: number;\n\treadUnit: string;\n\t$create: Date;\n\t$update: Date;\n\torderNo: number;\n}\nexport interface ReportProject {\n\towner: number;\n\tid: number;\n\tproject: number;\n\theader: string;\n\treadUnit: string;\n}\nexport interface BookReport {\n\tid: number;\n\trootUnit: number;\n\tcaption: string;\n\tprojects: ReportProject[];\n}\n\nexport enum EnumUnitRole {owner=1, admin=2, unitAdmin=4};\nexport enum EnumPeriod {day=1, week=2, month=3, year=4};\nexport interface UnitItem {\n\tid:number; \n\tcaption:string; \n\tcontent:string;\n\trole: EnumUnitRole;\n\tmemberCount: number;\n}\nexport interface MemberItem {\n\tmember: number;\n\tassigned: string;\n\tdiscription: string;\n\trole: EnumUnitRole;\n}\nexport interface ProjectSum {\n\tproject: BookProject;\n\tdebit: number;\n\tcredit: number;\n}\n\nexport interface UnitProjectsSum {\n\tunit: UnitItem;\n\tprojectSums: ProjectSum[];\n}\n\nexport interface MemberProjectsSum {\n\tmember: MemberItem;\n\tprojectSums: ProjectSum[];\n}\n","import React from 'react';\nimport { FA } from '../../../tonva';\nimport { CContainer } from '../CContainer';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from '../../noteBase/VNoteBase';\n\nexport class VFolderDir extends VNoteBase<CContainer> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\n\t\t\tlet dot:any;\n\t\t\tif (unread>0) {\n\t\t\t\tdot = <u/>;\n\t\t\t}\n\t\n\t\t\tlet vIcon = <div className=\"unread-dot mr-3\">\n\t\t\t\t<FA name=\"folder\" className=\"text-warning\" size=\"lg\" fixWidth={true} />\n\t\t\t\t{dot}\n\t\t\t</div>;\n\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-center\">\n\t\t\t\t\t{vIcon}\n\t\t\t\t\t<b className=\"\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n}\n","//import React from 'react';\nimport { VRelativesBase, TabRelative } from \"../../noteBase\";\nimport { CFolder } from \"../CFolder\";\n\nexport class VFolderRelatives extends VRelativesBase<CFolder> {\n\tprotected get tabs():TabRelative[] { return [this.tabShare] };\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CContainer } from '../CContainer';\nimport { VFolderRelatives } from './VFolderRelatives';\n\nexport class VFolderView<T extends CContainer> extends VNoteBaseView<T> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (noteItem) {\n\t\t\t\treturn noteItem.caption;\n\t\t\t}\n\t\t\treturn this.t('notes');\n\t\t}));\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VFolderRelatives as any);\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n}\n","import { CNoteBase } from \"../noteBase\";\nimport { NoteItem, EnumNoteType } from '../model';\nimport { QueryPager } from \"../../tonva\";\nimport { EnumSpecFolder } from \"../../tapp\";\nimport { VFolder } from \"./views/VFolder\"\nimport { VFolderDir } from \"./views/VFolderDir\";\nimport { VFolderView } from \"./views/VFolderView\";\nimport { observable, computed } from \"mobx\";\nimport { CContent, CFolder } from \"../../notes/components\";\n\nexport abstract class CContainer extends CNoteBase {\n\t@observable cContent: CContent;\n\tfolderId: number;\n\tnotesPager: QueryPager<CNoteBase>;\n\tcurrentNoteItem: NoteItem;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CFolder(this.res)\n\t\tif (param) {\n\t\t\tthis.caption = param.caption;\n\t\t\tthis.cContent.init(param.obj);\n\t\t}\n\n\t\tlet folderId = this.noteItem?.note;\n\t\tif (!folderId) this.folderId = -EnumSpecFolder.notes;\n\t\telse this.folderId = folderId;\n\n\t\tthis.notesPager = new QueryPager<CNoteBase>(this.uqs.notes.GetNotes, undefined, undefined, true);\n\t\tthis.notesPager.setItemConverter(this.getItemConverter());\n\t}\n\n\t@computed get isContentChanged():boolean {return this.cContent.changed}\n\n\tprotected getItemConverter() {\n\t\treturn this.owner.noteItemConverter;\n\t}\n\n\tasync load() {\n\t\tawait this.notesPager.first({folderId: this.folderId, withX: 0});\n\t}\n\n\tasync refresh() {\n\t\t//每次刷新取5个。\n\t\tlet newnotes = new QueryPager<NoteItem>(this.uqs.notes.GetNotes, 5, 5, false);\n\t\tawait newnotes.first({folderId: this.folderId, withX: 1});\n\t\tlet newitems = newnotes.items;\n\t\tif (newitems) {\n\t\t\tlet len = newitems.length;\n\t\t\tlet items = this.notesPager.items;\n\t\t\tfor (let i = len - 1; i >= 0; --i) {\n\t\t\t\tlet item = newitems[i];\n\t\t\t\tlet {note, x} = item;\n\t\t\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\titems.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tif (x === 0) {\n\t\t\t\t\tlet cNoteItem = this.owner.noteItemConverter(item, undefined);\n\t\t\t\t\titems.unshift(cNoteItem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// private async getNote(id: number): Promise<NoteModel> {\n\t// \tlet folderId = this.owner.currentFold?.folderId;\n\t// \tlet ret = await this.uqs.notes.GetNote.query({folder: folderId, note: id});\n\t// \tlet noteModel:NoteModel = ret.ret[0];\n\t// \tnoteModel.to = ret.to;\n\t// \tnoteModel.flow = ret.flow;\n\t// \tnoteModel.spawn = ret.spawn;\n\t// \tnoteModel.contain = ret.contain;\n\t// \tnoteModel.comments = ret.comments;\n\t// \tfor (var sItem of noteModel.spawn) {\n\t// \t\tinitNoteItemObj(sItem);\n\t// \t}\n\t// \treturn noteModel;\n\t// }\n\n\tshowNoteItem = async (item: CNoteBase) => {\n\t\tlet noteItem = this.currentNoteItem = item.noteItem;\n\t\t//let noteModel = await this.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\tnoteItem.commentUnread = 0;\n\t\t//item.noteModel = noteModel;\n\t\tawait item.lodeModel();\n\t\treturn item.showViewPage();\n\t}\n\n\titemChanged(noteItem: NoteItem):NoteItem {\n\t\tlet {items} = this.notesPager;\n\t\tlet index = items.findIndex(v => v.noteItem === noteItem);\n\t\tif (index > 0) {\n\t\t\tlet fItem = items.splice(index, 1);\n\t\t\titems.unshift(...fItem);\n\t\t}\n\t\t//return index >= 0;\n\t\treturn this.noteItem;\n\t}\n\n\tabstract async showFolder(): Promise<void>;\n\t/* {\n\t\tthis.load();\n\t\tthis.openVPage(VFolder);\n\t}*/\n\n\trenderListView() {\n\t\treturn (new VFolder(this)).renderListView();\n\t}\n\n\tshowViewPage(): void {\n\t\tthis.owner.openFolder(this);\n\t}\n\n\tasync showFolderView() {\n\t\tlet noteItem = this.noteItem;\n\t\tif (!noteItem)\n\t\t\treturn;\n\t\t//let noteModel = await this.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\tnoteItem.commentUnread = 0;\n\t\t//this.noteModel = noteModel;\n\t\tawait this.lodeModel();\n\t\tthis.showFolderViewPage();\n\t}\n\n\tshowFolderViewPage() {\n\t\tthis.openVPage(VFolderView as any);\n\t}\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type:EnumNoteType) {\n\t\tlet sub = 0;\n\t\tlet param = {\n\t\t\tgroupFolder:this.groupFolder,\n\t\t\tfolder:folder,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\ttype,\n\t\t\tsub}\n\t\tlet ret = await this.uqs.notes.AddNote.submit(param);\n\t\tlet {note} = ret;\n\t\tlet date = new Date();\n\t\tlet noteItem:NoteItem = {\n\t\t\tseconds: undefined,\n\t\t\towner: this.user.id,\n\t\t\tnote: note as number,\n\t\t\ttype,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\tx: 0,\n\t\t\tassigned: undefined,\n\t\t\tfrom: undefined,\n\t\t\tfromAssigned: undefined,\n\t\t\tstate: undefined,\n\t\t\tunread: 0,\n\t\t\tobj,\n\t\t\t$create: date,\n\t\t\t$update: date,\n\t\t}\n\t\tif (type === EnumNoteType.folder) {\n\t\t\tnoteItem.groupFolder = this.groupFolder;\n\t\t}\n\t\tlet cNoteItem = this.owner.createCNoteBase(noteItem);\n\t\tcNoteItem.init(noteItem);\n\t\tif (folder === this.folderId) {\n\t\t\tthis.notesPager.items.unshift(cNoteItem);\n\t\t}\n\t\treturn cNoteItem;\n\t}\n\n\tasync editNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\tlet {SetNote} = this.uqs.notes;\n\t\tlet {note, type} = noteItem;\n\t\tawait SetNote.submit({note, caption, content, type}, waiting);\n\t\t// Note.resetCache(note); 现在不调用NoteTuid的cache，所以不需要了\n\t\t// noteItem.unread = 1; 自己修改自己的小单，只是移到最前面，并不显示unread\n\t\tif (note === this.noteItem?.note) {\n\t\t\tthis.noteItem.caption = caption;\n\t\t\tthis.noteItem.content = content;\n\t\t\tthis.noteItem.obj = obj;\n\t\t}\n\t\telse {\n\t\t\tlet {items} = this.notesPager;\n\t\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\t\tif (index >= 0) {\n\t\t\t\tlet theItems = items.splice(index, 1);\n\t\t\t\tlet theItem = theItems[0];\n\t\t\t\ttheItem.noteItem.caption = caption;\n\t\t\t\ttheItem.noteItem.content = content;\n\t\t\t\ttheItem.noteItem.obj = obj;\n\t\t\t\titems.unshift(theItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.uqs.notes.HideNote.submit({note, x});\n\t\tlet index = this.notesPager.items.findIndex(v => v.noteItem.note === note);\n\t\tif (index >= 0) this.notesPager.items.splice(index, 1);\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VFolderDir(this);\n\t\treturn vNoteItem.render();\n\t}\n\n\tasync addGroup(caption:string, content:string, members:{member:number}[]) {\n\t\tlet ret = await this.uqs.notes.AddGroup.submit({caption, content, members});\n\t\tlet {group, folder} = ret;\n\t\tlet date = new Date();\n\t\tlet type = EnumNoteType.groupFolder;\n\t\tlet noteItem:NoteItem = {\n\t\t\tseconds: undefined,\n\t\t\towner: this.user.id,\n\t\t\tnote: folder as number,\n\t\t\ttype,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\tx: 0,\n\t\t\tassigned: undefined,\n\t\t\tfrom: undefined,\n\t\t\tfromAssigned: undefined,\n\t\t\tstate: undefined,\n\t\t\tgroupFolder:group,\n\t\t\tunread: 0,\n\t\t\tobj: undefined,\n\t\t\t$create: date,\n\t\t\t$update: date,\n\t\t}\n\t\tlet cNoteItem = this.owner.createCNoteBase(noteItem);\n\t\tcNoteItem.init(noteItem);\n\t\tthis.notesPager.items.unshift(cNoteItem);\n\t\treturn cNoteItem;\n\t}\n\n\ttaskUpdateState(noteItem:NoteItem) {\n\t\tlet {items} = this.notesPager;\n\t\tlet {note} = noteItem;\n\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\tif (index >= 0) {\n\t\t\titems.splice(index, 1);\n\t\t\tlet c = this.getItemConverter();\n\t\t\tlet newItem = c(noteItem, undefined);\n\t\t\titems.unshift(newItem);\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from '../../../tonva';\nimport { CSpace } from './CSpace';\nimport { observer } from 'mobx-react';\nimport { VNoteBase, renderIcon } from '../../../notes/noteBase';\n\nexport class VSpaceDir extends VNoteBase<CSpace> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex pl-2 pr-3 py-2 align-items-center\">\n\t\t\t\t\t<div className=\"unread-dot mr-3\">\n\t\t\t\t\t\t{renderIcon('users', 'text-warning')}\n\t\t\t\t\t\t{unread>0 && <u />}\n\t\t\t\t\t</div>\n\t\t\t\t\t<b className=\"text-primary\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n\t// <FA name=\"users\" className=\"text-warning\" size=\"lg\" fixWidth={true} />\n}\n","import { VBasePage } from '../../../notes/views/VBasePage';\nimport React from 'react';\nimport { FA, List } from '../../../tonva';\nimport { CSpace } from './CSpace';\n\nexport class VSpaceMembers extends VBasePage<CSpace> {\n\theader() {return '空间成员'}\n\tright() {\n\t\treturn <div className=\"cursor-pointer btn btn-lg text-white p-1 mr-1\" onClick={this.controller.showAddMember}>\n\t\t\t<FA name=\"plus\" />\n\t\t</div>;\n\t}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"text-success px-3 py-2 bg-white border-bottom\">[自己]</div>\n\t\t\t<List items={this.controller.members} item={{render: this.renderContactItem}} />\n\t\t</div>\n\t}\n}","import React from 'react';\nimport { DropdownAction, FA } from '../../../tonva';\nimport { VFolder } from \"../views/VFolder\";\nimport { CSpace } from './CSpace';\nimport { VNotesDropDown } from '../../views';\nimport { CNotes } from '../../../notes/CNotes';\nimport { observer } from 'mobx-react';\n\nexport class VSpaceView extends VFolder<CSpace> {\n\theader() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet caption = noteItem ? noteItem.caption : this.t('noteSpace');\n\t\t\treturn <div>{caption}</div>\n\t\t}));\n\t}\n\n\tright() {\n\t\tif (this.isMe(this.controller.groupOwner)) {\n\t\t\tlet dd = new VSpaceDropdown(this.controller.owner, this.controller);\n\t\t\treturn dd.render();\n\t\t}\n\t\telse {\n\t\t\treturn this.controller.owner.renderSpaceDropDown();\n\t\t}\n\t}\n\n\tprotected top():JSX.Element {\n\t\tlet {noteItem} = this.controller;\n\t\tif (!noteItem) return;\n\n\t\tlet paragraphs: string = '群';\n\t\tlet {content: contentString} = noteItem;\n\t\tif (contentString) {\n\t\t\tlet json = JSON.parse(contentString);\n\t\t\tif (json) {\n\t\t\t\tlet {content} = json;\n\t\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t\t\tparagraphs = paragraphs.replace(/(\\r|\\n)/g, ' ');\n\t\t\t}\n\t\t}\n\t\treturn <div className=\"px-3 py-3 d-flex cursor-pointer align-items-center\"\n\t\t\tonClick={this.controller.showSpaceContent}>\n\t\t\t<FA className=\"mr-3 mt-1 text-warning\" name=\"users\" size=\"2x\" />\n\t\t\t<div className=\"text-muted mr-3\" style={{whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis'}}>\n\t\t\t\t{paragraphs}\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n\nclass  VSpaceDropdown extends VNotesDropDown {\n\tprivate cSpace: CSpace;\n\t\n\tconstructor(cNotes:CNotes, cSpace: CSpace) {\n\t\tsuper(cNotes);\n\t\tthis.cSpace = cSpace;\n\t}\n\tprotected get dropdownActions(): DropdownAction[] {\n\t\tlet addMember = {\n\t\t\ticon:'user-o', \n\t\t\tcaption:this.t('成员增减'), \n\t\t\taction: this.cSpace.showAddMember,\n\t\t\ticonClass: 'text-success'\n\t\t};\n\t\treturn [this.text, this.list, this.checkable, this.task, this.folder, undefined, addMember];\n\t}\n}\n","import { CContainer } from '../CContainer';\nimport { VNoteBaseEdit } from '../../../notes/noteBase';\n\nexport abstract class VContainerForm<T extends CContainer> extends VNoteBaseEdit<T> {\n\theader() {\n\t\treturn this.t('noteFolder');\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderInput()\n\t}\n\n}\n\n/*\nexport abstract class VContainerForm<T extends CContainer> extends VNoteBaseView<T> {\n\t@observable private changed: boolean = false;\n\tprivate inputAdd: HTMLInputElement;\n\n\theader() {return this.t('notes')}\n\n\tprotected onTitleChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.controller.title = evt.target.value.trim();\n\t}\n\n\tprotected onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t}\n\n\t@computed protected get btnSaveDisabled():boolean {\n\t\tif (this.changed === true) return false;\n\t\treturn this.getSaveDisabled();\n\t}\n\n\tprotected abstract getSaveDisabled():boolean;\n\n\tprotected abstract onButtonSave(): Promise<void>;\n\n\tprotected async onDelete(): Promise<void> {\n\t\tlet options: ConfirmOptions = {\n\t\t\tcaption: '请确认',\n\t\t\tmessage: '真的要删除这个小单吗？',\n\t\t\tyes: '确认删除',\n\t\t\tno: '不删除'\n\t\t};\n\t\tif (await this.controller.confirm(options) === 'yes') {\n\t\t\tawait this.controller.owner.hideNote(this.controller.noteItem.note, 1);\n\t\t\tthis.closePage(2);\n\t\t}\n\t}\n\n\tprotected renderDeleteButton() {\n\t\treturn <button className=\"btn btn-outline-secondary mr-3\" onClick={() => this.onDelete()}>\n\t\t\t删除\n\t\t</button>;\n\t}\n\n\tprotected abstract renderExButtons():JSX.Element;\n\n\tprotected renderEdit() {\n\t\treturn <div className=\"m-2\">\n\t\t\t<div className=\"border rounded\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t<div className=\"py-1 px-1 border-bottom\">\n\t\t\t\t\t\t<input type=\"text\" className=\"w-100 border-0 form-control font-weight-bold\" placeholder=\"标题\" maxLength={80}\n\t\t\t\t\t\t\tonChange={this.onTitleChange}\n\t\t\t\t\t\t\tdefaultValue={this.controller.title} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"py-1 px-1\">\n\t\t\t\t\t\t{React.createElement(observer(() => this.renderContentTextArea()))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={this.btnSaveDisabled}>\n\t\t\t\t\t\t\t保存\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</>))}\n\t\t\t\t\t{this.renderExButtons()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={this.t('notes')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n}\n*/","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VContainerForm } from '../views/VContainerForm';\nimport { CSpace } from './CSpace';\n\nexport class VSpaceEdit extends VContainerForm<CSpace> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn '编辑空间';\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t</div>;\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.SetGroup();\n\t\tthis.closePage();\n\t}\n}\n","import { observer } from 'mobx-react';\nimport { renderParagraphs } from '../../components';\nimport React from 'react';\nimport { FA, List } from '../../../tonva';\nimport { VNoteBase } from \"../../noteBase\";\nimport { CSpace } from \"./CSpace\";\n\nexport class VContentView extends VNoteBase<CSpace> {\n\theader() {return '详情'}\n\tright() {\n\t\tlet vEditButton:any;\n\t\tif (this.isMe(this.controller.groupOwner)) {\n\t\t\tvEditButton = <span className=\"mr-2\">{this.renderEditButton()}</span>;\n\t\t}\n\t\treturn vEditButton;\n\t}\n\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tif (!noteItem) return;\n\n\t\t\tlet paragraphs: string = '空间';\n\t\t\tlet {caption, content: contentString} = noteItem;\n\t\t\tif (contentString) {\n\t\t\t\tlet json = JSON.parse(contentString);\n\t\t\t\tif (json) {\n\t\t\t\t\tlet {content} = json;\n\t\t\t\t\tparagraphs = (content as string)?.trimEnd();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet left: any;\n\t\t\tleft = <div className=\"\">\n\t\t\t\t<div className=\"d-flex py-3 px-3\">\n\t\t\t\t\t<FA className=\"mr-3 text-warning\" name=\"users\" size=\"2x\" />\n\t\t\t\t\t<div>{caption}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"bg-white px-3 py-2\">\n\t\t\t\t\t{renderParagraphs(paragraphs)}\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t\tlet {memberCount} = this.controller;\n\t\t\tlet members = this.controller.members.filter((value, index)=>value.already===1);\n\t\t\treturn <div>\n\t\t\t\t{left}\n\t\t\t\t<div className=\"d-flex mt-2 align-items-end\">\n\t\t\t\t\t<div className=\"ml-3 mb-2 small text-muted\">{memberCount}成员</div>\n\t\t\t\t\t{ this.isMe(this.controller.groupOwner) ?\n\t\t\t\t\t\t<div className=\"ml-auto cursor-pointer text-success border border-success rounded bg-white px-1 mr-2 mb-1\"\n\t\t\t\t\t\t\tonClick={this.controller.showAddMember}>\n\t\t\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t:\n\t\t\t\t\t\tundefined\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"text-success px-3 py-2 bg-white border-bottom\">[自己]</div>\n\t\t\t\t\t{members.length>0 && <List items={members} item={{render: this.renderContactItem}} />}\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n}\n","import { Contact } from 'model';\nimport { VBasePage } from '../../../notes/views/VBasePage';\nimport React from 'react';\nimport { List } from '../../../tonva';\nimport { CSpace } from './CSpace';\n\nexport class VContacts extends VBasePage<CSpace> {\n\theader() {return '选择成员'}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<List items={this.controller.contacts} \n\t\t\t\titem={{render: this.renderContactItem, onSelect:this.onContactSelect}} \n\t\t\t\tisItemSelected={v=> v.already > 0}/>\n\t\t</div>\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.controller.selectMember(item, isSelected);\n\t}\n\n}","import { VSpaceEdit } from \"./VSpaceEdit\";\n\nexport class VSapceAdd extends VSpaceEdit {\n\theader() {return '新建群'}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.addGroup();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n}","import { CContainer } from \"../CContainer\";\nimport { VSpaceDir } from \"./VSpaceDir\";\nimport { renderIcon } from \"../../noteBase\";\nimport { compareID, EnumNoteType, NoteItem } from \"../../../notes/model\";\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { VSpaceMembers } from \"./VSpaceMembers\";\nimport { VSpaceView } from \"./VSpaceView\";\nimport { VSpaceEdit } from \"./VSpaceEdit\";\nimport { VContentView } from \"./VContentView\";\nimport { VContacts } from \"./VContacts\";\nimport { VSapceAdd } from \"./VSpaceAdd\";\n\nexport class CSpace extends CContainer {\n\tgroupId: number;\n\tgroupOwner: number;\n\t@observable memberCount: number;\n\t@observable members:Contact[];\n\t@observable contacts:Contact[];\n\n\tget type():EnumNoteType { return EnumNoteType.groupFolder }\n\tasync showFolder() {\n\t\tthis.load();\n\t\tawait this.loadSpace();\t\t \n\t\tthis.openVPage(VSpaceView);\n\t}\n\n\tasync loadSpace() {\n\t\tlet resulte = await this.uqs.notes.GetGroupFolderMemberCount.query({folder: this.folderId});\n\t\tlet {group, count, owner} = resulte.ret[0];\n\t\tthis.groupId = group;\n\t\tthis.groupOwner = owner;\n\t\tthis.memberCount = count;\n\t}\n\n\tasync loadMembers() {\n\t\tlet result = await this.uqs.notes.GetGroupMembers.query({group: this.groupId});\n\t\tlet ret:any[] = result.ret;\n\t\tlet index = ret.findIndex(v => this.isMe(v.contact));\n\t\tif (index >= 0) ret.splice(index, 1);\n\t\tthis.members = ret;\n\t}\n\n\tasync loadContacts() {\n\t\tlet result = await this.uqs.notes.GetGroupContacts.query({group: this.groupId});\n\t\tlet ret:any[] = result.ret;\n\t\tlet index = ret.findIndex(v => this.isMe(v.contact));\n\t\tif (index >= 0) ret.splice(index, 1);\n\t\tthis.contacts = ret;\n\t}\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('users', 'text-warning');\n\t}\n\trenderDirItem():JSX.Element {\n\t\tlet item = new VSpaceDir(this);\n\t\treturn item.render();\n\t}\n\n\tshowAddPage() {\n\t\tthis.openVPage(VSapceAdd);\n\t}\n\n\tshowEditPage() {\n\t\tthis.openVPage(VSpaceEdit);\n\t}\n\n\tshowMembers = async () => {\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VSpaceMembers);\n\t}\n\n\tshowSpaceContent = async() => {\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VContentView);\n\t}\n\n\tshowAddMember = async () => {\n\t\tawait this.loadContacts();\n\t\tawait this.loadMembers();\n\t\tthis.openVPage(VContacts);\n\t}\n\n\tasync selectMember(item:Contact, isSelected:boolean) {\n\t\tlet i = this.contacts.findIndex(v=>compareID(v.contact, item.contact));\n\t\tif (i < 0)\n\t\t\treturn;\n\t\tlet c = this.contacts[i];\n\t\tif (isSelected) {\n\t\t\tawait this.uqs.notes.AddGroupMember.submit({group:this.groupId, member:c.contact});\n\t\t\tc.already = 1;\n\t\t}\n\t\telse {\n\t\t\tawait this.uqs.notes.RemoveGroupMember.submit({group:this.groupId, member:c.contact})\n\t\t\tc.already = 0;\n\t\t}\n\t\tlet mi = this.members.findIndex(v=>compareID(v.contact, item.contact));\n\t\tif (mi >= 0) {\n\t\t\tlet m = this.members[mi];\n\t\t\tm.already = c.already;\n\t\t}\n\t\telse if (isSelected) {\n\t\t\tthis.members.push({...c});\n\t\t}\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\tasync addGroup() {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\treturn await this.owner.rootFold.addGroup(this.caption, noteContent, []);\n\t}\n\n\tasync SetGroup(showWaiting: boolean = true) {\n\t\tlet obj = this.endContentInput();\n\t\tlet noteContent = JSON.stringify(obj);\n\t\tawait this.editGroup(showWaiting,\n\t\t\tthis.noteItem,\n\t\t\tthis.caption,\n\t\t\tnoteContent,\n\t\t\tobj);\n\t\tthis.updateChange();\n\t}\n\n\tasync editGroup(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\tlet {SetGroup} = this.uqs.notes;\n\t\tlet {note} = noteItem;\n\t\tawait SetGroup.submit({group:this.groupId, caption, content}, waiting);\n\t\tif (note === this.noteItem?.note) {\n\t\t\tthis.noteItem.caption = caption;\n\t\t\tthis.noteItem.content = content;\n\t\t\tthis.noteItem.obj = obj;\n\t\t}\n\t}\n\n}\n","import { CContainer } from \"./CContainer\";\nimport { NoteItem, EnumNoteType } from \"../model\";\nimport { CNoteBase } from \"../noteBase\";\n\nexport abstract class CFolder extends CContainer {\n\tget type():EnumNoteType { return EnumNoteType.folder }\n}\n\nexport abstract class CFolderDisableItemFrom extends CFolder {\n\tprotected getItemConverter() {\n\t\treturn (item:NoteItem, queryResults:{[name:string]:any[]}):CNoteBase => {\n\t\t\tlet ret = this.owner.noteItemConverter(item, queryResults);\n\t\t\tret.disableFrom = true;\n\t\t\treturn ret;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VContainerForm } from '../views/VContainerForm';\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMyEdit extends VContainerForm<CFolderMy> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\treturn '编辑目录';\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t</div>;\n\t}\n}\n","import { VFolderMyEdit } from \"./VFolderMyEdit\";\n\nexport class VFolderMyAdd extends VFolderMyEdit {\n\theader() {return '新建小单夹'}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n}","import React from 'react';\nimport { VFolderView } from '../views';\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMyView extends VFolderView<CFolderMy> {\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.renderShareButton()}\n\t\t</div>;\n\t}\n}\n","import { VFolder } from '../views/VFolder'\nimport { CFolderMy } from './CFolderMy';\n\nexport class VFolderMy extends VFolder<CFolderMy> {\n\n}","import { CFolderDisableItemFrom } from \"../CFolder\";\nimport { renderIcon } from \"../../noteBase\";\nimport { VFolderMyEdit } from \"./VFolderMyEdit\";\nimport { VFolderMyAdd } from \"./VFolderMyAdd\";\nimport { VFolderMyView } from \"./VFolderMyView\";\nimport { VFolderMy } from \"./VFolderMy\";\n\n// 小单夹\nexport class CFolderMy extends CFolderDisableItemFrom {\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon(this.noteItem.toCount>0? 'files-o': 'file-o', 'text-info');\n\t}\n\tshowAddPage() {\n\t\tthis.openVPage(VFolderMyAdd);\n\t}\n\tshowEditPage() {\n\t\tthis.openVPage(VFolderMyEdit);\n\t}\n\n\tshowFolderViewPage() {\n\t\tthis.openVPage(VFolderMyView);\n\t}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\tthis.openVPage(VFolderMy);\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n}\n","import { VFolder } from '../views/VFolder'\nimport { CFolderShare } from './CFolderShare';\n\nexport class VFolderShare extends VFolder<CFolderShare> {\n\n}","import { CFolderDisableItemFrom } from \"../CFolder\";\nimport { renderIcon } from \"../../noteBase\";\nimport { VFolderShare } from \"./VFolderShare\";\n\nexport class CFolderShare extends CFolderDisableItemFrom {\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('folder', 'text-warning');\n\t}\n\tshowAddPage() {}\n\tshowEditPage() {}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\tthis.openVPage(VFolderShare);\n\t}\n}\n","import { CFolder } from \"../CFolder\";\n\nexport class CFolderRoot extends CFolder {\n\trenderIcon(): JSX.Element {return;}\n\tshowAddPage() {}\n\tshowEditPage() {}\n\n\tasync showFolder() {\n\t\tthis.load();\n\t\t//this.openVPage(VFolder);\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from \"../../../../notes/views/VBasePage\";\nimport { CRootAdmin } from \"./CUnitAdmin\";\nimport { FA, Form, ItemSchema, List, Page, \n\tButtonSchema, UiButton, \n\tStringSchema, IntSchema, UiTextItem, UiNumberItem, UiSchema, Context } from '../../../../tonva';\nimport { BookProject } from '../model';\n\nexport class VRootProjects extends VBasePage<CRootAdmin> {\n\tprivate projectFileds: ItemSchema[] = [\n\t\t{name: 'name', type: 'string', maxLength: 100, required: true} as StringSchema,\n\t\t{name: 'caption', type: 'string', maxLength: 100} as StringSchema,\n\t\t{name: 'memo', type: 'string', maxLength: 100} as StringSchema,\n\t\t{name: 'ratioX', type: 'integer', min: 1} as IntSchema,\n\t\t{name: 'ratioY', type: 'integer', min: 1} as IntSchema,\n\t\t{name: 'readUnit', type: 'string', maxLength: 20} as StringSchema,\n\t\t{name: 'submit', type: 'submit'} as ButtonSchema,\n\t];\n\tprivate projectUISchema: UiSchema= {\n\t\titems: {\n\t\t\tname: {\n\t\t\t\tlabel: '名称', placeholder: '科目名称'\n\t\t\t} as UiTextItem,\n\t\t\tcaption: {\n\t\t\t\tlabel: '标题', placeholder: '科目显示标题'\n\t\t\t} as UiTextItem,\n\t\t\tmemo: {\n\t\t\t\tlabel: '说明', placeholder: '科目说明'\n\t\t\t} as UiTextItem,\n\t\t\tratioX: {\n\t\t\t\tlabel: '分子', defaultValue: 1, discription: '基本单位换算分子，默认1'\n\t\t\t} as UiNumberItem,\n\t\t\tratioY: {\n\t\t\t\tlabel: '分母', defaultValue: 1, discription: '基本单位换算分母，默认1'\n\t\t\t} as UiNumberItem,\n\t\t\treadUnit: {\n\t\t\t\tlabel: '计量单位', placeholder: '显示出来的计量单位'\n\t\t\t} as UiTextItem,\n\t\t\tsubmit: {\n\t\t\t\twidget: 'button',\n\t\t\t\tlabel: '提交',\n\t\t\t\tclassName: 'btn btn-primary'\n\t\t\t} as UiButton\n\t\t}\n\t};\n\theader() {return '机构科目'}\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-success mr-2\" onClick={this.onClickAdd}>\n\t\t\t<FA name=\"plus\" />\n\t\t</button>\n\t}\n\n\tprivate onClickAdd = () => {\n\t\tthis.controller.project = undefined;\n\t\tthis.openPageElement(<Page header=\"新增科目\">\n\t\t\t<Form className=\"m-3\"\n\t\t\t\tschema={this.projectFileds} \n\t\t\t\tuiSchema={this.projectUISchema} \n\t\t\t\tfieldLabelSize={2} onButtonClick={this.onSubmitNewProject} />\n\t\t</Page>);\n\t}\n\n\tprivate onSubmitNewProject = async (name:string, context: Context) => {\n\t\tawait this.controller.saveBookProject(context.data);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"my-3\">\n\t\t\t<List items={this.controller.bookProjects} \n\t\t\t\titem={{render: this.renderProject, onClick: this.onClickProject}} />\n\t\t</div>;\n\t}\n\n\tprivate renderProject = (project: BookProject, index: number) => {\n\t\tlet {name, caption, memo, ratioX, ratioY, readUnit} = project;\n\t\treturn <div className=\"px-3 py-2 align-items-center\">\n\t\t\t<b>{caption ?? name}</b> <small className=\"ml-3 text-muted\">{memo}</small>\n\t\t\t<span className=\"ml-auto\">{name} = {ratioX} / {ratioY} {readUnit}</span>\n\t\t</div>;\n\t}\n\n\tprivate onClickProject = (project: BookProject) => {\n\t\tthis.controller.project = project;\n\t\tthis.openPageElement(<Page header=\"编辑科目\">\n\t\t\t<Form className=\"m-3\"\n\t\t\t\tformData={this.controller.project}\n\t\t\t\tschema={this.projectFileds} \n\t\t\t\tuiSchema={this.projectUISchema} \n\t\t\t\tfieldLabelSize={2} onButtonClick={this.onSubmitNewProject} />\n\t\t</Page>);\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from \"../../../../notes/views/VBasePage\";\nimport { CAdminBase } from \"./CUnitAdmin\";\nimport { FA, List, Page } from '../../../../tonva';\nimport { BookProject } from '../model';\n\nexport class VUnitProjects <C extends CAdminBase> extends VBasePage<C> {\n\theader() {return '显示科目'}\n\tright() {return <button className=\"btn btn-sm btn-success mr-2\" onClick={this.onAddSub}>增减</button>}\n\tcontent() {\n\t\treturn <div className=\"my-3\">\n\t\t\t<List items={this.controller.unitedProjects} \n\t\t\t\titem={{render: this.renderProject, onClick: this.onClickProject}} />\n\t\t</div>;\n\t}\n\n\tprivate renderProject = (project: BookProject, index: number) => {\n\t\tlet {name, caption, memo, ratioX, ratioY, readUnit} = project;\n\t\treturn <div className=\"px-3 py-2 align-items-center\">\n\t\t\t<b>{caption ?? name}</b> <small className=\"ml-3 text-muted\">{memo}</small>\n\t\t\t<span className=\"ml-auto\">{name} = {ratioX} / {ratioY} {readUnit}</span>\n\t\t</div>;\n\t}\n\n\tprivate onClickProject = (project: BookProject) => {\n\t}\n\n\tprivate onAddSub = () => {\n\t\tthis.openPageElement(<Page header=\"调整科目\">\n\t\t\t<div className=\"mt-3 mb-1 small mx-3\">已显示科目</div>\n\t\t\t<List items={this.controller.unitedProjects} \n\t\t\t\titem={{render: this.renderUnitedProject}} />\n\t\t\t\n\t\t\t<div className=\"mt-3 mb-1 small mx-3\">可显示科目</div>\n\t\t\t<List items={this.controller.unitableProjects} \n\t\t\t\titem={{render: this.renderUnitableProject}} />\n\t\t</Page>);\n\t}\n\n\tprivate renderUnitedProject = (project: BookProject, index: number) => {\n\t\tlet {name, caption, memo, ratioX, ratioY, readUnit} = project;\n\t\tlet downVisible = index>=this.controller.unitedProjects.length-1? 'invisible' : '';\n\t\tlet upVisible = index<=0? 'invisible' : '';\n\t\treturn <div className=\"px-3 py-2 align-items-center\">\n\t\t\t<b>{caption ?? name}</b> <small className=\"ml-3 text-muted\">{memo}</small>\n\t\t\t<span className=\"ml-auto\">{name} = {ratioX} / {ratioY} {readUnit}</span>\n\t\t\t<button className=\"btn btn-sm btn-outline-dark ml-3\" \n\t\t\t\tonClick={()=>this.controller.setProjectDisplay(project, false)}>\n\t\t\t\t\t<FA name=\"minus\" />\n\t\t\t</button>\n\t\t\t<button className={'btn btn-sm btn-outline-info ml-3 ' + downVisible}\n\t\t\t\tonClick={()=>this.controller.setProjectDown(index)}>\n\t\t\t\t\t<FA name=\"arrow-down\" />\n\t\t\t</button>\n\t\t\t<button className={'btn btn-sm btn-outline-info ml-3 ' + upVisible}\n\t\t\t\tonClick={()=>this.controller.setProjectUp(index)}>\n\t\t\t\t\t<FA name=\"arrow-up\" />\n\t\t\t</button>\n\t\t</div>;\n\t}\n\n\tprivate renderUnitableProject = (project: BookProject, index: number) => {\n\t\tlet {name, caption, memo, ratioX, ratioY, readUnit} = project;\n\t\treturn <div className=\"px-3 py-2 align-items-center\">\n\t\t\t<b>{caption ?? name}</b> <small className=\"ml-3 text-muted\">{memo}</small>\n\t\t\t<span className=\"ml-auto\">{name} = {ratioX} / {ratioY} {readUnit}</span>\n\t\t\t<button className=\"btn btn-sm btn-success ml-3\"\n\t\t\t\tonClick={()=>this.controller.setProjectDisplay(project, true)}>\n\t\t\t\t\t<FA name=\"plus\" />\n\t\t\t\t</button>\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from \"../../../../notes/views/VBasePage\";\nimport { CRootAdmin } from \"./CUnitAdmin\";\nimport { FA, Form, ItemSchema, List, Page, \n\tButtonSchema, UiButton, \n\tStringSchema, CStringEdit, UiTextItem, UiSchema, Context } from '../../../../tonva';\nimport { BookReport } from '../model';\n\nexport class VReportsAdmin extends VBasePage<CRootAdmin> {\n\tprivate projectFileds: ItemSchema[] = [\n\t\t{name: 'caption', type: 'string', maxLength: 100, required: true} as StringSchema,\n\t\t{name: 'submit', type: 'submit'} as ButtonSchema,\n\t];\n\tprivate projectUISchema: UiSchema= {\n\t\titems: {\n\t\t\tcaption: {\n\t\t\t\tlabel: '名称', placeholder: '报表名称'\n\t\t\t} as UiTextItem,\n\t\t\tsubmit: {\n\t\t\t\twidget: 'button',\n\t\t\t\tlabel: '提交',\n\t\t\t\tclassName: 'btn btn-primary'\n\t\t\t} as UiButton\n\t\t}\n\t};\n\theader() {return '报表设计'}\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-success mr-2\" onClick={this.onClickAdd}>\n\t\t\t<FA name=\"plus\" />\n\t\t</button>\n\t}\n\n\tprivate onClickAdd = () => {\n\t\tthis.controller.report = undefined;\n\t\tthis.openPageElement(<Page header=\"新增报表\">\n\t\t\t<Form className=\"m-3\"\n\t\t\t\tschema={this.projectFileds} \n\t\t\t\tuiSchema={this.projectUISchema} \n\t\t\t\tfieldLabelSize={2} onButtonClick={this.onSubmitNewReport} />\n\t\t</Page>);\n\t}\n\n\tprivate onSubmitNewReport = async (name:string, context: Context) => {\n\t\tawait this.controller.saveBookReport(context.data);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"my-3\">\n\t\t\t<List items={this.controller.bookReports} \n\t\t\t\titem={{render: this.renderProject, onClick: this.onClickReport}} />\n\t\t</div>;\n\t}\n\n\tprivate renderProject = (report: BookReport, index: number) => {\n\t\tlet {caption} = report;\n\t\treturn <div className=\"px-3 py-2 align-items-center\">\n\t\t\t<b>{caption}</b>\n\t\t</div>;\n\t}\n\n\tprivate onClickReport = (report: BookReport) => {\n\t\tthis.controller.report = report;\n\t\tlet cNameEdit: CStringEdit = new CStringEdit(this.res);\n\t\tlet props = {\n\t\t\tlabel: '报表名称', \n\t\t\tonValueChange: this.controller.changeReportName,\n\t\t};\n\t\tthis.openPageElement(<Page header=\"编辑报表\">\n\t\t\t<div className=\"px-3 py-2 align-items-center\">\n\t\t\t\t<small className=\"text-muted\">报表名称:</small> &nbsp;\n\t\t\t\t{cNameEdit.render(report.caption, props)}\n\t\t\t</div>\n\t\t</Page>);\n\t}\n/*\n\t<Form className=\"m-3\"\n\tformData={this.controller.report}\n\tschema={this.projectFileds} \n\tuiSchema={this.projectUISchema} \n\tfieldLabelSize={2} onButtonClick={this.onSubmitNewReport} />\n*/\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Edit, FA, Form, List, Schema, StringSchema, BoolSchema, UiSchema, UiTextItem, UiCheckItem, VPage, ItemSchema, Page } from '../../../../tonva';\nimport { CAdminBase, CUnitAdmin, CRootAdmin } from './CUnitAdmin';\nimport { VBasePage } from '../../../../notes/views/VBasePage';\nimport { VAddContact } from '../../../../tool';\nimport { EnumUnitRole, MemberItem, UnitItem } from '../model';\n\nexport abstract class VAdminBase<C extends CAdminBase> extends VBasePage<C> {\n\tcontent() {\n\t\tlet {unit} = this.controller;\n\t\tlet {content} = unit;\n\t\treturn <div>\n\t\t\t{this.renderParent()}\n\t\t\t<div className=\"m-3\">\n\t\t\t\t<div>\n\t\t\t\t\t{React.createElement(observer(()=><b>{unit.caption}</b>))}\n\t\t\t\t\t{this.renderEditUnitName()}\n\t\t\t\t\t{this.renderUnitID()}\n\t\t\t\t</div>\n\t\t\t\t{content && <div>content</div>}\n\t\t\t</div>\n\n\t\t\t<div className=\"my-5\">\n\t\t\t\t{this.renderProjects()}\n\t\t\t\t{/*this.renderReportDesign()*/}\n\t\t\t\t{this.renderUnitProjects()}\n\t\t\t</div>\n\n\t\t\t{this.renderMembersAndUnits()}\n\t\t</div>\n\t}\n\n\tprotected renderParent():JSX.Element {return;}\n\tprotected renderEditUnitName():JSX.Element {return}\n\tprotected renderUnitID():JSX.Element {return}\n\tprotected renderProjects():JSX.Element {return;}\n\tprotected renderReportDesign():JSX.Element {return;}\n\n\tprotected renderUnitProjects():JSX.Element {\n\t\treturn <div className=\"mt-3 px-3 py-2 d-flex bg-white cursor-pointer align-items-center\"\n\t\t\tonClick={this.controller.showUnitProjects}>\n\t\t\t<span>科目显示</span>\n\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t</div>;\n\t}\n\n\tprotected renderMembersAndUnits() {\n\t\treturn <>\n\t\t\t{this.renderMembers()}\n\t\t\t<div className=\"mt-5\" />\n\t\t\t{this.renderUnits()}\n\t\t</>\n\t}\n\n\tprotected renderMembers() {\n\t\treturn <>\n\t\t\t\t<div className=\"d-flex align-items-end px-3 my-2\">\n\t\t\t\t<div className=\"small text-muted\">成员</div>\n\t\t\t\t<button className=\"ml-auto btn btn-sm btn-primary\" onClick={this.onNewMember}>\n\t\t\t\t\t<FA name=\"plus\" /> 成员\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<List items={this.controller.members} item={{render:this.renderMemberRow, onClick:this.onClickMember}} />\n\t\t</>;\n\t}\n\n\tprotected renderUnits() {\n\t\treturn <>\n\t\t\t\t<div className=\"d-flex align-items-end px-3 my-2\">\n\t\t\t\t<div className=\"small text-muted\">下级单位</div>\n\t\t\t\t<button className=\"ml-auto btn btn-sm btn-primary\" onClick={this.onNewUnit}>\n\t\t\t\t\t<FA name=\"plus\" /> 单位\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<List items={this.controller.units} item={{render: this.renderUnitRow, onClick: this.onUnitRow}} />\n\t\t</>\n\t}\n\n\tprivate onNewUnit = () => {\n\t\tthis.openVPage(VNewUnit);\n\t}\n\n\tprivate renderUnitRow = (unitItem: UnitItem, index: number) => {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {caption, memberCount} = unitItem;\n\t\t\treturn <div className=\"px-3 py-2 align-items-center d-flex\">\n\t\t\t\t<div>\n\t\t\t\t\t<FA className=\"text-warning mr-3\" name=\"sitemap\" />\n\t\t\t\t\t<span>{caption}</span>\n\t\t\t\t</div>\n\n\t\t\t\t{<span className=\"ml-auto small\"><FA name=\"user-o\" className=\"small text-info mr-2\" /> {memberCount}</span>}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onUnitRow = (unitItem: UnitItem) => {\n\t\tthis.controller.showUnitAdmin(unitItem);\n\t}\n\n\tprivate onNewMember = () => {\n\t\tthis.openVPage(VNewMember);\n\t}\n\n\tprivate renderMemberRow = (item: MemberItem, index: number) => {\n\t\tlet {member, assigned, role, discription} = item;\n\t\tlet right: any[] = [];\n\t\tif ((role & EnumUnitRole.owner) === EnumUnitRole.owner) {\n\t\t\tright.push(<FA key=\"owner\" className=\"text-danger ml-2\" name=\"flag\" />);\n\t\t}\n\t\tif ((role&EnumUnitRole.admin) === EnumUnitRole.admin) {\n\t\t\tright.push(<span key=\"admin\" className=\"ml-2\">管理员</span>)\n\t\t}\n\t\treturn <div className=\"px-3 py-2 cursor-pointer align-items-center\">\n\t\t\t<div className=\"mr-3\">{this.renderContact(member, assigned)}</div>\n\t\t\t<div className=\"small text-muted\">{discription}</div>\n\t\t\t<span className=\"ml-auto small\">\n\t\t\t\t{right}\n\t\t\t</span>\n\t\t</div>;\n\t}\n\n\tprivate onClickMember = (item: MemberItem) => {\n\t\tthis.openVPage(VEditMember, item);\n\t}\t\n}\n\nexport class VRootAdmin extends VAdminBase<CRootAdmin> {\n\theader() {return React.createElement(observer(()=><>机构 {this.controller.unit.caption}</>))};\n\tprotected renderUnitID() {\n\t\treturn <small className=\"text-muted ml-3\">ID={this.controller.unit.id}</small>\n\t}\n\n\tprotected renderReportDesign():JSX.Element {\n\t\treturn <div className=\"px-3 py-2 d-flex bg-white cursor-pointer\"\n\t\t\tonClick={this.controller.showDesignReports}>\n\t\t\t<span>报表设计</span>\n\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t</div>;\n\t}\n\n\tprotected renderProjects():JSX.Element {\n\t\treturn <div className=\"px-3 py-2 d-flex bg-white cursor-pointer border-bottom\"\n\t\t\tonClick={this.controller.showRootProjects}>\n\t\t\t<span>机构科目</span>\n\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t</div>;\n\t}\n\n\tprotected renderMembersAndUnits() {\n\t\treturn <>\n\t\t\t{this.renderUnits()}\n\t\t\t<div className=\"mt-5\" />\n\t\t\t{this.renderMembers()}\n\t\t</>;\n\t}\n}\n\nexport class VUnitAdmin extends VAdminBase<CUnitAdmin> {\n\theader() {return React.createElement(observer(()=><>{this.controller.unit.caption}</>))};\n\n\tprotected renderParent() {\n\t\tlet {parent} = this.controller;\n\t\treturn <div className=\"m-3 small\">\n\t\t\t<span className=\"text-muted\">上级：</span>\n\t\t\t<b className=\"text-primary\">{parent.caption}</b>\n\t\t</div>;\n\t}\n\n\tprotected renderUnitID() {\n\t\treturn <small className=\"text-muted\">ID={this.controller.unit.id}</small>\n\t}\n\n\tprotected renderEditUnitName() {\n\t\treturn <span className=\"cursor-pointer align-self-stretch\" onClick={this.onEditUnitName}>\n\t\t\t<FA className=\"text-info mx-3\" name=\"pencil-square-o\" />\n\t\t</span>;\n\t}\n\tprivate onEditUnitName = () => {\n\t\tlet right = <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onUnitNameSubmit}>提交</button>;\n\t\tthis.openPageElement(<Page header=\"名称\" right={right}>\n\t\t\t<div className=\"m-3\">\n\t\t\t\t<input type=\"text\" className=\"form-control\" \n\t\t\t\t\tdefaultValue={this.controller.unit.caption}\n\t\t\t\t\tonChange={this.onUnitNameChange} maxLength={100}\n\t\t\t\t\tonKeyDown={this.onUnitNameKeyDown} />\n\t\t\t</div>\n\t\t</Page>)\n\t}\n\n\tprivate unitName:string;\n\tprivate onUnitNameChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.unitName = evt.target.value;\n\t}\n\tprivate onUnitNameKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) this.onUnitNameSubmit();\n\t}\n\n\tprivate onUnitNameSubmit = async () => {\n\t\tawait this.controller.setUnitName(this.unitName);\n\t\tthis.controller.unit.caption = this.unitName;\n\t\tthis.closePage();\n\t}\n}\n\nclass VNewUnit<C extends CAdminBase> extends VPage<C> {\n\t@observable private input: string;\n\t@observable private error: string;\n\n\theader() {return '新增单位'}\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet vError:any;\n\t\t\tif (this.error)\n\t\t\tvError = <div className=\"my-3 text-danger\">{this.error}</div>;\n\t\t\treturn <div className=\"m-3\">\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<input type=\"text\" className=\"form-control\" maxLength={100}\n\t\t\t\t\t\tplaceholder=\"单位名称\" onChange={this.onChange} onKeyDown={this.onKeyDown}/>\n\t\t\t\t</div>\n\t\t\t\t{vError}\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.input?.trim().length===0}\n\t\t\t\t\t\tonClick={this.onCreate}>新建单位</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.input = evt.currentTarget.value;\n\t}\n\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tawait this.onCreate();\n\t\t}\n\t}\n\n\tprivate onCreate = async () => {\n\t\tlet unitId = await this.controller.createUnit(this.input.trim());\n\t\tif (unitId > 0) {\n\t\t\tthis.closePage();\n\t\t\treturn;\n\t\t}\n\t\tswitch (unitId) {\n\t\t\tdefault: this.error = '错误编号：' + unitId; break;\n\t\t\tcase -1: this.error = '无建单位权限'; break;\n\t\t\tcase -2: this.error = '单位重名'; break;\n\t\t}\n\t}\n}\n\nconst adminSchema = {name: 'isAdmin', type: 'boolean', required: false} as BoolSchema;\nconst isAdminUI = {widget: 'checkbox',label: '管理员'} as UiCheckItem;\n\nconst schema: Schema = [\n\t{name: 'assigned', type: 'string', required: false, maxLength: 100} as StringSchema,\n\t{name: 'discription', type: 'string', required: false, maxLength: 100} as StringSchema,\n];\nconst uiSchema: UiSchema = {\n\titems: {\n\t\tassigned: {\n\t\t\twidget: 'text',\n\t\t\tlabel: '赋予名字',\n\t\t\tplaceholder: '成员的真实姓名'\n\t\t} as UiTextItem,\n\t\tdiscription: {\n\t\t\twidget: 'text',\n\t\t\tlabel: '说明',\n\t\t\tplaceholder: '职称，职务或者岗位信息'\n\t\t} as UiTextItem,\n\t\tisAdmin: isAdminUI,\n\t}\n};\nclass VNewMember<C extends CAdminBase> extends VAddContact<C> {\n\tprivate form: Form;\n\n\tprotected renderFields() {\n\t\treturn <Form ref={f => this.form=f} className=\"m-3\" schema={schema} uiSchema={uiSchema} fieldLabelSize={2} />\t\n\t}\n\t\n\tprotected async addContact():Promise<void> {\n\t\tlet {assigned, discription} = this.form.data;\n\t\tawait this.controller.addMember(this.user.id, assigned, discription);\n\t}\n}\n\nclass VEditMember<C extends CAdminBase> extends VBasePage<C> {\n\t@observable private item: MemberItem;\n\tinit(item: MemberItem) {\n\t\tthis.item = item;\n\t\tisAdminUI.readOnly = (this.item.role & EnumUnitRole.owner) === EnumUnitRole.owner;\n\t}\n\theader() {return '详情'}\n\tcontent () {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {assigned, discription} = this.item;\n\t\t\tlet data = {\n\t\t\t\tisAdmin: (this.item.role & (EnumUnitRole.admin | EnumUnitRole.unitAdmin)) !== 0,\n\t\t\t\tassigned, discription,\n\t\t\t};\n\t\t\treturn <div>\n\t\t\t\t<Edit className=\"m-3\" \n\t\t\t\t\tdata={data}\n\t\t\t\t\tschema={[adminSchema, ...schema]} \n\t\t\t\t\tuiSchema={uiSchema}\n\t\t\t\t\tonItemChanged={this.onItemChanged} />\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onItemChanged = async (itemSchema: ItemSchema, newValue:any, preValue:any) => {\n\t\tlet {name} = itemSchema;\n\t\tif (name === 'isAdmin') {\n\t\t\tawait this.controller.setUnitMemberAdmin(this.item, newValue);\n\t\t}\n\t\telse {\n\t\t\tawait this.controller.setUnitMemberProp(this.item, name, newValue);\n\t\t}\n\t}\n}\n","import { observable } from \"mobx\";\nimport _ from 'lodash';\nimport { EnumNoteType } from \"../../../../notes/model\";\nimport { renderIcon } from \"../../../../notes/noteBase\";\nimport { CUqBase } from \"../../../../tapp\";\nimport { VRootProjects } from \"./VRootProjects\";\nimport { VUnitProjects } from \"./VUnitProjects\";\nimport { VReportsAdmin } from \"./VReportsAdmin\";\nimport { VAdminBase, VUnitAdmin, VRootAdmin } from \"./VUnitAdmin\";\nimport { BookProject, BookReport, EnumUnitRole, MemberItem, UnitItem } from \"../model\";\n\nexport class CAdminBase  extends CUqBase {\n\tisChanged: boolean = false;\n\troot: UnitItem;\n\tparent: UnitItem;\n\t@observable unit: UnitItem;\n\t@observable units:UnitItem[];\n\t@observable members:MemberItem[];\n\n\tprotected async internalStart() {}\n\tinit(root:UnitItem, parent:UnitItem, unit:UnitItem) {\n\t\tthis.root = root;\n\t\tthis.parent = parent;\n\t\tthis.unit = unit;\n\t}\n\n\tget type():EnumNoteType { return EnumNoteType.unitNote }\n\trenderIcon(): JSX.Element {return renderIcon('sitemap', 'text-primary');}\n\trenderDirItem(index: number): JSX.Element {return;}\n\tshowAddPage() {}\n\tshowEditPage() {}\n\n\tprotected getVUnitAdmin(): new (controller: any) => VAdminBase<any> { return VUnitAdmin; }\n\n\tasync showViewPage(afterBack: (isChanged:boolean) => void) {\n\t\tlet unitNote = -this.unit.id;\n\t\tlet result = await this.uqs.notes.GetUnit.query({unitNote});\n\t\tthis.unit = result.ret[0];\n\t\tif (this.unit === undefined) {\n\t\t\tdebugger;\n\t\t\tthrow new Error('not unit for note=' + unitNote);\n\t\t}\n\t\tthis.units = result.units;\n\t\tthis.members = this.moveOwnerMemberToTop(result.members);\n\t\tthis.openVPage(this.getVUnitAdmin(), undefined, afterBack);\n\t}\n\n\tprivate moveOwnerMemberToTop(members: MemberItem[]):MemberItem[] {\n\t\tlet ret:MemberItem[] = [];\n\t\tlet pOwner = 0, pAdmin = 0;\n\t\tfor (let member of members) {\n\t\t\tlet {role} = member;\n\t\t\tif ((role & EnumUnitRole.owner) === EnumUnitRole.owner) {\n\t\t\t\tret.splice(pOwner, 0, member);\n\t\t\t\tpOwner++;\n\t\t\t\tpAdmin++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ((role & EnumUnitRole.admin) === EnumUnitRole.admin) {\n\t\t\t\tret.splice(pAdmin, 0, member);\n\t\t\t\tpAdmin++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tret.push(member);\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync showUnitAdmin(unitItem: UnitItem) {\n\t\tlet cUnitAdmin = new CUnitAdmin(this.cApp);\n\t\tcUnitAdmin.init(this.root, this.unit, unitItem);\n\t\tawait cUnitAdmin.showViewPage(() => {\n\t\t\tlet {isChanged} = cUnitAdmin;\n\t\t\tif (isChanged) this.isChanged = isChanged;\n\t\t});\n\t}\n\n\tasync createUnit(unitName: string):Promise<number> {\n\t\tlet result = await this.uqs.notes.CreateUnit.submit({\n\t\t\tparent: this.parent.id, //.unitNoteId, \n\t\t\tname: unitName,\n\t\t\tcontent: undefined,\n\t\t});\n\t\tlet {id} = result;\n\t\tif (id > 0) {\n\t\t\tthis.units.push({\n\t\t\t\tid,\n\t\t\t\tcaption: unitName,\n\t\t\t\tcontent: undefined,\n\t\t\t\trole: 7,\n\t\t\t\tmemberCount: 0,\n\t\t\t})\n\t\t}\n\t\tthis.isChanged = true;\n\t\treturn id;\n\t}\n\n\tasync setUnitName(unitName:string) {\n\t\tawait this.uqs.notes.SetUnitName.submit({unit: this.unit.id, name: unitName});\n\t\tthis.parent.caption = unitName;\n\t\tthis.isChanged = true;\n\t}\n\n\tasync addMember(userId:number, assigned:string, discription:string) {\n\t\tawait this.uqs.notes.AddUnitMember.submit({\n\t\t\tunit: this.unit.id,\n\t\t\tmember: userId,\n\t\t\tassigned,\n\t\t\tdiscription\n\t\t});\n\t\tthis.members.push({\n\t\t\tmember: userId,\n\t\t\tassigned,\n\t\t\tdiscription,\n\t\t\trole: 0,\n\t\t});\n\t\tthis.isChanged = true;\n\t}\n\n\tasync setUnitMemberAdmin(member:MemberItem, isAdmin: boolean) {\n\t\tlet roleMask = EnumUnitRole.admin | EnumUnitRole.unitAdmin;\n\t\tlet role = isAdmin ? roleMask : 0;\n\t\tawait this.uqs.notes.SetUnitMemberRole.submit({\n\t\t\tunit:this.unit.id, member:member.member, roleMask, role\n\t\t});\n\t\tmember.role &= ~roleMask;\n\t\tmember.role |= role;\n\t\tthis.isChanged = true;\n\t}\n\n\tasync setUnitMemberProp(member:MemberItem, prop:string, value:string) {\n\t\tawait this.uqs.notes.SetUnitMemberProp.submit({\n\t\t\tunit:this.unit.id, member:member.member, prop, value\n\t\t});\n\t\t(member as any)[prop] = value;\n\t\tthis.isChanged = true;\n\t}\n\n\trootProjects: BookProject[];\n\t@observable unitedProjects: BookProject[];\n\t@observable unitableProjects: BookProject[];\n\tprivate async loadUnitProjects() {\n\t\tlet results = await this.uqs.notes.GetUnitProjects.query({\n\t\t\trootUnit: this.root.id, \n\t\t\tunit:this.unit.id\n\t\t});\n\t\tlet projects:BookProject[] = results.ret;\n\t\tthis.rootProjects = projects;\n\t\tlet unitedProjects:BookProject[] = [];\n\t\tlet unitableProjects:BookProject[] = [];\n\t\tfor (let project of projects) {\n\t\t\tlet {orderNo} = project;\n\t\t\tif (orderNo > 0) {\n\t\t\t\tunitedProjects.push(project);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tunitableProjects.push(project);\n\t\t\t}\n\t\t}\n\t\tif (unitedProjects.length === 0) {\n\t\t\tfor (let i=0; i<projects.length; i++) {unitableProjects[i].orderNo = i+1};\n\t\t\tunitedProjects = unitableProjects;\n\t\t\tunitableProjects = [];\n\t\t}\n\t\tthis.unitedProjects = unitedProjects;\n\t\tthis.unitableProjects = unitableProjects;\n\t}\n\tshowUnitProjects = async () => {\n\t\tawait this.loadUnitProjects();\n\t\tthis.openVPage<CAdminBase>(VUnitProjects);\n\t}\n\n\tsetProjectDisplay = async (project: BookProject, display: boolean) => {\n\t\tlet from: BookProject[], to: BookProject[];\n\t\tif (display === true) {\n\t\t\tfrom = this.unitableProjects;\n\t\t\tto = this.unitedProjects;\n\t\t\tproject.orderNo = this.unitedProjects.length + 1;\n\t\t}\n\t\telse {\n\t\t\tfrom = this.unitedProjects;\n\t\t\tto = this.unitableProjects;\n\t\t\tproject.orderNo = undefined;\n\t\t}\n\t\tlet index = from.findIndex(v => v === project);\n\t\tif (index >= 0) {\n\t\t\tfrom.splice(index, 1);\n\t\t\tto.push(project);\n\t\t}\n\t\tawait this.setUnitProjects();\n\t}\n\tsetProjectDown = async (index: number) => {\n\t\tlet arr = this.unitedProjects.splice(index, 1);\n\t\tthis.unitedProjects.splice(index+1, 0, ...arr);\n\t\tawait this.setUnitProjects();\n\t}\n\tsetProjectUp = async (index: number) => {\n\t\tlet arr = this.unitedProjects.splice(index, 1);\n\t\tthis.unitedProjects.splice(index-1, 0, ...arr);\n\t\tawait this.setUnitProjects();\n\t}\n\n\tprivate async setUnitProjects() {\n\t\tlet param = {\n\t\t\tunit: this.unit.id, \n\t\t\tprojects: this.unitedProjects.map(v => ({project: v.id, orderNo: v.orderNo}))\n\t\t}\n\t\tawait this.uqs.notes.SetUnitProjects.submit(param);\n\t}\n}\n\nexport class CUnitAdmin extends CAdminBase {\n}\n\nexport class CRootAdmin extends CAdminBase {\n\tproject: BookProject;\n\t@observable bookProjects: BookProject[];\n\treport: BookReport;\n\t@observable bookReports: BookReport[];\n\n\tprotected getVUnitAdmin(): new (controller: any) => VAdminBase<any> { return VRootAdmin; }\n\n\tprivate async loadBookProjects() {\n\t\tlet results = await this.uqs.notes.GetRootUnitProjects.query({rootUnit: this.unit.id});\n\t\tthis.bookProjects = results.ret;\n\t}\n\tshowRootProjects = async () => {\n\t\tawait this.loadBookProjects();\n\t\tthis.openVPage(VRootProjects);\n\t}\n\tasync saveBookProject(data: any) {\n\t\tlet id = this.project?.id;\n\t\tdata.rootUnit = this.unit.id;\n\t\tlet ret = await this.uqs.notes.BookProject.save(id, data);\n\t\tdata.id = ret.id;\n\t\tif (this.project) {\n\t\t\t_.merge(this.project, data);\n\t\t}\n\t\telse {\n\t\t\tthis.bookProjects.push(data);\n\t\t}\n\t}\n\n\tprivate async loadBookReports() {\n\t\tlet results = await this.uqs.notes.GetRootUnitReports.query({rootUnit: this.unit.id});\n\t\tthis.bookReports = results.ret;\n\t}\n\tshowDesignReports = async () => {\n\t\tawait this.loadBookReports();\n\t\tthis.openVPage(VReportsAdmin);\n\t}\n\tasync saveBookReport(data: any) {\n\t\tlet id = this.report?.id;\n\t\tdata.rootUnit = this.unit.id;\n\t\tlet ret = await this.uqs.notes.BookReport.save(id, data);\n\t\tdata.id = ret.id;\n\t\tif (this.report) {\n\t\t\t_.merge(this.report, data);\n\t\t}\n\t\telse {\n\t\t\tthis.bookReports.push(data);\n\t\t}\n\t}\n\n\tchangeReportName = async (caption: string) => {\n\t\tthis.report.caption = caption;\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { FA } from '../../../tonva';\nimport { CContainer } from '../CContainer';\nimport { VNoteBase } from '../../noteBase';\n\nexport class VUnitNoteDir extends VNoteBase<CContainer> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet {toCount, unread} = noteItem;\n\t\t\tlet divToCount:any;\n\t\t\tif (toCount > 0) {\n\t\t\t\tdivToCount = <small className=\"ml-4 text-muted\">\n\t\t\t\t\t<FA name=\"share\" className=\"mr-1\" />\n\t\t\t\t\t{toCount}\n\t\t\t\t</small>;\n\t\t\t}\n\n\t\t\tlet dot:any;\n\t\t\tif (unread>0) {\n\t\t\t\tdot = <u/>;\n\t\t\t}\n\t\n\t\t\tlet vIcon = <div className=\"unread-dot mr-3\">\n\t\t\t\t{this.controller.renderIcon()}\n\t\t\t\t{dot}\n\t\t\t</div>;\n\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"d-flex pl-2 pr-3 py-2 align-items-center\">\n\t\t\t\t\t{vIcon}\n\t\t\t\t\t<b className=\"text-primary\">{noteItem.caption}</b>\n\t\t\t\t\t{divToCount}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}));\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { FA, List } from '../../../tonva';\nimport { VNoteBase } from '../../noteBase';\nimport { CUnitNote } from './CUnitNote';\nimport { EnumUnitRole, MemberProjectsSum, ProjectSum, UnitProjectsSum } from './model';\n\nexport class VUnitNoteView extends VNoteBase<CUnitNote> {\n\theader() {return this.controller.noteItem.caption};\n\tright() {\n\t\tlet {role} = this.controller.unit;\n\t\tif ((role & EnumUnitRole.admin) === EnumUnitRole.admin) {\n\t\t\treturn <button className=\"btn btn-success btn-sm mr-2\" onClick={this.onAdmin}>管理</button>;\n\t\t}\n\t}\n\tprivate onAdmin = () => {\n\t\tthis.controller.showRootAdmin();\n\t}\n\t\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {unit, myProjectsSum} = this.controller;\n\t\t\tlet {id, caption, content} = unit;\n\t\t\treturn <div className=\"pb-3\">\n\t\t\t\t<div className=\"m-3\">\n\t\t\t\t\tnote: {id} <br/>\n\t\t\t\t\tcaption: {caption} <br/>\n\t\t\t\t\tcontent: {content} <br/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mb-1\" />\n\t\t\t\t<div className=\"bg-white mb-4\">\n\t\t\t\t\t{this.renderMemberRow(myProjectsSum, 0)}\n\t\t\t\t</div>\n\t\t\t\t{this.renderUnits()}\n\t\t\t\t<div className=\"mb-4\" />\n\t\t\t\t{this.renderMembers()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate renderProjectSums(projectSums:ProjectSum[]) {\n\t\treturn <div className=\"d-flex flex-wrap\">\n\t\t\t{projectSums.map(v => {\n\t\t\t\tlet {project, debit} = v;\n\t\t\t\tlet {name, caption} =project;\n\t\t\t\treturn <div className=\"border p-2 mx-3 mb-3 text-center w-8c rounded border-info\">\n\t\t\t\t\t<div className=\"mb-2 text-truncate text-dark small\">{caption || name}</div>\n\t\t\t\t\t<div className=\"text-primary\">{debit}</div>\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprotected renderUnits() {\n\t\treturn <>\n\t\t\t<div className=\"d-flex align-items-end px-3 my-2\">\n\t\t\t\t<div className=\"small text-muted\">单位</div>\n\t\t\t</div>\n\t\t\t<List items={this.controller.unitProjectsSums} item={{render: this.renderUnitRow, onClick: this.onUnitRow}} />\n\t\t</>\n\t}\n\n\tprivate renderUnitRow = (unitProjectsSum: UnitProjectsSum, index: number) => {\n\t\tlet {unit, projectSums} = unitProjectsSum;\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {caption} = unit;\n\t\t\treturn <div className=\"d-block\">\n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-center\">\n\t\t\t\t\t<FA className=\"text-warning mr-3\" name=\"sitemap\" />\n\t\t\t\t\t<span>{caption}</span>\n\t\t\t\t</div>\n\t\t\t\t{this.renderProjectSums(projectSums)}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onUnitRow = () => {\n\t\talert('unit')\n\t}\n\n\tprotected renderMembers() {\n\t\treturn <>\n\t\t\t\t<div className=\"d-flex align-items-end px-3 my-2\">\n\t\t\t\t<div className=\"small text-muted\">成员</div>\n\t\t\t</div>\n\t\t\t<List items={this.controller.memberProjectsSums} item={{render:this.renderMemberRow, onClick:this.onMemberRow}} />\n\t\t</>;\n\t}\n\n\tprivate renderMemberRow = (memberProjectsSum: MemberProjectsSum, index: number) => {\n\t\tlet {member:memberItem, projectSums} = memberProjectsSum;\n\t\tlet {member, assigned, discription} = memberItem;\n\t\tlet right: any[] = [];\n\t\t/*\n\t\tif ((role & EnumUnitRole.owner) === EnumUnitRole.owner) {\n\t\t\tright.push(<FA key=\"owner\" className=\"text-danger ml-2\" name=\"flag\" />);\n\t\t}\n\t\tif ((role&EnumUnitRole.admin) === EnumUnitRole.admin) {\n\t\t\tright.push(<span key=\"admin\" className=\"ml-2\">管理员</span>)\n\t\t}\n\t\t*/\n\t\treturn <div className=\"d-block\">\n\t\t\t<div className=\"d-flex px-3 py-2 cursor-pointer align-items-center\">\n\t\t\t\t<div className=\"mr-3\">{this.renderContact(member, assigned)}</div>\n\t\t\t\t<div className=\"small text-muted\">{discription}</div>\n\t\t\t\t<span className=\"ml-auto small\">\n\t\t\t\t\t{right}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t{this.renderProjectSums(projectSums)}\n\t\t</div>;\n\t}\n\n\tprivate onMemberRow = () => {\n\t\talert('member')\n\t}\n}\n","import { observable } from \"mobx\";\nimport { EnumNoteType } from \"../../../notes/model\";\nimport { renderIcon } from \"../../../notes/noteBase\";\nimport { Tuid } from \"../../../tonva\";\nimport { CContainer } from \"../CContainer\";\nimport { CRootAdmin, CUnitAdmin } from \"./admin\";\nimport { EnumPeriod, MemberItem, MemberProjectsSum, ProjectSum, UnitItem, UnitProjectsSum } from \"./model\";\nimport { VUnitNoteDir } from \"./VUnitNoteDir\";\nimport { VUnitNoteView } from \"./VUnitNoteView\";\n\nexport class CUnitNote extends CContainer {\n\tunit: UnitItem;\n\t@observable units:UnitItem[];\n\t@observable members:MemberItem[];\n\tcUnitAdmins: CUnitAdmin[] = [];\n\tcurUnitAdmin: CUnitAdmin;\n\tisChanged: boolean = false;\n\t@observable unitProjectsSums: UnitProjectsSum[];\n\t@observable memberProjectsSums: MemberProjectsSum[];\n\t@observable myProjectsSum: MemberProjectsSum;\n\n\tget type():EnumNoteType { return EnumNoteType.unitNote }\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('sitemap', 'text-primary');\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VUnitNoteDir(this);\n\t\treturn vNoteItem.render();\n\t}\n\n\tshowAddPage() {\n\t\t//this.openVPage(VFolderMyAdd);\n\t}\n\tshowEditPage() {\n\t\t//this.openVPage(VFolderMyEdit);\n\t}\n\n\tprivate async loadUnits() {\n\t\tlet unitNote = this.noteItem.note;\n\t\tlet result = await this.uqs.notes.GetUnit.query({unitNote});\n\t\tthis.unit = result.ret[0];\n\t\tif (this.unit === undefined) {\n\t\t\tdebugger;\n\t\t\tthrow new Error('not unit for note=' + unitNote);\n\t\t}\n\t\tthis.units = result.units;\n\t\tthis.members = result.members;\n\t}\n\n\tasync loadMySum(period: EnumPeriod) {\n\t\tlet results = await this.uqs.notes.GetMySum.query({\n\t\t\tunit:this.unit.id,\n\t\t\tat: undefined,\n\t\t\tperiod, \t\t\t// 1=day, 2=week, 3=month, 4=year\t\t\t\t\t\t\t\n\t\t});\n\t\tlet {projects, sum} = results;\n\t\tthis.myProjectsSum = this.buildMyProjectsSum(sum, projects);\n\t}\n\n\tprivate async loadProjectsSum(period: EnumPeriod) {\n\t\tlet results = await this.uqs.notes.GetUnitSum.query({\n\t\t\tunit:this.unit.id,\n\t\t\tat: undefined,\n\t\t\tperiod, \t\t\t// 1=day, 2=week, 3=month, 4=year\t\t\t\t\t\t\t\n\t\t});\n\t\tlet {projects, subSum, memberSum} = results;\n\t\tthis.unitProjectsSums = this.buildUnitProjectsSums(subSum, projects);\n\t\tthis.memberProjectsSums = this.buildMemberProjectsSums(memberSum, projects);\n\t}\n\n\tprivate buildUnitProjectsSums(unitSums:any[], projects:any[]):UnitProjectsSum[] {\n\t\tlet unitProjectsSum:UnitProjectsSum = undefined;\n\t\tlet unitProjectsSums:UnitProjectsSum[] = [];\n\t\tfor (let subRow of unitSums) {\n\t\t\tlet {unit, project, debit, credit} = subRow;\n\t\t\tlet projectSums: ProjectSum[];\n\t\t\tif (unitProjectsSum === undefined || unitProjectsSum.unit.id !== unit) {\n\t\t\t\tlet unitItem = this.units.find(v => v.id === unit);\n\t\t\t\tif (unitItem === undefined) break;\n\t\t\t\tprojectSums  = projects.map((v:any) => ({project:v, debit:undefined, credit:undefined}));\n\t\t\t\tunitProjectsSum = {\n\t\t\t\t\tunit: unitItem,\n\t\t\t\t\tprojectSums\n\t\t\t\t}\n\t\t\t\tunitProjectsSums.push(unitProjectsSum);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tprojectSums = unitProjectsSum.projectSums;\n\t\t\t}\n\t\t\tlet projectSum = projectSums.find(v => v.project.id === project);\n\t\t\tif (projectSum !== undefined) {\n\t\t\t\tprojectSum.debit = debit;\n\t\t\t\tprojectSum.credit = credit;\n\t\t\t}\n\t\t}\n\t\treturn unitProjectsSums;\n\t}\n\n\tprivate buildMemberProjectsSums(memberSums:any[], projects:any[]):MemberProjectsSum[] {\n\t\tlet memberProjectsSum:MemberProjectsSum = undefined;\n\t\tlet memberProjectsSums = [];\n\t\tfor (let memberSum of memberSums) {\n\t\t\tlet {member, project, debit, credit} = memberSum;\n\t\t\tlet projectSums: ProjectSum[];\n\t\t\tif (memberProjectsSum === undefined || Tuid.equ(memberProjectsSum.member.member, member) === false) {\n\t\t\t\tlet memberItem = this.members.find(v => Tuid.equ(v.member, member));\n\t\t\t\tif (memberItem === undefined) break;\n\t\t\t\tprojectSums  = projects.map((v:any) => ({project:v, debit:undefined, credit:undefined}));\n\t\t\t\tmemberProjectsSum = {\n\t\t\t\t\tmember: memberItem,\n\t\t\t\t\tprojectSums\n\t\t\t\t}\n\t\t\t\tmemberProjectsSums.push(memberProjectsSum);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tprojectSums = memberProjectsSum.projectSums;\n\t\t\t}\n\t\t\tlet projectSum = projectSums.find(v => v.project.id === project);\n\t\t\tif (projectSum !== undefined) {\n\t\t\t\tprojectSum.debit = debit;\n\t\t\t\tprojectSum.credit = credit;\n\t\t\t}\n\t\t}\n\t\treturn memberProjectsSums;\n\t}\n\n\tprivate buildMyProjectsSum(mySums:any, projects:any[]):MemberProjectsSum {\n\t\tlet memberItem = this.members.find(v => Tuid.equ(v.member, this.user.id));\n\t\tlet projectSums: ProjectSum[] = projects.map((v:any) => ({project:v, debit:undefined, credit:undefined}));\n\t\tlet memberProjectsSum:MemberProjectsSum = {\n\t\t\tmember: memberItem,\n\t\t\tprojectSums\n\t\t}\n\t\tfor (let sum of mySums) {\n\t\t\tlet {project, debit, credit} = sum;\n\t\t\tlet projectSum = projectSums.find(v => v.project.id === project);\n\t\t\tif (projectSum !== undefined) {\n\t\t\t\tprojectSum.debit = debit;\n\t\t\t\tprojectSum.credit = credit;\n\t\t\t}\n\t\t}\n\t\treturn memberProjectsSum;\n\t}\n\n\tasync showFolder() {\n\t\tawait this.loadUnits();\n\t\tawait this.loadMySum(EnumPeriod.day);\n\t\tawait this.loadProjectsSum(EnumPeriod.day);\n\t\tthis.openVPage(VUnitNoteView);\n\t}\n\n\tasync showRootAdmin() {\n\t\tthis.curUnitAdmin = new CRootAdmin(this.cApp);\n\t\tthis.curUnitAdmin.init(this.unit, undefined, {\n\t\t\tid: -this.noteItem.note,\n\t\t} as any);\n\t\tawait this.curUnitAdmin.showViewPage(() => {\n\t\t\tlet {isChanged} = this.curUnitAdmin;\n\t\t\tif (isChanged) {\n\t\t\t\tthis.units = undefined;\n\t\t\t\tthis.loadUnits();\n\t\t\t}\n\t\t});\n\t}\n}\n","import React from 'react';\nimport { View, Page, UserView, EasyTime, User } from \"../../../../tonva\";\nimport { CComments } from \"./CComments\";\nimport { CommentItem } from '../../../../notes/model';\n\nexport class VCommentsList extends View<CComments> {\n\trender() {\n\t\treturn this.renderComments();\n\t}\n\t\n\tprotected renderComments = () => {\n\t\tlet {comments} = this.controller.cNote.noteModel;\n\t\tlet {length} = comments;\n\t\tif (length === 0) return;\n\t\treturn <div className=\"py-3\">\n\t\t\t{comments.map(v => this.renderComment(v))}\n\t\t\t{\n\t\t\t\tlength >= 10 && <div className=\"px-3 pt-3 cursor-pointer text-primary text-right small\"\n\t\t\t\tonClick={this.showMoreComments}>更多评论...</div>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tprivate showMoreComments = () => {\n\t\tthis.openPageElement(<Page header=\"评论\">\n\t\t\t<div className=\"text-muted p-3\">更多评论正在开发中 ...</div>\n\t\t</Page>);\n\t}\n\n\tprotected renderComment(comment:CommentItem) {\n\t\tlet {id, owner, assigned, content, $update} = comment;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {id, name, nick} = user;\n\t\t\tlet isMe = this.isMe(id);\n\t\t\tlet userName:string, cn:string;\n\t\t\tif (isMe === true) {\n\t\t\t\tcn = 'text-success';\n\t\t\t\tuserName = '[我]';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcn = 'text-primary-dark';\n\t\t\t\tuserName = assigned || nick || name;\n\t\t\t}\n\t\t\tlet divUserName = <span className={cn + ' mr-2'}>{userName}:</span>;\n\t\t\t// <Image className=\"w-1-5c h-1-5c mx-3\" src={icon || '.user-o'} />\n\t\t\t// <div className=\"small mb-3\">{divUserName}</div>\n\t\t\treturn <div className=\"mt-1 d-flex bg-white pt-2\">\n\t\t\t\t<div className=\"mx-3\">\n\t\t\t\t\t<div className=\"small text-muted\"><EasyTime date={$update} /></div>\n\t\t\t\t\t<div className=\"\">{this.renderCommentContent(divUserName, content)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView key={id} user={owner} render={renderUser} />;\n\t}\n\t\n\tprotected renderCommentContent(vUser:any, content:string):JSX.Element {\n\t\tif (!content) return;\n\t\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\t\tlet c:any;\n\t\t\tif (!v) {\n\t\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc = '';\n\t\t\t\tlet len = v.length, i=0;\n\t\t\t\tfor (; i<len; i++) {\n\t\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tc += v.substr(i);\n\t\t\t}\n\t\t\tif (index === 0) c = <>{vUser}{c}</>;\n\t\t\treturn <div key={index} className=\"pb-1\">{c}</div>;\n\t\t})}</>;\n\t}\n}\n","import { EnumNoteType, NoteItem } from \"../../model\";\n\nexport enum EnumTaskState { Start = 0, Done = 1, Pass = 2, Fail = 3, Rated = 4, Canceled = 5 };\n\nexport interface TaskStateResult {\n\tcontent: string;\n\tisEnd: boolean;\n}\nconst stateContents: {[key in EnumTaskState]: TaskStateResult} = {\n\t[EnumTaskState.Start]: {content: '待办', isEnd: false},\n\t[EnumTaskState.Done]: {content: '已办', isEnd: true},\n\t[EnumTaskState.Pass]: {content: '签收', isEnd: true},\n\t[EnumTaskState.Fail]: {content: '拒签', isEnd: true},\n\t[EnumTaskState.Rated]: {content: '已评价', isEnd: true},\n\t[EnumTaskState.Canceled]: {content: '已取消', isEnd: true}\n}\n\nexport function GetTaskStateContent(type:number, state:number) {\n\tif (type !== EnumNoteType.task)\n\t\treturn;\n\treturn stateContents[state as EnumTaskState];\n}\n\nexport function getTaskItemState(noteItem: NoteItem): TaskStateResult {\n\tlet {type, state} = noteItem;\n\tif (type !== EnumNoteType.task)\n\t\treturn;\n\tswitch (state) {\n\t\tcase EnumTaskState.Done:\n\t\t\tif (noteItem.obj.checker) {\n\t\t\t\treturn {content: '待验收', isEnd: false};\n\t\t\t}\n\t\t\telse if (noteItem.obj.rater) {\n\t\t\t\treturn {content: '待评分', isEnd: false};\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EnumTaskState.Pass:\n\t\t\tif (noteItem.obj.rater) {\n\t\t\t\treturn {content: '待评分', isEnd: false};\n\t\t\t}\n\t\t\tbreak;\n\t}\n\treturn GetTaskStateContent(type, state);\n}\n","import React from 'react';\nimport { VPage } from \"../../../../tonva\";\nimport { CComments } from \"./CComments\";\n\nexport class VAddComment extends VPage<CComments> {\n\theader() {return \"评论\"}\n\t\n\tcontent() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\"\n\t\t\tplaceholder=\"请输入\" maxLength={20000}\n\t\t\tonChange={this.onCommentChange} />\n\t}\n\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onCommentSubmit}>提交</button>;\n\t}\n\n\tprivate comment:string;\n\tprivate onCommentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.comment = evt.target.value;\n\t}\n\n\tprivate onCommentSubmit = async () => {\n\t\tawait this.controller.onAddComment(this.comment);\n\t\t//this.controller.relativeKey = 'comment';\n\t\tthis.closePage();\n\t}\n}\n","import React from 'react';\nimport { View, Page, FA } from \"../../../../tonva\";\nimport { CComments } from \"./CComments\";\n\nexport class VWriteComment extends View<CComments> {\n\trender():JSX.Element {\n\t\treturn <div\n\t\t\tclassName=\"flex-fill rounded-pill mr-3 border bg-white px-3 py-1 small cursor-pointer\"\n\t\t\tonClick={this.onComment}>\n\t\t\t写评论...\n\t\t</div>;\n\t}\n\n\trenderButton():JSX.Element {\n\t\treturn <span className=\"cursor-pointer text-primary mr-5\" onClick={this.onComment}>\n\t\t\t<FA name=\"comment-o\" />\n\t\t</span>;\n\t}\n\n\tprotected onComment = () => {\n\t\tlet right = <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onCommentSubmit}>提交</button>;\n\t\tthis.openPageElement(<Page header=\"评论\" right={right}>\n\t\t\t<textarea rows={10} \n\t\t\t\tclassName=\"w-100 border-0 form-control\"\n\t\t\t\tplaceholder=\"请输入\" maxLength={20000}\n\t\t\t\tonChange={this.onCommentChange} />\n\t\t</Page>);\n\t}\n\tprivate comment:string;\n\tprivate onCommentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.comment = evt.target.value;\n\t}\n\n\tprivate onCommentSubmit = async () => {\n\t\tawait this.controller.onAddComment(this.comment);\n\t\t//this.controller.relativeKey = 'comment';\n\t\tthis.closePage();\n\t}\n}\n","import { Controller } from \"../../../../tonva\";\nimport { VCommentsList } from \"./VCommentsList\";\nimport { VAddComment } from \"./VAddComment\";\nimport { CNote } from \"../../../../notes/note/CNote\";\nimport { VWriteComment } from \"./VWriteComment\";\n\nexport class CComments extends Controller {\n\tcNote: CNote;\n\n\tprotected async internalStart() {}\n\n\tinit(cNote: CNote) {\n\t\tthis.cNote = cNote;\n\t}\n\n\trenderCommentsList():JSX.Element { return this.renderView(VCommentsList); }\n\t\n\tshowAddCommentPage() {\n\t\tthis.openVPage(VAddComment);\n\t}\n\n\tasync onAddComment(comment:string) {\n\t\tawait this.cNote.addComment(comment);\n\t}\n\n\trenderWriteComment():JSX.Element {\n\t\treturn this.renderView(VWriteComment);\n\t}\n\n\trenderCommentButton():JSX.Element {\n\t\tlet vWriteComment = new VWriteComment(this);\n\t\treturn vWriteComment.renderButton();\n\t}\n}\n","import { CNoteBase } from \"../noteBase\";\nimport { NoteItem } from \"../model\";\nimport { CComments } from \"./components\";\n\nexport abstract class CNote extends CNoteBase {\n\tcComments: CComments;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cComments = new CComments(this.res);\n\t\tthis.cComments.init(this);\n\t\tif (param) {\n\t\t\tif (!this.caption) this.caption = param.caption;\n\t\t}\n\t}\n\t\n\taddComment = async (content: string) => {\n\t\tlet ret = await this.uqs.notes.AddComment.submit({ note: this.noteModel.id, content });\n\t\tlet commentId = ret.comment;\n\t\t// 加入note界面，显示comment\n\t\tif (commentId) {\n\t\t\tthis.noteItem.commentCount++;\n\t\t\tthis.noteModel.comments.unshift({\n\t\t\t\tid: commentId,\n\t\t\t\tcontent: content,\n\t\t\t\towner: this.user.id,\n\t\t\t\tassigned: undefined,\n\t\t\t\t$create: new Date(),\n\t\t\t\t$update: new Date(),\n\t\t\t});\n\t\t\tthis.activeRelativeTab = 'comment';\n\t\t\tthis.updateChange();\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from \"../../../tonva\";\nimport { CNote } from \"../CNote\";\nimport { VRelativesBase, TabRelative } from '../../noteBase';\n\nexport class VRelativesNoteBase<T extends CNote> extends VRelativesBase<T> {\n\tprotected tabComment:TabRelative = {\n\t\tname: 'comment',\n\t\tvisible: () => this.controller.noteItem.commentCount>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\tlet {commentCount} = this.controller.noteItem;\n\t\t\tlet vCount:any;\n\t\t\tif (commentCount > 0) vCount = <small>{commentCount}</small>;\n\t\t\treturn <>\n\t\t\t\t<FA className=\"mr-2\" name=\"comment-o\" /> \n\t\t\t\t{vCount}\n\t\t\t</>\n\t\t},\n\t\trender: () => this.controller.cComments.renderCommentsList(),\n\t}\n\n\tprotected tabFlow:TabRelative = {\n\t\tname: 'flow',\n\t\tvisible: () => this.controller.noteModel?.flow.length>0,\n\t\tcaption: (isAction:boolean) => {\n\t\t\treturn <>流程</>;\n\t\t},\n\t\trender: () => {\n\t\t\tlet {flow} = this.controller.noteModel;\n\t\t\tif (!flow || flow.length === 0) return;\n\t\t\treturn <div>flow: {flow.length}</div>\n\t\t}\n\t}\n\t\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare, this.tabFlow] };\n}\n\nexport class VNoteRelatives extends VRelativesNoteBase<CNote> {\n}","//import React from 'react';\nimport { VRelativesNoteBase } from '../views';\nimport { CNoteAssign } from './CNoteAssign';\nimport { TabRelative } from '../../noteBase';\n\nexport class VAssignRelatives extends VRelativesNoteBase<CNoteAssign> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare] };\n}\n","import { NoteItem } from '../../../notes/model';\nimport React from 'react';\nimport { DropdownAction, DropdownActions, List } from '../../../tonva';\nimport { VNoteBaseView } from '../../noteBase';\nimport { getTaskItemState } from '../task/TaskState';\nimport { CNoteAssign } from './CNoteAssign';\nimport { VAssignRelatives } from './VAssignRelatives';\n\nexport class VAssignView extends VNoteBaseView<CNoteAssign> {\n\theader() {\n\t\treturn this.t('noteTask')\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VAssignRelatives);\n\t}\n\n\tright() {\n\t\tlet dropdownActions: DropdownAction[] = [\n\t\t\t{\n\t\t\t\ticon:'hand-pointer-o', \n\t\t\t\tcaption:'复制任务', \n\t\t\t\taction: this.controller.duplicateAssign,\n\t\t\t\ticonClass: 'text-primary'\n\t\t\t}\n\t\t];\n\t\treturn <DropdownActions actions={dropdownActions}\n\t\t\ticon=\"plus\"\n\t\t\titemIconClass=\"text-info\"\n\t\t\tclassName=\"cursor-pointer btn btn-lg text-white p-1 mr-1\"/>\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.controller.cComments.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderDirContent();\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\tlet {noteItem, noteModel} = this.controller;\n\t\tif (this.isMe(noteItem.owner) === false) return;\n\n\t\tlet {spawn} = noteModel;\n\t\tlet div:any;\n\t\tif (spawn.length === 0) {\n\t\t\tdiv = <div className=\"px-3 py-2\">\n\t\t\t\t<button className=\"btn btn-primary\" onClick={this.controller.showAssignTo}>分派</button>\n\t\t\t</div>;\n\t\t}\n\t\telse {\n\t\t\tdiv = <div className=\"my-3\">\n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-end\">\n\t\t\t\t\t<div className=\"small text-muted pt-2 pb-1\">已分派</div>\n\t\t\t\t</div>\n\t\t\t\t<List items={spawn} item={{render: this.renderSpawn, className:'notes'}} />\n\t\t\t</div>;\n\t\t}\n\t\treturn <div className=\"bg-light\">{div}</div>;\n\t}\n\n\tprivate renderSpawn = (noteItem: NoteItem, index: number) => {\n\t\tlet {owner, assigned} = noteItem;\n\t\tlet state = getTaskItemState(noteItem);\n\t\tlet {content, isEnd} = state;\n\t\treturn <div className=\"px-3 py-2 bg-light border-top\" onClick={e=>this.controller.showSpawn(noteItem)}>\n\t\t\t{this.renderContact(owner as number, assigned)}\n\t\t\t<div className=\"ml-2\"></div>\n\t\t\t{this.renderStateSpan(content, isEnd)}\n\t\t</div>\n\t}\n\n\tprotected renderEditButton() : JSX.Element {\n\t\treturn;\n\t}\n\n}\n","import { observer } from \"mobx-react\";\nimport React from \"react\";\nimport { VAssignEdit } from './VAssignEdit';\n\nexport class VAssignAdd extends VAssignEdit {\n\tprotected async onButtonSend(): Promise<void> {\n\t\tawait this.controller.saveAndAssingTo();\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn;\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSend()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={this.controller.isNoteEmpty}>\n\t\t\t\t\t分派\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t\t{this.renderExButtons()}\n\t\t</div>;\n\t}\n\t\n}\n","import React from 'react';\nimport { FA } from \"../../../tonva\";\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { VNoteBaseEdit } from '../../../notes/noteBase';\nimport { none } from '../../../tool';\nimport { taskTimeToString } from '../../../notes/model';\nimport { CInputHours } from '../../../notes/components';\n\ninterface TaskParam {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\nexport class VAssignEdit extends VNoteBaseEdit<CNoteAssign> { // VNoteForm<CNoteAssign> {\n\theader() {\n\t\treturn this.t('noteTask');\n\t}\n\n\tprotected renderTopCaptionContent():JSX.Element {\n\t\treturn <div className=\"\">\n\t\t\t{this.renderCaptionInput()}\n\t\t\t<div className=\"mx-1 py-1 bg-white\">\n\t\t\t\t{this.renderContent()}\n\t\t\t</div>\n\t\t\t{this.renderTaskAdditions()}\n\t\t</div>;\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderInput()\n\t}\n\n\tprotected renderParam(param: TaskParam) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t\t{\n\t\t\t\tonClick ?\n\t\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t\t\t:\n\t\t\t\tundefined\n\t\t\t}\n\t\t</div>\n\t}\n\n\tprotected renderTaskAdditions() {\n\t\tlet additionRows: TaskParam[] = [\n\t\t\t{label: '分派工时', values: this.renderAssignHours(), onClick: this.onClickHours}, \n\t\t];\n\t\treturn <div>\n\t\t\t{additionRows.map(v => this.renderParam(v))}\n\t\t</div>;\n\t}\n\n\tprotected renderAssignHours() {\n\t\treturn <div className=\"flex-fill mr-3 \">\n\t\t\t{taskTimeToString(this.controller.assignhours)}\n\t\t\t</div>\n\t}\n\n\tprivate onClickHours = async () => {\n\t\tlet chours = new CInputHours(this.controller.owner);\n\t\tlet h = await chours.inputHours(this.controller.assignhours);\n\t\tthis.closePage();\n\t\tif (h !== undefined) {\n\t\t\tthis.controller.assignhours = h;\n\t\t}\n\t}\n\n\t// protected onHoursChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t// \tlet m = checkHourMinutes(evt.target.value);\n\t// \tif (m < 0) {\n\t// \t\tm = 0;\n\t// \t}\n\t// \tthis.controller.assignhours = m;\n\t// \tthis.controller.changed = true;\n\t// }\n\n\t// protected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t// \tif (checkHourMinutes(evt.target.value) < 0) {\n\t// \t\tevt.target.value = '';\n\t// \t\tthis.controller.assignhours = 0;\n\t// \t\tthis.controller.changed = true;\n\t// \t}\n\t// }\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn <>{this.renderDeleteButton()}</>;\n\t}\n}\n","import { VNoteBaseDir } from '../../noteBase';\nimport { CNoteAssign } from './CNoteAssign';\n\nexport class VAssignDir extends VNoteBaseDir<CNoteAssign> {\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderDirContent();\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { VPage, FA, UserView, Image, User } from \"../../../tonva\";\nimport { none } from '../../../tool';\nimport { Contact } from '../../../model';\nimport { SelectContactOptions } from '../../views';\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { CAssignTo } from './CAssignTo';\nimport { CNotes } from '../../../notes/CNotes';\nimport { CSelectContact } from '../../../notes/components/selectContact';\nimport { taskTimeToString } from '../../../notes/model';\nimport { CInputHours } from '../../../notes/components';\n\nexport interface Row {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\n//const none = <small className=\"text-muted\">[无]</small>;\n\nexport class VAssignParams extends VPage<CAssignTo> {\n\tprivate cNoteAssign: CNoteAssign;\n\n\tinit() {\n\t\tthis.cNoteAssign = this.controller.cNoteAssign;\n\t}\n\n\theader() {return '分派任务'}\n\tget back(): 'close'|'back'|'none' {return 'close';}\n\n\tprivate renderParam(param: Row) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex cursor-pointer align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t\t{\n\t\t\t\tonClick ?\n\t\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t\t\t:\n\t\t\t\tundefined\n\t\t\t}\n\t\t</div>\n\t}\n\n\tcontent() {\n\t\tlet rows: Row[] = [\n\t\t\t//{label: '执行人', values: this.renderContacts(), onClick: this.onClickContacts}, \n\t\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '工时', values: this.renderHours(), onClick: this.onClickHours}, \n\t\t\t{label: '检查人', values: this.renderChecker(), onClick: this.onClickChecker}, \n\t\t\t{label: '评价人', values: this.renderRater(), onClick: this.onClickRater}, \n\t\t];\n\t\t//let {owner} = this.controller;\n\t\treturn <div className=\"py-2\">\n\t\t\t{this.cNoteAssign.renderDirItem(0)}\n\t\t\t{rows.map(v => this.renderParam(v))}\n\t\t\t<div className=\"px-3 py-2\"><button className=\"btn btn-primary\" onClick={this.controller.onSendOut}>发送</button></div>\n\t\t</div>;\n\t}\n\n\tprivate renderContact = (item:Contact, index?:number) => {\n\t\tif (!item) return none;\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1c h-1c mr-1\" src={icon || '.user-o'} />\n\t\t\t\t<span className=\"mr-3\">{assigned || nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n\n\tprivate renderPoint() {\n\t\treturn <input className=\"flex-fill form-control border-0\"\n\t\t\t\ttype=\"number\" step=\"1\" min=\"1\" defaultValue={this.cNoteAssign.point}\n\t\t\t\tonChange={this.onItemChange}\n\t\t\t\tonKeyDown={this.onItemKeyDown}/>;\n\t}\n\n\tprivate renderHours() {\n\t\tlet time = taskTimeToString(this.cNoteAssign.assignhours);\n\t\treturn <div className=\"flex-fill form-control border-0\">{time}</div>\n\t\t// return <input className=\"flex-fill form-control border-0\"\n\t\t// \t\ttype=\"text\"\n\t\t// \t\tplaceholder=\"2.5或者2:30表示两个半小时\"\n\t\t// \t\tdefaultValue={time}\n\t\t// \t\tonChange={this.onHoursChange}\n\t\t// \t\tonBlur={this.onHoursBlur}\n\t\t// \t\tonKeyDown={this.onHoursKeyDown}/>;\n\t}\n\n\tprivate onClickHours = async () => {\n\t\tlet chours = new CInputHours(this.cNoteAssign.owner);\n\t\tlet h = await chours.inputHours(this.cNoteAssign.assignhours);\n\t\tthis.closePage();\n\t\tif (h !== undefined) {\n\t\t\tthis.cNoteAssign.assignhours = h;\n\t\t}\n\t}\n\n\n\tprivate onItemChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.cNoteAssign.point = Number(evt.currentTarget.value);\n\t}\n\n\tprivate onItemKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t}\n\n\t// private onHoursChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t// \tlet m = checkHourMinutes(evt.target.value);\n\t// \tif (m < 0) {\n\t// \t\tm = 0;\n\t// \t}\n\t// \tthis.cNoteAssign.assignhours = m;\n\t// }\n\n\t// private onHoursKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t// }\n\n\t// protected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t// \tif (checkHourMinutes(evt.target.value) < 0) {\n\t// \t\tevt.target.value = '';\n\t// \t\tthis.cNoteAssign.assignhours = 0;\n\t// \t}\n\t// }\n\n\tprivate renderChecker() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.cNoteAssign.checker)));\n\t}\n\n\tprivate onClickChecker = async () => {\n\t\tlet cSelectContact = new CNotesSelectContact(this.cNoteAssign.owner, '检查人')\n\t\tcSelectContact.SetContacts(this.controller.GetAssignToContacts());\n\n\t\tlet options: SelectContactOptions = {title: '检查人', single: true};\n\t\tlet contacts = await cSelectContact.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.cNoteAssign.checker = contacts[0];\n\t}\n\n\tprivate renderRater() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.cNoteAssign.rater)));\n\t}\n\n\tprivate onClickRater = async () => {\n\t\tlet cSelectContact = new CNotesSelectContact(this.cNoteAssign.owner, '评价人')\n\t\tcSelectContact.SetContacts(this.controller.GetAssignToContacts());\n\n\t\tlet options: SelectContactOptions = {title: '评价人', single: true};\n\t\tlet contacts = await cSelectContact.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.cNoteAssign.rater = contacts[0];\n\t}\n}\n\nclass CNotesSelectContact extends CSelectContact {\n\tprotected cNotes: CNotes;\n\ttitle: string;\n\tconstructor(cNotes:CNotes, title: string) {\n\t\tsuper(cNotes.cApp);\n\t\tthis.cNotes = cNotes;\n\t\tthis.title = title;\n\t}\n\n\tSetContacts(contacts:Contact[]) {\n\t\tthis.contacts = [];\n\t\tfor (var ci of contacts) {\n\t\t\tlet n = {...ci};\n\t\t\tn.already = 0;\n\t\t\tthis.contacts.push(n);\n\t\t}\n\t}\n\n\tprotected async loadContacts() {\n\t}\n}\n","import { CTo } from \"../../../notes/components\";\nimport { VTo } from \"../../../notes/components/to/VTo\"\nimport { VAssignParams } from \"./VAssignParams\";\nimport { CNoteAssign } from \"./CNoteAssign\";\nimport { Query } from \"../../../tonva\";\nimport { Contact } from \"../../../model\";\n\nexport class CAssignTo extends CTo {\n\tcNoteAssign: CNoteAssign;\n\n\tconstructor(cApp:any, cNoteAssign: CNoteAssign, replaceTop:boolean=false) {\n\t\tlet {currentFold} = cNoteAssign.owner;\n\t\tlet {groupFolder, currentNoteItem} = currentFold;\n\t\tsuper(cApp, groupFolder, currentNoteItem);\n\t\tthis.cNoteAssign = cNoteAssign;\n\t\tthis.replaceTop = replaceTop;\n\t}\n\n\tprotected replaceTop:boolean;\n\n\tprotected get GetContacts(): Query {return this.uqs.notes.GetAssignToContacts}\n\n\tprotected async internalStart():Promise<void> {\n\t\tlet ret = await this.GetContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentGroupFolder,\n\t\t\t\tnote: undefined,\n\t\t\t}, 0, 50, true);\n\t\tthis.groupContacts = ret.$page;\n\t\tthis.groupContacts.push({contact:this.user.id, assigned:'[自己]', already:0});\n\t\tif (this.replaceTop) {\n\t\t\tthis.replaceVPage(VTo);//replacePage((new VTo(this)).render());\n\t\t}\n\t\telse {\n\t\t\tthis.startAction();\n\t\t\tthis.openVPage(VTo);\n\t\t}\n\t}\n\n\tGetAssignToContacts() : Contact[] {\n\t\treturn this.groupContacts;\n\t}\n\n\tprotected async sendOut(toList:number[]): Promise<void> {\n\t\tawait this.cNoteAssign.assignTask(toList);\n\t}\n\n\tprotected async afterContactsSelected(): Promise<void> {\n\t\tthis.openVPage(VAssignParams);\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { View } from \"../../../../tonva\";\nimport { CTaskContent } from './CTaskContent';\nimport { TaskCheckItem } from '../model';\n\nexport abstract class VBase extends View<CTaskContent> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {uncheckedItems, checkedItems} = this.controller.getItems();\n\t\t\treturn <div className=\"mb-2\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t\t{this.renderCheckedItems(checkedItems)}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected abstract renderCheckItem(v:TaskCheckItem):JSX.Element;\n\tprotected abstract renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element;\n}\n","import React from 'react';\nimport { TaskCheckItem } from '../model';\nimport { VBase } from './VBase';\n\nexport class VView extends VBase {\n\tprotected renderCheckItem(v:TaskCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdisabled={!this.controller.allowCheck}\n\t\t\t\tonChange={e => this.controller.onCheckChange(key, e.currentTarget.checked)}\n\t\t\t\tdata-key={key} />\n\t\t\t<div className={'form-control-plaintext ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"border-top py-2\">\n\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedCount}项完成</div>\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import React from 'react';\nimport { FA } from '../../../../tonva';\nimport { TaskCheckItem } from '../model';\nimport { VBase } from \"./VBase\";\n\nexport class VItem extends VBase {\n\tprotected renderCheckItem(v:TaskCheckItem) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tlet icon: string;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t\ticon = 'check-square';\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t\ticon = 'square-o';\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 align-items-center\">\n\t\t\t<FA name={icon} />\n\t\t\t<div className={'py-1 ' + cn}>{content}</div>\n\t\t</div>;\n\t}\n\n\tprotected renderCheckedItems(checkedItems:TaskCheckItem[]):JSX.Element {\n\t\tlet checkedCount = checkedItems.length;\n\t\tif (checkedCount > 0) {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v))}\n\t\t\t</div>;\n\t\t}\n\t}\n}\n","import { observable } from \"mobx\";\nimport { CContent } from \"../../../components\";\nimport { VView } from \"./VView\";\nimport { VItem } from \"./VItem\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskContent extends CContent {\n\tallowCheck: boolean;\n\tprivate inputingText: string;\n\t@observable items: TaskCheckItem[] = [];\n\titemKey: number = 1;\n\n\tinit(obj:any) {\n\t\tif (obj) {\n\t\t\tif (obj.itemKey !== undefined && obj.items !== undefined) {\n\t\t\t\tthis.itemKey = obj.itemKey;\n\t\t\t\tthis.items = obj.items;\n\t\t\t}\n\t\t}\n\t}\n\n\trenderInput():JSX.Element {\n\t\treturn;\n\t}\n\n\trenderViewContent():JSX.Element {return this.renderView(VView)}\n\trenderDirContent():JSX.Element {return this.renderView(VItem)}\n\n\tendInput(obj:any): void {\n\t\tthis.addNewItem();\n\t\tthis.buildObj(obj);\n\t}\n\n\tprotected buildObj(obj:any): void {\n\t\tobj.itemKey = this.itemKey;\n\t\tobj.items = this.items;\n\t}\n\n\ttoString():string { \n\t\treturn this.items?.map(v => v.text).join('\\n')\n\t}\n\n\tfromString(value: string) {\n\t\tif (value) {\n\t\t\tthis.items = [];\n\t\t\tthis.itemKey = 1;\n\t\t\tthis.items.push(...value.split('\\n').filter((v, index) => {\n\t\t\t\treturn v.trim().length > 0;\n\t\t\t}).map((v, index) => {\n\t\t\t\treturn {\n\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\ttext: v,\n\t\t\t\t\tchecked: false\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tasync onCheckChange(key: number, checked: boolean) {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) item.checked = checked;\n\t\t//await this.onContentChanged?.();\n\t\t//await this.SetNote(false);\n\t}\n\t/*\n\tonItemChanged = (key: number, value: string) => {\n\t\tlet item = key && this.items.find(v => v.key === key);\n\t\tif (item) {\n\t\t\titem.text = value;\n\t\t}\n\t\telse {\n\t\t\tthis.inputingText = value;\n\t\t}\n\t\tthis.changed = true;\n\t}\n\t*/\n\n\taddNewItem(): void {\n\t\tif (this.inputingText === undefined) return;\n\t\tlet text = this.inputingText.trim();\n\t\tif (text.length === 0) return;\n\t\tthis.items.push({\n\t\t\tkey: this.itemKey++,\n\t\t\ttext,\n\t\t\tchecked: false,\n\t\t});\n\t\tthis.changed = true;\n\t\tthis.inputingText = undefined;\n\t}\n\n\tgetItems():{uncheckedItems:TaskCheckItem[], checkedItems: TaskCheckItem[]} {\n\t\tlet uncheckedItems:TaskCheckItem[] = [];\n\t\tlet checkedItems:TaskCheckItem[] = [];\n\t\tfor (let ci of this.items) {\n\t\t\tlet {checked} = ci;\n\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\telse uncheckedItems.push(ci);\n\t\t}\n\t\treturn {uncheckedItems, checkedItems};\n\t}\n}\n","import { observable } from \"mobx\";\nimport { NoteItem, EnumNoteType } from '../../model';\nimport { renderIcon } from '../../noteBase';\nimport { TaskStateResult } from \"./TaskState\"\nimport { CNote } from \"../CNote\";\nimport { CTaskContent } from \"./content\";\n\nexport abstract class CNoteTask extends CNote {\n\tget type():EnumNoteType { return EnumNoteType.task }\n\n\tcContent: CTaskContent;\n\tget allowCheck() { return false; }\n\n\t@observable checkInfo: string;\n\t@observable rateInfo: string;\n\n\tprotected checker: number;\n\tprotected rater: number;\n\tprotected checkInfoInput: string;\n\tprotected rateInfoInput: string;\n\tprotected rateValue: number;\n\tprotected rateValueInput: number;\n\tassignhours: number;\n\t@observable hours: number;\n\tpoint: number;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CTaskContent(this.res);\n\t\tif (param) {\n\t\t\tlet {obj} = param;\n\t\t\tthis.initobj(obj);\n\t\t}\n\t\tthis.cContent.allowCheck = this.allowCheck;\n\t}\n\n\tprotected initobj(obj:any) {\n\t\tif (obj) {\n\t\t\tthis.cContent.init(obj);\n\t\t\tthis.checkInfo = obj.checkInfo;\n\t\t\tthis.checkInfoInput = this.checkInfo;\n\t\t\tthis.rateInfo = obj.rateInfo;\n\t\t\tthis.rateInfoInput = this.rateInfo;\n\t\t\tthis.rateValue = obj.rateValue;\n\t\t\tthis.rateValueInput = this.rateValue;\n\t\t\tthis.checker = obj.checker;\n\t\t\tthis.rater = obj.rater;\n\t\t\tthis.assignhours = obj.assignhours;\n\t\t\tthis.hours = obj.hours;\n\t\t\tthis.point = obj.point;\n\t\t}\n}\n\n\tprotected endContentInput():any {\n\t\tlet obj = super.endContentInput();\n\t\tif (this.checkInfo) {\n\t\t\tobj.checkInfo = this.checkInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.checkInfo;\n\t\t}\n\t\tif (this.rateInfo) {\n\t\t\tobj.rateInfo = this.rateInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateInfo;\n\t\t}\n\t\tif (this.rateValue !== undefined) {\n\t\t\tobj.rateValue = this.rateValue;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateValue;\n\t\t}\n\t\tif (this.checker !== undefined) {\n\t\t\tobj.checker = this.checker;\n\t\t}\n\t\tif (this.rater !== undefined) {\n\t\t\tobj.rater = this.rater;\n\t\t}\n\t\tobj.assignhours = this.assignhours;\n\t\tobj.hours = this.hours;\n\t\tobj.point = this.point;\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\tupdateCheckInfo(v:string) {\n\t\tthis.checkInfoInput = v;\n\t}\n\n\tupdateRateInfo(v:string) {\n\t\tthis.rateInfoInput = v;\n\t}\n\tabstract get taskStateResult(): TaskStateResult;\n\n\tshowAddPage() {/*CNoteTask no need to Add*/}\n\tshowEditPage() {/*CNoteTask no need to Edit*/}\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('tasks', 'text-success');\n\t}\n\n\tasync checkSaveInfo() {\n\t\tlet change = false;\n\t\tif (this.rateInfo !== this.rateInfoInput) {\n\t\t\tthis.rateInfo = this.rateInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.checkInfo !== this.checkInfoInput) {\n\t\t\tthis.checkInfo = this.checkInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.rateValue !== this.rateValueInput) {\n\t\t\tthis.rateValue = this.rateValueInput;\n\t\t\tchange = true;\n\t\t}\n\n\t\tif (change) {\n\t\t\tawait this.saveX();\n\t\t}\n\t}\n\n\tprotected async saveX() {\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet flowContent = JSON.stringify(obj);\n\t\tlet param = { note: noteId, content: flowContent };\n\t\tawait this.uqs.notes.SetNoteX.submit(param, false);\n\t}\n}\n","import { TabRelative } from '../../noteBase';\nimport { CNoteTask } from \"./CNoteTask\";\nimport { VRelativesNoteBase } from '../views';\n\nexport class VTaskRelatives extends VRelativesNoteBase<CNoteTask> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment] };\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { FA } from \"../../../tonva\";\nimport { TaskCheckItemBase } from './model';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CNoteTask } from \"./CNoteTask\";\nimport { VTaskRelatives } from './VTaskRelatives';\nimport { none } from '../../../tool';\nimport { taskTimeToString } from '../../../notes/model';\n\nexport interface TaskParam {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\nexport abstract class VTaskView<T extends CNoteTask> extends VNoteBaseView<T> {\n\tprotected get back(): 'close' | 'back' | 'none' { return 'close' }\n\theader() { return this.t('task') }\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"\">\n\t\t\t\t{this.renderTopCaptionContent()}\n\t\t\t\t{this.renderTaskAdditions()}\n\t\t\t\t{this.renderViewBottom()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.controller.cComments?.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\trenderDirView() {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t{this.renderTaskDirTop()}\n\t\t\t\t\t<div className=\"py-2\">\n\t\t\t\t\t\t{this.controller.cContent.renderDirContent()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{this.renderDirBottom()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderTop():JSX.Element {\n\t\treturn <div className={'d-flex px-3 py-3 border-top border-bottom bg-light'}>\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t<div>\n\t\t\t\t\t{this.renderFrom()} \n\t\t\t\t\t<span className=\"mr-3\">{this.renderEditTime()}</span>\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</div>;\n\t}\n\n\tprivate renderTaskDirTop():JSX.Element {\n\t\treturn <div className={'d-flex pr-3 pl-2 py-2'}>\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<span className=\"ml-auto\">{this.renderEditTime()}</span>\n\t\t</div>;\n\t}\n\n\t/*\n\tprotected renderDirTop():JSX.Element {\n\t\treturn <div className=\"d-flex px-3 py-2 border-top\">\n\t\t\t{this.renderIcon()}\n\t\t\t<div>\n\t\t\t\t{this.renderCaption()}\n\t\t\t\t{this.renderFrom()}\n\t\t\t</div>\n\t\t\t<div className=\"ml-auto\">{this.renderEditTime()}</div>\n\t\t</div>;\n\t}*/\n\n\tprotected renderDirBottom():JSX.Element {\n\t\tlet divToCount = this.renderToCount();\n\t\tlet divSpawnCount = this.renderSpawnCount();\n\t\tlet divComment = this.renderCommentFlag();\n\t\tif (divToCount || divSpawnCount || divComment) {\n\t\t\treturn <div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t{divToCount}\n\t\t\t\t{divSpawnCount}\n\t\t\t\t{divComment}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderCaption() {\n\t\tlet { caption: title } = this.controller;\n\t\tlet divCaption = title ? <b className=\"text-primary\">{title}</b> : <span className=\"text-info\">任务</span>;\n\t\treturn <div className=\"pr-3\">\n\t\t\t<span className=\"mr-2\">{divCaption}</span> {this.renderState()}\n\t\t</div>;\n\t}\n\n\tprotected renderParam(param: TaskParam) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t\t{\n\t\t\t\tonClick ?\n\t\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t\t\t:\n\t\t\t\tundefined\n\t\t\t}\n\t\t</div>\n\t}\n\n\tprotected get additionRows(): TaskParam[]  {\n\t\treturn \t[\n\t\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '分派工时', values: this.renderAssignHours()}, \n\t\t\t{label: '实际工时', values: this.renderHours()}, \n\t\t];\n\t}\n\n\tprotected renderTaskAdditions() {\n\t\treturn <div>\n\t\t\t{this.additionRows.map(v => this.renderParam(v))}\n\t\t</div>;\n\t}\n\n\tprotected renderPoint() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{this.controller.point}\n\t\t</div>;\n\t}\n\n\tprotected renderAssignHours() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{taskTimeToString(this.controller.assignhours)}\n\t\t</div>;\n\t}\n\n\tprotected renderHours() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{taskTimeToString(this.controller.hours)}\n\t\t</div>;\n\t}\n\n\tprotected renderViewBottom():JSX.Element {\n\t\treturn;\n\t\t/*\n\t\tlet { owner, state } = this.controller.noteItem;\n\t\tlet right: any;\n\t\tlet isMe = this.isMe(owner);\t\t\n\t\tif (isMe === true && state === EnumTaskState.Start) {\n\t\t\tright = <>{this.renderEditButton()}</>;\n\t\t}\n\t\treturn <div className=\"py-2 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.controller.cComments.renderCommentButton()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t\t*/\n\t}\n\n\trenderRelatives() {\n\t\treturn this.renderVm(VTaskRelatives as any);\n\t}\n\n\tprotected renderState(): JSX.Element {\n\t\treturn <>state</>;\n\t}\n\t/*\n\tprotected onEdit() {\n\t\tthis.openVPage(VEdit as any);\n\t}\n\t*/\n\n\tprotected renderCheckItem(v:TaskCheckItemBase, checkable:boolean) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tonChange={this.onCheckChange}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!checkable} />\n\t\t\t<div className={cn}>{content}</div>\n\t\t</label>;\n\t}\n\n\tprivate onCheckChange = async (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\t//let t = evt.currentTarget;\n\t\t//let key = Number(t.getAttribute('data-key'));\n\t\t//await this.controller.onCheckChange(key, t.checked);\n\t}\n}\n","import React from 'react';\nimport { VTaskView } from './VTaskView';\nimport { CTaskObserver } from './CTaskObserver';\n\nexport class VTaskObserver extends VTaskView<CTaskObserver> {\n\tprotected renderState() {\n\t\tlet state = this.controller.taskStateResult;\n\t\treturn this.renderStateSpan(state.content, state.isEnd);\n\t}\n\n\tprotected renderTaskAdditions() {\n\t\tlet rows = [\n\t\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '分派工时', values: this.renderAssignHours()}, \n\t\t\t{label: '实际工时', values: this.renderHours()}, \n\t\t];\n\t\tlet {checker, rater} = this.controller.noteItem.obj;\n\t\treturn <div>\n\t\t\t{rows.map(v => this.renderParam(v))}\n\t\t\t{ checker ? this.renderChecker() : undefined }\n\t\t\t{ rater ? this.renderRater() : undefined }\n\t\t</div>;\n\t}\n\n\tprivate renderChecker() {\n\t\treturn <div>检查人</div>;\n\t}\n\n\tprivate renderRater() {\n\t\treturn <div>评分人</div>;\n\t}\n\n}\n\nexport class VTaskObserverDir extends VTaskObserver {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { initNoteItemObj } from \"../../../notes/model\";\nimport { CNoteTask } from \"./CNoteTask\";\nimport { TaskStateResult, getTaskItemState } from \"./TaskState\";\nimport { VTaskObserver, VTaskObserverDir } from \"./VTaskObserver\";\n\nexport class CTaskObserver extends CNoteTask {\t\n\tget allowCheck() { return false; }\n\n\tshowViewPage():void {this.openVPage(VTaskObserver);};\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskObserverDir);\n\t}\n\tget taskStateResult(): TaskStateResult {\n\t\treturn getTaskItemState(this.noteItem);\n\t}\n\n\tinitModelData() {\n\t\tif (this.noteModel === undefined || this.noteModel.flowContent === undefined)\n\t\t\treturn;\n\t\tthis.noteItem.flowContent = this.noteModel.flowContent;\n\t\tinitNoteItemObj(this.noteItem);\n\n\t\tlet {obj} = this.noteItem;\n\t\tthis.initobj(obj);\n\t}\n}\n","//import React from 'react';\nimport { computed, observable } from 'mobx';\n//import { FA } from 'tonva';\nimport { Contact } from '../../../model';\nimport { EnumNoteType, NoteItem, numberFromId } from '../../model';\nimport { renderIcon } from '../../noteBase';\nimport { CContent, CCheckable } from '../../components';\nimport { CNote } from '../CNote';\nimport { VAssignView } from './VAssignView';\nimport { VAssignAdd } from './VAssignAdd';\n//import { VAssignEdit } from './VAssignEdit'\nimport { VAssignDir } from './VAssignDir';\nimport { CAssignTo } from './CAssignTo';\nimport { CTaskObserver } from '../task/CTaskObserver';\n\nexport class CNoteAssign extends CNote {\n\tcContent: CContent;\n\t@observable checker: Contact;\n\t@observable rater: Contact;\n\n\tpoint:number = 100;\n\t@observable assignhours:number = 0;\n\t@observable changed:boolean = false;\n\n\tinit(param: NoteItem): void {\n\t\tsuper.init(param);\n\t\tthis.cContent = new CCheckable(this.res);\n\t\tlet obj:any;\n\t\tif (param) {\n\t\t\tthis.caption = param.caption;\n\t\t\tobj = param.obj;\n\t\t\tthis.assignhours = obj.assignhours;\n\t\t}\n\t\tthis.cContent.init(obj);\n\t}\n\n\t@computed get isContentChanged():boolean {return this.changed || this.cContent.changed}\n\tget type():EnumNoteType { return EnumNoteType.assign }\n\t@computed get isNoteEmpty(): boolean {\n\t\treturn (this.caption === undefined || this.caption.trim().length === 0) || this.cContent.isEmpty;\n\t}\n\n\trenderIcon(): JSX.Element {\n\t\treturn renderIcon('list', 'text-primary');\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\tobj.assignhours = this.assignhours;\n\t\treturn obj;\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VAssignDir);\n\t}\n\n\tshowViewPage() {\n\t\tthis.openVPage(VAssignView);\n\t}\n\n\tshowEditPage() {\n\t\t//this.cContent.startInput();\n\t\t//this.openVPage(VAssignEdit);\n\t}\n\n\tduplicateAssign = () => {\n\t\t//this.owner\n\t\tlet noteItem = {...this.noteItem};\n\t\tnoteItem.obj = JSON.parse(noteItem.content);\n\t\tnoteItem.commentCount = 0;\n\t\tnoteItem.commentUnread = 0;\n\t\tnoteItem.note = undefined;\n\t\tthis.closePage();\n\t\tthis.owner.duplicateAssign(noteItem);\n\t}\n\n\tshowAddPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.startAction();\n\t\tthis.openVPage(VAssignAdd);\n\t}\n\n\tsaveAndAssingTo = async () => {\n\t\tlet ret = await this.AddNote() as CNoteAssign;\n\t\tlet cAssignTo = new CAssignTo(this.cApp, ret, true);\n\t\tcAssignTo.SetTopKey(this.TopKey);\n\t\tawait cAssignTo.start();\n\t}\n\n\tshowAssignTo = async () => {\n\t\tlet cAssignTo = new CAssignTo(this.cApp, this);\n\t\tawait cAssignTo.start();\n\t}\n\n\tassignTask = async (toList: number[]) => {\n\t\tlet { note } = this.noteItem;\n\t\tlet { caption, content } = this.noteItem;\n\t\tlet cObj = JSON.parse(content);\n\t\tif (this.checker) {\n\t\t\tcObj.checker = numberFromId(this.checker.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.checker;\n\t\t}\n\t\tif (this.rater) {\n\t\t\tcObj.rater = numberFromId(this.rater.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.rater;\n\t\t}\n\t\tcObj.assignhours = this.assignhours;\n\t\t//cObj.hours = this.assignhours;\n\t\tcObj.point = this.point;\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote,\n\t\t\tcaption,\n\t\t\tcontent: JSON.stringify(cObj),\n\t\t\ttos: toList.map(v => ({to:v})),\n\t\t\tchecker: this.checker?.contact,\n\t\t\trater: this.rater?.contact,\n\t\t\tpoint: this.point,\n\t\t}\n\t\tawait this.uqs.notes.AssignTask.submit(data);\n\t\tawait this.lodeModel();\n\t\tthis.noteItem.spawnCount = this.noteModel.spawn.length;\n\t}\n\n\tshowSpawn = async (noteItem: NoteItem) => {\n\t\tlet s = new CTaskObserver(this.owner);\n\t\ts.init(noteItem);\n\t\tawait s.lodeModel();\n\t\ts.initModelData();\n\t\ts.showViewPage();\n\t}\n}\n","//import React from 'react';\nimport { TabRelative } from '../../noteBase';\nimport { VRelativesNoteBase } from '../views';\nimport { CNoteText } from './CNoteText';\n\nexport class VTextRelatives extends VRelativesNoteBase<CNoteText> {\n\tprotected get tabs():TabRelative[] { return [this.tabComment, this.tabShare] };\n}\n","import React from 'react';\nimport { View } from \"../../../tonva\";\nimport { CNoteText } from \"./CNoteText\";\nimport { observer } from 'mobx-react';\n\nexport class VTextHeader extends View<CNoteText> {\n\trender() {\n\t\treturn React.createElement(observer(() => <>{this.controller.header}</>));\n\t}\n}\n","import React from 'react';\nimport { VNoteBaseView } from '../../noteBase';\nimport { CNoteText } from './CNoteText';\nimport { VTextRelatives } from './VTextRelatives';\nimport { VTextHeader } from './VTextHeader';\n\nexport class VTextView extends VNoteBaseView<CNoteText> {\n\theader() {\n\t\treturn this.renderVm(VTextHeader);\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VTextRelatives);\n\t}\n\n\tfooter() {\n\t\treturn this.renderFooter();\n\t}\n\n\tprotected renderFooter() {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-center\">\n\t\t\t{this.renderShareButton()}\n\t\t\t{this.controller.cComments.renderWriteComment()}\n\t\t</div>;\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.controller.cContent.renderViewContent();\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { DropdownActions, DropdownAction } from '../../../tonva';\nimport { VNoteBaseEdit } from '../../noteBase';\nimport { CNoteText } from \"./CNoteText\";\nimport { VTextHeader } from './VTextHeader';\n\nexport class VTextEdit extends VNoteBaseEdit<CNoteText> {\n\theader() {\n\t\treturn this.renderVm(VTextHeader);\n\t}\n\n\tprotected renderContent():JSX.Element {\n\t\t//return this.controller.cContent.renderInput();\n\t\treturn React.createElement(observer(() =>{\n\t\t\tlet {cType, cContent} = this.controller;\n\t\t\treturn <>\n\t\t\t\t<span className=\"d-none\">{cType}</span>\n\t\t\t\t{cContent.renderInput()}\n\t\t\t</>;\n\t\t}));\n\t}\n\n\tprotected renderEditBottom():JSX.Element {\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t{this.renderButtonLeft()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={!this.controller.isNoteChanged}>\n\t\t\t\t\t保存\n\t\t\t\t</button>\n\t\t\t</>))}\n\t\t\t{this.renderExButtons()}\n\t\t</div>;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn this.renderDeleteButton();\n\t}\n\n\tprivate dropdownActions: {[type: string]: DropdownAction} = {\n\t\ttext: {\n\t\t\ticon:'file-o', \n\t\t\tcaption:this.t('noteText'), \n\t\t\taction: this.controller.changeToText,\n\t\t},\n\t\tlist: {\n\t\t\ticon:'list', \n\t\t\tcaption:this.t('noteList'), \n\t\t\taction: this.controller.changeToList,\n\t\t},\n\t\tcheckable: {\n\t\t\ticon:'check-square-o', \n\t\t\tcaption:this.t('noteCheckable'), \n\t\t\taction: this.controller.changeToCheckable,\n\t\t},\n\t};\n\n\tprotected renderButtonLeft():JSX.Element { \n\t\treturn <DropdownActions\n\t\t\tactions={this.controller.dropdowns.map(v => this.dropdownActions[v])} \n\t\t\ticon=\"th-list\" \n\t\t\titemIconClass=\"text-info\" \n\t\t\tisRight={false}\n\t\t\tclassName=\"cursor-pointer btn btn-lg p-1 mr-1\"/>;\n\t}\n}\n","import React from \"react\";\nimport { VTextEdit } from \"./VTextEdit\";\nimport { observer } from \"mobx-react\";\n\nexport class VTextAdd extends VTextEdit {\n\theader() {return <>新建</>}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote();\n\t\tthis.closePage();\n\t\treturn;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn React.createElement(observer(() => {\n\t\t\treturn this.renderShareButton();\n\t\t}));\n\t}\n\n\tprotected renderShareButton() {\n\t\treturn <button onClick={this.onSaveAndSendNote}\n\t\t\tclassName=\"btn btn-outline-primary mr-3\">\n\t\t\t发给\n\t\t</button>;\n\t}\n\n\tprotected onSaveAndSendNote = async () => {\n\t\tlet cnewNote = await this.controller.AddNote();\n\t\tthis.closePage();\n\t\tawait cnewNote.cApp.loadRelation();\n\t\tcnewNote.showShareTo();\n\t}\n\n}\n","import { CNoteText } from \"./CNoteText\";\nimport { VNoteBaseDir } from \"../../noteBase\";\n\nexport class VTextDir extends VNoteBaseDir<CNoteText> {\n\tprotected renderContent():JSX.Element {\n\t\treturn this.controller.cContent.renderDirContent();\n\t}\n}\n","import { computed, observable } from 'mobx';\nimport { EnumNoteType, NoteItem } from '../../model';\nimport { VTextView } from './VTextView';\nimport { VTextAdd } from './VTextAdd';\nimport { renderIcon } from '../../noteBase';\nimport { VTextDir } from './VTextDir';\nimport { VTextEdit } from './VTextEdit';\nimport { CContent, CText, CCheckable, CList } from '../../components';\nimport { CNote } from '../CNote';\n\nexport class CNoteText extends CNote {\n\t@observable header: string;\n\t@observable cType: EnumNoteType;\n\t@observable dropdowns: string[];\n\t@observable cContent: CContent;\n\n\tcreateTextContent(): void {\n\t\tthis.header = this.t('noteText');\n\t\tthis.cContent = new CText(this.res);\n\t\tthis.cType = EnumNoteType.text;\n\t\tthis.dropdowns = ['list', 'checkable'];\n\t}\n\t\n\tcreateListContent(): void {\n\t\tthis.header = this.t('noteList');\n\t\tthis.cContent = new CList(this.res);\n\t\tthis.cType = EnumNoteType.textList;\n\t\tthis.dropdowns = ['text', 'checkable'];\n\t}\n\n\tcreateCheckableContent(): void {\n\t\tthis.header = this.t('noteCheckable');\n\t\tthis.cContent = new CCheckable(this.res);\n\t\tthis.cType = EnumNoteType.textCheckable;\n\t\tthis.dropdowns = ['text', 'list'];\n\t}\n\t\n\tinit(param: NoteItem): void {\n\t\tsuper.init(param);\n\t\tif (param) {\n\t\t\tif (this.cContent === undefined) {\n\t\t\t\tdebugger;\n\t\t\t\tthrow new Error('this.cContent should have created');\n\t\t\t}\n\t\t\tthis.cContent.init(param.obj);\n\t\t}\n\t}\n\n\t@computed get isContentChanged():boolean { return this.cContent.changed }\n\tget type():EnumNoteType { return this.cType; }\n\n\trenderIcon(): JSX.Element {\n\t\t//return renderIcon(this.noteItem.toCount>0? 'files-o': 'file-o', 'text-info');\n\t\treturn renderIcon('file-o', 'text-info');\n\t}\n\n\tprotected endContentInput():any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tthis.cContent.endInput(obj);\n\t\treturn obj;\n\t}\n\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTextDir);\n\t}\n\n\tshowViewPage() {\n\t\tthis.openVPage(VTextView);\n\t}\n\n\tshowEditPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VTextEdit);\n\t}\n\n\tshowAddPage() {\n\t\tthis.cContent.startInput();\n\t\tthis.openVPage(VTextAdd);\n\t}\n\n\tchangeToText = () => {\n\t\tif (this.cType === EnumNoteType.text)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createTextContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.text;\n\t\t}\n\t}\n\n\tchangeToList = () => {\n\t\tif (this.cType === EnumNoteType.textList)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createListContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.textList;\n\t\t}\n\t}\n\n\tchangeToCheckable = () => {\n\t\tif (this.cType === EnumNoteType.textCheckable)\n\t\t\treturn;\n\t\tlet content = this.cContent.toString();\n\t\tthis.createCheckableContent();\n\t\tthis.cContent.reset(content);\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.type = EnumNoteType.textCheckable;\n\t\t}\n\t}\n}\n","import { CInputHours } from '../../../../notes/components';\nimport { taskTimeToString } from '../../../../notes/model';\nimport React from 'react';\nimport { FA, Image, User, UserView } from '../../../../tonva';\nimport { none } from '../../../../tool';\nimport { VTaskView, TaskParam } from '../VTaskView';\nimport { CTaskStart } from './CTaskStart';\n\nexport class VTaskStart extends VTaskView<CTaskStart> {\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待办');\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet { owner } = this.controller.noteItem;\n\t\tlet left: any, right: any;\n\t\tlet isMe = this.isMe(owner);\n\t\tif (isMe === true) {\n\t\t\tleft = <button onClick={this.onDone} className=\"btn btn-primary mx-3\">\n\t\t\t\t完成\n\t\t\t</button>;\n\t\t}\n\n\t\treturn <div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t{right}\n\t\t</div>;\n\t}\n\n\tprotected get additionRows(): TaskParam[]  {\n\t\treturn \t[\n\t\t\t//{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '分派工时', values: this.renderAssignHours()}, \n\t\t\t{label: '实际工时', values: this.renderHours(), onClick: this.onClickHours}, \n\t\t];\n\t}\n\n\tprotected renderHours() {\n\t\treturn <div className=\"flex-fill form-control border-0\">\n\t\t\t{taskTimeToString(this.controller.hours)}\n\t\t</div>;\n\t}\n\n\tprivate onClickHours = async () => {\n\t\tlet chours = new CInputHours(this.controller.owner);\n\t\tlet h = await chours.inputHours(this.controller.hours);\n\t\tthis.closePage();\n\t\tif (h !== undefined) {\n\t\t\tthis.controller.hours = h;\n\t\t}\n\t}\n\n\t// protected onHoursChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t// \tlet m = checkHourMinutes(evt.target.value);\n\t// \tif (m < 0) {\n\t// \t\tm = 0;\n\t// \t}\n\t// \tthis.controller.hours = m;\n\t// }\n\n\t// protected onHoursBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t// \tif (checkHourMinutes(evt.target.value) < 0) {\n\t// \t\tevt.target.value = '';\n\t// \t\tthis.controller.hours = 0;\n\t// \t}\n\t// }\n\n\tprivate onDone = async () => {\n\t\tawait this.controller.DoneTask();\n\t\tthis.closePage();\n\n\t\t// 这个地方应该要显示，下一步是由谁来做什么。比如谁来验收，或者谁来评价\n\t\t// 如果没有后续操作，显示成红色，加一个终止标志 #\n\t\t// 如果由后续操作，显示成绿色，并且显示下一步什么操作，由谁来操作\n\t\tlet { obj } = this.controller.noteItem;\n\t\tlet { checker, rater } = obj;\n\t\tlet content;\n\t\tif (checker === undefined && rater === undefined) {\n\t\t\tcontent = <div className=\"text-danger\"><FA className=\"mr-1\" name=\"stop\" />任务完成</div>\n\t\t}\n\t\telse {\n\t\t\tlet contentChecker = checker ? <div className=\"px-3 py-2 bg-white d-flex border-bottom\">\n\t\t\t\t<div className=\"text-muted mr-3 w-5c\">检查人</div>\n\t\t\t\t<div className=\"mr-3 \">{this.renderContact(checker)}</div>\n\t\t\t\t</div>\n\t\t\t\t: undefined;\n\t\t\tlet contentRater = rater ? <div className=\"px-3 py-2 bg-white d-flex border-bottom\">\n\t\t\t\t<div className=\"text-muted mr-3 w-5c\">评分人</div>\n\t\t\t\t<div className=\"mr-3 \">{this.renderContact(rater)}</div>\n\t\t\t\t</div>\n\t\t\t\t: undefined;\n\n\t\t\tcontent = <div>\n\t\t\t\t<div className=\"text-success\">任务完成</div>\n\t\t\t\t{contentChecker}\n\t\t\t\t{contentRater}\n\t\t\t</div>\n\t\t}\n\t\tthis.showActionEndPage({ content });\n\t}\n\n\tprotected renderContact = (item:number) => {\n\t\tif (!item) return none;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1c h-1c mr-1\" src={icon || '.user-o'} />\n\t\t\t\t<span className=\"mr-3\">{nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={item} render={renderUser} />;\n\t}\n}\n\nexport class VTaskStartDir extends VTaskStart {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskStart, VTaskStartDir } from \"./VTaskStart\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\n\nexport class CTaskStart extends CNoteTask {\t\n\tget allowCheck() { return this.isMe(this.noteItem.owner); }\n\n\tshowViewPage():void {this.openVPage(VTaskStart);};\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskStartDir);\n\t}\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '待办', isEnd: false}\n\t}\n\n\tasync DoneTask() {\n\t\tlet { note: noteId, caption } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\tcontent: content,\n\t\t\tcaption: caption,\n\t\t\thours: this.hours\n\t\t}\n\n\t\tawait this.uqs.notes.DoneTask.submit(data);\n\t\tthis.noteItem.state = EnumTaskState.Done;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskDone } from './CTaskDone';\n\nexport class VTaskDone extends VTaskView<CTaskDone> {\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { checker } = obj;\n\t\t\tif (checker) {\n\t\t\t\treturn this.renderStateSpan('待验收');\n\t\t\t}\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评分');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('已办', true);\n\t}\n}\n\nexport class VTaskDoneDir extends VTaskDone {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskDone, VTaskDoneDir } from \"./VTaskDone\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskDone extends CNoteTask {\t\n\t//protected getTaskView() {return VTaskDone };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskDoneDir);\n\t}\n\tshowViewPage():void {this.openVPage(VTaskDone);}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已办', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskCanceled } from './CTaskCanceled';\n\nexport class VTaskCanceled extends VTaskView<CTaskCanceled> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已取消', true);\n\t}\n}\n\nexport class VTaskCanceledDir extends VTaskCanceled {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskCanceled, VTaskCanceledDir } from \"./VTaskCanceled\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskCanceled extends CNoteTask {\t\n\t//protected getTaskView() {return VTaskCanceled };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskCanceledDir);\n\t}\n\tshowViewPage():void {this.openVPage(VTaskCanceled);}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已取消', isEnd: false}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskPass } from './CTaskPass';\n\nexport class VTaskPass extends VTaskView<CTaskPass> {\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评价');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('签收', true);\n\t}\n}\n\nexport class VTaskPassDir extends VTaskPass {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskPass, VTaskPassDir } from \"./VTaskPass\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskPass extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskPass) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskPassDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '签收', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskFail } from './CTaskFail';\n\nexport class VTaskFail extends VTaskView<CTaskFail> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('拒签', true);\n\t}\n}\n\nexport class VTaskFailDir extends VTaskFail {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskFail, VTaskFailDir } from \"./VTaskFail\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskFail extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskFail) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskFailDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '拒签', isEnd: true}\n\t}\n}\n","//import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskRated } from './CTaskRated';\n\nexport class VTaskRated extends VTaskView<CTaskRated> {\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已评价', true);\n\t}\n}\n\nexport class VTaskRatedDir extends VTaskRated {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { CNoteTask } from \"../CNoteTask\";\nimport { VTaskRated, VTaskRatedDir } from \"./VTaskRated\";\nimport { TaskStateResult } from \"../TaskState\";\n\nexport class CTaskRated extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskRated) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskRatedDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: '已评价', isEnd: true}\n\t}\n}\n","import React from \"react\";\nimport { Controller, View, Page } from \"../../../tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport interface EditTextItemProps {\n\tonUpdate: (inputContent: string) => Promise<void>;\n\tcontent: string;\n\theader: string;\n}\n\nexport class VEditTextItemInput<T extends Controller> extends View<T> {\n\t@observable private disabled: boolean;\n\tprivate inputText: string;\n\tprivate props: EditTextItemProps;\n\n\tconstructor(controller: T, props: EditTextItemProps) {\n\t\tsuper(controller);\n\t\tthis.props = props;\n\t\tthis.inputText = this.props.content;\n\t}\n\n\tonUpdate = () => {\n\t\tthis.disabled = true;\n\t\tthis.openPageElement(React.createElement(observer(() => {\n\t\t\tlet onClickSave = async () => {\n\t\t\t\tif (this.disabled === true) return;\n\t\t\t\tlet inputText = this.inputText.trim();\n\t\t\t\tawait this.props.onUpdate(inputText);\n\t\t\t\tthis.closePage();\n\t\t\t}\n\t\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\t\tif (evt.keyCode === 13) onClickSave();\n\t\t\t}\n\t\t\tlet onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\t\tthis.inputText = evt.target.value;\n\t\t\t\tthis.disabled = this.props.content === this.inputText;\n\t\t\t}\n\t\t\tlet right = <button className=\"btn btn-sm btn-success mr-2\"\n\t\t\t\tdisabled={this.disabled}\n\t\t\t\tonClick={onClickSave}>保存</button>;\n\t\t\treturn <Page header={this.props.header} back=\"close\" right={right}>\n\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t<input className=\"form-control\" type=\"text\"\n\t\t\t\t\t\tonChange={onInputChange} onKeyDown={onKeyDown}\n\t\t\t\t\t\tdefaultValue={this.props.content} />\n\t\t\t\t</div>\n\t\t\t</Page>;\n\t\t})));\n\t}\n\n\trender(props: EditTextItemProps): JSX.Element {\n\t\tthis.props = props;\n\t\tthis.inputText = this.props.content;\n\n\t\treturn <></>\n\t}\n}\n","import React from 'react';\nimport { VTaskView } from '../VTaskView';\nimport { Page, FA } from '../../../../tonva';\nimport { VEditTextItemInput, EditTextItemProps } from '../VEditTextItem';\nimport { CTaskCheck } from './CTaskCheck';\nimport { TaskCheckItem } from '../model';\n\nexport class VTaskCheck extends VTaskView<CTaskCheck> {\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待验收');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\tlet onUpdate = async (v: string) => {\n\t\t\tawait this.controller.setCheckInfo(item, v);\n\t\t}\n\t\tlet eprops: EditTextItemProps = { onUpdate: onUpdate, content: checkInfo, header: '验收事项说明' }\n\t\tlet vEdit = new VEditTextItemInput(this.controller, eprops);\n\t\treturn <div key={key} className={'d-flex'}>\n\t\t\t<label className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\t\tdefaultChecked={checked}\n\t\t\t\t\tdata-key={key}\n\t\t\t\t\tdisabled={!this.controller.allowCheck} />\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info cursor-ponter\" onClick={vEdit.onUpdate}>{checkInfo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t<div className=\"p-2 cursor-pointer\" onClick={vEdit.onUpdate}>\n\t\t\t\t<FA name=\"pencil-square-o text-info\" />\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { checkInfo } = this.controller;\n\t\treturn <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t<div className=\"text-muted mr-1 w-5c\">验收意见</div>\n\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t</div>\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateCheckInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.checkSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet left = <div>\n\t\t\t<button onClick={()=>this.onCheck(true)} className=\"btn btn-success mx-3\">\n\t\t\t\t<FA name=\"check\" /> 通过\n\t\t\t</button>\n\t\t\t<button onClick={() => this.onCheck(false)} className=\"btn btn-outline-secondary mx-3\">\n\t\t\t\t<FA name=\"times\" /> 不通过\n\t\t\t</button>\n\t\t</div>;\n\t\treturn <>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</>;\n\t}\n\n\tprotected onCheck = async (pass: boolean) => {\n\t\tawait this.controller.checkTask(pass);\n\t\tthis.closePage();\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\tthis.showActionEndPage({ content });\n\t\t//this.openPage(this.resultPage, {pass})\n\t}\n\n\tprotected resultPage = ({ pass }: { pass: boolean }) => {\n\t\tlet { caption: title } = this.controller;\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\treturn <Page header={title} back=\"close\">\n\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t{content}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={() => this.closePage()}>返回</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Page>;\n\t}\n}\n\nexport class VTaskCheckDir extends VTaskCheck {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskCheck, VTaskCheckDir } from \"./VTaskCheck\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskCheck extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskCheck) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskCheckDir);\n\t}\n\t\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: 'check', isEnd: false}\n\t}\n\n\tasync checkTask(pass: boolean) {\n\t\tawait this.checkSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\taction: pass ? 1 : 2,\n\t\t\tcontent: content\n\t\t}\n\n\t\tawait this.uqs.notes.CheckTask.submit(data);\n\t\tthis.noteItem.state = pass ? EnumTaskState.Pass : EnumTaskState.Fail;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n\n\tasync setCheckInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.checkInfo;\n\t\t}\n\t\telse {\n\t\t\titem.checkInfo = v;\n\t\t}\n\t\tawait this.saveX();\n\t}\n}\n","import React from 'react';\nimport { FA } from '../../../../tonva';\nimport { VTaskView } from '../VTaskView';\nimport { CTaskRate } from './CTaskRate';\nimport { TaskCheckItem } from '../model';\n\nexport class VTaskRate extends VTaskView<CTaskRate> {\n\tprotected rateValue: number = 0;\n\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待评价');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!this.controller.allowCheck} />\n\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t<span className=\"text-info cursor-ponter\" >{checkInfo}</span>\n\t\t\t\t</div>}\n\t\t\t</div>\n\t\t</label>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { rateInfo, checkInfo } = this.controller;\n\t\treturn <div>\n\t\t\t{\n\t\t\t\tcheckInfo && <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t\t\t<div className=\"text-muted mr-1 w-5c\">验收意见</div>\n\t\t\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t /></div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t<div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t\t<div className=\"text-muted mr-1 w-5c\">评分意见</div>\n\t\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\t\tdefaultValue={rateInfo}\n\t\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateRateInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.checkSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderViewBottom() {\n\t\tlet left = <div>\n\t\t\t<button onClick={() => this.onRate()} className=\"btn btn-success mx-3\">\n\t\t\t\t评价\n\t\t\t</button>\n\t\t</div>;\n\n\t\treturn <div>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t{this.renderValueRadio()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.rateValue = Number(evt.target.value);\n\t};\n\n\tprotected renderValueRadio(): JSX.Element {\n\t\tlet radios = [\n\t\t\t{ val: 2, text: '卓越' },\n\t\t\t{ val: 1, text: '谢谢' },\n\t\t];\n\n\t\treturn <div className=\"my-3\">\n\t\t\t{radios.map((v, index) => {\n\t\t\t\tlet { val, text } = v;\n\t\t\t\treturn <label key={index} className=\"mb-0 mx-3\">\n\t\t\t\t\t<input className=\"mr-1\" type=\"radio\" value={val}\n\t\t\t\t\t\tdefaultChecked={this.rateValue === val} name={'ratevalue'} onChange={this.onChange} />\n\t\t\t\t\t{text}\n\t\t\t\t</label>\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate onRate = async () => {\n\t\tawait this.controller.rateTask(this.rateValue);\n\t\tthis.closePage();\n\t\tlet content = <>评价完成</>;\n\t\tthis.showActionEndPage({ content });\n\t}\n}\n\nexport class VTaskRateDir extends VTaskRate {\n\trender() {\n\t\treturn this.renderDirView();\n\t}\n}","import { numberFromId } from \"../../../model\";\nimport { CNoteTask } from \"../CNoteTask\";\nimport { VTaskRate, VTaskRateDir } from \"./VRateTask\";\nimport { TaskStateResult, EnumTaskState } from \"../TaskState\";\nimport { TaskCheckItem } from \"../model\";\n\nexport class CTaskRate extends CNoteTask {\t\n\tshowViewPage():void {this.openVPage(VTaskRate) };\n\trenderDirItem(index: number): JSX.Element {\n\t\treturn this.renderView(VTaskRateDir);\n\t}\n\n\tget taskStateResult(): TaskStateResult {\n\t\treturn {content: 'rate', isEnd: true}\n\t}\n\n\tasync rateTask(value: number) {\n\t\tthis.rateValueInput = value;\n\t\tawait this.checkSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet obj = this.endContentInput();\n\t\tlet content = JSON.stringify(obj);\n\t\tlet data = {\n\t\t\tgroupFolder: this.owner.currentFold.groupFolder,\n\t\t\tfolder: this.owner.currentFold.folderId,\n\t\t\tnote: numberFromId(noteId),\n\t\t\tvalue: value,\n\t\t\tcontent: content\n\t\t}\n\n\t\tawait this.uqs.notes.RateTask.submit(data);\n\t\tthis.noteItem.state = EnumTaskState.Rated;\n\t\tthis.noteItem.flowContent = content;\n\t\tthis.noteItem.$update = new Date();\n\t\tthis.owner.currentFold.taskUpdateState(this.noteItem);\n\t}\n\n\tasync setRateInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.rateInfo;\n\t\t}\n\t\telse {\n\t\t\titem.rateInfo = v;\n\t\t}\n\t\tawait this.saveX();\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from './VBasePage';\nimport { CShareTo } from 'notes/CShareTo';\n\nexport class VActions extends VBasePage<CShareTo> {\n\theader() {return '操作'}\n\tcontent() {\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mt-1';\n\t\treturn <div className=\"\">\n\t\t\t<div className=\"text-muted small px-3 py-1 mt-2\">收件人</div>\n\t\t\t<div className=\"border rounded p-3 mb-3\">\n\t\t\t\t{this.renderSelectedContact(this.controller.contacts)}\n\t\t\t</div>\n\t\t\t<div className={cn} onClick={this.controller.onSendOut}>\n\t\t\t\t分享内容\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import { CTo } from \"./components\";\nimport { VActions } from \"./views/VActions\";\nimport { CNotes } from \"./CNotes\";\nimport { Query } from \"tonva\";\n\nexport class CShareTo extends CTo {\n\tprivate cNotes:CNotes;\n\tconstructor(cApp:any, cNotes:CNotes) {\n\t\tlet {currentFold} = cNotes;\n\t\tlet {groupFolder, currentNoteItem} = currentFold;\n\t\tif (currentNoteItem === undefined) {\n\t\t\tcurrentNoteItem = currentFold.noteItem;\n\t\t}\n\t\tsuper(cApp, groupFolder, currentNoteItem);\n\t\tthis.cNotes = cNotes;\n\t}\n\t\n\tprotected get GetContacts(): Query {return this.uqs.notes.GetShareContacts}\n\n\tprotected async sendOut(toList:number[]):Promise<void> {\n\t\tawait this.cNotes.sendNoteTo(toList);\n\t}\n\n\tprotected async afterContactsSelected(): Promise<void> {\n\t\tthis.openVPage(VActions); //, {contacts, noteId: this.currentNoteId});\n\t}\n}\n","import { CUqBase } from \"../tapp\";\nimport { VSelectContact, SelectContactOptions } from \"./views\";\nimport { EnumNoteType, initNoteItemObj, NoteItem } from \"./model\";\nimport { CNoteBase } from \"./noteBase\";\nimport { CContainer, CFolderRoot, createCSpace, createCFolder, createCUnitNote } from \"./container\";\nimport { Contact } from \"../model\";\nimport { createCNoteTask } from \"./note\";\nimport { VFolderDropdown, VHomeDropdown, VSpaceDropdown } from \"./views/VNotesDropDown\";\nimport { CNoteText } from \"./note/text\";\nimport { CNoteAssign } from \"./note/assign\";\nimport { CFolderMy } from \"./container/folderMy\";\nimport { CShareTo } from \"./CShareTo\";\nimport { CSpace } from \"./container/space\";\n\nexport class CNotes extends CUqBase {\n\tprotected foldStack: CContainer[];\n\trootFold: CContainer;\n\tcurrentFold: CContainer;\n\tnoteItem: NoteItem;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.rootFold =this.currentFold = this.newSub(CFolderRoot);\n\t\tthis.foldStack = [];\n\t}\n\n\tnoteItemConverter = (item:NoteItem, queryResults:{[name:string]:any[]}):CNoteBase => {\n\t\tinitNoteItemObj(item);\n\t\tlet cNoteBase = this.createCNoteBase(item);\n\t\tcNoteBase.init(item);\n\t\treturn cNoteBase;\n\t}\n\n\titemChanged(noteItem: NoteItem) {\n\t\tlet folderNoteItem = this.currentFold.itemChanged(noteItem);\n\t\tif (this.foldStack.length > 0) {\n\t\t\tfor (let folder of this.foldStack) {\n\t\t\t\tfolderNoteItem = folder.itemChanged(folderNoteItem)\n\t\t\t}\n\t\t}\n\t}\n\n\topenFolder(foldItem:CContainer) {\n\t\tthis.foldStack.push(this.currentFold);\n\t\tthis.currentFold = foldItem;\n\t\tthis.currentFold.showFolder();\n\t}\n\n\tpopFolder() {\n\t\tthis.currentFold = this.foldStack.pop();\n\t}\n\n\tcreateCNoteBase(noteItem: NoteItem): CNoteBase {\n\t\tswitch (noteItem.type) {\n\t\t\tdefault: throw Error(\"unknown type\");\n\t\t\tcase EnumNoteType.text: return this.createCNoteText();\n\t\t\tcase EnumNoteType.textList: return this.createCNoteList(); \n\t\t\tcase EnumNoteType.textCheckable: return this.createCNoteCheckable(); \n\t\t\tcase EnumNoteType.folder: return createCFolder(this, noteItem);\n\t\t\tcase EnumNoteType.task: return createCNoteTask(this, noteItem); \n\t\t\tcase EnumNoteType.group: debugger; throw Error(\"type group undefined\");\n\t\t\tcase EnumNoteType.groupFolder: return createCSpace(this); \n\t\t\tcase EnumNoteType.unit:  debugger; throw Error(\"type unit undefined\");\n\t\t\tcase EnumNoteType.assign: return new CNoteAssign(this);\n\t\t\tcase EnumNoteType.unitNote: return createCUnitNote(this);\n\t\t}\n\t}\n\n\tprivate createCNoteText(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createTextContent();\n\t\treturn ret;\n\t}\n\n\tprivate createCNoteList(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createListContent();\n\t\treturn ret;\n\t}\n\n\tprivate createCNoteCheckable(): CNoteText {\n\t\tlet ret = new CNoteText(this);\n\t\tret.createCheckableContent();\n\t\treturn ret;\n\t}\n\n\tasync load() {\n\t\tawait this.currentFold.load();\n\t}\n\n\tasync refresh() {\n\t\tawait this.currentFold.refresh();\n\t}\n\t/*\n\tasync getNote(id: number): Promise<NoteModel> {\n\t\treturn await this.currentFold.getNote(id);\n\t}\n\t*/\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type: EnumNoteType) {\n\t\treturn await this.currentFold.addNote(folder, caption, content, obj, type);\n\t}\n\n\tasync editNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\treturn await this.currentFold.editNote(waiting, noteItem, caption, content, obj);\n\t}\n\n\tasync sendNoteTo(toList:number[]) {\n\t\tlet {groupFolder, currentNoteItem} = this.currentFold;\n\t\tif (currentNoteItem === undefined) {\n\t\t\tcurrentNoteItem = this.currentFold.noteItem;\n\t\t}\n\t\tlet {note} = currentNoteItem;\n\t\tlet tos = toList.join('|');\n\t\tawait this.uqs.notes.SendNoteTo.submit({groupFolder, note, tos});\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.currentFold.hideNote(note, x);\n\t}\n\n\trenderNotesView() {\n\t\treturn this.currentFold.renderListView();\n\t}\n\n\trenderHomeDropDown() {\n\t\tlet vHomeDropdown = new VHomeDropdown(this);\n\t\treturn vHomeDropdown.render();\n\t};\n\n\trenderFolderDropDown() {\n\t\tlet vHomeDropdown = new VFolderDropdown(this);\n\t\treturn vHomeDropdown.render();\n\t};\n\n\trenderSpaceDropDown() {\n\t\tlet vSpaceDropdown = new VSpaceDropdown(this);\n\t\treturn vSpaceDropdown.render();\n\t};\n\n\tshowAddNoteTextPage = () => {\n\t\tlet cNoteText = this.createCNoteText();\n\t\tcNoteText.showAddPage();\n\t}\n\n\tshowAddNoteListPage = () => {\n\t\tlet cNoteText = this.createCNoteList();\n\t\tcNoteText.showAddPage();\n\t}\n\t\n\tshowAddNoteCheckablePage = () => {\n\t\tlet cNoteText = this.createCNoteCheckable();\n\t\tcNoteText.showAddPage();\n\t}\n\n\tshowAddMyFolderPage = () => {\n\t\tlet cFolder = new CFolderMy(this);\n\t\tcFolder.init(undefined);\n\t\tcFolder.showAddPage();\n\t}\n\n\tshowAddGroupPage = () => {\n\t\t//let cGroup = this.newSub(CGroup);\n\t\t//cGroup.showAddPage()\n\t\tlet cGroup = new CSpace(this);\n\t\tcGroup.init(undefined);\n\t\tcGroup.showAddPage();\n\t}\n\n\tshowAddAssignPage = () => {\n\t\tlet cNoteAssign = new CNoteAssign(this);\n\t\tcNoteAssign.init(undefined);\n\t\tcNoteAssign.showAddPage();\n\t}\n\n\tduplicateAssign = (param: NoteItem) => {\n\t\tlet cNoteAssign = new CNoteAssign(this);\n\t\tcNoteAssign.init(param);\n\t\tcNoteAssign.showAddPage();\n\t}\n\t\n\tasync showShareTo() {\n\t\t//this.noteItem = noteItem;\n\t\t/*\n\t\tlet ret = await this.uqs.notes.GetMyContacts.page(\n\t\t\t{\n\t\t\t\tgroupFolder: this.currentFold.groupFolder\n\t\t\t}, 0, 50, true);\n\t\tthis.groupMembers = ret.$page;\n\t\tthis.openVPage(VTo, backPageCount);\n\t\t*/\n\t\t//let {groupFolder} = this.currentFold;\n\t\t//let {note} = noteItem;\n\t\t/*\n\t\tlet props: CToProps = {\n\t\t\tcurrentGroupFolder: groupFolder,\n\t\t\tonAfterContactsSelected: async () => {\n\t\t\t\tthis.openVPage(VActions); //, {contacts, noteId: this.currentNoteId});\n\t\t\t},\n\t\t\tsendOut: async (toList: number[]) => {\n\t\t\t\tlet tos = toList.join('|');\n\t\t\t\tawait this.uqs.notes.SendNoteTo.submit({groupFolder, note, tos});\n\t\t\t},\n\t\t};\n\t\tlet cTo = new CTo(this.cApp, props);\n\t\tawait cTo.start();\n\t\t*/\n\t\tlet cShareTo = new CShareTo(this.cApp, this);\n\t\tawait cShareTo.start();\n\t}\n\n\t/*\n\tshowSentPage() {\n\t\tthis.openVPage(VSent);\n\t}\n\t*/\n\n\tasync callSelectContact(options: SelectContactOptions): Promise<Contact[]> {\n\t\treturn await this.vCall(VSelectContact, options);\n\t}\n\n\t/*\n\tshowAssignTaskPage() {\n\t\tlet cNoteTask = createCNoteTask(this, this.noteItem); // this.newSub(CNoteTask);\n\t\tcNoteTask.init(this.noteItem);\n\t\tcNoteTask.showAssignTaskPage();\n\t}\n\t*/\n}\n","import { CNotes } from '../CNotes';\nimport { CSpace } from './space';\nimport { CFolder } from './CFolder';\nimport { NoteItem } from '../model';\nimport { CFolderMy } from './folderMy';\nimport { CFolderShare } from './folderShare';\n\nexport { CContainer } from './CContainer';\nexport { CFolderRoot } from './folderRoot';\n\nexport * from './unitNote';\n\nexport function createCSpace(cNotes: CNotes): CSpace { \n\treturn new CSpace(cNotes);\n}\n\nexport function createCFolder(cNotes: CNotes, noteItem: NoteItem): CFolder {\n\tif (cNotes.isMe(noteItem.owner) === true) {\n\t\treturn new CFolderMy(cNotes);\n\t}\n\telse {\n\t\treturn new CFolderShare(cNotes);\n\t}\n}\n","import { CNotes } from '../../CNotes';\nimport { NoteItem } from '../../model';\nimport { CNoteTask } from './CNoteTask';\nimport { EnumTaskState } from './TaskState';\nimport { CTaskStart } from './start';\nimport { CTaskDone } from './done';\nimport { CTaskCanceled } from './canceled';\nimport { CTaskPass } from './pass';\nimport { CTaskFail } from './fail';\nimport { CTaskRated } from './rated';\nimport { CTaskCheck } from './check';\nimport { CTaskRate } from './rate';\n\nexport function createCNoteTask(cNotes: CNotes, noteItem: NoteItem): CNoteTask {\n\tswitch (noteItem.state) {\n\t\tdefault:\n\t\tcase EnumTaskState.Start:\n\t\t\treturn new CTaskStart(cNotes);\n\t\tcase EnumTaskState.Done:\n\t\t\tif (noteItem && cNotes.isMe(noteItem.obj.checker)) {\n\t\t\t\treturn new CTaskCheck(cNotes);\n\t\t\t}\n\t\t\treturn new CTaskDone(cNotes);\n\t\tcase EnumTaskState.Pass:\n\t\t\tif (noteItem && cNotes.isMe(noteItem.obj.rater)) {\n\t\t\t\treturn new CTaskRate(cNotes);\n\t\t\t}\n\t\t\treturn new CTaskPass(cNotes);\n\t\tcase EnumTaskState.Fail:\n\t\t\treturn new CTaskFail(cNotes);\n\t\tcase EnumTaskState.Rated:\n\t\t\treturn new CTaskRated(cNotes);\n\t\tcase EnumTaskState.Canceled:\n\t\t\treturn new CTaskCanceled(cNotes);\n\t}\n}\n","import { CNotes } from \"notes/CNotes\";\nimport { CUnitNote } from \"./CUnitNote\";\n\nexport function createCUnitNote(cNotes: CNotes): CUnitNote { \n\treturn new CUnitNote(cNotes);\n}\n","import React from 'react';\nimport { VPage, Page } from '../tonva';\nimport { CHome } from './CHome';\n\nexport class VHome extends VPage<CHome> {\n\trender() {\n\t\tlet {cNotes: cNodes} = this.controller;\n\t\tlet right = this.controller.cNotes.renderHomeDropDown();\n\t\treturn <Page header={this.t('home')} right={right}>\n\t\t\t{cNodes.renderNotesView()}\n\t\t</Page>;\n\t}\n}\n","import { CUqBase } from \"../tapp\";\nimport { CNotes } from \"../notes\";\nimport { VHome } from \"./VHome\";\n\nexport class CHome extends CUqBase {\n\tcNotes: CNotes;\n\n  \tprotected async internalStart() {\n\t}\n\n\tasync refresh() {\n\t\tawait this.cNotes.refresh();\n\t}\n\n\tinit() {\n\t\tthis.cNotes = this.newC(CNotes);\n\t}\n\n\ttab = () => this.renderView(VHome);\n\n\tasync load() {\n\t\tawait this.cNotes.load();\n\t}\n}\n","import { CRelation } from \"./CRelation\";\nimport { VAddContact } from \"../tool\";\n\nexport class VAdd extends VAddContact<CRelation> {\n\tprotected async addContact():Promise<void> {\n\t\tawait this.controller.AddContact(this.user.id);\n\t}\n}\n","import React from 'react';\nimport { CRelation } from './CRelation';\nimport { VPage, FA, List, UserView, User, Image } from '../tonva';\nimport { VAdd } from './VAdd';\nimport { Contact } from '../model';\n\nexport class VRelation extends VPage<CRelation> {\n\theader() {return this.t('relation')}\n\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-primary mr-1\" onClick={()=>this.openVPage(VAdd)}>\n\t\t\t<FA name=\"user-plus\" />\n\t\t</button>;\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"\">\n\t\t\t<List items={this.controller.contacts} item={{render: this.renderContact}} />\n\t\t</div>\n\t}\n\n\tprivate renderContact = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <div className=\"px-3 py-2 cursor-pointer\" onClick={()=>this.controller.onShowContact(item)}>\n\t\t\t\t<Image className=\"w-2c h-2c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n}\n","import React from \"react\";\nimport { CContact } from \"./CContact\";\nimport { VPage, UserView, Image, FA, Muted, User } from \"../../tonva\";\nimport { observer } from \"mobx-react\";\n\nexport class VContact extends VPage<CContact> {\n\n\tinit(param:any) {\n\t}\n\n\theader() {\n\t\treturn ' ';\n\t}\n\n\tprivate onEditAlias = () => {\n\t\tthis.controller.onEditAssigned();\n\t}\n\n\tcontent() {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {id, name, nick, icon} = user;\n\t\t\tlet { assigned } = this.controller.contact;\n\t\t\treturn <div className=\"p-3 d-flex\">\n\t\t\t\t<Image className=\"w-3c h-3c mr-4\" src={icon || '.user-o'} />\n\t\t\t\t<div>\n\t\t\t\t\t<div className=\"h6\"><b>{assigned || nick || name}</b></div>\n\t\t\t\t\t<div><Muted>id: </Muted>{id}</div>\n\t\t\t\t\t<div><Muted>用户名: </Muted>{name}</div>\n\t\t\t\t\t{nick && <div><Muted>别名: </Muted>{nick}</div>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}\n\t\tlet { contact } = this.controller.contact;\n\t\tlet cn = 'px-3 py-2 bg-white d-flex align-items-center border-bottom cursor-pointer';\n\t\treturn <div>\n\t\t\t<UserView user={contact as number} render={renderUser} />\n\t\t\t{\n\t\t\t\tReact.createElement(observer(() =>\n\t\t\t\t<div className={cn}  onClick={this.onEditAlias}>\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\n\t\t\t\t\t<div className=\"flex-fill w-100 border-0 form-control mr-auto\">{this.controller.contact.assigned || <Muted>[无]</Muted>}</div>\n\t\t\t\t\t<FA name=\"angle-right\" />\n\t\t\t\t</div>))\n\t\t\t}\n\t\t</div>;\n\t}\n}","import React from \"react\";\nimport { CContact } from \"./CContact\";\nimport { VPage } from \"../../tonva\";\nimport { observable, computed } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport class VEditAssigned extends VPage<CContact> {\n\t@observable private assigned:string;\n\n\tinit(param?:any) {\n\t\tthis.assigned = this.controller.contact?.assigned;\n\t}\n\n\t@computed protected get btnSaveDisabled():boolean {\n\t\treturn this.assigned === this.controller.contact.assigned;\n\t}\n\n\theader() {\n\t\treturn '编辑';\n\t}\n\n\tright():JSX.Element {\n\t\treturn React.createElement(observer(() => <>\n\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\tclassName=\"btn btn-sm btn-success mr-1\" disabled={this.btnSaveDisabled}>\n\t\t\t\t保存\n\t\t\t</button>\n\t\t</>));\n\t}\n\n\tprotected onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.assigned = evt.target.value.trim();\n\t}\n\n\tprivate onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tif (!this.btnSaveDisabled) {\n\t\t\t\tthis.onButtonSave();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tthis.controller.SaveContactAssign(this.assigned);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"border rounded\">\n\t\t\t<div className=\"bg-white\">\n\t\t\t\t<div className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\">\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\n\t\t\t\t\t<input type=\"text\" className=\"flex-fill w-100 border-0 form-control\" maxLength={80}\n\t\t\t\t\t\tautoFocus={true}\n\t\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\n\t\t\t\t\t\tdefaultValue={this.assigned} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t}\n}","import { CUqSub } from \"../../tapp\"\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { CRelation } from \"../CRelation\";\nimport { VContact } from \"./VContact\";\nimport { VEditAssigned } from \"./VEditAssigned\";\n\nexport class CContact extends CUqSub<CRelation> {\n\tprotected async internalStart() {}\n\t@observable contact: Contact;\n\n\tinit(param:Contact):void {\n\t\tthis.contact = {...param};\n\t}\n\n\tasync SaveContactAssign(value:string) {\n\t\tawait this.owner.SaveContactAssign(this.contact, value);\n\t\tthis.contact.assigned = value;\n\t}\n\n\tasync showContact() {\n\t\tthis.openVPage(VContact);\n\t}\n\n\tasync onEditAssigned() {\n\t\tthis.openVPage(VEditAssigned);\n\t}\n}","import { CUqBase } from \"../tapp\";\nimport { VRelation } from \"./VRelation\";\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { CContact } from \"./contact\";\n\nexport class CRelation extends CUqBase {\n\tprivate loaded: boolean = false;\n\t@observable contacts: Contact[] = [];\n\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VRelation);\n\n\tload = async () => {\n\t\tif (this.loaded === true) return;\n\t\tlet ret = await this.uqs.notes.GetMyContacts.page({}, 0, 500, true);\n\t\tthis.contacts.push(...ret['$page']);\n\t\tthis.loaded = true;\n\t}\n\n\tasync AddContact(contact: number) {\n\t\tawait this.uqs.notes.AddContact.submit({contact});\n\t\tthis.contacts.unshift({contact, assigned:undefined});\n\t}\n\n\tasync onShowContact(item:Contact) {\n\t\tlet cc = this.newSub(CContact, item);\n\t\tcc.showContact();\n\t}\n\n\tasync SaveContactAssign(item:Contact, value:string) {\n\t\tlet param = {contact:item.contact, assigned:value};\n\t\tawait this.uqs.notes.SetContactAssinged.submit(param);\n\t\tlet c = this.contacts.find(v=>v.contact === item.contact);\n\t\tif (c !== undefined) {\n\t\t\tc.assigned = value;\n\t\t}\n\t}\n}\n","import { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport React from 'react';\nimport { VPage, userApi, User, Image, Page, List, UserView, \n\tEdit, ItemSchema, StringSchema, IntSchema, UiSchema, UiTextItem, UiNumberItem, BoolSchema, UiCheckItem } from \"../tonva\";\nimport { CMe, RootUnitItem } from \"./CMe\";\n\nexport class VAdmin extends VPage<CMe> {\n\theader() {return '管理员'}\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"px-3 py-3 bg-white border-bottom\">\n\t\t\t\t<div><b className=\"text-info\">为用户创建机构</b></div>\n\t\t\t\t<div>\n\t\t\t\t\t给指定用户创建机构。机构下面的部门和成员，由机构所有者创建。\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={()=>this.openVPage(VUser)}>创建</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<List items={this.controller.rootUnits} item={{render: this.renderRootUnit, onClick: this.onClickRootUnit}} />\n\t\t</div>;\n\t}\n\n\tprivate renderRootUnit = (item: RootUnitItem, index: number) => {\n\t\tlet {id, owner, name, tonvaUnit, x} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{nick || name}\n\t\t\t</>\n\t\t}\n\t\tlet vId = <small className=\"text-muted\">ID={id}</small>;\n\t\tlet vName = (x !== 0)? \n\t\t\t<del>{name} {vId}</del>\n\t\t\t:\n\t\t\t<><b>{name}</b> {vId}</>;\n\t\treturn <div className={'px-3 py-2 align-items-center '}>\n\t\t\t<div className=\"mr-3\">{vName}</div>\n\t\t\t<div className=\"small text-muted d-flex align-items-center\"><UserView user={owner as number} render={renderUser} /></div>\n\t\t\t{tonvaUnit && <div className=\"ml-auto small text-muted\">tonva={tonvaUnit}</div>}\n\t\t</div>;\n\t}\n\n\tprivate onClickRootUnit = (item: RootUnitItem) => {\n\t\tlet {name} = item;\n\t\tlet schema: ItemSchema[] = [\n\t\t\t{ name: 'name', type: 'string' } as StringSchema,\n\t\t\t{ name: 'tonvaUnit', type: 'integer' } as IntSchema,\n\t\t\t{ name: 'x', type: 'boolean' } as BoolSchema,\n\t\t];\n\t\tlet uiSchema: UiSchema = {\n\t\t\titems: {\n\t\t\t\tname: { widget: 'text', label: '机构名称' } as UiTextItem,\n\t\t\t\ttonvaUnit: { widget: 'number', label: 'Tonva Unit' } as UiNumberItem,\n\t\t\t\tx: {widget: 'checkbox', label: '停用', trueValue: 1, falseValue: 0} as UiCheckItem,\n\t\t\t}\n\t\t}\n\t\tthis.openPageElement(<Page header={name}>\n            <Edit schema={schema} uiSchema={uiSchema}\n                data={item}\n                onItemChanged={async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\n\t\t\t\t\tawait this.onItemChanged(item, itemSchema, newValue, preValue);\n\t\t\t\t}} />\n\t\t</Page>);\n\t}\n\n\tprivate onItemChanged = async (item: RootUnitItem, itemSchema: ItemSchema, newValue: any, preValue: any) => {\n\t\tswitch (itemSchema.name) {\n\t\t\tcase 'name':\n\t\t\t\tlet name = newValue.trim();\n\t\t\t\tif (name === preValue.trim()) break;\n\t\t\t\tawait this.controller.changeRootUnitName(item, name);\n\t\t\t\tbreak;\n\t\t\tcase 'tonvaUnit':\n\t\t\t\tawait this.controller.changeRootUnitTonva(item, newValue);\n\t\t\t\tbreak;\n\t\t\tcase 'x':\n\t\t\t\tawait this.controller.changeRootUnitX(item, newValue);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nclass VUser extends VPage<CMe> {\n\t@observable private hasError = false;\n\t@observable private user:{id:number, name:string, nick:string, icon:string};\n\t@observable private inputName: string;\n\n\theader() {return '机构所有者'}\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet vError:any;\n\t\t\tif (this.hasError===true)\n\t\t\t\tvError = <div className=\"my-3 text-danger\">用户不存在！</div>;\n\t\t\treturn <div className=\"m-3\">\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" className=\"form-control\"  maxLength={100}\n\t\t\t\t\t\tplaceholder=\"用户\"\n\t\t\t\t\t\tonFocus={()=>this.hasError = false}\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\n\t\t\t\t\t\tonChange={this.onChange}/>\n\t\t\t\t</div>\n\t\t\t\t{vError}\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.inputName?.trim().length===0}\n\t\t\t\t\t\tonClick={this.onNext}>下一步</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tthis.hasError = false;\n\t\tif (evt.keyCode === 13) {\n\t\t\tawait this.onNext();\n\t\t}\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputName = evt.currentTarget.value;\n\t}\n\n\tprivate onNext = async () => {\n\t\tawait this.search(this.inputName.trim());\n\t\tif (this.hasError === false) {\n\t\t\tthis.controller.unitOwner = this.user as User;\n\t\t\tthis.openVPage(VUnit);\n\t\t}\n\t}\n\n\tprivate search = async (key:string) => {\n\t\tlet ret = await userApi.fromKey(key);\n\t\tif (!ret) {\n\t\t\tthis.hasError = true;\n\t\t\treturn;\n\t\t}\n\t\t// if (this.controller.isMe(ret.id)) {\n\t\t//\treturn;\n\t\t//}\n\t\tthis.user = ret;\n\t}\n}\n\nclass VUnit extends VPage<CMe> {\n\t@observable private input: string;\n\n\theader() {return '新建机构'}\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {unitOwner} = this.controller;\n\t\t\tlet {icon, name, nick} = unitOwner;\n\t\t\treturn <div className=\"m-3\">\n\t\t\t\t<div className=\"my-2\">所有者: <Image className=\"w-2c h-2c\" src={icon} /> {nick ?? name} </div>\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" className=\"form-control\" maxLength={100}\n\t\t\t\t\t\tplaceholder=\"机构名称\" onChange={this.onChange} onKeyDown={this.onKeyDown}/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-2\">\n\t\t\t\t\t<button className=\"btn btn-primary\" disabled={this.input?.trim().length===0}\n\t\t\t\t\t\tonClick={this.onCreate}>创建机构</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.input = evt.currentTarget.value;\n\t}\n\n\tprivate onKeyDown = async (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tawait this.onCreate();\n\t\t}\n\t}\n\n\tprivate onCreate = async () => {\n\t\tlet unitId = await this.controller.createRootUnit({\n\t\t\tname: this.input.trim(),  \n\t\t\tcontent: undefined,\n\t\t\towner: this.controller.user.id\n\t\t});\n\t\tlet header:string = '错误', cn:string = 'text-danger', content:string;\n\t\tswitch (unitId) {\n\t\t\tdefault:\n\t\t\t\theader = '成功';\n\t\t\t\tcn = 'text-success';\n\t\t\t\tcontent = '机构创建成功！';\n\t\t\t\tbreak;\n\t\t\tcase -1:\n\t\t\t\tcontent = '无权创建机构';\n\t\t\t\tbreak;\n\t\t\tcase -2:\n\t\t\t\tcontent = '机构名称已经被使用了';\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.openPageElement(<Page header={header} afterBack={()=>this.closePage(3)} back=\"close\">\n\t\t\t<div className={'m-3 ' +  cn}>{content}</div>\n\t\t</Page>)\n\t}\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport {\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\n    Edit, UiSchema, VPage\n} from '../tonva';\nimport { CMe } from './CMe';\n\nexport class VEditMe extends VPage<CMe>{\n\n    async open(param: any) {\n        this.openPage(this.page);\n    }\n\n    private schema: ItemSchema[] = [\n        { name: 'nick', type: 'string' } as StringSchema,\n        { name: 'icon', type: 'image' } as ImageSchema,\n    ];\n    private uiSchema: UiSchema = {\n        items: {\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\n        }\n    }\n    @observable private data: any;\n\n    constructor(props: any) {\n        super(props);\n        let { nick, icon } = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        };\n    }\n\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\n        let { name } = itemSchema;\n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        nav.user.name = newValue;\n        nav.saveLocalUser();\n    }\n\n    private page = () => {\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\n\t\tlet vAdmin: any;\n\t\t\n\t\tlet { role } = this.controller;\n\t\tif ((role & 2) === 2) {\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\n\t\t}\n\n        return <Page header=\"个人信息\">\n            <Edit schema={schema} uiSchema={uiSchema}\n                data={data}\n                onItemChanged={onItemChanged} />\n\t\t\t{vAdmin}\n        </Page>;\n    }\n}\n\nexport const webUserSchema: ItemSchema[] = [\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\n    { name: 'gender', type: 'string' } as StringSchema,\n    { name: 'salutation', type: 'string' } as StringSchema,\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\n    { name: 'departmentName', type: 'string' } as StringSchema,\n];\n\n","import React from 'react';\nimport { CMe } from './CMe';\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from '../tonva';\nimport { observer } from 'mobx-react';\nimport { appConfig } from '../tapp';\n\nexport class VMe extends VPage<CMe> {\n\theader() {return this.t('me')}\n\n\tcontent() {\n        const { user } = nav;\n        let aboutRows: Prop[] = [\n            '',\n            {\n                type: 'component',\n                component: <div className=\"w-100 d-flex justify-content-between\">\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text={this.t('aboutTheApp')} />\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\n                </div>,\n            }\n        ];\n\n        let rows: Prop[];\n        if (user === undefined) {\n            rows = aboutRows;\n            rows.push(\n                {\n                    type: 'component',\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\n                    </button>\n                },\n            );\n        }\n        else {\n            let logOutRows: Prop[] = [\n                '',\n                {\n                    type: 'component',\n                    bk: '',\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.onExit}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\n                </button>\n                },\n            ];\n\n            rows = [\n                '',\n                {\n                    type: 'component',\n                    component: <this.meInfo />\n                },\n                '',\n                {\n                    type: 'component',\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\n                    onClick: this.changePassword\n                },\n            ]\n            rows.push(...aboutRows, ...logOutRows);\n        }\n        return <PropGrid rows={[...rows]} values={{}} />;\n\t}\n\n\tprivate onExit = () => {\n        nav.showLogout();\n    }\n\n    private changePassword = async () => {\n        await nav.changePassword();\n    }\n\n    private meInfo = observer(() => {\n        let { user } = nav;\n        if (user === undefined) return null;\n        let { id, name, nick, icon } = user;\n        return <LMR className=\"py-2 cursor-pointer w-100\"\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\n            onClick={this.controller.showEditMe}>\n            <div>\n                <div>{userSpan(name, nick)}</div>\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\n            </div>\n        </LMR>;\n    });\n}\n\nfunction userSpan(name: string, nick: string): JSX.Element {\n    return nick ?\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\n        : <b>{name}</b>\n}\n","import { CUqBase } from \"../tapp\";\nimport { QueryPager, User } from \"../tonva\";\nimport { VAdmin } from \"./VAdmin\";\nimport { VEditMe } from \"./VEditMe\";\nimport { VMe } from \"./VMe\";\n\nexport interface RootUnitItem {\n\tid: number;\t\t\t\t\t// root unit id\n\towner: any;\n\tname: string;\t\t\t\t// 唯一\n\tcontent: string;\n\ttonvaUnit: number;\t\t\t// 跟tonva机构对应的值\n\tx: number;\n}\n\nexport class CMe extends CUqBase {\n\trole: number;\n\tunitOwner: User;\n\trootUnits: QueryPager<any>;\n\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VMe);\n\n\tshowEditMe = async () => {\n\t\tlet result = await this.uqs.notes.GetSystemRole.query({});\n\t\tthis.role = result.ret[0]?.role;\n\t\tthis.openVPage(VEditMe);\n\t}\n\n\tshowAdmin = async () => {\n\t\tthis.rootUnits = new QueryPager<any>(this.uqs.notes.GetRootUnits, undefined, undefined, true);\n\t\tthis.rootUnits.first({});\n\t\tthis.openVPage(VAdmin);\n\t}\n\n\tasync createRootUnit(param: {name:string; content:string; owner:number}): Promise<number> {\n\t\tlet result = await this.uqs.notes.CreateRootUnit.submit(param);\n\t\treturn result.id;\n\t}\n\n\tasync changeRootUnitName(item:RootUnitItem, name:string) {\n\t\tawait this.uqs.notes.ChangeRootUnitProp.submit({unit:item.id, prop:'name', value: name})\n\t\titem.name = name;\n\t}\n\n\tasync changeRootUnitTonva(item:RootUnitItem, tonvaUnit:any) {\n\t\tawait this.uqs.notes.ChangeRootUnitProp.submit({unit:item.id, prop:'tonvaUnit', value: tonvaUnit})\n\t\titem.tonvaUnit = tonvaUnit;\n\t}\n\n\tasync changeRootUnitX(item:RootUnitItem, x:number) {\n\t\tawait this.uqs.notes.ChangeRootUnitProp.submit({unit:item.id, prop:'x', value: x})\n\t\titem.x = x;\n\t}\n}\n","import { Tuid, Query, Action/*, Map, Sheet, Tag*/ } from \"../tonva\";\n\nexport enum EnumSpecFolder {notes=1};\n\nexport interface Notes {\n\tNote: Tuid;\n\n\tAddNote: Action;\n\tSetNote: Action;\n\tSetNoteX: Action;\n\tSendNoteTo: Action;\n\tHideNote: Action;\n\tAddContact: Action;\n\tSetContactAssinged: Action;\n\tAssignTask: Action;\n\n\tDoneTask: Action;\n\tCheckTask: Action;\n\tRateTask: Action;\n\n\tAddComment: Action;\n\n\tAddGroup: Action;\n\tSetGroup: Action;\n\n\t$Poked: Query;\n\tGetNotes: Query;\n\tGetMyContacts: Query;\n\tGetNote: Query;\n\tGetNoteItemFromId: Query;\n\tGetShareContacts: Query;\n\tGetSpawnContacts: Query;\n\tGetAssignToContacts: Query;\n\n\tAddGroupMember: Action;\n\tRemoveGroupMember: Action;\n\tGetGroupFolderMemberCount: Query;\n\tGetGroupMembers: Query;\n\tGetGroupContacts: Query;\n\n\tGetBookProjects: Query;\n\tGetProjectFlow: Query;\n\tGetProjectYearSum: Query;\n\tGetProjectMonthSum: Query;\n\tGetProjectDaySum: Query;\n\n\tInitMySetting: Action;\n\tGetSystemRole: Query;\n\n\tCreateRootUnit: Action;\n\tCreateUnit: Action;\n\tGetUnit: Query;\n\tSetUnitName: Action;\n\tAddUnitMember: Action;\n\tSetUnitMemberRole: Action;\n\tSetUnitMemberProp: Action;\n\tGetRootUnits: Query;\n\tChangeRootUnitProp: Action;\n\n\tBookProject: Tuid;\n\tBookReport: Tuid;\n\tGetRootUnitProjects: Query;\n\tGetRootUnitReports: Query;\n\tGetUnitProjects: Query;\n\tSetUnitProjects: Action;\n\tGetUnitSum: Query;\n\tGetMySum: Query;\n\n\tTestBusBootProject: Action;\n};\n\nexport interface UQs {\n    notes: Notes\n}\n","import React from 'react';\nimport { CDiscover } from './CDiscover';\nimport { VPage, LMR, FA } from '../tonva';\n\ninterface Item {\n\ticon: string;\n\tcaption: string;\n\tonClick: () => void;\n}\n\nexport class VDiscover extends VPage<CDiscover> {\n\tprivate onTaskReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate onOtherReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate items:(Item|string)[] = [\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t\t'-',\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t];\n\n\theader() {return this.t('discover')}\n\tcontent() {\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mb-1';\n\t\tlet right = <FA name=\"angle-right\" />;\n\t\treturn <div className=\"py-3\">\n\t\t\t<div>\n\t\t\t\t<button className=\"btn btn-primary\" onClick={this.testBus}>测试Bus</button>\n\t\t\t</div>\n\n\t\t\t{this.controller.cBook.renderBook()}\n\n\t\t\t{this.items.map((v, index) => {\n\t\t\t\tif (typeof v === 'string') {\n\t\t\t\t\treturn <div key={index} className=\"pt-2\" />;\n\t\t\t\t}\n\t\t\t\tlet {icon, caption, onClick} = v;\n\t\t\t\tlet left = <FA name={icon} />;\n\t\t\t\treturn <LMR key={index} className={cn} onClick={onClick} left={left} right={right}>\n\t\t\t\t\t{caption}\n\t\t\t\t</LMR>\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate testBus = async () => {\n\t\tawait this.controller.testBus();\n\t}\n}\n","import React from 'react';\nimport { View, FA } from \"../tonva\";\nimport { CBook, ProjectSum } from './CBook';\n\nexport class VBook extends View<CBook> {\n\trender() {\n\t\tlet {projectSums} = this.controller;\n\t\tif (projectSums.length === 0) return;\n\t\treturn <div className=\"px-3 mb-3 border-top\">\n\t\t\t{projectSums.map(v => { \n\t\t\t\t//let {id, name, debitYear, creditYear, debitMonth, creditMonth, debitWeek, creditWeek, debitDay, creditDay} = v;\n\t\t\t\tlet {id, name, debitMonth, debitWeek, debitDay} = v;\n\t\t\t\treturn <div key={id} className=\"row py-3 align-items-end border-bottom bg-white cursor-pointer\"\n\t\t\t\t\tonClick={() => this.onProject(v)}>\n\t\t\t\t\t<div className=\"col text-center\">{name}</div>\n\t\t\t\t\t{this.renderNumber('今天', debitDay)}\n\t\t\t\t\t{this.renderNumber('本周', debitWeek)}\n\t\t\t\t\t{this.renderNumber('本月', debitMonth)}\n\t\t\t\t\t<div className=\"mx-3\">\n\t\t\t\t\t\t<FA name=\"angle-right\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate renderNumber(caption:string, num:number) {\n\t\treturn <div className=\"text-center col\">\n\t\t\t<small className=\"text-muted\">{caption}</small><br/>\n\t\t\t<span>{num ?? 0}</span>\n\t\t</div>\n\t}\n\n\tprivate onProject = async (projectSum:ProjectSum) => {\n\t\tawait this.controller.showProjectFlow(projectSum);\n\t}\n}\n","import React from 'react';\nimport { CBook, ProjectFlowItem, ProjectSum } from './CBook';\nimport { VPage, List, EasyTime, FA } from '../tonva';\n\nexport class VFlow extends VPage<CBook> {\n\tprivate projectSum: ProjectSum;\n\tinit(param: ProjectSum) {\n\t\tthis.projectSum = param;\n\t}\n\n\theader() {return '明细 - ' + this.projectSum.name}\n\n\tcontent() {\n\t\treturn <div>\n\t\t\t<div className=\"px-3 py-2 d-flex\">\n\t\t\t\t<div className=\"w-8c\">日期</div>\n\t\t\t\t<div className=\"w-5c text-right\"><FA name=\"plus\"/></div>\n\t\t\t\t<div className=\"w-5c text-right\"><FA name=\"minus\"/></div>\n\t\t\t</div>\n\t\t\t<List\n\t\t\t\titems={this.controller.projectDetailPager}\n\t\t\t\titem={{render: this.renderFlowItem}}/>\n\t\t</div>;\n\t}\n\n\tprivate renderFlowItem = (flowItem:ProjectFlowItem) => {\n\t\tlet {stamp, memo, debit, credit} = flowItem;\n\t\treturn <div className=\"px-3 py-2 d-flex cursor-pointer\" onClick={()=>this.controller.showFlowItem(flowItem)}>\n\t\t\t<div className=\"w-8c\"><EasyTime date={stamp} /></div>\n\t\t\t<div className=\"w-5c text-right\">{debit}</div>\n\t\t\t<div className=\"w-5c text-right\">{credit}</div>\n\t\t\t<div className=\"ml-5\">{memo}</div>\n\t\t</div>;\n\t}\n}\n","import { CUqBase } from \"../tapp\";\nimport { initNoteItemObj, NoteItem } from \"../notes/model\";\nimport { VBook } from \"./VBook\";\nimport { QueryPager } from \"../tonva\";\nimport { VFlow } from \"./VFlow\";\n\nexport interface ProjectSum {\n\tid: number;\n\tname: string;\n\tdebitYear: number;\n\tcreditYear: number;\n\tdebitMonth: number;\n\tcreditMonth: number;\n\tdebitWeek: number;\n\tcreditWeek: number;\n\tdebitDay: number;\n\tcreditDay: number;\n\th8: number;\n}\n\nexport interface ProjectFlowItem {\n\tproject: number;\n\tstamp: Date;\n\tdebit: number;\n\tcredit: number;\n\tmemo: string;\n\tnote: number; \t\t// 关联的Note\n}\n\nexport class CBook extends CUqBase {\n\tprojectSums: ProjectSum[];\n\tprojectDetailPager: QueryPager<ProjectFlowItem>;\n\n    protected async internalStart() {\n\t}\n\n\tasync loadBookProjects() {\n\t\t//let ret = await this.uqs.notes.GetBookProjects.query({user: this.user.id, at: undefined}, true);\n\t\tthis.projectSums = []; //ret.ret;\n\t}\n\n\trenderBook() {\n\t\treturn this.renderView(VBook);\n\t}\n\n\tasync showProjectFlow(projectSum: ProjectSum) {\n\t\tthis.projectDetailPager = new QueryPager(this.uqs.notes.GetProjectFlow);\n\t\tthis.projectDetailPager.first({project: projectSum.id});\n\t\tthis.openVPage(VFlow, projectSum);\n\t}\n\n\tasync showFlowItem(projectFlowItem: ProjectFlowItem) {\n\t\tlet {note} = projectFlowItem;\n\t\tlet ret = await this.uqs.notes.GetNoteItemFromId.query({note});\n\t\tlet noteItem:NoteItem = ret.ret[0];\n\t\tinitNoteItemObj(noteItem);\n\t\tlet cNote = this.cApp.cHome.cNotes.createCNoteBase(noteItem);\n\t\tcNote.init(noteItem);\n\t\tcNote.showViewPage();\n\t}\n}\n","import { CUqBase } from \"../tapp\";\nimport { VDiscover } from \"./VDiscover\";\nimport { CBook } from \"../book\";\n\nexport class CDiscover extends CUqBase {\n\tcBook: CBook;\n\n    protected async internalStart() {\n\t}\n\n\tinit() {\n\t\tthis.cBook = this.newC(CBook);\n\t\treturn;\n\t}\n\n\tloadBookProjects = async () => {\n\t\tawait this.cBook.loadBookProjects();\n\t}\n\n\ttab = () => this.renderView(VDiscover);\n\n\tasync testBus() {\n\t\tawait this.uqs.notes.TestBusBootProject.submit({});\n\t\talert('test bus');\n\t}\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"../tonva\";\n\nexport class VTestMe extends VPage<CApp> {\n\theader() {return 'VTestMe'}\n\tcontent() {\n\t\treturn <div>VTestMe</div>;\n\t}\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"../tonva\";\nimport { VTestMe } from './VTestMe';\n\nexport class VTestAB extends VPage<CApp> {\n\theader() {return 'VTestAB'}\n\tcontent() {\n\t\treturn <div>\n\t\t\tVTestAB\n\t\t\t<button onClick={()=>this.go(()=>this.openVPage(VTestMe), '/bbbb/cccc')}>To Me</button>\n\t\t</div>;\n\t}\n}\n","import { zh } from \"./zh\";\nimport { en } from \"./en\";\n\nexport const res = {\n\t$zh: zh,\n\t$en: en,\n}\n","export const zh = {\n\thome: '首页',\n\trelation: '关系',\n\tdiscover: '发现',\n\tme: '我',\n\n\tchangePassword: '修改密码',\n\taboutTheApp: '关于本APP',\n\tlogout: '退出登录',\n\tpleaseLogin: '登录',\n\n\tnotes: '小单',\n\ttask: '任务',\n\tassign: '作业单',\n\n\tnoteSpace: '群',\n\n\tnoteText: '文字单',\n\tnoteList: '列表单',\n\tnoteCheckable: '勾选单',\n\tnoteTask: '布置任务',\n\tnoteFolder: '小单夹',\n\tnoteCreateSpace: '新建群',\n\n\tcontent: '内容',\n}\n","export const en = {\n\thome: 'Home',\n\trelation: 'Relation',\n\tdiscover: 'Discover',\n\tme: 'Me',\n\n\tchangePassword: 'Change password',\n\taboutTheApp: 'About the APP',\n\tlogout: 'Logout',\n\tpleaseLogin: 'Login',\n\n\tnotes: 'Notes',\n\ttask: 'Task',\n\tassign: 'Assign',\n\n\tnoteSpace: 'Group',\n\n\tnoteText: 'Text',\n\tnoteList: 'List',\n\tnoteCheckable: 'Checkable',\n\tnoteTask: 'Task',\n\tnoteFolder: 'Folder',\n\tnoteCreateSpace: 'Create Group',\n\n\tcontent: 'Content',\n}\n","import { CUqApp } from \"./CBase\";\nimport { VMain } from \"./main\";\nimport { CHome } from \"../home\";\nimport { CRelation } from \"../relation\";\nimport { CMe } from \"../me\";\nimport { CDiscover } from \"../discover\";\nimport { computed } from \"mobx\";\nimport { Contact } from \"model\";\nimport { VTestMe } from \"./VTestMe\";\nimport { VTestAB } from \"./VTestAB\";\nimport { res } from \"./res\";\n\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\n\nexport class CApp extends CUqApp {\n\tprivate timer:any;\n\tcHome: CHome;\n\tcRelation: CRelation;\n\tcDiscover: CDiscover;\n\tcMe: CMe;\n\n\tprotected async internalStart(isUserLogin: boolean) {\n\t\tthis.setRes(res);\n\t\tif (isUserLogin === true) await this.initMySetting();\n\t\tif (this.isRouting === false) await this.startHome();\n\t}\n\n\tprotected async startHome() {\n\t\tthis.cHome = this.newC(CHome);\n\t\tthis.cRelation = this.newC(CRelation);\n\t\tthis.cDiscover = this.newC(CDiscover);\n\t\tthis.cMe = this.newC(CMe);\n\t\tthis.cHome.load();\n\t\tthis.showMain();\n\n\t\tthis.timer = setInterval(this.callTick, 1000);\n\t}\n\n\tprivate async initMySetting() {\n\t\tlet timezone:number = - (new Date()).getTimezoneOffset() / 60;\n\t\tawait this.uqs.notes.InitMySetting.submit({timezone}, true);\n\t}\n\n\tprotected onDispose() {\n\t\tclearInterval(this.timer);\n\t\tthis.timer = undefined;\n\t}\n\n\tprotected async startMe() {\n\t\tthis.openVPage(VTestMe);\n\t}\n\n\tprotected async startAB() {\n\t\tthis.openVPage(VTestAB);\n\t}\n\n\tprotected onRoute() {\n\t\tthis.on({\n\t\t\t'/a/b': () => {\n\t\t\t\t// renderDom(<div>/a/b <button onClick={()=>nav.navigate('/c/d')}>test</button></div>)\n\t\t\t\tthis.startAB();\n\t\t\t},\n\t\t\t'/c/d': () => {\n\t\t\t\t/*\n\t\t\t\trenderDom(<div>\n\t\t\t\t\t/c/d\n\t\t\t\t\t<button onClick={()=>nav.navigate('/eeee/a/1?c=1 & d=3')}>test</button>\n\t\t\t\t</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/eeee/:action/:id': (params:any, queryStr:any) => {\n\t\t\t\t/*\n\t\t\t\tlet span:any;\n\t\t\t\tif (queryStr) {\n\t\t\t\t\tspan = <span>{queryStr}</span>\n\t\t\t\t}\n\t\t\t\trenderDom(<div>/e query:{span}  params:{JSON.stringify(params)}</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/bbbb/cccc': () => {\n\t\t\t\t//renderCApp(new CAppBBBBCCCC());\n\t\t\t\tthis.startMe();\n\t\t\t},\n\t\t});\n\t\tthis.on(() => {\n\t\t\t//renderCApp(new CApp());\n\t\t\tthis.startHome();\n\t\t});\n\t}\n\n\n\t@computed get contacts(): Contact[] {return this.cRelation.contacts;};\n\n\tasync loadRelation() {\n\t\tawait this.cRelation.load();\n\t}\n\n    private showMain(initTabName?: string) {\n        this.openVPage(VMain, initTabName, this.dispose);\n\t}\n\n\tprivate tick = 0;\n\tprivate gapIndex = 0;\n\tprivate callTick = async () => {\n\t\ttry {\n\t\t\tif (!this.user) return;\n\t\t\t++this.tick;\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\n\t\t\t//console.error('tick ', new Date());\n\t\t\tthis.tick = 0;\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\n\t\t\tlet ret = await this.uqs.notes.$Poked.query(undefined, false);\n\t\t\tlet v = ret.ret[0];\n\t\t\tif (v === undefined) return;\n\t\t\tif (!v.poke) return;\n\t\t\tthis.gapIndex = 1;\n\n\t\t\t// uq 里面加入这一句，会让相应的$Poked查询返回poke=1：\n\t\t\t// TUID [$User] ID (member) SET poke=1;\n\t\t\t// 这个地方重新调入的数据\n\t\t\tthis.cHome.refresh();\n\t\t}\n\t\tcatch {\n\t\t}\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import 'bootstrap/dist/css/bootstrap.css'\nimport './bootstrap.css';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport { NavView, start, nav } from './tonva';\nimport './App.css';\nimport { CApp, appConfig } from './tapp';\n\nasync function startApp() {\n\tnav.setSettings(appConfig);\n\t//如果要支持route，必须调用下面这一句\n\t//await startRoute(appConfig);\n\tconst App: React.FC = () => {\n\t\tconst onLogined = async (isUserLogin?: boolean) => {\n\t\t\tawait start(CApp, appConfig, isUserLogin);\n\t\t}\n\t\treturn <NavView onLogined={onLogined} />;\n\t}\n\n\tReactDOM.render(\n\t\t<React.StrictMode>\n\t\t\t<App />\n\t\t</React.StrictMode>,\n\t\tdocument.getElementById('root')\n\t);\n\n\t// If you want your app to work offline and load faster, you can change\n\t// unregister() to register() below. Note this comes with some pitfalls.\n\t// Learn more about service workers: https://bit.ly/CRA-PWA\n\tserviceWorker.unregister();\n}\n\nexport default function createApp() {\n\tnav.setSettings(appConfig);\n\tconst container = document.createElement('div')\n\tcontainer.id = 'app'\n\tdocument.body.appendChild(container)\n\tconst App: React.FC = () => {\n\t\tconst onLogined = async (isUserLogin?: boolean) => {\n\t\t\tawait start(CApp, appConfig, isUserLogin);\n\t\t}\n\t\treturn <NavView onLogined={onLogined} />;\n\t}\n\n\tReactDOM.render(\n\t\t<React.StrictMode>\n\t\t\t<App />\n\t\t</React.StrictMode>,\n\t\tcontainer\n\t);\n}\n\n\"undefined\" != typeof wx && wx.getSystemInfoSync || startApp()\n"],"sourceRoot":""}